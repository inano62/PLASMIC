(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function yk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var up={exports:{}},cc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uT;function uO(){if(uT)return cc;uT=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,o){var c=null;if(o!==void 0&&(c=""+o),a.key!==void 0&&(c=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:t,type:i,key:c,ref:a!==void 0?a:null,props:o}}return cc.Fragment=e,cc.jsx=n,cc.jsxs=n,cc}var dT;function dO(){return dT||(dT=1,up.exports=uO()),up.exports}var S=dO(),dp={exports:{}},He={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fT;function fO(){if(fT)return He;fT=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.iterator;function y(j){return j===null||typeof j!="object"?null:(j=v&&j[v]||j["@@iterator"],typeof j=="function"?j:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,E={};function x(j,te,he){this.props=j,this.context=te,this.refs=E,this.updater=he||T}x.prototype.isReactComponent={},x.prototype.setState=function(j,te){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,te,"setState")},x.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function _(){}_.prototype=x.prototype;function N(j,te,he){this.props=j,this.context=te,this.refs=E,this.updater=he||T}var P=N.prototype=new _;P.constructor=N,k(P,x.prototype),P.isPureReactComponent=!0;var O=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},w=Object.prototype.hasOwnProperty;function V(j,te,he,le,ge,De){return he=De.ref,{$$typeof:t,type:j,key:te,ref:he!==void 0?he:null,props:De}}function M(j,te){return V(j.type,te,void 0,void 0,void 0,j.props)}function D(j){return typeof j=="object"&&j!==null&&j.$$typeof===t}function B(j){var te={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(he){return te[he]})}var Y=/\/+/g;function re(j,te){return typeof j=="object"&&j!==null&&j.key!=null?B(""+j.key):te.toString(36)}function de(){}function be(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(de,de):(j.status="pending",j.then(function(te){j.status==="pending"&&(j.status="fulfilled",j.value=te)},function(te){j.status==="pending"&&(j.status="rejected",j.reason=te)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function xe(j,te,he,le,ge){var De=typeof j;(De==="undefined"||De==="boolean")&&(j=null);var ye=!1;if(j===null)ye=!0;else switch(De){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(j.$$typeof){case t:case e:ye=!0;break;case m:return ye=j._init,xe(ye(j._payload),te,he,le,ge)}}if(ye)return ge=ge(j),ye=le===""?"."+re(j,0):le,O(ge)?(he="",ye!=null&&(he=ye.replace(Y,"$&/")+"/"),xe(ge,te,he,"",function(yt){return yt})):ge!=null&&(D(ge)&&(ge=M(ge,he+(ge.key==null||j&&j.key===ge.key?"":(""+ge.key).replace(Y,"$&/")+"/")+ye)),te.push(ge)),1;ye=0;var Ae=le===""?".":le+":";if(O(j))for(var Be=0;Be<j.length;Be++)le=j[Be],De=Ae+re(le,Be),ye+=xe(le,te,he,De,ge);else if(Be=y(j),typeof Be=="function")for(j=Be.call(j),Be=0;!(le=j.next()).done;)le=le.value,De=Ae+re(le,Be++),ye+=xe(le,te,he,De,ge);else if(De==="object"){if(typeof j.then=="function")return xe(be(j),te,he,le,ge);throw te=String(j),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return ye}function H(j,te,he){if(j==null)return j;var le=[],ge=0;return xe(j,le,"","",function(De){return te.call(he,De,ge++)}),le}function ae(j){if(j._status===-1){var te=j._result;te=te(),te.then(function(he){(j._status===0||j._status===-1)&&(j._status=1,j._result=he)},function(he){(j._status===0||j._status===-1)&&(j._status=2,j._result=he)}),j._status===-1&&(j._status=0,j._result=te)}if(j._status===1)return j._result.default;throw j._result}var ee=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)};function Se(){}return He.Children={map:H,forEach:function(j,te,he){H(j,function(){te.apply(this,arguments)},he)},count:function(j){var te=0;return H(j,function(){te++}),te},toArray:function(j){return H(j,function(te){return te})||[]},only:function(j){if(!D(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},He.Component=x,He.Fragment=n,He.Profiler=a,He.PureComponent=N,He.StrictMode=i,He.Suspense=d,He.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,He.__COMPILER_RUNTIME={__proto__:null,c:function(j){return A.H.useMemoCache(j)}},He.cache=function(j){return function(){return j.apply(null,arguments)}},He.cloneElement=function(j,te,he){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var le=k({},j.props),ge=j.key,De=void 0;if(te!=null)for(ye in te.ref!==void 0&&(De=void 0),te.key!==void 0&&(ge=""+te.key),te)!w.call(te,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&te.ref===void 0||(le[ye]=te[ye]);var ye=arguments.length-2;if(ye===1)le.children=he;else if(1<ye){for(var Ae=Array(ye),Be=0;Be<ye;Be++)Ae[Be]=arguments[Be+2];le.children=Ae}return V(j.type,ge,void 0,void 0,De,le)},He.createContext=function(j){return j={$$typeof:c,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:o,_context:j},j},He.createElement=function(j,te,he){var le,ge={},De=null;if(te!=null)for(le in te.key!==void 0&&(De=""+te.key),te)w.call(te,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(ge[le]=te[le]);var ye=arguments.length-2;if(ye===1)ge.children=he;else if(1<ye){for(var Ae=Array(ye),Be=0;Be<ye;Be++)Ae[Be]=arguments[Be+2];ge.children=Ae}if(j&&j.defaultProps)for(le in ye=j.defaultProps,ye)ge[le]===void 0&&(ge[le]=ye[le]);return V(j,De,void 0,void 0,null,ge)},He.createRef=function(){return{current:null}},He.forwardRef=function(j){return{$$typeof:u,render:j}},He.isValidElement=D,He.lazy=function(j){return{$$typeof:m,_payload:{_status:-1,_result:j},_init:ae}},He.memo=function(j,te){return{$$typeof:h,type:j,compare:te===void 0?null:te}},He.startTransition=function(j){var te=A.T,he={};A.T=he;try{var le=j(),ge=A.S;ge!==null&&ge(he,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(Se,ee)}catch(De){ee(De)}finally{A.T=te}},He.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},He.use=function(j){return A.H.use(j)},He.useActionState=function(j,te,he){return A.H.useActionState(j,te,he)},He.useCallback=function(j,te){return A.H.useCallback(j,te)},He.useContext=function(j){return A.H.useContext(j)},He.useDebugValue=function(){},He.useDeferredValue=function(j,te){return A.H.useDeferredValue(j,te)},He.useEffect=function(j,te,he){var le=A.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return le.useEffect(j,te)},He.useId=function(){return A.H.useId()},He.useImperativeHandle=function(j,te,he){return A.H.useImperativeHandle(j,te,he)},He.useInsertionEffect=function(j,te){return A.H.useInsertionEffect(j,te)},He.useLayoutEffect=function(j,te){return A.H.useLayoutEffect(j,te)},He.useMemo=function(j,te){return A.H.useMemo(j,te)},He.useOptimistic=function(j,te){return A.H.useOptimistic(j,te)},He.useReducer=function(j,te,he){return A.H.useReducer(j,te,he)},He.useRef=function(j){return A.H.useRef(j)},He.useState=function(j){return A.H.useState(j)},He.useSyncExternalStore=function(j,te,he){return A.H.useSyncExternalStore(j,te,he)},He.useTransition=function(){return A.H.useTransition()},He.version="19.1.0",He}var hT;function Ev(){return hT||(hT=1,dp.exports=fO()),dp.exports}var b=Ev();const hO=yk(b);var fp={exports:{}},uc={},hp={exports:{}},mp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mT;function mO(){return mT||(mT=1,function(t){function e(H,ae){var ee=H.length;H.push(ae);e:for(;0<ee;){var Se=ee-1>>>1,j=H[Se];if(0<a(j,ae))H[Se]=ae,H[ee]=j,ee=Se;else break e}}function n(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var ae=H[0],ee=H.pop();if(ee!==ae){H[0]=ee;e:for(var Se=0,j=H.length,te=j>>>1;Se<te;){var he=2*(Se+1)-1,le=H[he],ge=he+1,De=H[ge];if(0>a(le,ee))ge<j&&0>a(De,le)?(H[Se]=De,H[ge]=ee,Se=ge):(H[Se]=le,H[he]=ee,Se=he);else if(ge<j&&0>a(De,ee))H[Se]=De,H[ge]=ee,Se=ge;else break e}}return ae}function a(H,ae){var ee=H.sortIndex-ae.sortIndex;return ee!==0?ee:H.id-ae.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var d=[],h=[],m=1,v=null,y=3,T=!1,k=!1,E=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function O(H){for(var ae=n(h);ae!==null;){if(ae.callback===null)i(h);else if(ae.startTime<=H)i(h),ae.sortIndex=ae.expirationTime,e(d,ae);else break;ae=n(h)}}function A(H){if(E=!1,O(H),!k)if(n(d)!==null)k=!0,w||(w=!0,re());else{var ae=n(h);ae!==null&&xe(A,ae.startTime-H)}}var w=!1,V=-1,M=5,D=-1;function B(){return x?!0:!(t.unstable_now()-D<M)}function Y(){if(x=!1,w){var H=t.unstable_now();D=H;var ae=!0;try{e:{k=!1,E&&(E=!1,N(V),V=-1),T=!0;var ee=y;try{t:{for(O(H),v=n(d);v!==null&&!(v.expirationTime>H&&B());){var Se=v.callback;if(typeof Se=="function"){v.callback=null,y=v.priorityLevel;var j=Se(v.expirationTime<=H);if(H=t.unstable_now(),typeof j=="function"){v.callback=j,O(H),ae=!0;break t}v===n(d)&&i(d),O(H)}else i(d);v=n(d)}if(v!==null)ae=!0;else{var te=n(h);te!==null&&xe(A,te.startTime-H),ae=!1}}break e}finally{v=null,y=ee,T=!1}ae=void 0}}finally{ae?re():w=!1}}}var re;if(typeof P=="function")re=function(){P(Y)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,be=de.port2;de.port1.onmessage=Y,re=function(){be.postMessage(null)}}else re=function(){_(Y,0)};function xe(H,ae){V=_(function(){H(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(H){switch(y){case 1:case 2:case 3:var ae=3;break;default:ae=y}var ee=y;y=ae;try{return H()}finally{y=ee}},t.unstable_requestPaint=function(){x=!0},t.unstable_runWithPriority=function(H,ae){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ee=y;y=H;try{return ae()}finally{y=ee}},t.unstable_scheduleCallback=function(H,ae,ee){var Se=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?Se+ee:Se):ee=Se,H){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ee+j,H={id:m++,callback:ae,priorityLevel:H,startTime:ee,expirationTime:j,sortIndex:-1},ee>Se?(H.sortIndex=ee,e(h,H),n(d)===null&&H===n(h)&&(E?(N(V),V=-1):E=!0,xe(A,ee-Se))):(H.sortIndex=j,e(d,H),k||T||(k=!0,w||(w=!0,re()))),H},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(H){var ae=y;return function(){var ee=y;y=ae;try{return H.apply(this,arguments)}finally{y=ee}}}}(mp)),mp}var pT;function pO(){return pT||(pT=1,hp.exports=mO()),hp.exports}var pp={exports:{}},dn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gT;function gO(){if(gT)return dn;gT=1;var t=Ev();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,h,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:d,containerInfo:h,implementation:m}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,dn.createPortal=function(d,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return o(d,h,null,m)},dn.flushSync=function(d){var h=c.T,m=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=h,i.p=m,i.d.f()}},dn.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(d,h))},dn.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},dn.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var m=h.as,v=u(m,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,T=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?i.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:T}):m==="script"&&i.d.X(d,{crossOrigin:v,integrity:y,fetchPriority:T,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},dn.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=u(h.as,h.crossOrigin);i.d.M(d,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(d)},dn.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,v=u(m,h.crossOrigin);i.d.L(d,m,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},dn.preloadModule=function(d,h){if(typeof d=="string")if(h){var m=u(h.as,h.crossOrigin);i.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(d)},dn.requestFormReset=function(d){i.d.r(d)},dn.unstable_batchedUpdates=function(d,h){return d(h)},dn.useFormState=function(d,h,m){return c.H.useFormState(d,h,m)},dn.useFormStatus=function(){return c.H.useHostTransitionStatus()},dn.version="19.1.0",dn}var vT;function Sk(){if(vT)return pp.exports;vT=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),pp.exports=gO(),pp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bT;function vO(){if(bT)return uc;bT=1;var t=pO(),e=Ev(),n=Sk();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var s=r,l=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(l=s.return),r=s.return;while(r)}return s.tag===3?l:null}function c(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function u(r){if(o(r)!==r)throw Error(i(188))}function d(r){var s=r.alternate;if(!s){if(s=o(r),s===null)throw Error(i(188));return s!==r?null:r}for(var l=r,f=s;;){var p=l.return;if(p===null)break;var g=p.alternate;if(g===null){if(f=p.return,f!==null){l=f;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===l)return u(p),r;if(g===f)return u(p),s;g=g.sibling}throw Error(i(188))}if(l.return!==f.return)l=p,f=g;else{for(var C=!1,R=p.child;R;){if(R===l){C=!0,l=p,f=g;break}if(R===f){C=!0,f=p,l=g;break}R=R.sibling}if(!C){for(R=g.child;R;){if(R===l){C=!0,l=g,f=p;break}if(R===f){C=!0,f=g,l=p;break}R=R.sibling}if(!C)throw Error(i(189))}}if(l.alternate!==f)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?r:s}function h(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=h(r),s!==null)return s;r=r.sibling}return null}var m=Object.assign,v=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),P=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function re(r){return r===null||typeof r!="object"?null:(r=Y&&r[Y]||r["@@iterator"],typeof r=="function"?r:null)}var de=Symbol.for("react.client.reference");function be(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===de?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case k:return"Fragment";case x:return"Profiler";case E:return"StrictMode";case A:return"Suspense";case w:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case T:return"Portal";case P:return(r.displayName||"Context")+".Provider";case N:return(r._context.displayName||"Context")+".Consumer";case O:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case V:return s=r.displayName||null,s!==null?s:be(r.type)||"Memo";case M:s=r._payload,r=r._init;try{return be(r(s))}catch{}}return null}var xe=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},Se=[],j=-1;function te(r){return{current:r}}function he(r){0>j||(r.current=Se[j],Se[j]=null,j--)}function le(r,s){j++,Se[j]=r.current,r.current=s}var ge=te(null),De=te(null),ye=te(null),Ae=te(null);function Be(r,s){switch(le(ye,s),le(De,r),le(ge,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?US(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=US(s),r=BS(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}he(ge),le(ge,r)}function yt(){he(ge),he(De),he(ye)}function st(r){r.memoizedState!==null&&le(Ae,r);var s=ge.current,l=BS(s,r.type);s!==l&&(le(De,r),le(ge,l))}function Vt(r){De.current===r&&(he(ge),he(De)),Ae.current===r&&(he(Ae),rc._currentValue=ee)}var Nn=Object.prototype.hasOwnProperty,$r=t.unstable_scheduleCallback,Dn=t.unstable_cancelCallback,hl=t.unstable_shouldYield,js=t.unstable_requestPaint,cn=t.unstable_now,ml=t.unstable_getCurrentPriorityLevel,Us=t.unstable_ImmediatePriority,Wn=t.unstable_UserBlockingPriority,gi=t.unstable_NormalPriority,Xn=t.unstable_LowPriority,vi=t.unstable_IdlePriority,Gr=t.log,Yr=t.unstable_setDisableYieldValue,tn=null,gt=null;function gn(r){if(typeof Gr=="function"&&Yr(r),gt&&typeof gt.setStrictMode=="function")try{gt.setStrictMode(tn,r)}catch{}}var nn=Math.clz32?Math.clz32:su,sh=Math.log,Vi=Math.LN2;function su(r){return r>>>=0,r===0?32:31-(sh(r)/Vi|0)|0}var qa=256,$a=4194304;function ur(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Ga(r,s,l){var f=r.pendingLanes;if(f===0)return 0;var p=0,g=r.suspendedLanes,C=r.pingedLanes;r=r.warmLanes;var R=f&134217727;return R!==0?(f=R&~g,f!==0?p=ur(f):(C&=R,C!==0?p=ur(C):l||(l=R&~r,l!==0&&(p=ur(l))))):(R=f&~g,R!==0?p=ur(R):C!==0?p=ur(C):l||(l=f&~r,l!==0&&(p=ur(l)))),p===0?0:s!==0&&s!==p&&(s&g)===0&&(g=p&-p,l=s&-s,g>=l||g===32&&(l&4194048)!==0)?s:p}function Hi(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function ou(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bs(){var r=qa;return qa<<=1,(qa&4194048)===0&&(qa=256),r}function lu(){var r=$a;return $a<<=1,($a&62914560)===0&&($a=4194304),r}function zs(r){for(var s=[],l=0;31>l;l++)s.push(r);return s}function Ya(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function cu(r,s,l,f,p,g){var C=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var R=r.entanglements,I=r.expirationTimes,K=r.hiddenUpdates;for(l=C&~l;0<l;){var ie=31-nn(l),oe=1<<ie;R[ie]=0,I[ie]=-1;var Q=K[ie];if(Q!==null)for(K[ie]=null,ie=0;ie<Q.length;ie++){var W=Q[ie];W!==null&&(W.lane&=-536870913)}l&=~oe}f!==0&&Ka(r,f,0),g!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=g&~(C&~s))}function Ka(r,s,l){r.pendingLanes|=s,r.suspendedLanes&=~s;var f=31-nn(s);r.entangledLanes|=s,r.entanglements[f]=r.entanglements[f]|1073741824|l&4194090}function Qa(r,s){var l=r.entangledLanes|=s;for(r=r.entanglements;l;){var f=31-nn(l),p=1<<f;p&s|r[f]&s&&(r[f]|=s),l&=~p}}function pl(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function gl(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function U(){var r=ae.p;return r!==0?r:(r=window.event,r===void 0?32:rT(r.type))}function q(r,s){var l=ae.p;try{return ae.p=r,s()}finally{ae.p=l}}var X=Math.random().toString(36).slice(2),ce="__reactFiber$"+X,me="__reactProps$"+X,ke="__reactContainer$"+X,Oe="__reactEvents$"+X,_e="__reactListeners$"+X,Me="__reactHandles$"+X,Le="__reactResources$"+X,we="__reactMarker$"+X;function Re(r){delete r[ce],delete r[me],delete r[Oe],delete r[_e],delete r[Me]}function Fe(r){var s=r[ce];if(s)return s;for(var l=r.parentNode;l;){if(s=l[ke]||l[ce]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(r=FS(r);r!==null;){if(l=r[ce])return l;r=FS(r)}return s}r=l,l=r.parentNode}return null}function rt(r){if(r=r[ce]||r[ke]){var s=r.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return r}return null}function Tt(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function wt(r){var s=r[Le];return s||(s=r[Le]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ze(r){r[we]=!0}var ct=new Set,Fi={};function Mn(r,s){fn(r,s),fn(r+"Capture",s)}function fn(r,s){for(Fi[r]=s,r=0;r<s.length;r++)ct.add(s[r])}var Zn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vs={},Kr={};function dr(r){return Nn.call(Kr,r)?!0:Nn.call(Vs,r)?!1:Zn.test(r)?Kr[r]=!0:(Vs[r]=!0,!1)}function fr(r,s,l){if(dr(s))if(l===null)r.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+l)}}function hr(r,s,l){if(l===null)r.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+l)}}function Ve(r,s,l,f){if(f===null)r.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(s,l,""+f)}}var It,mr;function vn(r){if(It===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);It=s&&s[1]||"",mr=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+It+r+mr}var kt=!1;function Qr(r,s){if(!r||kt)return"";kt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(W){var Q=W}Reflect.construct(r,[],oe)}else{try{oe.call()}catch(W){Q=W}r.call(oe.prototype)}}else{try{throw Error()}catch(W){Q=W}(oe=r())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(W){if(W&&Q&&typeof W.stack=="string")return[W.stack,Q.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=f.DetermineComponentFrameRoot(),C=g[0],R=g[1];if(C&&R){var I=C.split(`
`),K=R.split(`
`);for(p=f=0;f<I.length&&!I[f].includes("DetermineComponentFrameRoot");)f++;for(;p<K.length&&!K[p].includes("DetermineComponentFrameRoot");)p++;if(f===I.length||p===K.length)for(f=I.length-1,p=K.length-1;1<=f&&0<=p&&I[f]!==K[p];)p--;for(;1<=f&&0<=p;f--,p--)if(I[f]!==K[p]){if(f!==1||p!==1)do if(f--,p--,0>p||I[f]!==K[p]){var ie=`
`+I[f].replace(" at new "," at ");return r.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",r.displayName)),ie}while(1<=f&&0<=p);break}}}finally{kt=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?vn(l):""}function uu(r){switch(r.tag){case 26:case 27:case 5:return vn(r.type);case 16:return vn("Lazy");case 13:return vn("Suspense");case 19:return vn("SuspenseList");case 0:case 15:return Qr(r.type,!1);case 11:return Qr(r.type.render,!1);case 1:return Qr(r.type,!0);case 31:return vn("Activity");default:return""}}function du(r){try{var s="";do s+=uu(r),r=r.return;while(r);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Jn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Mb(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function aR(r){var s=Mb(r)?"checked":"value",l=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),f=""+r[s];if(!r.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var p=l.get,g=l.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return p.call(this)},set:function(C){f=""+C,g.call(this,C)}}),Object.defineProperty(r,s,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(C){f=""+C},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function fu(r){r._valueTracker||(r._valueTracker=aR(r))}function Pb(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var l=s.getValue(),f="";return r&&(f=Mb(r)?r.checked?"true":"false":r.value),r=f,r!==l?(s.setValue(r),!0):!1}function hu(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var sR=/[\n"\\]/g;function ei(r){return r.replace(sR,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function oh(r,s,l,f,p,g,C,R){r.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?r.type=C:r.removeAttribute("type"),s!=null?C==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+Jn(s)):r.value!==""+Jn(s)&&(r.value=""+Jn(s)):C!=="submit"&&C!=="reset"||r.removeAttribute("value"),s!=null?lh(r,C,Jn(s)):l!=null?lh(r,C,Jn(l)):f!=null&&r.removeAttribute("value"),p==null&&g!=null&&(r.defaultChecked=!!g),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?r.name=""+Jn(R):r.removeAttribute("name")}function Lb(r,s,l,f,p,g,C,R){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(r.type=g),s!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||s!=null))return;l=l!=null?""+Jn(l):"",s=s!=null?""+Jn(s):l,R||s===r.value||(r.value=s),r.defaultValue=s}f=f??p,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=R?r.checked:!!f,r.defaultChecked=!!f,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(r.name=C)}function lh(r,s,l){s==="number"&&hu(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function Hs(r,s,l,f){if(r=r.options,s){s={};for(var p=0;p<l.length;p++)s["$"+l[p]]=!0;for(l=0;l<r.length;l++)p=s.hasOwnProperty("$"+r[l].value),r[l].selected!==p&&(r[l].selected=p),p&&f&&(r[l].defaultSelected=!0)}else{for(l=""+Jn(l),s=null,p=0;p<r.length;p++){if(r[p].value===l){r[p].selected=!0,f&&(r[p].defaultSelected=!0);return}s!==null||r[p].disabled||(s=r[p])}s!==null&&(s.selected=!0)}}function Ib(r,s,l){if(s!=null&&(s=""+Jn(s),s!==r.value&&(r.value=s),l==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=l!=null?""+Jn(l):""}function jb(r,s,l,f){if(s==null){if(f!=null){if(l!=null)throw Error(i(92));if(xe(f)){if(1<f.length)throw Error(i(93));f=f[0]}l=f}l==null&&(l=""),s=l}l=Jn(s),r.defaultValue=l,f=r.textContent,f===l&&f!==""&&f!==null&&(r.value=f)}function Fs(r,s){if(s){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=s;return}}r.textContent=s}var oR=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ub(r,s,l){var f=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?f?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":f?r.setProperty(s,l):typeof l!="number"||l===0||oR.has(s)?s==="float"?r.cssFloat=l:r[s]=(""+l).trim():r[s]=l+"px"}function Bb(r,s,l){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,l!=null){for(var f in l)!l.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var p in s)f=s[p],s.hasOwnProperty(p)&&l[p]!==f&&Ub(r,p,f)}else for(var g in s)s.hasOwnProperty(g)&&Ub(r,g,s[g])}function ch(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lR=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cR=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mu(r){return cR.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var uh=null;function dh(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var qs=null,$s=null;function zb(r){var s=rt(r);if(s&&(r=s.stateNode)){var l=r[me]||null;e:switch(r=s.stateNode,s.type){case"input":if(oh(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+ei(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var f=l[s];if(f!==r&&f.form===r.form){var p=f[me]||null;if(!p)throw Error(i(90));oh(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<l.length;s++)f=l[s],f.form===r.form&&Pb(f)}break e;case"textarea":Ib(r,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&Hs(r,!!l.multiple,s,!1)}}}var fh=!1;function Vb(r,s,l){if(fh)return r(s,l);fh=!0;try{var f=r(s);return f}finally{if(fh=!1,(qs!==null||$s!==null)&&(Ju(),qs&&(s=qs,r=$s,$s=qs=null,zb(s),r)))for(s=0;s<r.length;s++)zb(r[s])}}function vl(r,s){var l=r.stateNode;if(l===null)return null;var f=l[me]||null;if(f===null)return null;l=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(i(231,s,typeof l));return l}var pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hh=!1;if(pr)try{var bl={};Object.defineProperty(bl,"passive",{get:function(){hh=!0}}),window.addEventListener("test",bl,bl),window.removeEventListener("test",bl,bl)}catch{hh=!1}var Wr=null,mh=null,pu=null;function Hb(){if(pu)return pu;var r,s=mh,l=s.length,f,p="value"in Wr?Wr.value:Wr.textContent,g=p.length;for(r=0;r<l&&s[r]===p[r];r++);var C=l-r;for(f=1;f<=C&&s[l-f]===p[g-f];f++);return pu=p.slice(r,1<f?1-f:void 0)}function gu(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function vu(){return!0}function Fb(){return!1}function bn(r){function s(l,f,p,g,C){this._reactName=l,this._targetInst=p,this.type=f,this.nativeEvent=g,this.target=C,this.currentTarget=null;for(var R in r)r.hasOwnProperty(R)&&(l=r[R],this[R]=l?l(g):g[R]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?vu:Fb,this.isPropagationStopped=Fb,this}return m(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=vu)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=vu)},persist:function(){},isPersistent:vu}),s}var Wa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bu=bn(Wa),yl=m({},Wa,{view:0,detail:0}),uR=bn(yl),ph,gh,Sl,yu=m({},yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bh,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Sl&&(Sl&&r.type==="mousemove"?(ph=r.screenX-Sl.screenX,gh=r.screenY-Sl.screenY):gh=ph=0,Sl=r),ph)},movementY:function(r){return"movementY"in r?r.movementY:gh}}),qb=bn(yu),dR=m({},yu,{dataTransfer:0}),fR=bn(dR),hR=m({},yl,{relatedTarget:0}),vh=bn(hR),mR=m({},Wa,{animationName:0,elapsedTime:0,pseudoElement:0}),pR=bn(mR),gR=m({},Wa,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),vR=bn(gR),bR=m({},Wa,{data:0}),$b=bn(bR),yR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},TR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ER(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=TR[r])?!!s[r]:!1}function bh(){return ER}var CR=m({},yl,{key:function(r){if(r.key){var s=yR[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=gu(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?SR[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bh,charCode:function(r){return r.type==="keypress"?gu(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?gu(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),kR=bn(CR),_R=m({},yu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gb=bn(_R),wR=m({},yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bh}),xR=bn(wR),RR=m({},Wa,{propertyName:0,elapsedTime:0,pseudoElement:0}),AR=bn(RR),OR=m({},yu,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),NR=bn(OR),DR=m({},Wa,{newState:0,oldState:0}),MR=bn(DR),PR=[9,13,27,32],yh=pr&&"CompositionEvent"in window,Tl=null;pr&&"documentMode"in document&&(Tl=document.documentMode);var LR=pr&&"TextEvent"in window&&!Tl,Yb=pr&&(!yh||Tl&&8<Tl&&11>=Tl),Kb=" ",Qb=!1;function Wb(r,s){switch(r){case"keyup":return PR.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xb(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Gs=!1;function IR(r,s){switch(r){case"compositionend":return Xb(s);case"keypress":return s.which!==32?null:(Qb=!0,Kb);case"textInput":return r=s.data,r===Kb&&Qb?null:r;default:return null}}function jR(r,s){if(Gs)return r==="compositionend"||!yh&&Wb(r,s)?(r=Hb(),pu=mh=Wr=null,Gs=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Yb&&s.locale!=="ko"?null:s.data;default:return null}}var UR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zb(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!UR[r.type]:s==="textarea"}function Jb(r,s,l,f){qs?$s?$s.push(f):$s=[f]:qs=f,s=ad(s,"onChange"),0<s.length&&(l=new bu("onChange","change",null,l,f),r.push({event:l,listeners:s}))}var El=null,Cl=null;function BR(r){MS(r,0)}function Su(r){var s=Tt(r);if(Pb(s))return r}function ey(r,s){if(r==="change")return s}var ty=!1;if(pr){var Sh;if(pr){var Th="oninput"in document;if(!Th){var ny=document.createElement("div");ny.setAttribute("oninput","return;"),Th=typeof ny.oninput=="function"}Sh=Th}else Sh=!1;ty=Sh&&(!document.documentMode||9<document.documentMode)}function iy(){El&&(El.detachEvent("onpropertychange",ry),Cl=El=null)}function ry(r){if(r.propertyName==="value"&&Su(Cl)){var s=[];Jb(s,Cl,r,dh(r)),Vb(BR,s)}}function zR(r,s,l){r==="focusin"?(iy(),El=s,Cl=l,El.attachEvent("onpropertychange",ry)):r==="focusout"&&iy()}function VR(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Su(Cl)}function HR(r,s){if(r==="click")return Su(s)}function FR(r,s){if(r==="input"||r==="change")return Su(s)}function qR(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Pn=typeof Object.is=="function"?Object.is:qR;function kl(r,s){if(Pn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var l=Object.keys(r),f=Object.keys(s);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var p=l[f];if(!Nn.call(s,p)||!Pn(r[p],s[p]))return!1}return!0}function ay(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function sy(r,s){var l=ay(r);r=0;for(var f;l;){if(l.nodeType===3){if(f=r+l.textContent.length,r<=s&&f>=s)return{node:l,offset:s-r};r=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=ay(l)}}function oy(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?oy(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function ly(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=hu(r.document);s instanceof r.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)r=s.contentWindow;else break;s=hu(r.document)}return s}function Eh(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var $R=pr&&"documentMode"in document&&11>=document.documentMode,Ys=null,Ch=null,_l=null,kh=!1;function cy(r,s,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;kh||Ys==null||Ys!==hu(f)||(f=Ys,"selectionStart"in f&&Eh(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),_l&&kl(_l,f)||(_l=f,f=ad(Ch,"onSelect"),0<f.length&&(s=new bu("onSelect","select",null,s,l),r.push({event:s,listeners:f}),s.target=Ys)))}function Xa(r,s){var l={};return l[r.toLowerCase()]=s.toLowerCase(),l["Webkit"+r]="webkit"+s,l["Moz"+r]="moz"+s,l}var Ks={animationend:Xa("Animation","AnimationEnd"),animationiteration:Xa("Animation","AnimationIteration"),animationstart:Xa("Animation","AnimationStart"),transitionrun:Xa("Transition","TransitionRun"),transitionstart:Xa("Transition","TransitionStart"),transitioncancel:Xa("Transition","TransitionCancel"),transitionend:Xa("Transition","TransitionEnd")},_h={},uy={};pr&&(uy=document.createElement("div").style,"AnimationEvent"in window||(delete Ks.animationend.animation,delete Ks.animationiteration.animation,delete Ks.animationstart.animation),"TransitionEvent"in window||delete Ks.transitionend.transition);function Za(r){if(_h[r])return _h[r];if(!Ks[r])return r;var s=Ks[r],l;for(l in s)if(s.hasOwnProperty(l)&&l in uy)return _h[r]=s[l];return r}var dy=Za("animationend"),fy=Za("animationiteration"),hy=Za("animationstart"),GR=Za("transitionrun"),YR=Za("transitionstart"),KR=Za("transitioncancel"),my=Za("transitionend"),py=new Map,wh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wh.push("scrollEnd");function bi(r,s){py.set(r,s),Mn(s,[r])}var gy=new WeakMap;function ti(r,s){if(typeof r=="object"&&r!==null){var l=gy.get(r);return l!==void 0?l:(s={value:r,source:s,stack:du(s)},gy.set(r,s),s)}return{value:r,source:s,stack:du(s)}}var ni=[],Qs=0,xh=0;function Tu(){for(var r=Qs,s=xh=Qs=0;s<r;){var l=ni[s];ni[s++]=null;var f=ni[s];ni[s++]=null;var p=ni[s];ni[s++]=null;var g=ni[s];if(ni[s++]=null,f!==null&&p!==null){var C=f.pending;C===null?p.next=p:(p.next=C.next,C.next=p),f.pending=p}g!==0&&vy(l,p,g)}}function Eu(r,s,l,f){ni[Qs++]=r,ni[Qs++]=s,ni[Qs++]=l,ni[Qs++]=f,xh|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function Rh(r,s,l,f){return Eu(r,s,l,f),Cu(r)}function Ws(r,s){return Eu(r,null,null,s),Cu(r)}function vy(r,s,l){r.lanes|=l;var f=r.alternate;f!==null&&(f.lanes|=l);for(var p=!1,g=r.return;g!==null;)g.childLanes|=l,f=g.alternate,f!==null&&(f.childLanes|=l),g.tag===22&&(r=g.stateNode,r===null||r._visibility&1||(p=!0)),r=g,g=g.return;return r.tag===3?(g=r.stateNode,p&&s!==null&&(p=31-nn(l),r=g.hiddenUpdates,f=r[p],f===null?r[p]=[s]:f.push(s),s.lane=l|536870912),g):null}function Cu(r){if(50<Wl)throw Wl=0,Pm=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var Xs={};function QR(r,s,l,f){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(r,s,l,f){return new QR(r,s,l,f)}function Ah(r){return r=r.prototype,!(!r||!r.isReactComponent)}function gr(r,s){var l=r.alternate;return l===null?(l=Ln(r.tag,s,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=s,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,s=r.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function by(r,s){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,s=l.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function ku(r,s,l,f,p,g){var C=0;if(f=r,typeof r=="function")Ah(r)&&(C=1);else if(typeof r=="string")C=XA(r,l,ge.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=Ln(31,l,s,p),r.elementType=D,r.lanes=g,r;case k:return Ja(l.children,p,g,s);case E:C=8,p|=24;break;case x:return r=Ln(12,l,s,p|2),r.elementType=x,r.lanes=g,r;case A:return r=Ln(13,l,s,p),r.elementType=A,r.lanes=g,r;case w:return r=Ln(19,l,s,p),r.elementType=w,r.lanes=g,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case _:case P:C=10;break e;case N:C=9;break e;case O:C=11;break e;case V:C=14;break e;case M:C=16,f=null;break e}C=29,l=Error(i(130,r===null?"null":typeof r,"")),f=null}return s=Ln(C,l,s,p),s.elementType=r,s.type=f,s.lanes=g,s}function Ja(r,s,l,f){return r=Ln(7,r,f,s),r.lanes=l,r}function Oh(r,s,l){return r=Ln(6,r,null,s),r.lanes=l,r}function Nh(r,s,l){return s=Ln(4,r.children!==null?r.children:[],r.key,s),s.lanes=l,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var Zs=[],Js=0,_u=null,wu=0,ii=[],ri=0,es=null,vr=1,br="";function ts(r,s){Zs[Js++]=wu,Zs[Js++]=_u,_u=r,wu=s}function yy(r,s,l){ii[ri++]=vr,ii[ri++]=br,ii[ri++]=es,es=r;var f=vr;r=br;var p=32-nn(f)-1;f&=~(1<<p),l+=1;var g=32-nn(s)+p;if(30<g){var C=p-p%5;g=(f&(1<<C)-1).toString(32),f>>=C,p-=C,vr=1<<32-nn(s)+p|l<<p|f,br=g+r}else vr=1<<g|l<<p|f,br=r}function Dh(r){r.return!==null&&(ts(r,1),yy(r,1,0))}function Mh(r){for(;r===_u;)_u=Zs[--Js],Zs[Js]=null,wu=Zs[--Js],Zs[Js]=null;for(;r===es;)es=ii[--ri],ii[ri]=null,br=ii[--ri],ii[ri]=null,vr=ii[--ri],ii[ri]=null}var hn=null,xt=null,at=!1,ns=null,qi=!1,Ph=Error(i(519));function is(r){var s=Error(i(418,""));throw Rl(ti(s,r)),Ph}function Sy(r){var s=r.stateNode,l=r.type,f=r.memoizedProps;switch(s[ce]=r,s[me]=f,l){case"dialog":Ze("cancel",s),Ze("close",s);break;case"iframe":case"object":case"embed":Ze("load",s);break;case"video":case"audio":for(l=0;l<Zl.length;l++)Ze(Zl[l],s);break;case"source":Ze("error",s);break;case"img":case"image":case"link":Ze("error",s),Ze("load",s);break;case"details":Ze("toggle",s);break;case"input":Ze("invalid",s),Lb(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),fu(s);break;case"select":Ze("invalid",s);break;case"textarea":Ze("invalid",s),jb(s,f.value,f.defaultValue,f.children),fu(s)}l=f.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||f.suppressHydrationWarning===!0||jS(s.textContent,l)?(f.popover!=null&&(Ze("beforetoggle",s),Ze("toggle",s)),f.onScroll!=null&&Ze("scroll",s),f.onScrollEnd!=null&&Ze("scrollend",s),f.onClick!=null&&(s.onclick=sd),s=!0):s=!1,s||is(r)}function Ty(r){for(hn=r.return;hn;)switch(hn.tag){case 5:case 13:qi=!1;return;case 27:case 3:qi=!0;return;default:hn=hn.return}}function wl(r){if(r!==hn)return!1;if(!at)return Ty(r),at=!0,!1;var s=r.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||Wm(r.type,r.memoizedProps)),l=!l),l&&xt&&is(r),Ty(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8)if(l=r.data,l==="/$"){if(s===0){xt=Si(r.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;r=r.nextSibling}xt=null}}else s===27?(s=xt,fa(r.type)?(r=ep,ep=null,xt=r):xt=s):xt=hn?Si(r.stateNode.nextSibling):null;return!0}function xl(){xt=hn=null,at=!1}function Ey(){var r=ns;return r!==null&&(Tn===null?Tn=r:Tn.push.apply(Tn,r),ns=null),r}function Rl(r){ns===null?ns=[r]:ns.push(r)}var Lh=te(null),rs=null,yr=null;function Xr(r,s,l){le(Lh,s._currentValue),s._currentValue=l}function Sr(r){r._currentValue=Lh.current,he(Lh)}function Ih(r,s,l){for(;r!==null;){var f=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),r===l)break;r=r.return}}function jh(r,s,l,f){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var g=p.dependencies;if(g!==null){var C=p.child;g=g.firstContext;e:for(;g!==null;){var R=g;g=p;for(var I=0;I<s.length;I++)if(R.context===s[I]){g.lanes|=l,R=g.alternate,R!==null&&(R.lanes|=l),Ih(g.return,l,r),f||(C=null);break e}g=R.next}}else if(p.tag===18){if(C=p.return,C===null)throw Error(i(341));C.lanes|=l,g=C.alternate,g!==null&&(g.lanes|=l),Ih(C,l,r),C=null}else C=p.child;if(C!==null)C.return=p;else for(C=p;C!==null;){if(C===r){C=null;break}if(p=C.sibling,p!==null){p.return=C.return,C=p;break}C=C.return}p=C}}function Al(r,s,l,f){r=null;for(var p=s,g=!1;p!==null;){if(!g){if((p.flags&524288)!==0)g=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var C=p.alternate;if(C===null)throw Error(i(387));if(C=C.memoizedProps,C!==null){var R=p.type;Pn(p.pendingProps.value,C.value)||(r!==null?r.push(R):r=[R])}}else if(p===Ae.current){if(C=p.alternate,C===null)throw Error(i(387));C.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(rc):r=[rc])}p=p.return}r!==null&&jh(s,r,l,f),s.flags|=262144}function xu(r){for(r=r.firstContext;r!==null;){if(!Pn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function as(r){rs=r,yr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function un(r){return Cy(rs,r)}function Ru(r,s){return rs===null&&as(r),Cy(r,s)}function Cy(r,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},yr===null){if(r===null)throw Error(i(308));yr=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else yr=yr.next=s;return l}var WR=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(l,f){r.push(f)}};this.abort=function(){s.aborted=!0,r.forEach(function(l){return l()})}},XR=t.unstable_scheduleCallback,ZR=t.unstable_NormalPriority,Ht={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uh(){return{controller:new WR,data:new Map,refCount:0}}function Ol(r){r.refCount--,r.refCount===0&&XR(ZR,function(){r.controller.abort()})}var Nl=null,Bh=0,eo=0,to=null;function JR(r,s){if(Nl===null){var l=Nl=[];Bh=0,eo=Vm(),to={status:"pending",value:void 0,then:function(f){l.push(f)}}}return Bh++,s.then(ky,ky),s}function ky(){if(--Bh===0&&Nl!==null){to!==null&&(to.status="fulfilled");var r=Nl;Nl=null,eo=0,to=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function eA(r,s){var l=[],f={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return r.then(function(){f.status="fulfilled",f.value=s;for(var p=0;p<l.length;p++)(0,l[p])(s)},function(p){for(f.status="rejected",f.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),f}var _y=H.S;H.S=function(r,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&JR(r,s),_y!==null&&_y(r,s)};var ss=te(null);function zh(){var r=ss.current;return r!==null?r:vt.pooledCache}function Au(r,s){s===null?le(ss,ss.current):le(ss,s.pool)}function wy(){var r=zh();return r===null?null:{parent:Ht._currentValue,pool:r}}var Dl=Error(i(460)),xy=Error(i(474)),Ou=Error(i(542)),Vh={then:function(){}};function Ry(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Nu(){}function Ay(r,s,l){switch(l=r[l],l===void 0?r.push(s):l!==s&&(s.then(Nu,Nu),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,Ny(r),r;default:if(typeof s.status=="string")s.then(Nu,Nu);else{if(r=vt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(f){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=f}},function(f){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,Ny(r),r}throw Ml=s,Dl}}var Ml=null;function Oy(){if(Ml===null)throw Error(i(459));var r=Ml;return Ml=null,r}function Ny(r){if(r===Dl||r===Ou)throw Error(i(483))}var Zr=!1;function Hh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Fh(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Jr(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ea(r,s,l){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(ot&2)!==0){var p=f.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),f.pending=s,s=Cu(r),vy(r,null,l),s}return Eu(r,f,s,l),Cu(r)}function Pl(r,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var f=s.lanes;f&=r.pendingLanes,l|=f,s.lanes=l,Qa(r,l)}}function qh(r,s){var l=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var p=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var C={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?p=g=C:g=g.next=C,l=l.next}while(l!==null);g===null?p=g=s:g=g.next=s}else p=g=s;l={baseState:f.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:f.shared,callbacks:f.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=s:r.next=s,l.lastBaseUpdate=s}var $h=!1;function Ll(){if($h){var r=to;if(r!==null)throw r}}function Il(r,s,l,f){$h=!1;var p=r.updateQueue;Zr=!1;var g=p.firstBaseUpdate,C=p.lastBaseUpdate,R=p.shared.pending;if(R!==null){p.shared.pending=null;var I=R,K=I.next;I.next=null,C===null?g=K:C.next=K,C=I;var ie=r.alternate;ie!==null&&(ie=ie.updateQueue,R=ie.lastBaseUpdate,R!==C&&(R===null?ie.firstBaseUpdate=K:R.next=K,ie.lastBaseUpdate=I))}if(g!==null){var oe=p.baseState;C=0,ie=K=I=null,R=g;do{var Q=R.lane&-536870913,W=Q!==R.lane;if(W?(tt&Q)===Q:(f&Q)===Q){Q!==0&&Q===eo&&($h=!0),ie!==null&&(ie=ie.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Ue=r,Ie=R;Q=s;var ft=l;switch(Ie.tag){case 1:if(Ue=Ie.payload,typeof Ue=="function"){oe=Ue.call(ft,oe,Q);break e}oe=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=Ie.payload,Q=typeof Ue=="function"?Ue.call(ft,oe,Q):Ue,Q==null)break e;oe=m({},oe,Q);break e;case 2:Zr=!0}}Q=R.callback,Q!==null&&(r.flags|=64,W&&(r.flags|=8192),W=p.callbacks,W===null?p.callbacks=[Q]:W.push(Q))}else W={lane:Q,tag:R.tag,payload:R.payload,callback:R.callback,next:null},ie===null?(K=ie=W,I=oe):ie=ie.next=W,C|=Q;if(R=R.next,R===null){if(R=p.shared.pending,R===null)break;W=R,R=W.next,W.next=null,p.lastBaseUpdate=W,p.shared.pending=null}}while(!0);ie===null&&(I=oe),p.baseState=I,p.firstBaseUpdate=K,p.lastBaseUpdate=ie,g===null&&(p.shared.lanes=0),la|=C,r.lanes=C,r.memoizedState=oe}}function Dy(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function My(r,s){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)Dy(l[r],s)}var no=te(null),Du=te(0);function Py(r,s){r=xr,le(Du,r),le(no,s),xr=r|s.baseLanes}function Gh(){le(Du,xr),le(no,no.current)}function Yh(){xr=Du.current,he(no),he(Du)}var ta=0,qe=null,ut=null,jt=null,Mu=!1,io=!1,os=!1,Pu=0,jl=0,ro=null,tA=0;function Mt(){throw Error(i(321))}function Kh(r,s){if(s===null)return!1;for(var l=0;l<s.length&&l<r.length;l++)if(!Pn(r[l],s[l]))return!1;return!0}function Qh(r,s,l,f,p,g){return ta=g,qe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,H.H=r===null||r.memoizedState===null?v0:b0,os=!1,g=l(f,p),os=!1,io&&(g=Iy(s,l,f,p)),Ly(r),g}function Ly(r){H.H=zu;var s=ut!==null&&ut.next!==null;if(ta=0,jt=ut=qe=null,Mu=!1,jl=0,ro=null,s)throw Error(i(300));r===null||Qt||(r=r.dependencies,r!==null&&xu(r)&&(Qt=!0))}function Iy(r,s,l,f){qe=r;var p=0;do{if(io&&(ro=null),jl=0,io=!1,25<=p)throw Error(i(301));if(p+=1,jt=ut=null,r.updateQueue!=null){var g=r.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}H.H=lA,g=s(l,f)}while(io);return g}function nA(){var r=H.H,s=r.useState()[0];return s=typeof s.then=="function"?Ul(s):s,r=r.useState()[0],(ut!==null?ut.memoizedState:null)!==r&&(qe.flags|=1024),s}function Wh(){var r=Pu!==0;return Pu=0,r}function Xh(r,s,l){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~l}function Zh(r){if(Mu){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Mu=!1}ta=0,jt=ut=qe=null,io=!1,jl=Pu=0,ro=null}function yn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?qe.memoizedState=jt=r:jt=jt.next=r,jt}function Ut(){if(ut===null){var r=qe.alternate;r=r!==null?r.memoizedState:null}else r=ut.next;var s=jt===null?qe.memoizedState:jt.next;if(s!==null)jt=s,ut=r;else{if(r===null)throw qe.alternate===null?Error(i(467)):Error(i(310));ut=r,r={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},jt===null?qe.memoizedState=jt=r:jt=jt.next=r}return jt}function Jh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ul(r){var s=jl;return jl+=1,ro===null&&(ro=[]),r=Ay(ro,r,s),s=qe,(jt===null?s.memoizedState:jt.next)===null&&(s=s.alternate,H.H=s===null||s.memoizedState===null?v0:b0),r}function Lu(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Ul(r);if(r.$$typeof===P)return un(r)}throw Error(i(438,String(r)))}function em(r){var s=null,l=qe.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var f=qe.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=Jh(),qe.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(r),f=0;f<r;f++)l[f]=B;return s.index++,l}function Tr(r,s){return typeof s=="function"?s(r):s}function Iu(r){var s=Ut();return tm(s,ut,r)}function tm(r,s,l){var f=r.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=l;var p=r.baseQueue,g=f.pending;if(g!==null){if(p!==null){var C=p.next;p.next=g.next,g.next=C}s.baseQueue=p=g,f.pending=null}if(g=r.baseState,p===null)r.memoizedState=g;else{s=p.next;var R=C=null,I=null,K=s,ie=!1;do{var oe=K.lane&-536870913;if(oe!==K.lane?(tt&oe)===oe:(ta&oe)===oe){var Q=K.revertLane;if(Q===0)I!==null&&(I=I.next={lane:0,revertLane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),oe===eo&&(ie=!0);else if((ta&Q)===Q){K=K.next,Q===eo&&(ie=!0);continue}else oe={lane:0,revertLane:K.revertLane,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},I===null?(R=I=oe,C=g):I=I.next=oe,qe.lanes|=Q,la|=Q;oe=K.action,os&&l(g,oe),g=K.hasEagerState?K.eagerState:l(g,oe)}else Q={lane:oe,revertLane:K.revertLane,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},I===null?(R=I=Q,C=g):I=I.next=Q,qe.lanes|=oe,la|=oe;K=K.next}while(K!==null&&K!==s);if(I===null?C=g:I.next=R,!Pn(g,r.memoizedState)&&(Qt=!0,ie&&(l=to,l!==null)))throw l;r.memoizedState=g,r.baseState=C,r.baseQueue=I,f.lastRenderedState=g}return p===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function nm(r){var s=Ut(),l=s.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=r;var f=l.dispatch,p=l.pending,g=s.memoizedState;if(p!==null){l.pending=null;var C=p=p.next;do g=r(g,C.action),C=C.next;while(C!==p);Pn(g,s.memoizedState)||(Qt=!0),s.memoizedState=g,s.baseQueue===null&&(s.baseState=g),l.lastRenderedState=g}return[g,f]}function jy(r,s,l){var f=qe,p=Ut(),g=at;if(g){if(l===void 0)throw Error(i(407));l=l()}else l=s();var C=!Pn((ut||p).memoizedState,l);C&&(p.memoizedState=l,Qt=!0),p=p.queue;var R=zy.bind(null,f,p,r);if(Bl(2048,8,R,[r]),p.getSnapshot!==s||C||jt!==null&&jt.memoizedState.tag&1){if(f.flags|=2048,ao(9,ju(),By.bind(null,f,p,l,s),null),vt===null)throw Error(i(349));g||(ta&124)!==0||Uy(f,s,l)}return l}function Uy(r,s,l){r.flags|=16384,r={getSnapshot:s,value:l},s=qe.updateQueue,s===null?(s=Jh(),qe.updateQueue=s,s.stores=[r]):(l=s.stores,l===null?s.stores=[r]:l.push(r))}function By(r,s,l,f){s.value=l,s.getSnapshot=f,Vy(s)&&Hy(r)}function zy(r,s,l){return l(function(){Vy(s)&&Hy(r)})}function Vy(r){var s=r.getSnapshot;r=r.value;try{var l=s();return!Pn(r,l)}catch{return!0}}function Hy(r){var s=Ws(r,2);s!==null&&zn(s,r,2)}function im(r){var s=yn();if(typeof r=="function"){var l=r;if(r=l(),os){gn(!0);try{l()}finally{gn(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tr,lastRenderedState:r},s}function Fy(r,s,l,f){return r.baseState=l,tm(r,ut,typeof f=="function"?f:Tr)}function iA(r,s,l,f,p){if(Bu(r))throw Error(i(485));if(r=s.action,r!==null){var g={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){g.listeners.push(C)}};H.T!==null?l(!0):g.isTransition=!1,f(g),l=s.pending,l===null?(g.next=s.pending=g,qy(s,g)):(g.next=l.next,s.pending=l.next=g)}}function qy(r,s){var l=s.action,f=s.payload,p=r.state;if(s.isTransition){var g=H.T,C={};H.T=C;try{var R=l(p,f),I=H.S;I!==null&&I(C,R),$y(r,s,R)}catch(K){rm(r,s,K)}finally{H.T=g}}else try{g=l(p,f),$y(r,s,g)}catch(K){rm(r,s,K)}}function $y(r,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(f){Gy(r,s,f)},function(f){return rm(r,s,f)}):Gy(r,s,l)}function Gy(r,s,l){s.status="fulfilled",s.value=l,Yy(s),r.state=l,s=r.pending,s!==null&&(l=s.next,l===s?r.pending=null:(l=l.next,s.next=l,qy(r,l)))}function rm(r,s,l){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=l,Yy(s),s=s.next;while(s!==f)}r.action=null}function Yy(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function Ky(r,s){return s}function Qy(r,s){if(at){var l=vt.formState;if(l!==null){e:{var f=qe;if(at){if(xt){t:{for(var p=xt,g=qi;p.nodeType!==8;){if(!g){p=null;break t}if(p=Si(p.nextSibling),p===null){p=null;break t}}g=p.data,p=g==="F!"||g==="F"?p:null}if(p){xt=Si(p.nextSibling),f=p.data==="F!";break e}}is(f)}f=!1}f&&(s=l[0])}}return l=yn(),l.memoizedState=l.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ky,lastRenderedState:s},l.queue=f,l=m0.bind(null,qe,f),f.dispatch=l,f=im(!1),g=cm.bind(null,qe,!1,f.queue),f=yn(),p={state:s,dispatch:null,action:r,pending:null},f.queue=p,l=iA.bind(null,qe,p,g,l),p.dispatch=l,f.memoizedState=r,[s,l,!1]}function Wy(r){var s=Ut();return Xy(s,ut,r)}function Xy(r,s,l){if(s=tm(r,s,Ky)[0],r=Iu(Tr)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=Ul(s)}catch(C){throw C===Dl?Ou:C}else f=s;s=Ut();var p=s.queue,g=p.dispatch;return l!==s.memoizedState&&(qe.flags|=2048,ao(9,ju(),rA.bind(null,p,l),null)),[f,g,r]}function rA(r,s){r.action=s}function Zy(r){var s=Ut(),l=ut;if(l!==null)return Xy(s,l,r);Ut(),s=s.memoizedState,l=Ut();var f=l.queue.dispatch;return l.memoizedState=r,[s,f,!1]}function ao(r,s,l,f){return r={tag:r,create:l,deps:f,inst:s,next:null},s=qe.updateQueue,s===null&&(s=Jh(),qe.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=r.next=r:(f=l.next,l.next=r,r.next=f,s.lastEffect=r),r}function ju(){return{destroy:void 0,resource:void 0}}function Jy(){return Ut().memoizedState}function Uu(r,s,l,f){var p=yn();f=f===void 0?null:f,qe.flags|=r,p.memoizedState=ao(1|s,ju(),l,f)}function Bl(r,s,l,f){var p=Ut();f=f===void 0?null:f;var g=p.memoizedState.inst;ut!==null&&f!==null&&Kh(f,ut.memoizedState.deps)?p.memoizedState=ao(s,g,l,f):(qe.flags|=r,p.memoizedState=ao(1|s,g,l,f))}function e0(r,s){Uu(8390656,8,r,s)}function t0(r,s){Bl(2048,8,r,s)}function n0(r,s){return Bl(4,2,r,s)}function i0(r,s){return Bl(4,4,r,s)}function r0(r,s){if(typeof s=="function"){r=r();var l=s(r);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function a0(r,s,l){l=l!=null?l.concat([r]):null,Bl(4,4,r0.bind(null,s,r),l)}function am(){}function s0(r,s){var l=Ut();s=s===void 0?null:s;var f=l.memoizedState;return s!==null&&Kh(s,f[1])?f[0]:(l.memoizedState=[r,s],r)}function o0(r,s){var l=Ut();s=s===void 0?null:s;var f=l.memoizedState;if(s!==null&&Kh(s,f[1]))return f[0];if(f=r(),os){gn(!0);try{r()}finally{gn(!1)}}return l.memoizedState=[f,s],f}function sm(r,s,l){return l===void 0||(ta&1073741824)!==0?r.memoizedState=s:(r.memoizedState=l,r=uS(),qe.lanes|=r,la|=r,l)}function l0(r,s,l,f){return Pn(l,s)?l:no.current!==null?(r=sm(r,l,f),Pn(r,s)||(Qt=!0),r):(ta&42)===0?(Qt=!0,r.memoizedState=l):(r=uS(),qe.lanes|=r,la|=r,s)}function c0(r,s,l,f,p){var g=ae.p;ae.p=g!==0&&8>g?g:8;var C=H.T,R={};H.T=R,cm(r,!1,s,l);try{var I=p(),K=H.S;if(K!==null&&K(R,I),I!==null&&typeof I=="object"&&typeof I.then=="function"){var ie=eA(I,f);zl(r,s,ie,Bn(r))}else zl(r,s,f,Bn(r))}catch(oe){zl(r,s,{then:function(){},status:"rejected",reason:oe},Bn())}finally{ae.p=g,H.T=C}}function aA(){}function om(r,s,l,f){if(r.tag!==5)throw Error(i(476));var p=u0(r).queue;c0(r,p,s,ee,l===null?aA:function(){return d0(r),l(f)})}function u0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tr,lastRenderedState:ee},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tr,lastRenderedState:l},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function d0(r){var s=u0(r).next.queue;zl(r,s,{},Bn())}function lm(){return un(rc)}function f0(){return Ut().memoizedState}function h0(){return Ut().memoizedState}function sA(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var l=Bn();r=Jr(l);var f=ea(s,r,l);f!==null&&(zn(f,s,l),Pl(f,s,l)),s={cache:Uh()},r.payload=s;return}s=s.return}}function oA(r,s,l){var f=Bn();l={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Bu(r)?p0(s,l):(l=Rh(r,s,l,f),l!==null&&(zn(l,r,f),g0(l,s,f)))}function m0(r,s,l){var f=Bn();zl(r,s,l,f)}function zl(r,s,l,f){var p={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Bu(r))p0(s,p);else{var g=r.alternate;if(r.lanes===0&&(g===null||g.lanes===0)&&(g=s.lastRenderedReducer,g!==null))try{var C=s.lastRenderedState,R=g(C,l);if(p.hasEagerState=!0,p.eagerState=R,Pn(R,C))return Eu(r,s,p,0),vt===null&&Tu(),!1}catch{}finally{}if(l=Rh(r,s,p,f),l!==null)return zn(l,r,f),g0(l,s,f),!0}return!1}function cm(r,s,l,f){if(f={lane:2,revertLane:Vm(),action:f,hasEagerState:!1,eagerState:null,next:null},Bu(r)){if(s)throw Error(i(479))}else s=Rh(r,l,f,2),s!==null&&zn(s,r,2)}function Bu(r){var s=r.alternate;return r===qe||s!==null&&s===qe}function p0(r,s){io=Mu=!0;var l=r.pending;l===null?s.next=s:(s.next=l.next,l.next=s),r.pending=s}function g0(r,s,l){if((l&4194048)!==0){var f=s.lanes;f&=r.pendingLanes,l|=f,s.lanes=l,Qa(r,l)}}var zu={readContext:un,use:Lu,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useLayoutEffect:Mt,useInsertionEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useSyncExternalStore:Mt,useId:Mt,useHostTransitionStatus:Mt,useFormState:Mt,useActionState:Mt,useOptimistic:Mt,useMemoCache:Mt,useCacheRefresh:Mt},v0={readContext:un,use:Lu,useCallback:function(r,s){return yn().memoizedState=[r,s===void 0?null:s],r},useContext:un,useEffect:e0,useImperativeHandle:function(r,s,l){l=l!=null?l.concat([r]):null,Uu(4194308,4,r0.bind(null,s,r),l)},useLayoutEffect:function(r,s){return Uu(4194308,4,r,s)},useInsertionEffect:function(r,s){Uu(4,2,r,s)},useMemo:function(r,s){var l=yn();s=s===void 0?null:s;var f=r();if(os){gn(!0);try{r()}finally{gn(!1)}}return l.memoizedState=[f,s],f},useReducer:function(r,s,l){var f=yn();if(l!==void 0){var p=l(s);if(os){gn(!0);try{l(s)}finally{gn(!1)}}}else p=s;return f.memoizedState=f.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},f.queue=r,r=r.dispatch=oA.bind(null,qe,r),[f.memoizedState,r]},useRef:function(r){var s=yn();return r={current:r},s.memoizedState=r},useState:function(r){r=im(r);var s=r.queue,l=m0.bind(null,qe,s);return s.dispatch=l,[r.memoizedState,l]},useDebugValue:am,useDeferredValue:function(r,s){var l=yn();return sm(l,r,s)},useTransition:function(){var r=im(!1);return r=c0.bind(null,qe,r.queue,!0,!1),yn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,l){var f=qe,p=yn();if(at){if(l===void 0)throw Error(i(407));l=l()}else{if(l=s(),vt===null)throw Error(i(349));(tt&124)!==0||Uy(f,s,l)}p.memoizedState=l;var g={value:l,getSnapshot:s};return p.queue=g,e0(zy.bind(null,f,g,r),[r]),f.flags|=2048,ao(9,ju(),By.bind(null,f,g,l,s),null),l},useId:function(){var r=yn(),s=vt.identifierPrefix;if(at){var l=br,f=vr;l=(f&~(1<<32-nn(f)-1)).toString(32)+l,s=""+s+"R"+l,l=Pu++,0<l&&(s+="H"+l.toString(32)),s+=""}else l=tA++,s=""+s+"r"+l.toString(32)+"";return r.memoizedState=s},useHostTransitionStatus:lm,useFormState:Qy,useActionState:Qy,useOptimistic:function(r){var s=yn();s.memoizedState=s.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=cm.bind(null,qe,!0,l),l.dispatch=s,[r,s]},useMemoCache:em,useCacheRefresh:function(){return yn().memoizedState=sA.bind(null,qe)}},b0={readContext:un,use:Lu,useCallback:s0,useContext:un,useEffect:t0,useImperativeHandle:a0,useInsertionEffect:n0,useLayoutEffect:i0,useMemo:o0,useReducer:Iu,useRef:Jy,useState:function(){return Iu(Tr)},useDebugValue:am,useDeferredValue:function(r,s){var l=Ut();return l0(l,ut.memoizedState,r,s)},useTransition:function(){var r=Iu(Tr)[0],s=Ut().memoizedState;return[typeof r=="boolean"?r:Ul(r),s]},useSyncExternalStore:jy,useId:f0,useHostTransitionStatus:lm,useFormState:Wy,useActionState:Wy,useOptimistic:function(r,s){var l=Ut();return Fy(l,ut,r,s)},useMemoCache:em,useCacheRefresh:h0},lA={readContext:un,use:Lu,useCallback:s0,useContext:un,useEffect:t0,useImperativeHandle:a0,useInsertionEffect:n0,useLayoutEffect:i0,useMemo:o0,useReducer:nm,useRef:Jy,useState:function(){return nm(Tr)},useDebugValue:am,useDeferredValue:function(r,s){var l=Ut();return ut===null?sm(l,r,s):l0(l,ut.memoizedState,r,s)},useTransition:function(){var r=nm(Tr)[0],s=Ut().memoizedState;return[typeof r=="boolean"?r:Ul(r),s]},useSyncExternalStore:jy,useId:f0,useHostTransitionStatus:lm,useFormState:Zy,useActionState:Zy,useOptimistic:function(r,s){var l=Ut();return ut!==null?Fy(l,ut,r,s):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:em,useCacheRefresh:h0},so=null,Vl=0;function Vu(r){var s=Vl;return Vl+=1,so===null&&(so=[]),Ay(so,r,s)}function Hl(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function Hu(r,s){throw s.$$typeof===v?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function y0(r){var s=r._init;return s(r._payload)}function S0(r){function s(F,z){if(r){var $=F.deletions;$===null?(F.deletions=[z],F.flags|=16):$.push(z)}}function l(F,z){if(!r)return null;for(;z!==null;)s(F,z),z=z.sibling;return null}function f(F){for(var z=new Map;F!==null;)F.key!==null?z.set(F.key,F):z.set(F.index,F),F=F.sibling;return z}function p(F,z){return F=gr(F,z),F.index=0,F.sibling=null,F}function g(F,z,$){return F.index=$,r?($=F.alternate,$!==null?($=$.index,$<z?(F.flags|=67108866,z):$):(F.flags|=67108866,z)):(F.flags|=1048576,z)}function C(F){return r&&F.alternate===null&&(F.flags|=67108866),F}function R(F,z,$,se){return z===null||z.tag!==6?(z=Oh($,F.mode,se),z.return=F,z):(z=p(z,$),z.return=F,z)}function I(F,z,$,se){var Te=$.type;return Te===k?ie(F,z,$.props.children,se,$.key):z!==null&&(z.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===M&&y0(Te)===z.type)?(z=p(z,$.props),Hl(z,$),z.return=F,z):(z=ku($.type,$.key,$.props,null,F.mode,se),Hl(z,$),z.return=F,z)}function K(F,z,$,se){return z===null||z.tag!==4||z.stateNode.containerInfo!==$.containerInfo||z.stateNode.implementation!==$.implementation?(z=Nh($,F.mode,se),z.return=F,z):(z=p(z,$.children||[]),z.return=F,z)}function ie(F,z,$,se,Te){return z===null||z.tag!==7?(z=Ja($,F.mode,se,Te),z.return=F,z):(z=p(z,$),z.return=F,z)}function oe(F,z,$){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Oh(""+z,F.mode,$),z.return=F,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case y:return $=ku(z.type,z.key,z.props,null,F.mode,$),Hl($,z),$.return=F,$;case T:return z=Nh(z,F.mode,$),z.return=F,z;case M:var se=z._init;return z=se(z._payload),oe(F,z,$)}if(xe(z)||re(z))return z=Ja(z,F.mode,$,null),z.return=F,z;if(typeof z.then=="function")return oe(F,Vu(z),$);if(z.$$typeof===P)return oe(F,Ru(F,z),$);Hu(F,z)}return null}function Q(F,z,$,se){var Te=z!==null?z.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return Te!==null?null:R(F,z,""+$,se);if(typeof $=="object"&&$!==null){switch($.$$typeof){case y:return $.key===Te?I(F,z,$,se):null;case T:return $.key===Te?K(F,z,$,se):null;case M:return Te=$._init,$=Te($._payload),Q(F,z,$,se)}if(xe($)||re($))return Te!==null?null:ie(F,z,$,se,null);if(typeof $.then=="function")return Q(F,z,Vu($),se);if($.$$typeof===P)return Q(F,z,Ru(F,$),se);Hu(F,$)}return null}function W(F,z,$,se,Te){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return F=F.get($)||null,R(z,F,""+se,Te);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case y:return F=F.get(se.key===null?$:se.key)||null,I(z,F,se,Te);case T:return F=F.get(se.key===null?$:se.key)||null,K(z,F,se,Te);case M:var Ke=se._init;return se=Ke(se._payload),W(F,z,$,se,Te)}if(xe(se)||re(se))return F=F.get($)||null,ie(z,F,se,Te,null);if(typeof se.then=="function")return W(F,z,$,Vu(se),Te);if(se.$$typeof===P)return W(F,z,$,Ru(z,se),Te);Hu(z,se)}return null}function Ue(F,z,$,se){for(var Te=null,Ke=null,Ne=z,je=z=0,Xt=null;Ne!==null&&je<$.length;je++){Ne.index>je?(Xt=Ne,Ne=null):Xt=Ne.sibling;var it=Q(F,Ne,$[je],se);if(it===null){Ne===null&&(Ne=Xt);break}r&&Ne&&it.alternate===null&&s(F,Ne),z=g(it,z,je),Ke===null?Te=it:Ke.sibling=it,Ke=it,Ne=Xt}if(je===$.length)return l(F,Ne),at&&ts(F,je),Te;if(Ne===null){for(;je<$.length;je++)Ne=oe(F,$[je],se),Ne!==null&&(z=g(Ne,z,je),Ke===null?Te=Ne:Ke.sibling=Ne,Ke=Ne);return at&&ts(F,je),Te}for(Ne=f(Ne);je<$.length;je++)Xt=W(Ne,F,je,$[je],se),Xt!==null&&(r&&Xt.alternate!==null&&Ne.delete(Xt.key===null?je:Xt.key),z=g(Xt,z,je),Ke===null?Te=Xt:Ke.sibling=Xt,Ke=Xt);return r&&Ne.forEach(function(va){return s(F,va)}),at&&ts(F,je),Te}function Ie(F,z,$,se){if($==null)throw Error(i(151));for(var Te=null,Ke=null,Ne=z,je=z=0,Xt=null,it=$.next();Ne!==null&&!it.done;je++,it=$.next()){Ne.index>je?(Xt=Ne,Ne=null):Xt=Ne.sibling;var va=Q(F,Ne,it.value,se);if(va===null){Ne===null&&(Ne=Xt);break}r&&Ne&&va.alternate===null&&s(F,Ne),z=g(va,z,je),Ke===null?Te=va:Ke.sibling=va,Ke=va,Ne=Xt}if(it.done)return l(F,Ne),at&&ts(F,je),Te;if(Ne===null){for(;!it.done;je++,it=$.next())it=oe(F,it.value,se),it!==null&&(z=g(it,z,je),Ke===null?Te=it:Ke.sibling=it,Ke=it);return at&&ts(F,je),Te}for(Ne=f(Ne);!it.done;je++,it=$.next())it=W(Ne,F,je,it.value,se),it!==null&&(r&&it.alternate!==null&&Ne.delete(it.key===null?je:it.key),z=g(it,z,je),Ke===null?Te=it:Ke.sibling=it,Ke=it);return r&&Ne.forEach(function(cO){return s(F,cO)}),at&&ts(F,je),Te}function ft(F,z,$,se){if(typeof $=="object"&&$!==null&&$.type===k&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case y:e:{for(var Te=$.key;z!==null;){if(z.key===Te){if(Te=$.type,Te===k){if(z.tag===7){l(F,z.sibling),se=p(z,$.props.children),se.return=F,F=se;break e}}else if(z.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===M&&y0(Te)===z.type){l(F,z.sibling),se=p(z,$.props),Hl(se,$),se.return=F,F=se;break e}l(F,z);break}else s(F,z);z=z.sibling}$.type===k?(se=Ja($.props.children,F.mode,se,$.key),se.return=F,F=se):(se=ku($.type,$.key,$.props,null,F.mode,se),Hl(se,$),se.return=F,F=se)}return C(F);case T:e:{for(Te=$.key;z!==null;){if(z.key===Te)if(z.tag===4&&z.stateNode.containerInfo===$.containerInfo&&z.stateNode.implementation===$.implementation){l(F,z.sibling),se=p(z,$.children||[]),se.return=F,F=se;break e}else{l(F,z);break}else s(F,z);z=z.sibling}se=Nh($,F.mode,se),se.return=F,F=se}return C(F);case M:return Te=$._init,$=Te($._payload),ft(F,z,$,se)}if(xe($))return Ue(F,z,$,se);if(re($)){if(Te=re($),typeof Te!="function")throw Error(i(150));return $=Te.call($),Ie(F,z,$,se)}if(typeof $.then=="function")return ft(F,z,Vu($),se);if($.$$typeof===P)return ft(F,z,Ru(F,$),se);Hu(F,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,z!==null&&z.tag===6?(l(F,z.sibling),se=p(z,$),se.return=F,F=se):(l(F,z),se=Oh($,F.mode,se),se.return=F,F=se),C(F)):l(F,z)}return function(F,z,$,se){try{Vl=0;var Te=ft(F,z,$,se);return so=null,Te}catch(Ne){if(Ne===Dl||Ne===Ou)throw Ne;var Ke=Ln(29,Ne,null,F.mode);return Ke.lanes=se,Ke.return=F,Ke}finally{}}}var oo=S0(!0),T0=S0(!1),ai=te(null),$i=null;function na(r){var s=r.alternate;le(Ft,Ft.current&1),le(ai,r),$i===null&&(s===null||no.current!==null||s.memoizedState!==null)&&($i=r)}function E0(r){if(r.tag===22){if(le(Ft,Ft.current),le(ai,r),$i===null){var s=r.alternate;s!==null&&s.memoizedState!==null&&($i=r)}}else ia()}function ia(){le(Ft,Ft.current),le(ai,ai.current)}function Er(r){he(ai),$i===r&&($i=null),he(Ft)}var Ft=te(0);function Fu(r){for(var s=r;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||Jm(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function um(r,s,l,f){s=r.memoizedState,l=l(f,s),l=l==null?s:m({},s,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var dm={enqueueSetState:function(r,s,l){r=r._reactInternals;var f=Bn(),p=Jr(f);p.payload=s,l!=null&&(p.callback=l),s=ea(r,p,f),s!==null&&(zn(s,r,f),Pl(s,r,f))},enqueueReplaceState:function(r,s,l){r=r._reactInternals;var f=Bn(),p=Jr(f);p.tag=1,p.payload=s,l!=null&&(p.callback=l),s=ea(r,p,f),s!==null&&(zn(s,r,f),Pl(s,r,f))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var l=Bn(),f=Jr(l);f.tag=2,s!=null&&(f.callback=s),s=ea(r,f,l),s!==null&&(zn(s,r,l),Pl(s,r,l))}};function C0(r,s,l,f,p,g,C){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,g,C):s.prototype&&s.prototype.isPureReactComponent?!kl(l,f)||!kl(p,g):!0}function k0(r,s,l,f){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,f),s.state!==r&&dm.enqueueReplaceState(s,s.state,null)}function ls(r,s){var l=s;if("ref"in s){l={};for(var f in s)f!=="ref"&&(l[f]=s[f])}if(r=r.defaultProps){l===s&&(l=m({},l));for(var p in r)l[p]===void 0&&(l[p]=r[p])}return l}var qu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function _0(r){qu(r)}function w0(r){console.error(r)}function x0(r){qu(r)}function $u(r,s){try{var l=r.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function R0(r,s,l){try{var f=r.onCaughtError;f(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function fm(r,s,l){return l=Jr(l),l.tag=3,l.payload={element:null},l.callback=function(){$u(r,s)},l}function A0(r){return r=Jr(r),r.tag=3,r}function O0(r,s,l,f){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var g=f.value;r.payload=function(){return p(g)},r.callback=function(){R0(s,l,f)}}var C=l.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(r.callback=function(){R0(s,l,f),typeof p!="function"&&(ca===null?ca=new Set([this]):ca.add(this));var R=f.stack;this.componentDidCatch(f.value,{componentStack:R!==null?R:""})})}function cA(r,s,l,f,p){if(l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=l.alternate,s!==null&&Al(s,l,p,!0),l=ai.current,l!==null){switch(l.tag){case 13:return $i===null?Im():l.alternate===null&&Rt===0&&(Rt=3),l.flags&=-257,l.flags|=65536,l.lanes=p,f===Vh?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([f]):s.add(f),Um(r,f,p)),!1;case 22:return l.flags|=65536,f===Vh?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([f]):l.add(f)),Um(r,f,p)),!1}throw Error(i(435,l.tag))}return Um(r,f,p),Im(),!1}if(at)return s=ai.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,f!==Ph&&(r=Error(i(422),{cause:f}),Rl(ti(r,l)))):(f!==Ph&&(s=Error(i(423),{cause:f}),Rl(ti(s,l))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,f=ti(f,l),p=fm(r.stateNode,f,p),qh(r,p),Rt!==4&&(Rt=2)),!1;var g=Error(i(520),{cause:f});if(g=ti(g,l),Ql===null?Ql=[g]:Ql.push(g),Rt!==4&&(Rt=2),s===null)return!0;f=ti(f,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,r=p&-p,l.lanes|=r,r=fm(l.stateNode,f,r),qh(l,r),!1;case 1:if(s=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ca===null||!ca.has(g))))return l.flags|=65536,p&=-p,l.lanes|=p,p=A0(p),O0(p,r,l,f),qh(l,p),!1}l=l.return}while(l!==null);return!1}var N0=Error(i(461)),Qt=!1;function rn(r,s,l,f){s.child=r===null?T0(s,null,l,f):oo(s,r.child,l,f)}function D0(r,s,l,f,p){l=l.render;var g=s.ref;if("ref"in f){var C={};for(var R in f)R!=="ref"&&(C[R]=f[R])}else C=f;return as(s),f=Qh(r,s,l,C,g,p),R=Wh(),r!==null&&!Qt?(Xh(r,s,p),Cr(r,s,p)):(at&&R&&Dh(s),s.flags|=1,rn(r,s,f,p),s.child)}function M0(r,s,l,f,p){if(r===null){var g=l.type;return typeof g=="function"&&!Ah(g)&&g.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=g,P0(r,s,g,f,p)):(r=ku(l.type,null,f,s,s.mode,p),r.ref=s.ref,r.return=s,s.child=r)}if(g=r.child,!Sm(r,p)){var C=g.memoizedProps;if(l=l.compare,l=l!==null?l:kl,l(C,f)&&r.ref===s.ref)return Cr(r,s,p)}return s.flags|=1,r=gr(g,f),r.ref=s.ref,r.return=s,s.child=r}function P0(r,s,l,f,p){if(r!==null){var g=r.memoizedProps;if(kl(g,f)&&r.ref===s.ref)if(Qt=!1,s.pendingProps=f=g,Sm(r,p))(r.flags&131072)!==0&&(Qt=!0);else return s.lanes=r.lanes,Cr(r,s,p)}return hm(r,s,l,f,p)}function L0(r,s,l){var f=s.pendingProps,p=f.children,g=r!==null?r.memoizedState:null;if(f.mode==="hidden"){if((s.flags&128)!==0){if(f=g!==null?g.baseLanes|l:l,r!==null){for(p=s.child=r.child,g=0;p!==null;)g=g|p.lanes|p.childLanes,p=p.sibling;s.childLanes=g&~f}else s.childLanes=0,s.child=null;return I0(r,s,f,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&Au(s,g!==null?g.cachePool:null),g!==null?Py(s,g):Gh(),E0(s);else return s.lanes=s.childLanes=536870912,I0(r,s,g!==null?g.baseLanes|l:l,l)}else g!==null?(Au(s,g.cachePool),Py(s,g),ia(),s.memoizedState=null):(r!==null&&Au(s,null),Gh(),ia());return rn(r,s,p,l),s.child}function I0(r,s,l,f){var p=zh();return p=p===null?null:{parent:Ht._currentValue,pool:p},s.memoizedState={baseLanes:l,cachePool:p},r!==null&&Au(s,null),Gh(),E0(s),r!==null&&Al(r,s,f,!0),null}function Gu(r,s){var l=s.ref;if(l===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(r===null||r.ref!==l)&&(s.flags|=4194816)}}function hm(r,s,l,f,p){return as(s),l=Qh(r,s,l,f,void 0,p),f=Wh(),r!==null&&!Qt?(Xh(r,s,p),Cr(r,s,p)):(at&&f&&Dh(s),s.flags|=1,rn(r,s,l,p),s.child)}function j0(r,s,l,f,p,g){return as(s),s.updateQueue=null,l=Iy(s,f,l,p),Ly(r),f=Wh(),r!==null&&!Qt?(Xh(r,s,g),Cr(r,s,g)):(at&&f&&Dh(s),s.flags|=1,rn(r,s,l,g),s.child)}function U0(r,s,l,f,p){if(as(s),s.stateNode===null){var g=Xs,C=l.contextType;typeof C=="object"&&C!==null&&(g=un(C)),g=new l(f,g),s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=dm,s.stateNode=g,g._reactInternals=s,g=s.stateNode,g.props=f,g.state=s.memoizedState,g.refs={},Hh(s),C=l.contextType,g.context=typeof C=="object"&&C!==null?un(C):Xs,g.state=s.memoizedState,C=l.getDerivedStateFromProps,typeof C=="function"&&(um(s,l,C,f),g.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(C=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),C!==g.state&&dm.enqueueReplaceState(g,g.state,null),Il(s,f,g,p),Ll(),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(r===null){g=s.stateNode;var R=s.memoizedProps,I=ls(l,R);g.props=I;var K=g.context,ie=l.contextType;C=Xs,typeof ie=="object"&&ie!==null&&(C=un(ie));var oe=l.getDerivedStateFromProps;ie=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",R=s.pendingProps!==R,ie||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(R||K!==C)&&k0(s,g,f,C),Zr=!1;var Q=s.memoizedState;g.state=Q,Il(s,f,g,p),Ll(),K=s.memoizedState,R||Q!==K||Zr?(typeof oe=="function"&&(um(s,l,oe,f),K=s.memoizedState),(I=Zr||C0(s,l,I,f,Q,K,C))?(ie||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(s.flags|=4194308)):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=K),g.props=f,g.state=K,g.context=C,f=I):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{g=s.stateNode,Fh(r,s),C=s.memoizedProps,ie=ls(l,C),g.props=ie,oe=s.pendingProps,Q=g.context,K=l.contextType,I=Xs,typeof K=="object"&&K!==null&&(I=un(K)),R=l.getDerivedStateFromProps,(K=typeof R=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(C!==oe||Q!==I)&&k0(s,g,f,I),Zr=!1,Q=s.memoizedState,g.state=Q,Il(s,f,g,p),Ll();var W=s.memoizedState;C!==oe||Q!==W||Zr||r!==null&&r.dependencies!==null&&xu(r.dependencies)?(typeof R=="function"&&(um(s,l,R,f),W=s.memoizedState),(ie=Zr||C0(s,l,ie,f,Q,W,I)||r!==null&&r.dependencies!==null&&xu(r.dependencies))?(K||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(f,W,I),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(f,W,I)),typeof g.componentDidUpdate=="function"&&(s.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof g.componentDidUpdate!="function"||C===r.memoizedProps&&Q===r.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&Q===r.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=W),g.props=f,g.state=W,g.context=I,f=ie):(typeof g.componentDidUpdate!="function"||C===r.memoizedProps&&Q===r.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&Q===r.memoizedState||(s.flags|=1024),f=!1)}return g=f,Gu(r,s),f=(s.flags&128)!==0,g||f?(g=s.stateNode,l=f&&typeof l.getDerivedStateFromError!="function"?null:g.render(),s.flags|=1,r!==null&&f?(s.child=oo(s,r.child,null,p),s.child=oo(s,null,l,p)):rn(r,s,l,p),s.memoizedState=g.state,r=s.child):r=Cr(r,s,p),r}function B0(r,s,l,f){return xl(),s.flags|=256,rn(r,s,l,f),s.child}var mm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pm(r){return{baseLanes:r,cachePool:wy()}}function gm(r,s,l){return r=r!==null?r.childLanes&~l:0,s&&(r|=si),r}function z0(r,s,l){var f=s.pendingProps,p=!1,g=(s.flags&128)!==0,C;if((C=g)||(C=r!==null&&r.memoizedState===null?!1:(Ft.current&2)!==0),C&&(p=!0,s.flags&=-129),C=(s.flags&32)!==0,s.flags&=-33,r===null){if(at){if(p?na(s):ia(),at){var R=xt,I;if(I=R){e:{for(I=R,R=qi;I.nodeType!==8;){if(!R){R=null;break e}if(I=Si(I.nextSibling),I===null){R=null;break e}}R=I}R!==null?(s.memoizedState={dehydrated:R,treeContext:es!==null?{id:vr,overflow:br}:null,retryLane:536870912,hydrationErrors:null},I=Ln(18,null,null,0),I.stateNode=R,I.return=s,s.child=I,hn=s,xt=null,I=!0):I=!1}I||is(s)}if(R=s.memoizedState,R!==null&&(R=R.dehydrated,R!==null))return Jm(R)?s.lanes=32:s.lanes=536870912,null;Er(s)}return R=f.children,f=f.fallback,p?(ia(),p=s.mode,R=Yu({mode:"hidden",children:R},p),f=Ja(f,p,l,null),R.return=s,f.return=s,R.sibling=f,s.child=R,p=s.child,p.memoizedState=pm(l),p.childLanes=gm(r,C,l),s.memoizedState=mm,f):(na(s),vm(s,R))}if(I=r.memoizedState,I!==null&&(R=I.dehydrated,R!==null)){if(g)s.flags&256?(na(s),s.flags&=-257,s=bm(r,s,l)):s.memoizedState!==null?(ia(),s.child=r.child,s.flags|=128,s=null):(ia(),p=f.fallback,R=s.mode,f=Yu({mode:"visible",children:f.children},R),p=Ja(p,R,l,null),p.flags|=2,f.return=s,p.return=s,f.sibling=p,s.child=f,oo(s,r.child,null,l),f=s.child,f.memoizedState=pm(l),f.childLanes=gm(r,C,l),s.memoizedState=mm,s=p);else if(na(s),Jm(R)){if(C=R.nextSibling&&R.nextSibling.dataset,C)var K=C.dgst;C=K,f=Error(i(419)),f.stack="",f.digest=C,Rl({value:f,source:null,stack:null}),s=bm(r,s,l)}else if(Qt||Al(r,s,l,!1),C=(l&r.childLanes)!==0,Qt||C){if(C=vt,C!==null&&(f=l&-l,f=(f&42)!==0?1:pl(f),f=(f&(C.suspendedLanes|l))!==0?0:f,f!==0&&f!==I.retryLane))throw I.retryLane=f,Ws(r,f),zn(C,r,f),N0;R.data==="$?"||Im(),s=bm(r,s,l)}else R.data==="$?"?(s.flags|=192,s.child=r.child,s=null):(r=I.treeContext,xt=Si(R.nextSibling),hn=s,at=!0,ns=null,qi=!1,r!==null&&(ii[ri++]=vr,ii[ri++]=br,ii[ri++]=es,vr=r.id,br=r.overflow,es=s),s=vm(s,f.children),s.flags|=4096);return s}return p?(ia(),p=f.fallback,R=s.mode,I=r.child,K=I.sibling,f=gr(I,{mode:"hidden",children:f.children}),f.subtreeFlags=I.subtreeFlags&65011712,K!==null?p=gr(K,p):(p=Ja(p,R,l,null),p.flags|=2),p.return=s,f.return=s,f.sibling=p,s.child=f,f=p,p=s.child,R=r.child.memoizedState,R===null?R=pm(l):(I=R.cachePool,I!==null?(K=Ht._currentValue,I=I.parent!==K?{parent:K,pool:K}:I):I=wy(),R={baseLanes:R.baseLanes|l,cachePool:I}),p.memoizedState=R,p.childLanes=gm(r,C,l),s.memoizedState=mm,f):(na(s),l=r.child,r=l.sibling,l=gr(l,{mode:"visible",children:f.children}),l.return=s,l.sibling=null,r!==null&&(C=s.deletions,C===null?(s.deletions=[r],s.flags|=16):C.push(r)),s.child=l,s.memoizedState=null,l)}function vm(r,s){return s=Yu({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function Yu(r,s){return r=Ln(22,r,null,s),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function bm(r,s,l){return oo(s,r.child,null,l),r=vm(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function V0(r,s,l){r.lanes|=s;var f=r.alternate;f!==null&&(f.lanes|=s),Ih(r.return,s,l)}function ym(r,s,l,f,p){var g=r.memoizedState;g===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:p}:(g.isBackwards=s,g.rendering=null,g.renderingStartTime=0,g.last=f,g.tail=l,g.tailMode=p)}function H0(r,s,l){var f=s.pendingProps,p=f.revealOrder,g=f.tail;if(rn(r,s,f.children,l),f=Ft.current,(f&2)!==0)f=f&1|2,s.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&V0(r,l,s);else if(r.tag===19)V0(r,l,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}f&=1}switch(le(Ft,f),p){case"forwards":for(l=s.child,p=null;l!==null;)r=l.alternate,r!==null&&Fu(r)===null&&(p=l),l=l.sibling;l=p,l===null?(p=s.child,s.child=null):(p=l.sibling,l.sibling=null),ym(s,!1,p,l,g);break;case"backwards":for(l=null,p=s.child,s.child=null;p!==null;){if(r=p.alternate,r!==null&&Fu(r)===null){s.child=p;break}r=p.sibling,p.sibling=l,l=p,p=r}ym(s,!0,l,null,g);break;case"together":ym(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Cr(r,s,l){if(r!==null&&(s.dependencies=r.dependencies),la|=s.lanes,(l&s.childLanes)===0)if(r!==null){if(Al(r,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,l=gr(r,r.pendingProps),s.child=l,l.return=s;r.sibling!==null;)r=r.sibling,l=l.sibling=gr(r,r.pendingProps),l.return=s;l.sibling=null}return s.child}function Sm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&xu(r)))}function uA(r,s,l){switch(s.tag){case 3:Be(s,s.stateNode.containerInfo),Xr(s,Ht,r.memoizedState.cache),xl();break;case 27:case 5:st(s);break;case 4:Be(s,s.stateNode.containerInfo);break;case 10:Xr(s,s.type,s.memoizedProps.value);break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(na(s),s.flags|=128,null):(l&s.child.childLanes)!==0?z0(r,s,l):(na(s),r=Cr(r,s,l),r!==null?r.sibling:null);na(s);break;case 19:var p=(r.flags&128)!==0;if(f=(l&s.childLanes)!==0,f||(Al(r,s,l,!1),f=(l&s.childLanes)!==0),p){if(f)return H0(r,s,l);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),le(Ft,Ft.current),f)break;return null;case 22:case 23:return s.lanes=0,L0(r,s,l);case 24:Xr(s,Ht,r.memoizedState.cache)}return Cr(r,s,l)}function F0(r,s,l){if(r!==null)if(r.memoizedProps!==s.pendingProps)Qt=!0;else{if(!Sm(r,l)&&(s.flags&128)===0)return Qt=!1,uA(r,s,l);Qt=(r.flags&131072)!==0}else Qt=!1,at&&(s.flags&1048576)!==0&&yy(s,wu,s.index);switch(s.lanes=0,s.tag){case 16:e:{r=s.pendingProps;var f=s.elementType,p=f._init;if(f=p(f._payload),s.type=f,typeof f=="function")Ah(f)?(r=ls(f,r),s.tag=1,s=U0(null,s,f,r,l)):(s.tag=0,s=hm(null,s,f,r,l));else{if(f!=null){if(p=f.$$typeof,p===O){s.tag=11,s=D0(null,s,f,r,l);break e}else if(p===V){s.tag=14,s=M0(null,s,f,r,l);break e}}throw s=be(f)||f,Error(i(306,s,""))}}return s;case 0:return hm(r,s,s.type,s.pendingProps,l);case 1:return f=s.type,p=ls(f,s.pendingProps),U0(r,s,f,p,l);case 3:e:{if(Be(s,s.stateNode.containerInfo),r===null)throw Error(i(387));f=s.pendingProps;var g=s.memoizedState;p=g.element,Fh(r,s),Il(s,f,null,l);var C=s.memoizedState;if(f=C.cache,Xr(s,Ht,f),f!==g.cache&&jh(s,[Ht],l,!0),Ll(),f=C.element,g.isDehydrated)if(g={element:f,isDehydrated:!1,cache:C.cache},s.updateQueue.baseState=g,s.memoizedState=g,s.flags&256){s=B0(r,s,f,l);break e}else if(f!==p){p=ti(Error(i(424)),s),Rl(p),s=B0(r,s,f,l);break e}else{switch(r=s.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(xt=Si(r.firstChild),hn=s,at=!0,ns=null,qi=!0,l=T0(s,null,f,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(xl(),f===p){s=Cr(r,s,l);break e}rn(r,s,f,l)}s=s.child}return s;case 26:return Gu(r,s),r===null?(l=YS(s.type,null,s.pendingProps,null))?s.memoizedState=l:at||(l=s.type,r=s.pendingProps,f=od(ye.current).createElement(l),f[ce]=s,f[me]=r,sn(f,l,r),ze(f),s.stateNode=f):s.memoizedState=YS(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return st(s),r===null&&at&&(f=s.stateNode=qS(s.type,s.pendingProps,ye.current),hn=s,qi=!0,p=xt,fa(s.type)?(ep=p,xt=Si(f.firstChild)):xt=p),rn(r,s,s.pendingProps.children,l),Gu(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&at&&((p=f=xt)&&(f=UA(f,s.type,s.pendingProps,qi),f!==null?(s.stateNode=f,hn=s,xt=Si(f.firstChild),qi=!1,p=!0):p=!1),p||is(s)),st(s),p=s.type,g=s.pendingProps,C=r!==null?r.memoizedProps:null,f=g.children,Wm(p,g)?f=null:C!==null&&Wm(p,C)&&(s.flags|=32),s.memoizedState!==null&&(p=Qh(r,s,nA,null,null,l),rc._currentValue=p),Gu(r,s),rn(r,s,f,l),s.child;case 6:return r===null&&at&&((r=l=xt)&&(l=BA(l,s.pendingProps,qi),l!==null?(s.stateNode=l,hn=s,xt=null,r=!0):r=!1),r||is(s)),null;case 13:return z0(r,s,l);case 4:return Be(s,s.stateNode.containerInfo),f=s.pendingProps,r===null?s.child=oo(s,null,f,l):rn(r,s,f,l),s.child;case 11:return D0(r,s,s.type,s.pendingProps,l);case 7:return rn(r,s,s.pendingProps,l),s.child;case 8:return rn(r,s,s.pendingProps.children,l),s.child;case 12:return rn(r,s,s.pendingProps.children,l),s.child;case 10:return f=s.pendingProps,Xr(s,s.type,f.value),rn(r,s,f.children,l),s.child;case 9:return p=s.type._context,f=s.pendingProps.children,as(s),p=un(p),f=f(p),s.flags|=1,rn(r,s,f,l),s.child;case 14:return M0(r,s,s.type,s.pendingProps,l);case 15:return P0(r,s,s.type,s.pendingProps,l);case 19:return H0(r,s,l);case 31:return f=s.pendingProps,l=s.mode,f={mode:f.mode,children:f.children},r===null?(l=Yu(f,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=gr(r.child,f),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return L0(r,s,l);case 24:return as(s),f=un(Ht),r===null?(p=zh(),p===null&&(p=vt,g=Uh(),p.pooledCache=g,g.refCount++,g!==null&&(p.pooledCacheLanes|=l),p=g),s.memoizedState={parent:f,cache:p},Hh(s),Xr(s,Ht,p)):((r.lanes&l)!==0&&(Fh(r,s),Il(s,null,null,l),Ll()),p=r.memoizedState,g=s.memoizedState,p.parent!==f?(p={parent:f,cache:f},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),Xr(s,Ht,f)):(f=g.cache,Xr(s,Ht,f),f!==p.cache&&jh(s,[Ht],l,!0))),rn(r,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function kr(r){r.flags|=4}function q0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!ZS(s)){if(s=ai.current,s!==null&&((tt&4194048)===tt?$i!==null:(tt&62914560)!==tt&&(tt&536870912)===0||s!==$i))throw Ml=Vh,xy;r.flags|=8192}}function Ku(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?lu():536870912,r.lanes|=s,fo|=s)}function Fl(r,s){if(!at)switch(r.tailMode){case"hidden":s=r.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function _t(r){var s=r.alternate!==null&&r.alternate.child===r.child,l=0,f=0;if(s)for(var p=r.child;p!==null;)l|=p.lanes|p.childLanes,f|=p.subtreeFlags&65011712,f|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)l|=p.lanes|p.childLanes,f|=p.subtreeFlags,f|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=f,r.childLanes=l,s}function dA(r,s,l){var f=s.pendingProps;switch(Mh(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(s),null;case 1:return _t(s),null;case 3:return l=s.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Sr(Ht),yt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(wl(s)?kr(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Ey())),_t(s),null;case 26:return l=s.memoizedState,r===null?(kr(s),l!==null?(_t(s),q0(s,l)):(_t(s),s.flags&=-16777217)):l?l!==r.memoizedState?(kr(s),_t(s),q0(s,l)):(_t(s),s.flags&=-16777217):(r.memoizedProps!==f&&kr(s),_t(s),s.flags&=-16777217),null;case 27:Vt(s),l=ye.current;var p=s.type;if(r!==null&&s.stateNode!=null)r.memoizedProps!==f&&kr(s);else{if(!f){if(s.stateNode===null)throw Error(i(166));return _t(s),null}r=ge.current,wl(s)?Sy(s):(r=qS(p,f,l),s.stateNode=r,kr(s))}return _t(s),null;case 5:if(Vt(s),l=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==f&&kr(s);else{if(!f){if(s.stateNode===null)throw Error(i(166));return _t(s),null}if(r=ge.current,wl(s))Sy(s);else{switch(p=od(ye.current),r){case 1:r=p.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:r=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":r=p.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":r=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":r=p.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof f.is=="string"?p.createElement("select",{is:f.is}):p.createElement("select"),f.multiple?r.multiple=!0:f.size&&(r.size=f.size);break;default:r=typeof f.is=="string"?p.createElement(l,{is:f.is}):p.createElement(l)}}r[ce]=s,r[me]=f;e:for(p=s.child;p!==null;){if(p.tag===5||p.tag===6)r.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===s)break e;for(;p.sibling===null;){if(p.return===null||p.return===s)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}s.stateNode=r;e:switch(sn(r,l,f),l){case"button":case"input":case"select":case"textarea":r=!!f.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&kr(s)}}return _t(s),s.flags&=-16777217,null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==f&&kr(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(i(166));if(r=ye.current,wl(s)){if(r=s.stateNode,l=s.memoizedProps,f=null,p=hn,p!==null)switch(p.tag){case 27:case 5:f=p.memoizedProps}r[ce]=s,r=!!(r.nodeValue===l||f!==null&&f.suppressHydrationWarning===!0||jS(r.nodeValue,l)),r||is(s)}else r=od(r).createTextNode(f),r[ce]=s,s.stateNode=r}return _t(s),null;case 13:if(f=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=wl(s),f!==null&&f.dehydrated!==null){if(r===null){if(!p)throw Error(i(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[ce]=s}else xl(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_t(s),p=!1}else p=Ey(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(Er(s),s):(Er(s),null)}if(Er(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=f!==null,r=r!==null&&r.memoizedState!==null,l){f=s.child,p=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(p=f.alternate.memoizedState.cachePool.pool);var g=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(g=f.memoizedState.cachePool.pool),g!==p&&(f.flags|=2048)}return l!==r&&l&&(s.child.flags|=8192),Ku(s,s.updateQueue),_t(s),null;case 4:return yt(),r===null&&$m(s.stateNode.containerInfo),_t(s),null;case 10:return Sr(s.type),_t(s),null;case 19:if(he(Ft),p=s.memoizedState,p===null)return _t(s),null;if(f=(s.flags&128)!==0,g=p.rendering,g===null)if(f)Fl(p,!1);else{if(Rt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(g=Fu(r),g!==null){for(s.flags|=128,Fl(p,!1),r=g.updateQueue,s.updateQueue=r,Ku(s,r),s.subtreeFlags=0,r=l,l=s.child;l!==null;)by(l,r),l=l.sibling;return le(Ft,Ft.current&1|2),s.child}r=r.sibling}p.tail!==null&&cn()>Xu&&(s.flags|=128,f=!0,Fl(p,!1),s.lanes=4194304)}else{if(!f)if(r=Fu(g),r!==null){if(s.flags|=128,f=!0,r=r.updateQueue,s.updateQueue=r,Ku(s,r),Fl(p,!0),p.tail===null&&p.tailMode==="hidden"&&!g.alternate&&!at)return _t(s),null}else 2*cn()-p.renderingStartTime>Xu&&l!==536870912&&(s.flags|=128,f=!0,Fl(p,!1),s.lanes=4194304);p.isBackwards?(g.sibling=s.child,s.child=g):(r=p.last,r!==null?r.sibling=g:s.child=g,p.last=g)}return p.tail!==null?(s=p.tail,p.rendering=s,p.tail=s.sibling,p.renderingStartTime=cn(),s.sibling=null,r=Ft.current,le(Ft,f?r&1|2:r&1),s):(_t(s),null);case 22:case 23:return Er(s),Yh(),f=s.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(l&536870912)!==0&&(s.flags&128)===0&&(_t(s),s.subtreeFlags&6&&(s.flags|=8192)):_t(s),l=s.updateQueue,l!==null&&Ku(s,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==l&&(s.flags|=2048),r!==null&&he(ss),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),Sr(Ht),_t(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function fA(r,s){switch(Mh(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Sr(Ht),yt(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Vt(s),null;case 13:if(Er(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));xl()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return he(Ft),null;case 4:return yt(),null;case 10:return Sr(s.type),null;case 22:case 23:return Er(s),Yh(),r!==null&&he(ss),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return Sr(Ht),null;case 25:return null;default:return null}}function $0(r,s){switch(Mh(s),s.tag){case 3:Sr(Ht),yt();break;case 26:case 27:case 5:Vt(s);break;case 4:yt();break;case 13:Er(s);break;case 19:he(Ft);break;case 10:Sr(s.type);break;case 22:case 23:Er(s),Yh(),r!==null&&he(ss);break;case 24:Sr(Ht)}}function ql(r,s){try{var l=s.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var p=f.next;l=p;do{if((l.tag&r)===r){f=void 0;var g=l.create,C=l.inst;f=g(),C.destroy=f}l=l.next}while(l!==p)}}catch(R){mt(s,s.return,R)}}function ra(r,s,l){try{var f=s.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var g=p.next;f=g;do{if((f.tag&r)===r){var C=f.inst,R=C.destroy;if(R!==void 0){C.destroy=void 0,p=s;var I=l,K=R;try{K()}catch(ie){mt(p,I,ie)}}}f=f.next}while(f!==g)}}catch(ie){mt(s,s.return,ie)}}function G0(r){var s=r.updateQueue;if(s!==null){var l=r.stateNode;try{My(s,l)}catch(f){mt(r,r.return,f)}}}function Y0(r,s,l){l.props=ls(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(f){mt(r,s,f)}}function $l(r,s){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof l=="function"?r.refCleanup=l(f):l.current=f}}catch(p){mt(r,s,p)}}function Gi(r,s){var l=r.ref,f=r.refCleanup;if(l!==null)if(typeof f=="function")try{f()}catch(p){mt(r,s,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){mt(r,s,p)}else l.current=null}function K0(r){var s=r.type,l=r.memoizedProps,f=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&f.focus();break e;case"img":l.src?f.src=l.src:l.srcSet&&(f.srcset=l.srcSet)}}catch(p){mt(r,r.return,p)}}function Tm(r,s,l){try{var f=r.stateNode;MA(f,r.type,l,s),f[me]=s}catch(p){mt(r,r.return,p)}}function Q0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&fa(r.type)||r.tag===4}function Em(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Q0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&fa(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Cm(r,s,l){var f=r.tag;if(f===5||f===6)r=r.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(r),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=sd));else if(f!==4&&(f===27&&fa(r.type)&&(l=r.stateNode,s=null),r=r.child,r!==null))for(Cm(r,s,l),r=r.sibling;r!==null;)Cm(r,s,l),r=r.sibling}function Qu(r,s,l){var f=r.tag;if(f===5||f===6)r=r.stateNode,s?l.insertBefore(r,s):l.appendChild(r);else if(f!==4&&(f===27&&fa(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(Qu(r,s,l),r=r.sibling;r!==null;)Qu(r,s,l),r=r.sibling}function W0(r){var s=r.stateNode,l=r.memoizedProps;try{for(var f=r.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);sn(s,f,l),s[ce]=r,s[me]=l}catch(g){mt(r,r.return,g)}}var _r=!1,Pt=!1,km=!1,X0=typeof WeakSet=="function"?WeakSet:Set,Wt=null;function hA(r,s){if(r=r.containerInfo,Km=hd,r=ly(r),Eh(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var p=f.anchorOffset,g=f.focusNode;f=f.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var C=0,R=-1,I=-1,K=0,ie=0,oe=r,Q=null;t:for(;;){for(var W;oe!==l||p!==0&&oe.nodeType!==3||(R=C+p),oe!==g||f!==0&&oe.nodeType!==3||(I=C+f),oe.nodeType===3&&(C+=oe.nodeValue.length),(W=oe.firstChild)!==null;)Q=oe,oe=W;for(;;){if(oe===r)break t;if(Q===l&&++K===p&&(R=C),Q===g&&++ie===f&&(I=C),(W=oe.nextSibling)!==null)break;oe=Q,Q=oe.parentNode}oe=W}l=R===-1||I===-1?null:{start:R,end:I}}else l=null}l=l||{start:0,end:0}}else l=null;for(Qm={focusedElem:r,selectionRange:l},hd=!1,Wt=s;Wt!==null;)if(s=Wt,r=s.child,(s.subtreeFlags&1024)!==0&&r!==null)r.return=s,Wt=r;else for(;Wt!==null;){switch(s=Wt,g=s.alternate,r=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&g!==null){r=void 0,l=s,p=g.memoizedProps,g=g.memoizedState,f=l.stateNode;try{var Ue=ls(l.type,p,l.elementType===l.type);r=f.getSnapshotBeforeUpdate(Ue,g),f.__reactInternalSnapshotBeforeUpdate=r}catch(Ie){mt(l,l.return,Ie)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,l=r.nodeType,l===9)Zm(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Zm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,Wt=r;break}Wt=s.return}}function Z0(r,s,l){var f=l.flags;switch(l.tag){case 0:case 11:case 15:aa(r,l),f&4&&ql(5,l);break;case 1:if(aa(r,l),f&4)if(r=l.stateNode,s===null)try{r.componentDidMount()}catch(C){mt(l,l.return,C)}else{var p=ls(l.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(p,s,r.__reactInternalSnapshotBeforeUpdate)}catch(C){mt(l,l.return,C)}}f&64&&G0(l),f&512&&$l(l,l.return);break;case 3:if(aa(r,l),f&64&&(r=l.updateQueue,r!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{My(r,s)}catch(C){mt(l,l.return,C)}}break;case 27:s===null&&f&4&&W0(l);case 26:case 5:aa(r,l),s===null&&f&4&&K0(l),f&512&&$l(l,l.return);break;case 12:aa(r,l);break;case 13:aa(r,l),f&4&&tS(r,l),f&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=EA.bind(null,l),zA(r,l))));break;case 22:if(f=l.memoizedState!==null||_r,!f){s=s!==null&&s.memoizedState!==null||Pt,p=_r;var g=Pt;_r=f,(Pt=s)&&!g?sa(r,l,(l.subtreeFlags&8772)!==0):aa(r,l),_r=p,Pt=g}break;case 30:break;default:aa(r,l)}}function J0(r){var s=r.alternate;s!==null&&(r.alternate=null,J0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&Re(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Et=null,Sn=!1;function wr(r,s,l){for(l=l.child;l!==null;)eS(r,s,l),l=l.sibling}function eS(r,s,l){if(gt&&typeof gt.onCommitFiberUnmount=="function")try{gt.onCommitFiberUnmount(tn,l)}catch{}switch(l.tag){case 26:Pt||Gi(l,s),wr(r,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Pt||Gi(l,s);var f=Et,p=Sn;fa(l.type)&&(Et=l.stateNode,Sn=!1),wr(r,s,l),ec(l.stateNode),Et=f,Sn=p;break;case 5:Pt||Gi(l,s);case 6:if(f=Et,p=Sn,Et=null,wr(r,s,l),Et=f,Sn=p,Et!==null)if(Sn)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(l.stateNode)}catch(g){mt(l,s,g)}else try{Et.removeChild(l.stateNode)}catch(g){mt(l,s,g)}break;case 18:Et!==null&&(Sn?(r=Et,HS(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),lc(r)):HS(Et,l.stateNode));break;case 4:f=Et,p=Sn,Et=l.stateNode.containerInfo,Sn=!0,wr(r,s,l),Et=f,Sn=p;break;case 0:case 11:case 14:case 15:Pt||ra(2,l,s),Pt||ra(4,l,s),wr(r,s,l);break;case 1:Pt||(Gi(l,s),f=l.stateNode,typeof f.componentWillUnmount=="function"&&Y0(l,s,f)),wr(r,s,l);break;case 21:wr(r,s,l);break;case 22:Pt=(f=Pt)||l.memoizedState!==null,wr(r,s,l),Pt=f;break;default:wr(r,s,l)}}function tS(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{lc(r)}catch(l){mt(s,s.return,l)}}function mA(r){switch(r.tag){case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new X0),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new X0),s;default:throw Error(i(435,r.tag))}}function _m(r,s){var l=mA(r);s.forEach(function(f){var p=CA.bind(null,r,f);l.has(f)||(l.add(f),f.then(p,p))})}function In(r,s){var l=s.deletions;if(l!==null)for(var f=0;f<l.length;f++){var p=l[f],g=r,C=s,R=C;e:for(;R!==null;){switch(R.tag){case 27:if(fa(R.type)){Et=R.stateNode,Sn=!1;break e}break;case 5:Et=R.stateNode,Sn=!1;break e;case 3:case 4:Et=R.stateNode.containerInfo,Sn=!0;break e}R=R.return}if(Et===null)throw Error(i(160));eS(g,C,p),Et=null,Sn=!1,g=p.alternate,g!==null&&(g.return=null),p.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)nS(s,r),s=s.sibling}var yi=null;function nS(r,s){var l=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:In(s,r),jn(r),f&4&&(ra(3,r,r.return),ql(3,r),ra(5,r,r.return));break;case 1:In(s,r),jn(r),f&512&&(Pt||l===null||Gi(l,l.return)),f&64&&_r&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?f:l.concat(f))));break;case 26:var p=yi;if(In(s,r),jn(r),f&512&&(Pt||l===null||Gi(l,l.return)),f&4){var g=l!==null?l.memoizedState:null;if(f=r.memoizedState,l===null)if(f===null)if(r.stateNode===null){e:{f=r.type,l=r.memoizedProps,p=p.ownerDocument||p;t:switch(f){case"title":g=p.getElementsByTagName("title")[0],(!g||g[we]||g[ce]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=p.createElement(f),p.head.insertBefore(g,p.querySelector("head > title"))),sn(g,f,l),g[ce]=r,ze(g),f=g;break e;case"link":var C=WS("link","href",p).get(f+(l.href||""));if(C){for(var R=0;R<C.length;R++)if(g=C[R],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){C.splice(R,1);break t}}g=p.createElement(f),sn(g,f,l),p.head.appendChild(g);break;case"meta":if(C=WS("meta","content",p).get(f+(l.content||""))){for(R=0;R<C.length;R++)if(g=C[R],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){C.splice(R,1);break t}}g=p.createElement(f),sn(g,f,l),p.head.appendChild(g);break;default:throw Error(i(468,f))}g[ce]=r,ze(g),f=g}r.stateNode=f}else XS(p,r.type,r.stateNode);else r.stateNode=QS(p,f,r.memoizedProps);else g!==f?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,f===null?XS(p,r.type,r.stateNode):QS(p,f,r.memoizedProps)):f===null&&r.stateNode!==null&&Tm(r,r.memoizedProps,l.memoizedProps)}break;case 27:In(s,r),jn(r),f&512&&(Pt||l===null||Gi(l,l.return)),l!==null&&f&4&&Tm(r,r.memoizedProps,l.memoizedProps);break;case 5:if(In(s,r),jn(r),f&512&&(Pt||l===null||Gi(l,l.return)),r.flags&32){p=r.stateNode;try{Fs(p,"")}catch(W){mt(r,r.return,W)}}f&4&&r.stateNode!=null&&(p=r.memoizedProps,Tm(r,p,l!==null?l.memoizedProps:p)),f&1024&&(km=!0);break;case 6:if(In(s,r),jn(r),f&4){if(r.stateNode===null)throw Error(i(162));f=r.memoizedProps,l=r.stateNode;try{l.nodeValue=f}catch(W){mt(r,r.return,W)}}break;case 3:if(ud=null,p=yi,yi=ld(s.containerInfo),In(s,r),yi=p,jn(r),f&4&&l!==null&&l.memoizedState.isDehydrated)try{lc(s.containerInfo)}catch(W){mt(r,r.return,W)}km&&(km=!1,iS(r));break;case 4:f=yi,yi=ld(r.stateNode.containerInfo),In(s,r),jn(r),yi=f;break;case 12:In(s,r),jn(r);break;case 13:In(s,r),jn(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Nm=cn()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,_m(r,f)));break;case 22:p=r.memoizedState!==null;var I=l!==null&&l.memoizedState!==null,K=_r,ie=Pt;if(_r=K||p,Pt=ie||I,In(s,r),Pt=ie,_r=K,jn(r),f&8192)e:for(s=r.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(l===null||I||_r||Pt||cs(r)),l=null,s=r;;){if(s.tag===5||s.tag===26){if(l===null){I=l=s;try{if(g=I.stateNode,p)C=g.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{R=I.stateNode;var oe=I.memoizedProps.style,Q=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;R.style.display=Q==null||typeof Q=="boolean"?"":(""+Q).trim()}}catch(W){mt(I,I.return,W)}}}else if(s.tag===6){if(l===null){I=s;try{I.stateNode.nodeValue=p?"":I.memoizedProps}catch(W){mt(I,I.return,W)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=r.updateQueue,f!==null&&(l=f.retryQueue,l!==null&&(f.retryQueue=null,_m(r,l))));break;case 19:In(s,r),jn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,_m(r,f)));break;case 30:break;case 21:break;default:In(s,r),jn(r)}}function jn(r){var s=r.flags;if(s&2){try{for(var l,f=r.return;f!==null;){if(Q0(f)){l=f;break}f=f.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var p=l.stateNode,g=Em(r);Qu(r,g,p);break;case 5:var C=l.stateNode;l.flags&32&&(Fs(C,""),l.flags&=-33);var R=Em(r);Qu(r,R,C);break;case 3:case 4:var I=l.stateNode.containerInfo,K=Em(r);Cm(r,K,I);break;default:throw Error(i(161))}}catch(ie){mt(r,r.return,ie)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function iS(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;iS(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function aa(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Z0(r,s.alternate,s),s=s.sibling}function cs(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:ra(4,s,s.return),cs(s);break;case 1:Gi(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&Y0(s,s.return,l),cs(s);break;case 27:ec(s.stateNode);case 26:case 5:Gi(s,s.return),cs(s);break;case 22:s.memoizedState===null&&cs(s);break;case 30:cs(s);break;default:cs(s)}r=r.sibling}}function sa(r,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,p=r,g=s,C=g.flags;switch(g.tag){case 0:case 11:case 15:sa(p,g,l),ql(4,g);break;case 1:if(sa(p,g,l),f=g,p=f.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(K){mt(f,f.return,K)}if(f=g,p=f.updateQueue,p!==null){var R=f.stateNode;try{var I=p.shared.hiddenCallbacks;if(I!==null)for(p.shared.hiddenCallbacks=null,p=0;p<I.length;p++)Dy(I[p],R)}catch(K){mt(f,f.return,K)}}l&&C&64&&G0(g),$l(g,g.return);break;case 27:W0(g);case 26:case 5:sa(p,g,l),l&&f===null&&C&4&&K0(g),$l(g,g.return);break;case 12:sa(p,g,l);break;case 13:sa(p,g,l),l&&C&4&&tS(p,g);break;case 22:g.memoizedState===null&&sa(p,g,l),$l(g,g.return);break;case 30:break;default:sa(p,g,l)}s=s.sibling}}function wm(r,s){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&Ol(l))}function xm(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Ol(r))}function Yi(r,s,l,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)rS(r,s,l,f),s=s.sibling}function rS(r,s,l,f){var p=s.flags;switch(s.tag){case 0:case 11:case 15:Yi(r,s,l,f),p&2048&&ql(9,s);break;case 1:Yi(r,s,l,f);break;case 3:Yi(r,s,l,f),p&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Ol(r)));break;case 12:if(p&2048){Yi(r,s,l,f),r=s.stateNode;try{var g=s.memoizedProps,C=g.id,R=g.onPostCommit;typeof R=="function"&&R(C,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(I){mt(s,s.return,I)}}else Yi(r,s,l,f);break;case 13:Yi(r,s,l,f);break;case 23:break;case 22:g=s.stateNode,C=s.alternate,s.memoizedState!==null?g._visibility&2?Yi(r,s,l,f):Gl(r,s):g._visibility&2?Yi(r,s,l,f):(g._visibility|=2,lo(r,s,l,f,(s.subtreeFlags&10256)!==0)),p&2048&&wm(C,s);break;case 24:Yi(r,s,l,f),p&2048&&xm(s.alternate,s);break;default:Yi(r,s,l,f)}}function lo(r,s,l,f,p){for(p=p&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var g=r,C=s,R=l,I=f,K=C.flags;switch(C.tag){case 0:case 11:case 15:lo(g,C,R,I,p),ql(8,C);break;case 23:break;case 22:var ie=C.stateNode;C.memoizedState!==null?ie._visibility&2?lo(g,C,R,I,p):Gl(g,C):(ie._visibility|=2,lo(g,C,R,I,p)),p&&K&2048&&wm(C.alternate,C);break;case 24:lo(g,C,R,I,p),p&&K&2048&&xm(C.alternate,C);break;default:lo(g,C,R,I,p)}s=s.sibling}}function Gl(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=r,f=s,p=f.flags;switch(f.tag){case 22:Gl(l,f),p&2048&&wm(f.alternate,f);break;case 24:Gl(l,f),p&2048&&xm(f.alternate,f);break;default:Gl(l,f)}s=s.sibling}}var Yl=8192;function co(r){if(r.subtreeFlags&Yl)for(r=r.child;r!==null;)aS(r),r=r.sibling}function aS(r){switch(r.tag){case 26:co(r),r.flags&Yl&&r.memoizedState!==null&&JA(yi,r.memoizedState,r.memoizedProps);break;case 5:co(r);break;case 3:case 4:var s=yi;yi=ld(r.stateNode.containerInfo),co(r),yi=s;break;case 22:r.memoizedState===null&&(s=r.alternate,s!==null&&s.memoizedState!==null?(s=Yl,Yl=16777216,co(r),Yl=s):co(r));break;default:co(r)}}function sS(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function Kl(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];Wt=f,lS(f,r)}sS(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)oS(r),r=r.sibling}function oS(r){switch(r.tag){case 0:case 11:case 15:Kl(r),r.flags&2048&&ra(9,r,r.return);break;case 3:Kl(r);break;case 12:Kl(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,Wu(r)):Kl(r);break;default:Kl(r)}}function Wu(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];Wt=f,lS(f,r)}sS(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:ra(8,s,s.return),Wu(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,Wu(s));break;default:Wu(s)}r=r.sibling}}function lS(r,s){for(;Wt!==null;){var l=Wt;switch(l.tag){case 0:case 11:case 15:ra(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var f=l.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ol(l.memoizedState.cache)}if(f=l.child,f!==null)f.return=l,Wt=f;else e:for(l=r;Wt!==null;){f=Wt;var p=f.sibling,g=f.return;if(J0(f),f===l){Wt=null;break e}if(p!==null){p.return=g,Wt=p;break e}Wt=g}}}var pA={getCacheForType:function(r){var s=un(Ht),l=s.data.get(r);return l===void 0&&(l=r(),s.data.set(r,l)),l}},gA=typeof WeakMap=="function"?WeakMap:Map,ot=0,vt=null,Xe=null,tt=0,lt=0,Un=null,oa=!1,uo=!1,Rm=!1,xr=0,Rt=0,la=0,us=0,Am=0,si=0,fo=0,Ql=null,Tn=null,Om=!1,Nm=0,Xu=1/0,Zu=null,ca=null,an=0,ua=null,ho=null,mo=0,Dm=0,Mm=null,cS=null,Wl=0,Pm=null;function Bn(){if((ot&2)!==0&&tt!==0)return tt&-tt;if(H.T!==null){var r=eo;return r!==0?r:Vm()}return U()}function uS(){si===0&&(si=(tt&536870912)===0||at?Bs():536870912);var r=ai.current;return r!==null&&(r.flags|=32),si}function zn(r,s,l){(r===vt&&(lt===2||lt===9)||r.cancelPendingCommit!==null)&&(po(r,0),da(r,tt,si,!1)),Ya(r,l),((ot&2)===0||r!==vt)&&(r===vt&&((ot&2)===0&&(us|=l),Rt===4&&da(r,tt,si,!1)),Ki(r))}function dS(r,s,l){if((ot&6)!==0)throw Error(i(327));var f=!l&&(s&124)===0&&(s&r.expiredLanes)===0||Hi(r,s),p=f?yA(r,s):jm(r,s,!0),g=f;do{if(p===0){uo&&!f&&da(r,s,0,!1);break}else{if(l=r.current.alternate,g&&!vA(l)){p=jm(r,s,!1),g=!1;continue}if(p===2){if(g=s,r.errorRecoveryDisabledLanes&g)var C=0;else C=r.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){s=C;e:{var R=r;p=Ql;var I=R.current.memoizedState.isDehydrated;if(I&&(po(R,C).flags|=256),C=jm(R,C,!1),C!==2){if(Rm&&!I){R.errorRecoveryDisabledLanes|=g,us|=g,p=4;break e}g=Tn,Tn=p,g!==null&&(Tn===null?Tn=g:Tn.push.apply(Tn,g))}p=C}if(g=!1,p!==2)continue}}if(p===1){po(r,0),da(r,s,0,!0);break}e:{switch(f=r,g=p,g){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:da(f,s,si,!oa);break e;case 2:Tn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(p=Nm+300-cn(),10<p)){if(da(f,s,si,!oa),Ga(f,0,!0)!==0)break e;f.timeoutHandle=zS(fS.bind(null,f,l,Tn,Zu,Om,s,si,us,fo,oa,g,2,-0,0),p);break e}fS(f,l,Tn,Zu,Om,s,si,us,fo,oa,g,0,-0,0)}}break}while(!0);Ki(r)}function fS(r,s,l,f,p,g,C,R,I,K,ie,oe,Q,W){if(r.timeoutHandle=-1,oe=s.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(ic={stylesheets:null,count:0,unsuspend:ZA},aS(s),oe=eO(),oe!==null)){r.cancelPendingCommit=oe(yS.bind(null,r,s,g,l,f,p,C,R,I,ie,1,Q,W)),da(r,g,C,!K);return}yS(r,s,g,l,f,p,C,R,I)}function vA(r){for(var s=r;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var f=0;f<l.length;f++){var p=l[f],g=p.getSnapshot;p=p.value;try{if(!Pn(g(),p))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function da(r,s,l,f){s&=~Am,s&=~us,r.suspendedLanes|=s,r.pingedLanes&=~s,f&&(r.warmLanes|=s),f=r.expirationTimes;for(var p=s;0<p;){var g=31-nn(p),C=1<<g;f[g]=-1,p&=~C}l!==0&&Ka(r,l,s)}function Ju(){return(ot&6)===0?(Xl(0),!1):!0}function Lm(){if(Xe!==null){if(lt===0)var r=Xe.return;else r=Xe,yr=rs=null,Zh(r),so=null,Vl=0,r=Xe;for(;r!==null;)$0(r.alternate,r),r=r.return;Xe=null}}function po(r,s){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,LA(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),Lm(),vt=r,Xe=l=gr(r.current,null),tt=s,lt=0,Un=null,oa=!1,uo=Hi(r,s),Rm=!1,fo=si=Am=us=la=Rt=0,Tn=Ql=null,Om=!1,(s&8)!==0&&(s|=s&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=s;0<f;){var p=31-nn(f),g=1<<p;s|=r[p],f&=~g}return xr=s,Tu(),l}function hS(r,s){qe=null,H.H=zu,s===Dl||s===Ou?(s=Oy(),lt=3):s===xy?(s=Oy(),lt=4):lt=s===N0?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Un=s,Xe===null&&(Rt=1,$u(r,ti(s,r.current)))}function mS(){var r=H.H;return H.H=zu,r===null?zu:r}function pS(){var r=H.A;return H.A=pA,r}function Im(){Rt=4,oa||(tt&4194048)!==tt&&ai.current!==null||(uo=!0),(la&134217727)===0&&(us&134217727)===0||vt===null||da(vt,tt,si,!1)}function jm(r,s,l){var f=ot;ot|=2;var p=mS(),g=pS();(vt!==r||tt!==s)&&(Zu=null,po(r,s)),s=!1;var C=Rt;e:do try{if(lt!==0&&Xe!==null){var R=Xe,I=Un;switch(lt){case 8:Lm(),C=6;break e;case 3:case 2:case 9:case 6:ai.current===null&&(s=!0);var K=lt;if(lt=0,Un=null,go(r,R,I,K),l&&uo){C=0;break e}break;default:K=lt,lt=0,Un=null,go(r,R,I,K)}}bA(),C=Rt;break}catch(ie){hS(r,ie)}while(!0);return s&&r.shellSuspendCounter++,yr=rs=null,ot=f,H.H=p,H.A=g,Xe===null&&(vt=null,tt=0,Tu()),C}function bA(){for(;Xe!==null;)gS(Xe)}function yA(r,s){var l=ot;ot|=2;var f=mS(),p=pS();vt!==r||tt!==s?(Zu=null,Xu=cn()+500,po(r,s)):uo=Hi(r,s);e:do try{if(lt!==0&&Xe!==null){s=Xe;var g=Un;t:switch(lt){case 1:lt=0,Un=null,go(r,s,g,1);break;case 2:case 9:if(Ry(g)){lt=0,Un=null,vS(s);break}s=function(){lt!==2&&lt!==9||vt!==r||(lt=7),Ki(r)},g.then(s,s);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:Ry(g)?(lt=0,Un=null,vS(s)):(lt=0,Un=null,go(r,s,g,7));break;case 5:var C=null;switch(Xe.tag){case 26:C=Xe.memoizedState;case 5:case 27:var R=Xe;if(!C||ZS(C)){lt=0,Un=null;var I=R.sibling;if(I!==null)Xe=I;else{var K=R.return;K!==null?(Xe=K,ed(K)):Xe=null}break t}}lt=0,Un=null,go(r,s,g,5);break;case 6:lt=0,Un=null,go(r,s,g,6);break;case 8:Lm(),Rt=6;break e;default:throw Error(i(462))}}SA();break}catch(ie){hS(r,ie)}while(!0);return yr=rs=null,H.H=f,H.A=p,ot=l,Xe!==null?0:(vt=null,tt=0,Tu(),Rt)}function SA(){for(;Xe!==null&&!hl();)gS(Xe)}function gS(r){var s=F0(r.alternate,r,xr);r.memoizedProps=r.pendingProps,s===null?ed(r):Xe=s}function vS(r){var s=r,l=s.alternate;switch(s.tag){case 15:case 0:s=j0(l,s,s.pendingProps,s.type,void 0,tt);break;case 11:s=j0(l,s,s.pendingProps,s.type.render,s.ref,tt);break;case 5:Zh(s);default:$0(l,s),s=Xe=by(s,xr),s=F0(l,s,xr)}r.memoizedProps=r.pendingProps,s===null?ed(r):Xe=s}function go(r,s,l,f){yr=rs=null,Zh(s),so=null,Vl=0;var p=s.return;try{if(cA(r,p,s,l,tt)){Rt=1,$u(r,ti(l,r.current)),Xe=null;return}}catch(g){if(p!==null)throw Xe=p,g;Rt=1,$u(r,ti(l,r.current)),Xe=null;return}s.flags&32768?(at||f===1?r=!0:uo||(tt&536870912)!==0?r=!1:(oa=r=!0,(f===2||f===9||f===3||f===6)&&(f=ai.current,f!==null&&f.tag===13&&(f.flags|=16384))),bS(s,r)):ed(s)}function ed(r){var s=r;do{if((s.flags&32768)!==0){bS(s,oa);return}r=s.return;var l=dA(s.alternate,s,xr);if(l!==null){Xe=l;return}if(s=s.sibling,s!==null){Xe=s;return}Xe=s=r}while(s!==null);Rt===0&&(Rt=5)}function bS(r,s){do{var l=fA(r.alternate,r);if(l!==null){l.flags&=32767,Xe=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(r=r.sibling,r!==null)){Xe=r;return}Xe=r=l}while(r!==null);Rt=6,Xe=null}function yS(r,s,l,f,p,g,C,R,I){r.cancelPendingCommit=null;do td();while(an!==0);if((ot&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(g=s.lanes|s.childLanes,g|=xh,cu(r,l,g,C,R,I),r===vt&&(Xe=vt=null,tt=0),ho=s,ua=r,mo=l,Dm=g,Mm=p,cS=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,kA(gi,function(){return kS(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=H.T,H.T=null,p=ae.p,ae.p=2,C=ot,ot|=4;try{hA(r,s,l)}finally{ot=C,ae.p=p,H.T=f}}an=1,SS(),TS(),ES()}}function SS(){if(an===1){an=0;var r=ua,s=ho,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=H.T,H.T=null;var f=ae.p;ae.p=2;var p=ot;ot|=4;try{nS(s,r);var g=Qm,C=ly(r.containerInfo),R=g.focusedElem,I=g.selectionRange;if(C!==R&&R&&R.ownerDocument&&oy(R.ownerDocument.documentElement,R)){if(I!==null&&Eh(R)){var K=I.start,ie=I.end;if(ie===void 0&&(ie=K),"selectionStart"in R)R.selectionStart=K,R.selectionEnd=Math.min(ie,R.value.length);else{var oe=R.ownerDocument||document,Q=oe&&oe.defaultView||window;if(Q.getSelection){var W=Q.getSelection(),Ue=R.textContent.length,Ie=Math.min(I.start,Ue),ft=I.end===void 0?Ie:Math.min(I.end,Ue);!W.extend&&Ie>ft&&(C=ft,ft=Ie,Ie=C);var F=sy(R,Ie),z=sy(R,ft);if(F&&z&&(W.rangeCount!==1||W.anchorNode!==F.node||W.anchorOffset!==F.offset||W.focusNode!==z.node||W.focusOffset!==z.offset)){var $=oe.createRange();$.setStart(F.node,F.offset),W.removeAllRanges(),Ie>ft?(W.addRange($),W.extend(z.node,z.offset)):($.setEnd(z.node,z.offset),W.addRange($))}}}}for(oe=[],W=R;W=W.parentNode;)W.nodeType===1&&oe.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<oe.length;R++){var se=oe[R];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}hd=!!Km,Qm=Km=null}finally{ot=p,ae.p=f,H.T=l}}r.current=s,an=2}}function TS(){if(an===2){an=0;var r=ua,s=ho,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=H.T,H.T=null;var f=ae.p;ae.p=2;var p=ot;ot|=4;try{Z0(r,s.alternate,s)}finally{ot=p,ae.p=f,H.T=l}}an=3}}function ES(){if(an===4||an===3){an=0,js();var r=ua,s=ho,l=mo,f=cS;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?an=5:(an=0,ho=ua=null,CS(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(ca=null),gl(l),s=s.stateNode,gt&&typeof gt.onCommitFiberRoot=="function")try{gt.onCommitFiberRoot(tn,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=H.T,p=ae.p,ae.p=2,H.T=null;try{for(var g=r.onRecoverableError,C=0;C<f.length;C++){var R=f[C];g(R.value,{componentStack:R.stack})}}finally{H.T=s,ae.p=p}}(mo&3)!==0&&td(),Ki(r),p=r.pendingLanes,(l&4194090)!==0&&(p&42)!==0?r===Pm?Wl++:(Wl=0,Pm=r):Wl=0,Xl(0)}}function CS(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,Ol(s)))}function td(r){return SS(),TS(),ES(),kS()}function kS(){if(an!==5)return!1;var r=ua,s=Dm;Dm=0;var l=gl(mo),f=H.T,p=ae.p;try{ae.p=32>l?32:l,H.T=null,l=Mm,Mm=null;var g=ua,C=mo;if(an=0,ho=ua=null,mo=0,(ot&6)!==0)throw Error(i(331));var R=ot;if(ot|=4,oS(g.current),rS(g,g.current,C,l),ot=R,Xl(0,!1),gt&&typeof gt.onPostCommitFiberRoot=="function")try{gt.onPostCommitFiberRoot(tn,g)}catch{}return!0}finally{ae.p=p,H.T=f,CS(r,s)}}function _S(r,s,l){s=ti(l,s),s=fm(r.stateNode,s,2),r=ea(r,s,2),r!==null&&(Ya(r,2),Ki(r))}function mt(r,s,l){if(r.tag===3)_S(r,r,l);else for(;s!==null;){if(s.tag===3){_S(s,r,l);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ca===null||!ca.has(f))){r=ti(l,r),l=A0(2),f=ea(s,l,2),f!==null&&(O0(l,f,s,r),Ya(f,2),Ki(f));break}}s=s.return}}function Um(r,s,l){var f=r.pingCache;if(f===null){f=r.pingCache=new gA;var p=new Set;f.set(s,p)}else p=f.get(s),p===void 0&&(p=new Set,f.set(s,p));p.has(l)||(Rm=!0,p.add(l),r=TA.bind(null,r,s,l),s.then(r,r))}function TA(r,s,l){var f=r.pingCache;f!==null&&f.delete(s),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,vt===r&&(tt&l)===l&&(Rt===4||Rt===3&&(tt&62914560)===tt&&300>cn()-Nm?(ot&2)===0&&po(r,0):Am|=l,fo===tt&&(fo=0)),Ki(r)}function wS(r,s){s===0&&(s=lu()),r=Ws(r,s),r!==null&&(Ya(r,s),Ki(r))}function EA(r){var s=r.memoizedState,l=0;s!==null&&(l=s.retryLane),wS(r,l)}function CA(r,s){var l=0;switch(r.tag){case 13:var f=r.stateNode,p=r.memoizedState;p!==null&&(l=p.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(s),wS(r,l)}function kA(r,s){return $r(r,s)}var nd=null,vo=null,Bm=!1,id=!1,zm=!1,ds=0;function Ki(r){r!==vo&&r.next===null&&(vo===null?nd=vo=r:vo=vo.next=r),id=!0,Bm||(Bm=!0,wA())}function Xl(r,s){if(!zm&&id){zm=!0;do for(var l=!1,f=nd;f!==null;){if(r!==0){var p=f.pendingLanes;if(p===0)var g=0;else{var C=f.suspendedLanes,R=f.pingedLanes;g=(1<<31-nn(42|r)+1)-1,g&=p&~(C&~R),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,OS(f,g))}else g=tt,g=Ga(f,f===vt?g:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(g&3)===0||Hi(f,g)||(l=!0,OS(f,g));f=f.next}while(l);zm=!1}}function _A(){xS()}function xS(){id=Bm=!1;var r=0;ds!==0&&(PA()&&(r=ds),ds=0);for(var s=cn(),l=null,f=nd;f!==null;){var p=f.next,g=RS(f,s);g===0?(f.next=null,l===null?nd=p:l.next=p,p===null&&(vo=l)):(l=f,(r!==0||(g&3)!==0)&&(id=!0)),f=p}Xl(r)}function RS(r,s){for(var l=r.suspendedLanes,f=r.pingedLanes,p=r.expirationTimes,g=r.pendingLanes&-62914561;0<g;){var C=31-nn(g),R=1<<C,I=p[C];I===-1?((R&l)===0||(R&f)!==0)&&(p[C]=ou(R,s)):I<=s&&(r.expiredLanes|=R),g&=~R}if(s=vt,l=tt,l=Ga(r,r===s?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,l===0||r===s&&(lt===2||lt===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&Dn(f),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Hi(r,l)){if(s=l&-l,s===r.callbackPriority)return s;switch(f!==null&&Dn(f),gl(l)){case 2:case 8:l=Wn;break;case 32:l=gi;break;case 268435456:l=vi;break;default:l=gi}return f=AS.bind(null,r),l=$r(l,f),r.callbackPriority=s,r.callbackNode=l,s}return f!==null&&f!==null&&Dn(f),r.callbackPriority=2,r.callbackNode=null,2}function AS(r,s){if(an!==0&&an!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(td()&&r.callbackNode!==l)return null;var f=tt;return f=Ga(r,r===vt?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(dS(r,f,s),RS(r,cn()),r.callbackNode!=null&&r.callbackNode===l?AS.bind(null,r):null)}function OS(r,s){if(td())return null;dS(r,s,!0)}function wA(){IA(function(){(ot&6)!==0?$r(Us,_A):xS()})}function Vm(){return ds===0&&(ds=Bs()),ds}function NS(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:mu(""+r)}function DS(r,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,r.id&&l.setAttribute("form",r.id),s.parentNode.insertBefore(l,s),r=new FormData(r),l.parentNode.removeChild(l),r}function xA(r,s,l,f,p){if(s==="submit"&&l&&l.stateNode===p){var g=NS((p[me]||null).action),C=f.submitter;C&&(s=(s=C[me]||null)?NS(s.formAction):C.getAttribute("formAction"),s!==null&&(g=s,C=null));var R=new bu("action","action",null,f,p);r.push({event:R,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(ds!==0){var I=C?DS(p,C):new FormData(p);om(l,{pending:!0,data:I,method:p.method,action:g},null,I)}}else typeof g=="function"&&(R.preventDefault(),I=C?DS(p,C):new FormData(p),om(l,{pending:!0,data:I,method:p.method,action:g},g,I))},currentTarget:p}]})}}for(var Hm=0;Hm<wh.length;Hm++){var Fm=wh[Hm],RA=Fm.toLowerCase(),AA=Fm[0].toUpperCase()+Fm.slice(1);bi(RA,"on"+AA)}bi(dy,"onAnimationEnd"),bi(fy,"onAnimationIteration"),bi(hy,"onAnimationStart"),bi("dblclick","onDoubleClick"),bi("focusin","onFocus"),bi("focusout","onBlur"),bi(GR,"onTransitionRun"),bi(YR,"onTransitionStart"),bi(KR,"onTransitionCancel"),bi(my,"onTransitionEnd"),fn("onMouseEnter",["mouseout","mouseover"]),fn("onMouseLeave",["mouseout","mouseover"]),fn("onPointerEnter",["pointerout","pointerover"]),fn("onPointerLeave",["pointerout","pointerover"]),Mn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Zl));function MS(r,s){s=(s&4)!==0;for(var l=0;l<r.length;l++){var f=r[l],p=f.event;f=f.listeners;e:{var g=void 0;if(s)for(var C=f.length-1;0<=C;C--){var R=f[C],I=R.instance,K=R.currentTarget;if(R=R.listener,I!==g&&p.isPropagationStopped())break e;g=R,p.currentTarget=K;try{g(p)}catch(ie){qu(ie)}p.currentTarget=null,g=I}else for(C=0;C<f.length;C++){if(R=f[C],I=R.instance,K=R.currentTarget,R=R.listener,I!==g&&p.isPropagationStopped())break e;g=R,p.currentTarget=K;try{g(p)}catch(ie){qu(ie)}p.currentTarget=null,g=I}}}}function Ze(r,s){var l=s[Oe];l===void 0&&(l=s[Oe]=new Set);var f=r+"__bubble";l.has(f)||(PS(s,r,2,!1),l.add(f))}function qm(r,s,l){var f=0;s&&(f|=4),PS(l,r,f,s)}var rd="_reactListening"+Math.random().toString(36).slice(2);function $m(r){if(!r[rd]){r[rd]=!0,ct.forEach(function(l){l!=="selectionchange"&&(OA.has(l)||qm(l,!1,r),qm(l,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[rd]||(s[rd]=!0,qm("selectionchange",!1,s))}}function PS(r,s,l,f){switch(rT(s)){case 2:var p=iO;break;case 8:p=rO;break;default:p=ap}l=p.bind(null,s,l,r),p=void 0,!hh||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),f?p!==void 0?r.addEventListener(s,l,{capture:!0,passive:p}):r.addEventListener(s,l,!0):p!==void 0?r.addEventListener(s,l,{passive:p}):r.addEventListener(s,l,!1)}function Gm(r,s,l,f,p){var g=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var C=f.tag;if(C===3||C===4){var R=f.stateNode.containerInfo;if(R===p)break;if(C===4)for(C=f.return;C!==null;){var I=C.tag;if((I===3||I===4)&&C.stateNode.containerInfo===p)return;C=C.return}for(;R!==null;){if(C=Fe(R),C===null)return;if(I=C.tag,I===5||I===6||I===26||I===27){f=g=C;continue e}R=R.parentNode}}f=f.return}Vb(function(){var K=g,ie=dh(l),oe=[];e:{var Q=py.get(r);if(Q!==void 0){var W=bu,Ue=r;switch(r){case"keypress":if(gu(l)===0)break e;case"keydown":case"keyup":W=kR;break;case"focusin":Ue="focus",W=vh;break;case"focusout":Ue="blur",W=vh;break;case"beforeblur":case"afterblur":W=vh;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=qb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=fR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=xR;break;case dy:case fy:case hy:W=pR;break;case my:W=AR;break;case"scroll":case"scrollend":W=uR;break;case"wheel":W=NR;break;case"copy":case"cut":case"paste":W=vR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=Gb;break;case"toggle":case"beforetoggle":W=MR}var Ie=(s&4)!==0,ft=!Ie&&(r==="scroll"||r==="scrollend"),F=Ie?Q!==null?Q+"Capture":null:Q;Ie=[];for(var z=K,$;z!==null;){var se=z;if($=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||$===null||F===null||(se=vl(z,F),se!=null&&Ie.push(Jl(z,se,$))),ft)break;z=z.return}0<Ie.length&&(Q=new W(Q,Ue,null,l,ie),oe.push({event:Q,listeners:Ie}))}}if((s&7)===0){e:{if(Q=r==="mouseover"||r==="pointerover",W=r==="mouseout"||r==="pointerout",Q&&l!==uh&&(Ue=l.relatedTarget||l.fromElement)&&(Fe(Ue)||Ue[ke]))break e;if((W||Q)&&(Q=ie.window===ie?ie:(Q=ie.ownerDocument)?Q.defaultView||Q.parentWindow:window,W?(Ue=l.relatedTarget||l.toElement,W=K,Ue=Ue?Fe(Ue):null,Ue!==null&&(ft=o(Ue),Ie=Ue.tag,Ue!==ft||Ie!==5&&Ie!==27&&Ie!==6)&&(Ue=null)):(W=null,Ue=K),W!==Ue)){if(Ie=qb,se="onMouseLeave",F="onMouseEnter",z="mouse",(r==="pointerout"||r==="pointerover")&&(Ie=Gb,se="onPointerLeave",F="onPointerEnter",z="pointer"),ft=W==null?Q:Tt(W),$=Ue==null?Q:Tt(Ue),Q=new Ie(se,z+"leave",W,l,ie),Q.target=ft,Q.relatedTarget=$,se=null,Fe(ie)===K&&(Ie=new Ie(F,z+"enter",Ue,l,ie),Ie.target=$,Ie.relatedTarget=ft,se=Ie),ft=se,W&&Ue)t:{for(Ie=W,F=Ue,z=0,$=Ie;$;$=bo($))z++;for($=0,se=F;se;se=bo(se))$++;for(;0<z-$;)Ie=bo(Ie),z--;for(;0<$-z;)F=bo(F),$--;for(;z--;){if(Ie===F||F!==null&&Ie===F.alternate)break t;Ie=bo(Ie),F=bo(F)}Ie=null}else Ie=null;W!==null&&LS(oe,Q,W,Ie,!1),Ue!==null&&ft!==null&&LS(oe,ft,Ue,Ie,!0)}}e:{if(Q=K?Tt(K):window,W=Q.nodeName&&Q.nodeName.toLowerCase(),W==="select"||W==="input"&&Q.type==="file")var Te=ey;else if(Zb(Q))if(ty)Te=FR;else{Te=VR;var Ke=zR}else W=Q.nodeName,!W||W.toLowerCase()!=="input"||Q.type!=="checkbox"&&Q.type!=="radio"?K&&ch(K.elementType)&&(Te=ey):Te=HR;if(Te&&(Te=Te(r,K))){Jb(oe,Te,l,ie);break e}Ke&&Ke(r,Q,K),r==="focusout"&&K&&Q.type==="number"&&K.memoizedProps.value!=null&&lh(Q,"number",Q.value)}switch(Ke=K?Tt(K):window,r){case"focusin":(Zb(Ke)||Ke.contentEditable==="true")&&(Ys=Ke,Ch=K,_l=null);break;case"focusout":_l=Ch=Ys=null;break;case"mousedown":kh=!0;break;case"contextmenu":case"mouseup":case"dragend":kh=!1,cy(oe,l,ie);break;case"selectionchange":if($R)break;case"keydown":case"keyup":cy(oe,l,ie)}var Ne;if(yh)e:{switch(r){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Gs?Wb(r,l)&&(je="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(je="onCompositionStart");je&&(Yb&&l.locale!=="ko"&&(Gs||je!=="onCompositionStart"?je==="onCompositionEnd"&&Gs&&(Ne=Hb()):(Wr=ie,mh="value"in Wr?Wr.value:Wr.textContent,Gs=!0)),Ke=ad(K,je),0<Ke.length&&(je=new $b(je,r,null,l,ie),oe.push({event:je,listeners:Ke}),Ne?je.data=Ne:(Ne=Xb(l),Ne!==null&&(je.data=Ne)))),(Ne=LR?IR(r,l):jR(r,l))&&(je=ad(K,"onBeforeInput"),0<je.length&&(Ke=new $b("onBeforeInput","beforeinput",null,l,ie),oe.push({event:Ke,listeners:je}),Ke.data=Ne)),xA(oe,r,K,l,ie)}MS(oe,s)})}function Jl(r,s,l){return{instance:r,listener:s,currentTarget:l}}function ad(r,s){for(var l=s+"Capture",f=[];r!==null;){var p=r,g=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||g===null||(p=vl(r,l),p!=null&&f.unshift(Jl(r,p,g)),p=vl(r,s),p!=null&&f.push(Jl(r,p,g))),r.tag===3)return f;r=r.return}return[]}function bo(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function LS(r,s,l,f,p){for(var g=s._reactName,C=[];l!==null&&l!==f;){var R=l,I=R.alternate,K=R.stateNode;if(R=R.tag,I!==null&&I===f)break;R!==5&&R!==26&&R!==27||K===null||(I=K,p?(K=vl(l,g),K!=null&&C.unshift(Jl(l,K,I))):p||(K=vl(l,g),K!=null&&C.push(Jl(l,K,I)))),l=l.return}C.length!==0&&r.push({event:s,listeners:C})}var NA=/\r\n?/g,DA=/\u0000|\uFFFD/g;function IS(r){return(typeof r=="string"?r:""+r).replace(NA,`
`).replace(DA,"")}function jS(r,s){return s=IS(s),IS(r)===s}function sd(){}function dt(r,s,l,f,p,g){switch(l){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||Fs(r,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&Fs(r,""+f);break;case"className":hr(r,"class",f);break;case"tabIndex":hr(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":hr(r,l,f);break;case"style":Bb(r,f,g);break;case"data":if(s!=="object"){hr(r,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||l!=="href")){r.removeAttribute(l);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(l);break}f=mu(""+f),r.setAttribute(l,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(s!=="input"&&dt(r,s,"name",p.name,p,null),dt(r,s,"formEncType",p.formEncType,p,null),dt(r,s,"formMethod",p.formMethod,p,null),dt(r,s,"formTarget",p.formTarget,p,null)):(dt(r,s,"encType",p.encType,p,null),dt(r,s,"method",p.method,p,null),dt(r,s,"target",p.target,p,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(l);break}f=mu(""+f),r.setAttribute(l,f);break;case"onClick":f!=null&&(r.onclick=sd);break;case"onScroll":f!=null&&Ze("scroll",r);break;case"onScrollEnd":f!=null&&Ze("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(l=f.__html,l!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}l=mu(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(l,""+f):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":f===!0?r.setAttribute(l,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(l,f):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(l,f):r.removeAttribute(l);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(l):r.setAttribute(l,f);break;case"popover":Ze("beforetoggle",r),Ze("toggle",r),fr(r,"popover",f);break;case"xlinkActuate":Ve(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ve(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ve(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ve(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ve(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ve(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ve(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ve(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ve(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":fr(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=lR.get(l)||l,fr(r,l,f))}}function Ym(r,s,l,f,p,g){switch(l){case"style":Bb(r,f,g);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(l=f.__html,l!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"children":typeof f=="string"?Fs(r,f):(typeof f=="number"||typeof f=="bigint")&&Fs(r,""+f);break;case"onScroll":f!=null&&Ze("scroll",r);break;case"onScrollEnd":f!=null&&Ze("scrollend",r);break;case"onClick":f!=null&&(r.onclick=sd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Fi.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),s=l.slice(2,p?l.length-7:void 0),g=r[me]||null,g=g!=null?g[l]:null,typeof g=="function"&&r.removeEventListener(s,g,p),typeof f=="function")){typeof g!="function"&&g!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(s,f,p);break e}l in r?r[l]=f:f===!0?r.setAttribute(l,""):fr(r,l,f)}}}function sn(r,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ze("error",r),Ze("load",r);var f=!1,p=!1,g;for(g in l)if(l.hasOwnProperty(g)){var C=l[g];if(C!=null)switch(g){case"src":f=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:dt(r,s,g,C,l,null)}}p&&dt(r,s,"srcSet",l.srcSet,l,null),f&&dt(r,s,"src",l.src,l,null);return;case"input":Ze("invalid",r);var R=g=C=p=null,I=null,K=null;for(f in l)if(l.hasOwnProperty(f)){var ie=l[f];if(ie!=null)switch(f){case"name":p=ie;break;case"type":C=ie;break;case"checked":I=ie;break;case"defaultChecked":K=ie;break;case"value":g=ie;break;case"defaultValue":R=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,s));break;default:dt(r,s,f,ie,l,null)}}Lb(r,g,R,I,K,C,p,!1),fu(r);return;case"select":Ze("invalid",r),f=C=g=null;for(p in l)if(l.hasOwnProperty(p)&&(R=l[p],R!=null))switch(p){case"value":g=R;break;case"defaultValue":C=R;break;case"multiple":f=R;default:dt(r,s,p,R,l,null)}s=g,l=C,r.multiple=!!f,s!=null?Hs(r,!!f,s,!1):l!=null&&Hs(r,!!f,l,!0);return;case"textarea":Ze("invalid",r),g=p=f=null;for(C in l)if(l.hasOwnProperty(C)&&(R=l[C],R!=null))switch(C){case"value":f=R;break;case"defaultValue":p=R;break;case"children":g=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(i(91));break;default:dt(r,s,C,R,l,null)}jb(r,f,p,g),fu(r);return;case"option":for(I in l)if(l.hasOwnProperty(I)&&(f=l[I],f!=null))switch(I){case"selected":r.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:dt(r,s,I,f,l,null)}return;case"dialog":Ze("beforetoggle",r),Ze("toggle",r),Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":Ze("load",r);break;case"video":case"audio":for(f=0;f<Zl.length;f++)Ze(Zl[f],r);break;case"image":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"embed":case"source":case"link":Ze("error",r),Ze("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in l)if(l.hasOwnProperty(K)&&(f=l[K],f!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:dt(r,s,K,f,l,null)}return;default:if(ch(s)){for(ie in l)l.hasOwnProperty(ie)&&(f=l[ie],f!==void 0&&Ym(r,s,ie,f,l,void 0));return}}for(R in l)l.hasOwnProperty(R)&&(f=l[R],f!=null&&dt(r,s,R,f,l,null))}function MA(r,s,l,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,g=null,C=null,R=null,I=null,K=null,ie=null;for(W in l){var oe=l[W];if(l.hasOwnProperty(W)&&oe!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":I=oe;default:f.hasOwnProperty(W)||dt(r,s,W,null,f,oe)}}for(var Q in f){var W=f[Q];if(oe=l[Q],f.hasOwnProperty(Q)&&(W!=null||oe!=null))switch(Q){case"type":g=W;break;case"name":p=W;break;case"checked":K=W;break;case"defaultChecked":ie=W;break;case"value":C=W;break;case"defaultValue":R=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(137,s));break;default:W!==oe&&dt(r,s,Q,W,f,oe)}}oh(r,C,R,I,K,ie,g,p);return;case"select":W=C=R=Q=null;for(g in l)if(I=l[g],l.hasOwnProperty(g)&&I!=null)switch(g){case"value":break;case"multiple":W=I;default:f.hasOwnProperty(g)||dt(r,s,g,null,f,I)}for(p in f)if(g=f[p],I=l[p],f.hasOwnProperty(p)&&(g!=null||I!=null))switch(p){case"value":Q=g;break;case"defaultValue":R=g;break;case"multiple":C=g;default:g!==I&&dt(r,s,p,g,f,I)}s=R,l=C,f=W,Q!=null?Hs(r,!!l,Q,!1):!!f!=!!l&&(s!=null?Hs(r,!!l,s,!0):Hs(r,!!l,l?[]:"",!1));return;case"textarea":W=Q=null;for(R in l)if(p=l[R],l.hasOwnProperty(R)&&p!=null&&!f.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:dt(r,s,R,null,f,p)}for(C in f)if(p=f[C],g=l[C],f.hasOwnProperty(C)&&(p!=null||g!=null))switch(C){case"value":Q=p;break;case"defaultValue":W=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==g&&dt(r,s,C,p,f,g)}Ib(r,Q,W);return;case"option":for(var Ue in l)if(Q=l[Ue],l.hasOwnProperty(Ue)&&Q!=null&&!f.hasOwnProperty(Ue))switch(Ue){case"selected":r.selected=!1;break;default:dt(r,s,Ue,null,f,Q)}for(I in f)if(Q=f[I],W=l[I],f.hasOwnProperty(I)&&Q!==W&&(Q!=null||W!=null))switch(I){case"selected":r.selected=Q&&typeof Q!="function"&&typeof Q!="symbol";break;default:dt(r,s,I,Q,f,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ie in l)Q=l[Ie],l.hasOwnProperty(Ie)&&Q!=null&&!f.hasOwnProperty(Ie)&&dt(r,s,Ie,null,f,Q);for(K in f)if(Q=f[K],W=l[K],f.hasOwnProperty(K)&&Q!==W&&(Q!=null||W!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(i(137,s));break;default:dt(r,s,K,Q,f,W)}return;default:if(ch(s)){for(var ft in l)Q=l[ft],l.hasOwnProperty(ft)&&Q!==void 0&&!f.hasOwnProperty(ft)&&Ym(r,s,ft,void 0,f,Q);for(ie in f)Q=f[ie],W=l[ie],!f.hasOwnProperty(ie)||Q===W||Q===void 0&&W===void 0||Ym(r,s,ie,Q,f,W);return}}for(var F in l)Q=l[F],l.hasOwnProperty(F)&&Q!=null&&!f.hasOwnProperty(F)&&dt(r,s,F,null,f,Q);for(oe in f)Q=f[oe],W=l[oe],!f.hasOwnProperty(oe)||Q===W||Q==null&&W==null||dt(r,s,oe,Q,f,W)}var Km=null,Qm=null;function od(r){return r.nodeType===9?r:r.ownerDocument}function US(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function BS(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function Wm(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Xm=null;function PA(){var r=window.event;return r&&r.type==="popstate"?r===Xm?!1:(Xm=r,!0):(Xm=null,!1)}var zS=typeof setTimeout=="function"?setTimeout:void 0,LA=typeof clearTimeout=="function"?clearTimeout:void 0,VS=typeof Promise=="function"?Promise:void 0,IA=typeof queueMicrotask=="function"?queueMicrotask:typeof VS<"u"?function(r){return VS.resolve(null).then(r).catch(jA)}:zS;function jA(r){setTimeout(function(){throw r})}function fa(r){return r==="head"}function HS(r,s){var l=s,f=0,p=0;do{var g=l.nextSibling;if(r.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(0<f&&8>f){l=f;var C=r.ownerDocument;if(l&1&&ec(C.documentElement),l&2&&ec(C.body),l&4)for(l=C.head,ec(l),C=l.firstChild;C;){var R=C.nextSibling,I=C.nodeName;C[we]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&C.rel.toLowerCase()==="stylesheet"||l.removeChild(C),C=R}}if(p===0){r.removeChild(g),lc(s);return}p--}else l==="$"||l==="$?"||l==="$!"?p++:f=l.charCodeAt(0)-48;else f=0;l=g}while(l);lc(s)}function Zm(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Zm(l),Re(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function UA(r,s,l,f){for(;r.nodeType===1;){var p=l;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[we])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(g=r.getAttribute("rel"),g==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(g!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(g=r.getAttribute("src"),(g!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&g&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var g=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===g)return r}else return r;if(r=Si(r.nextSibling),r===null)break}return null}function BA(r,s,l){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=Si(r.nextSibling),r===null))return null;return r}function Jm(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function zA(r,s){var l=r.ownerDocument;if(r.data!=="$?"||l.readyState==="complete")s();else{var f=function(){s(),l.removeEventListener("DOMContentLoaded",f)};l.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function Si(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return r}var ep=null;function FS(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return r;s--}else l==="/$"&&s++}r=r.previousSibling}return null}function qS(r,s,l){switch(s=od(l),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function ec(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);Re(r)}var oi=new Map,$S=new Set;function ld(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Rr=ae.d;ae.d={f:VA,r:HA,D:FA,C:qA,L:$A,m:GA,X:KA,S:YA,M:QA};function VA(){var r=Rr.f(),s=Ju();return r||s}function HA(r){var s=rt(r);s!==null&&s.tag===5&&s.type==="form"?d0(s):Rr.r(r)}var yo=typeof document>"u"?null:document;function GS(r,s,l){var f=yo;if(f&&typeof s=="string"&&s){var p=ei(s);p='link[rel="'+r+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),$S.has(p)||($S.add(p),r={rel:r,crossOrigin:l,href:s},f.querySelector(p)===null&&(s=f.createElement("link"),sn(s,"link",r),ze(s),f.head.appendChild(s)))}}function FA(r){Rr.D(r),GS("dns-prefetch",r,null)}function qA(r,s){Rr.C(r,s),GS("preconnect",r,s)}function $A(r,s,l){Rr.L(r,s,l);var f=yo;if(f&&r&&s){var p='link[rel="preload"][as="'+ei(s)+'"]';s==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+ei(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+ei(l.imageSizes)+'"]')):p+='[href="'+ei(r)+'"]';var g=p;switch(s){case"style":g=So(r);break;case"script":g=To(r)}oi.has(g)||(r=m({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:r,as:s},l),oi.set(g,r),f.querySelector(p)!==null||s==="style"&&f.querySelector(tc(g))||s==="script"&&f.querySelector(nc(g))||(s=f.createElement("link"),sn(s,"link",r),ze(s),f.head.appendChild(s)))}}function GA(r,s){Rr.m(r,s);var l=yo;if(l&&r){var f=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+ei(f)+'"][href="'+ei(r)+'"]',g=p;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=To(r)}if(!oi.has(g)&&(r=m({rel:"modulepreload",href:r},s),oi.set(g,r),l.querySelector(p)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(nc(g)))return}f=l.createElement("link"),sn(f,"link",r),ze(f),l.head.appendChild(f)}}}function YA(r,s,l){Rr.S(r,s,l);var f=yo;if(f&&r){var p=wt(f).hoistableStyles,g=So(r);s=s||"default";var C=p.get(g);if(!C){var R={loading:0,preload:null};if(C=f.querySelector(tc(g)))R.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":s},l),(l=oi.get(g))&&tp(r,l);var I=C=f.createElement("link");ze(I),sn(I,"link",r),I._p=new Promise(function(K,ie){I.onload=K,I.onerror=ie}),I.addEventListener("load",function(){R.loading|=1}),I.addEventListener("error",function(){R.loading|=2}),R.loading|=4,cd(C,s,f)}C={type:"stylesheet",instance:C,count:1,state:R},p.set(g,C)}}}function KA(r,s){Rr.X(r,s);var l=yo;if(l&&r){var f=wt(l).hoistableScripts,p=To(r),g=f.get(p);g||(g=l.querySelector(nc(p)),g||(r=m({src:r,async:!0},s),(s=oi.get(p))&&np(r,s),g=l.createElement("script"),ze(g),sn(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(p,g))}}function QA(r,s){Rr.M(r,s);var l=yo;if(l&&r){var f=wt(l).hoistableScripts,p=To(r),g=f.get(p);g||(g=l.querySelector(nc(p)),g||(r=m({src:r,async:!0,type:"module"},s),(s=oi.get(p))&&np(r,s),g=l.createElement("script"),ze(g),sn(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(p,g))}}function YS(r,s,l,f){var p=(p=ye.current)?ld(p):null;if(!p)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=So(l.href),l=wt(p).hoistableStyles,f=l.get(s),f||(f={type:"style",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=So(l.href);var g=wt(p).hoistableStyles,C=g.get(r);if(C||(p=p.ownerDocument||p,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(r,C),(g=p.querySelector(tc(r)))&&!g._p&&(C.instance=g,C.state.loading=5),oi.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},oi.set(r,l),g||WA(p,r,l,C.state))),s&&f===null)throw Error(i(528,""));return C}if(s&&f!==null)throw Error(i(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=To(l),l=wt(p).hoistableScripts,f=l.get(s),f||(f={type:"script",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function So(r){return'href="'+ei(r)+'"'}function tc(r){return'link[rel="stylesheet"]['+r+"]"}function KS(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function WA(r,s,l,f){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=r.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),sn(s,"link",l),ze(s),r.head.appendChild(s))}function To(r){return'[src="'+ei(r)+'"]'}function nc(r){return"script[async]"+r}function QS(r,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var f=r.querySelector('style[data-href~="'+ei(l.href)+'"]');if(f)return s.instance=f,ze(f),f;var p=m({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),ze(f),sn(f,"style",p),cd(f,l.precedence,r),s.instance=f;case"stylesheet":p=So(l.href);var g=r.querySelector(tc(p));if(g)return s.state.loading|=4,s.instance=g,ze(g),g;f=KS(l),(p=oi.get(p))&&tp(f,p),g=(r.ownerDocument||r).createElement("link"),ze(g);var C=g;return C._p=new Promise(function(R,I){C.onload=R,C.onerror=I}),sn(g,"link",f),s.state.loading|=4,cd(g,l.precedence,r),s.instance=g;case"script":return g=To(l.src),(p=r.querySelector(nc(g)))?(s.instance=p,ze(p),p):(f=l,(p=oi.get(g))&&(f=m({},l),np(f,p)),r=r.ownerDocument||r,p=r.createElement("script"),ze(p),sn(p,"link",f),r.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,cd(f,l.precedence,r));return s.instance}function cd(r,s,l){for(var f=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=f.length?f[f.length-1]:null,g=p,C=0;C<f.length;C++){var R=f[C];if(R.dataset.precedence===s)g=R;else if(g!==p)break}g?g.parentNode.insertBefore(r,g.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(r,s.firstChild))}function tp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function np(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var ud=null;function WS(r,s,l){if(ud===null){var f=new Map,p=ud=new Map;p.set(l,f)}else p=ud,f=p.get(l),f||(f=new Map,p.set(l,f));if(f.has(r))return f;for(f.set(r,null),l=l.getElementsByTagName(r),p=0;p<l.length;p++){var g=l[p];if(!(g[we]||g[ce]||r==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var C=g.getAttribute(s)||"";C=r+C;var R=f.get(C);R?R.push(g):f.set(C,[g])}}return f}function XS(r,s,l){r=r.ownerDocument||r,r.head.insertBefore(l,s==="title"?r.querySelector("head > title"):null)}function XA(r,s,l){if(l===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return r=s.disabled,typeof s.precedence=="string"&&r==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function ZS(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var ic=null;function ZA(){}function JA(r,s,l){if(ic===null)throw Error(i(475));var f=ic;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var p=So(l.href),g=r.querySelector(tc(p));if(g){r=g._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(f.count++,f=dd.bind(f),r.then(f,f)),s.state.loading|=4,s.instance=g,ze(g);return}g=r.ownerDocument||r,l=KS(l),(p=oi.get(p))&&tp(l,p),g=g.createElement("link"),ze(g);var C=g;C._p=new Promise(function(R,I){C.onload=R,C.onerror=I}),sn(g,"link",l),s.instance=g}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(s,r),(r=s.state.preload)&&(s.state.loading&3)===0&&(f.count++,s=dd.bind(f),r.addEventListener("load",s),r.addEventListener("error",s))}}function eO(){if(ic===null)throw Error(i(475));var r=ic;return r.stylesheets&&r.count===0&&ip(r,r.stylesheets),0<r.count?function(s){var l=setTimeout(function(){if(r.stylesheets&&ip(r,r.stylesheets),r.unsuspend){var f=r.unsuspend;r.unsuspend=null,f()}},6e4);return r.unsuspend=s,function(){r.unsuspend=null,clearTimeout(l)}}:null}function dd(){if(this.count--,this.count===0){if(this.stylesheets)ip(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var fd=null;function ip(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,fd=new Map,s.forEach(tO,r),fd=null,dd.call(r))}function tO(r,s){if(!(s.state.loading&4)){var l=fd.get(r);if(l)var f=l.get(null);else{l=new Map,fd.set(r,l);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<p.length;g++){var C=p[g];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(l.set(C.dataset.precedence,C),f=C)}f&&l.set(null,f)}p=s.instance,C=p.getAttribute("data-precedence"),g=l.get(C)||f,g===f&&l.set(null,p),l.set(C,p),this.count++,f=dd.bind(this),p.addEventListener("load",f),p.addEventListener("error",f),g?g.parentNode.insertBefore(p,g.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),s.state.loading|=4}}var rc={$$typeof:P,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function nO(r,s,l,f,p,g,C,R){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zs(0),this.hiddenUpdates=zs(null),this.identifierPrefix=f,this.onUncaughtError=p,this.onCaughtError=g,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function JS(r,s,l,f,p,g,C,R,I,K,ie,oe){return r=new nO(r,s,l,C,R,I,K,oe),s=1,g===!0&&(s|=24),g=Ln(3,null,null,s),r.current=g,g.stateNode=r,s=Uh(),s.refCount++,r.pooledCache=s,s.refCount++,g.memoizedState={element:f,isDehydrated:l,cache:s},Hh(g),r}function eT(r){return r?(r=Xs,r):Xs}function tT(r,s,l,f,p,g){p=eT(p),f.context===null?f.context=p:f.pendingContext=p,f=Jr(s),f.payload={element:l},g=g===void 0?null:g,g!==null&&(f.callback=g),l=ea(r,f,s),l!==null&&(zn(l,r,s),Pl(l,r,s))}function nT(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<s?l:s}}function rp(r,s){nT(r,s),(r=r.alternate)&&nT(r,s)}function iT(r){if(r.tag===13){var s=Ws(r,67108864);s!==null&&zn(s,r,67108864),rp(r,67108864)}}var hd=!0;function iO(r,s,l,f){var p=H.T;H.T=null;var g=ae.p;try{ae.p=2,ap(r,s,l,f)}finally{ae.p=g,H.T=p}}function rO(r,s,l,f){var p=H.T;H.T=null;var g=ae.p;try{ae.p=8,ap(r,s,l,f)}finally{ae.p=g,H.T=p}}function ap(r,s,l,f){if(hd){var p=sp(f);if(p===null)Gm(r,s,f,md,l),aT(r,f);else if(sO(p,r,s,l,f))f.stopPropagation();else if(aT(r,f),s&4&&-1<aO.indexOf(r)){for(;p!==null;){var g=rt(p);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var C=ur(g.pendingLanes);if(C!==0){var R=g;for(R.pendingLanes|=2,R.entangledLanes|=2;C;){var I=1<<31-nn(C);R.entanglements[1]|=I,C&=~I}Ki(g),(ot&6)===0&&(Xu=cn()+500,Xl(0))}}break;case 13:R=Ws(g,2),R!==null&&zn(R,g,2),Ju(),rp(g,2)}if(g=sp(f),g===null&&Gm(r,s,f,md,l),g===p)break;p=g}p!==null&&f.stopPropagation()}else Gm(r,s,f,null,l)}}function sp(r){return r=dh(r),op(r)}var md=null;function op(r){if(md=null,r=Fe(r),r!==null){var s=o(r);if(s===null)r=null;else{var l=s.tag;if(l===13){if(r=c(s),r!==null)return r;r=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return md=r,null}function rT(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ml()){case Us:return 2;case Wn:return 8;case gi:case Xn:return 32;case vi:return 268435456;default:return 32}default:return 32}}var lp=!1,ha=null,ma=null,pa=null,ac=new Map,sc=new Map,ga=[],aO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function aT(r,s){switch(r){case"focusin":case"focusout":ha=null;break;case"dragenter":case"dragleave":ma=null;break;case"mouseover":case"mouseout":pa=null;break;case"pointerover":case"pointerout":ac.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":sc.delete(s.pointerId)}}function oc(r,s,l,f,p,g){return r===null||r.nativeEvent!==g?(r={blockedOn:s,domEventName:l,eventSystemFlags:f,nativeEvent:g,targetContainers:[p]},s!==null&&(s=rt(s),s!==null&&iT(s)),r):(r.eventSystemFlags|=f,s=r.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),r)}function sO(r,s,l,f,p){switch(s){case"focusin":return ha=oc(ha,r,s,l,f,p),!0;case"dragenter":return ma=oc(ma,r,s,l,f,p),!0;case"mouseover":return pa=oc(pa,r,s,l,f,p),!0;case"pointerover":var g=p.pointerId;return ac.set(g,oc(ac.get(g)||null,r,s,l,f,p)),!0;case"gotpointercapture":return g=p.pointerId,sc.set(g,oc(sc.get(g)||null,r,s,l,f,p)),!0}return!1}function sT(r){var s=Fe(r.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=c(l),s!==null){r.blockedOn=s,q(r.priority,function(){if(l.tag===13){var f=Bn();f=pl(f);var p=Ws(l,f);p!==null&&zn(p,l,f),rp(l,f)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function pd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var l=sp(r.nativeEvent);if(l===null){l=r.nativeEvent;var f=new l.constructor(l.type,l);uh=f,l.target.dispatchEvent(f),uh=null}else return s=rt(l),s!==null&&iT(s),r.blockedOn=l,!1;s.shift()}return!0}function oT(r,s,l){pd(r)&&l.delete(s)}function oO(){lp=!1,ha!==null&&pd(ha)&&(ha=null),ma!==null&&pd(ma)&&(ma=null),pa!==null&&pd(pa)&&(pa=null),ac.forEach(oT),sc.forEach(oT)}function gd(r,s){r.blockedOn===s&&(r.blockedOn=null,lp||(lp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,oO)))}var vd=null;function lT(r){vd!==r&&(vd=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){vd===r&&(vd=null);for(var s=0;s<r.length;s+=3){var l=r[s],f=r[s+1],p=r[s+2];if(typeof f!="function"){if(op(f||l)===null)continue;break}var g=rt(l);g!==null&&(r.splice(s,3),s-=3,om(g,{pending:!0,data:p,method:l.method,action:f},f,p))}}))}function lc(r){function s(I){return gd(I,r)}ha!==null&&gd(ha,r),ma!==null&&gd(ma,r),pa!==null&&gd(pa,r),ac.forEach(s),sc.forEach(s);for(var l=0;l<ga.length;l++){var f=ga[l];f.blockedOn===r&&(f.blockedOn=null)}for(;0<ga.length&&(l=ga[0],l.blockedOn===null);)sT(l),l.blockedOn===null&&ga.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(f=0;f<l.length;f+=3){var p=l[f],g=l[f+1],C=p[me]||null;if(typeof g=="function")C||lT(l);else if(C){var R=null;if(g&&g.hasAttribute("formAction")){if(p=g,C=g[me]||null)R=C.formAction;else if(op(p)!==null)continue}else R=C.action;typeof R=="function"?l[f+1]=R:(l.splice(f,3),f-=3),lT(l)}}}function cp(r){this._internalRoot=r}bd.prototype.render=cp.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var l=s.current,f=Bn();tT(l,f,r,s,null,null)},bd.prototype.unmount=cp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;tT(r.current,2,null,r,null,null),Ju(),s[ke]=null}};function bd(r){this._internalRoot=r}bd.prototype.unstable_scheduleHydration=function(r){if(r){var s=U();r={blockedOn:null,target:r,priority:s};for(var l=0;l<ga.length&&s!==0&&s<ga[l].priority;l++);ga.splice(l,0,r),l===0&&sT(r)}};var cT=e.version;if(cT!=="19.1.0")throw Error(i(527,cT,"19.1.0"));ae.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=d(s),r=r!==null?h(r):null,r=r===null?null:r.stateNode,r};var lO={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yd.isDisabled&&yd.supportsFiber)try{tn=yd.inject(lO),gt=yd}catch{}}return uc.createRoot=function(r,s){if(!a(r))throw Error(i(299));var l=!1,f="",p=_0,g=w0,C=x0,R=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(g=s.onCaughtError),s.onRecoverableError!==void 0&&(C=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(R=s.unstable_transitionCallbacks)),s=JS(r,1,!1,null,null,l,f,p,g,C,R,null),r[ke]=s.current,$m(r),new cp(s)},uc.hydrateRoot=function(r,s,l){if(!a(r))throw Error(i(299));var f=!1,p="",g=_0,C=w0,R=x0,I=null,K=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(C=l.onCaughtError),l.onRecoverableError!==void 0&&(R=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(I=l.unstable_transitionCallbacks),l.formState!==void 0&&(K=l.formState)),s=JS(r,1,!0,s,l??null,f,p,g,C,R,I,K),s.context=eT(null),l=s.current,f=Bn(),f=pl(f),p=Jr(f),p.callback=null,ea(l,p,f),l=f,s.current.lanes=l,Ya(s,l),Ki(s),r[ke]=s.current,$m(r),new bd(s)},uc.version="19.1.0",uc}var yT;function bO(){if(yT)return fp.exports;yT=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),fp.exports=vO(),fp.exports}var yO=bO();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Tk=t=>{throw TypeError(t)},SO=(t,e,n)=>e.has(t)||Tk("Cannot "+n),gp=(t,e,n)=>(SO(t,e,"read from private field"),n?n.call(t):e.get(t)),TO=(t,e,n)=>e.has(t)?Tk("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),ST="popstate";function EO(t={}){function e(i,a){let{pathname:o,search:c,hash:u}=i.location;return Lc("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:Da(a)}return kO(e,n,null,t)}function We(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Dt(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function CO(){return Math.random().toString(36).substring(2,10)}function TT(t,e){return{usr:t.state,key:t.key,idx:e}}function Lc(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ua(e):e,state:n,key:e&&e.key||i||CO()}}function Da({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ua(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function kO(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:o=!1}=i,c=a.history,u="POP",d=null,h=m();h==null&&(h=0,c.replaceState({...c.state,idx:h},""));function m(){return(c.state||{idx:null}).idx}function v(){u="POP";let x=m(),_=x==null?null:x-h;h=x,d&&d({action:u,location:E.location,delta:_})}function y(x,_){u="PUSH";let N=Lc(E.location,x,_);h=m()+1;let P=TT(N,h),O=E.createHref(N);try{c.pushState(P,"",O)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;a.location.assign(O)}o&&d&&d({action:u,location:E.location,delta:1})}function T(x,_){u="REPLACE";let N=Lc(E.location,x,_);h=m();let P=TT(N,h),O=E.createHref(N);c.replaceState(P,"",O),o&&d&&d({action:u,location:E.location,delta:0})}function k(x){return Ek(x)}let E={get action(){return u},get location(){return t(a,c)},listen(x){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(ST,v),d=x,()=>{a.removeEventListener(ST,v),d=null}},createHref(x){return e(a,x)},createURL:k,encodeLocation(x){let _=k(x);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:y,replace:T,go(x){return c.go(x)}};return E}function Ek(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),We(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Da(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}var _c,ET=class{constructor(t){if(TO(this,_c,new Map),t)for(let[e,n]of t)this.set(e,n)}get(t){if(gp(this,_c).has(t))return gp(this,_c).get(t);if(t.defaultValue!==void 0)return t.defaultValue;throw new Error("No value found for context")}set(t,e){gp(this,_c).set(t,e)}};_c=new WeakMap;var _O=new Set(["lazy","caseSensitive","path","id","index","children"]);function wO(t){return _O.has(t)}var xO=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function RO(t){return xO.has(t)}function AO(t){return t.index===!0}function Ic(t,e,n=[],i={},a=!1){return t.map((o,c)=>{let u=[...n,String(c)],d=typeof o.id=="string"?o.id:u.join("-");if(We(o.index!==!0||!o.children,"Cannot specify children on an index route"),We(a||!i[d],`Found a route id collision on id "${d}".  Route id's must be globally unique within Data Router usages`),AO(o)){let h={...o,...e(o),id:d};return i[d]=h,h}else{let h={...o,...e(o),id:d,children:void 0};return i[d]=h,o.children&&(h.children=Ic(o.children,e,u,i,a)),h}})}function ka(t,e,n="/"){return Ud(t,e,n,!1)}function Ud(t,e,n,i){let a=typeof e=="string"?Ua(e):e,o=ui(a.pathname||"/",n);if(o==null)return null;let c=Ck(t);NO(c);let u=null;for(let d=0;u==null&&d<c.length;++d){let h=HO(o);u=zO(c[d],h,i)}return u}function OO(t,e){let{route:n,pathname:i,params:a}=t;return{id:n.id,pathname:i,params:a,data:e[n.id],loaderData:e[n.id],handle:n.handle}}function Ck(t,e=[],n=[],i="",a=!1){let o=(c,u,d=a,h)=>{let m={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(i)&&d)return;We(m.relativePath.startsWith(i),`Absolute route path "${m.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(i.length)}let v=Ji([i,m.relativePath]),y=n.concat(m);c.children&&c.children.length>0&&(We(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),Ck(c.children,e,y,v,d)),!(c.path==null&&!c.index)&&e.push({path:v,score:UO(v,c.index),routesMeta:y})};return t.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))o(c,u);else for(let d of kk(c.path))o(c,u,!0,d)}),e}function kk(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(i.length===0)return a?[o,""]:[o];let c=kk(i.join("/")),u=[];return u.push(...c.map(d=>d===""?o:[o,d].join("/"))),a&&u.push(...c),u.map(d=>t.startsWith("/")&&d===""?"/":d)}function NO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:BO(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var DO=/^:[\w-]+$/,MO=3,PO=2,LO=1,IO=10,jO=-2,CT=t=>t==="*";function UO(t,e){let n=t.split("/"),i=n.length;return n.some(CT)&&(i+=jO),e&&(i+=PO),n.filter(a=>!CT(a)).reduce((a,o)=>a+(DO.test(o)?MO:o===""?LO:IO),i)}function BO(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function zO(t,e,n=!1){let{routesMeta:i}=t,a={},o="/",c=[];for(let u=0;u<i.length;++u){let d=i[u],h=u===i.length-1,m=o==="/"?e:e.slice(o.length)||"/",v=sf({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},m),y=d.route;if(!v&&h&&n&&!i[i.length-1].route.index&&(v=sf({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!v)return null;Object.assign(a,v.params),c.push({params:a,pathname:Ji([o,v.pathname]),pathnameBase:GO(Ji([o,v.pathnameBase])),route:y}),v.pathnameBase!=="/"&&(o=Ji([o,v.pathnameBase]))}return c}function sf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=VO(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let o=a[0],c=o.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:i.reduce((h,{paramName:m,isOptional:v},y)=>{if(m==="*"){let k=u[y]||"";c=o.slice(0,o.length-k.length).replace(/(.)\/+$/,"$1")}const T=u[y];return v&&!T?h[m]=void 0:h[m]=(T||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:c,pattern:t}}function VO(t,e=!1,n=!0){Dt(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,d)=>(i.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function HO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Dt(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function ui(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}function FO({basename:t,pathname:e}){return e==="/"?t:Ji([t,e])}function qO(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?Ua(t):t;return{pathname:n?n.startsWith("/")?n:$O(n,e):e,search:YO(i),hash:KO(a)}}function $O(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function vp(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function _k(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Of(t){let e=_k(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function Nf(t,e,n,i=!1){let a;typeof t=="string"?a=Ua(t):(a={...t},We(!a.pathname||!a.pathname.includes("?"),vp("?","pathname","search",a)),We(!a.pathname||!a.pathname.includes("#"),vp("#","pathname","hash",a)),We(!a.search||!a.search.includes("#"),vp("#","search","hash",a)));let o=t===""||a.pathname==="",c=o?"/":a.pathname,u;if(c==null)u=n;else{let v=e.length-1;if(!i&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),v-=1;a.pathname=y.join("/")}u=v>=0?e[v]:"/"}let d=qO(a,u),h=c&&c!=="/"&&c.endsWith("/"),m=(o||c===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(h||m)&&(d.pathname+="/"),d}var Ji=t=>t.join("/").replace(/\/\/+/g,"/"),GO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),YO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,KO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,of=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function jc(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var wk=["POST","PUT","PATCH","DELETE"],QO=new Set(wk),WO=["GET",...wk],XO=new Set(WO),ZO=new Set([301,302,303,307,308]),JO=new Set([307,308]),bp={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},eN={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},dc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},tN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Cv=t=>tN.test(t),nN=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),xk="remix-router-transitions",Rk=Symbol("ResetLoaderData");function iN(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";We(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i=t.hydrationRouteProperties||[],a=t.mapRouteProperties||nN,o={},c=Ic(t.routes,a,void 0,o),u,d=t.basename||"/";d.startsWith("/")||(d=`/${d}`);let h=t.dataStrategy||lN,m={...t.future},v=null,y=new Set,T=null,k=null,E=null,x=t.hydrationData!=null,_=ka(c,t.history.location,d),N=!1,P=null,O;if(_==null&&!t.patchRoutesOnNavigation){let U=li(404,{pathname:t.history.location.pathname}),{matches:q,route:X}=Sd(c);O=!0,_=q,P={[X.id]:U}}else if(_&&!t.hydrationData&&Ka(_,c,t.history.location.pathname).active&&(_=null),_)if(_.some(U=>U.route.lazy))O=!1;else if(!_.some(U=>U.route.loader))O=!0;else{let U=t.hydrationData?t.hydrationData.loaderData:null,q=t.hydrationData?t.hydrationData.errors:null;if(q){let X=_.findIndex(ce=>q[ce.route.id]!==void 0);O=_.slice(0,X+1).every(ce=>!gg(ce.route,U,q))}else O=_.every(X=>!gg(X.route,U,q))}else{O=!1,_=[];let U=Ka(null,c,t.history.location.pathname);U.active&&U.matches&&(N=!0,_=U.matches)}let A,w={historyAction:t.history.action,location:t.history.location,matches:_,initialized:O,navigation:bp,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||P,fetchers:new Map,blockers:new Map},V="POP",M=!1,D,B=!1,Y=new Map,re=null,de=!1,be=!1,xe=new Set,H=new Map,ae=0,ee=-1,Se=new Map,j=new Set,te=new Map,he=new Map,le=new Set,ge=new Map,De,ye=null;function Ae(){if(v=t.history.listen(({action:U,location:q,delta:X})=>{if(De){De(),De=void 0;return}Dt(ge.size===0||X!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ce=ou({currentLocation:w.location,nextLocation:q,historyAction:U});if(ce&&X!=null){let me=new Promise(ke=>{De=ke});t.history.go(X*-1),Hi(ce,{state:"blocked",location:q,proceed(){Hi(ce,{state:"proceeding",proceed:void 0,reset:void 0,location:q}),me.then(()=>t.history.go(X))},reset(){let ke=new Map(w.blockers);ke.set(ce,dc),st({blockers:ke})}});return}return Dn(U,q)}),n){CN(e,Y);let U=()=>kN(e,Y);e.addEventListener("pagehide",U),re=()=>e.removeEventListener("pagehide",U)}return w.initialized||Dn("POP",w.location,{initialHydration:!0}),A}function Be(){v&&v(),re&&re(),y.clear(),D&&D.abort(),w.fetchers.forEach((U,q)=>nn(q)),w.blockers.forEach((U,q)=>Ga(q))}function yt(U){return y.add(U),()=>y.delete(U)}function st(U,q={}){U.matches&&(U.matches=U.matches.map(me=>{let ke=o[me.route.id],Oe=me.route;return Oe.element!==ke.element||Oe.errorElement!==ke.errorElement||Oe.hydrateFallbackElement!==ke.hydrateFallbackElement?{...me,route:ke}:me})),w={...w,...U};let X=[],ce=[];w.fetchers.forEach((me,ke)=>{me.state==="idle"&&(le.has(ke)?X.push(ke):ce.push(ke))}),le.forEach(me=>{!w.fetchers.has(me)&&!H.has(me)&&X.push(me)}),[...y].forEach(me=>me(w,{deletedFetchers:X,viewTransitionOpts:q.viewTransitionOpts,flushSync:q.flushSync===!0})),X.forEach(me=>nn(me)),ce.forEach(me=>w.fetchers.delete(me))}function Vt(U,q,{flushSync:X}={}){let ce=w.actionData!=null&&w.navigation.formMethod!=null&&En(w.navigation.formMethod)&&w.navigation.state==="loading"&&U.state?._isRedirect!==!0,me;q.actionData?Object.keys(q.actionData).length>0?me=q.actionData:me=null:ce?me=w.actionData:me=null;let ke=q.loaderData?MT(w.loaderData,q.loaderData,q.matches||[],q.errors):w.loaderData,Oe=w.blockers;Oe.size>0&&(Oe=new Map(Oe),Oe.forEach((we,Re)=>Oe.set(Re,dc)));let _e=de?!1:cu(U,q.matches||w.matches),Me=M===!0||w.navigation.formMethod!=null&&En(w.navigation.formMethod)&&U.state?._isRedirect!==!0;u&&(c=u,u=void 0),de||V==="POP"||(V==="PUSH"?t.history.push(U,U.state):V==="REPLACE"&&t.history.replace(U,U.state));let Le;if(V==="POP"){let we=Y.get(w.location.pathname);we&&we.has(U.pathname)?Le={currentLocation:w.location,nextLocation:U}:Y.has(U.pathname)&&(Le={currentLocation:U,nextLocation:w.location})}else if(B){let we=Y.get(w.location.pathname);we?we.add(U.pathname):(we=new Set([U.pathname]),Y.set(w.location.pathname,we)),Le={currentLocation:w.location,nextLocation:U}}st({...q,actionData:me,loaderData:ke,historyAction:V,location:U,initialized:!0,navigation:bp,revalidation:"idle",restoreScrollPosition:_e,preventScrollReset:Me,blockers:Oe},{viewTransitionOpts:Le,flushSync:X===!0}),V="POP",M=!1,B=!1,de=!1,be=!1,ye?.resolve(),ye=null}async function Nn(U,q){if(typeof U=="number"){t.history.go(U);return}let X=pg(w.location,w.matches,d,U,q?.fromRouteId,q?.relative),{path:ce,submission:me,error:ke}=kT(!1,X,q),Oe=w.location,_e=Lc(w.location,ce,q&&q.state);_e={..._e,...t.history.encodeLocation(_e)};let Me=q&&q.replace!=null?q.replace:void 0,Le="PUSH";Me===!0?Le="REPLACE":Me===!1||me!=null&&En(me.formMethod)&&me.formAction===w.location.pathname+w.location.search&&(Le="REPLACE");let we=q&&"preventScrollReset"in q?q.preventScrollReset===!0:void 0,Re=(q&&q.flushSync)===!0,Fe=ou({currentLocation:Oe,nextLocation:_e,historyAction:Le});if(Fe){Hi(Fe,{state:"blocked",location:_e,proceed(){Hi(Fe,{state:"proceeding",proceed:void 0,reset:void 0,location:_e}),Nn(U,q)},reset(){let rt=new Map(w.blockers);rt.set(Fe,dc),st({blockers:rt})}});return}await Dn(Le,_e,{submission:me,pendingError:ke,preventScrollReset:we,replace:q&&q.replace,enableViewTransition:q&&q.viewTransition,flushSync:Re})}function $r(){ye||(ye=_N()),Yr(),st({revalidation:"loading"});let U=ye.promise;return w.navigation.state==="submitting"?U:w.navigation.state==="idle"?(Dn(w.historyAction,w.location,{startUninterruptedRevalidation:!0}),U):(Dn(V||w.historyAction,w.navigation.location,{overrideNavigation:w.navigation,enableViewTransition:B===!0}),U)}async function Dn(U,q,X){D&&D.abort(),D=null,V=U,de=(X&&X.startUninterruptedRevalidation)===!0,Ya(w.location,w.matches),M=(X&&X.preventScrollReset)===!0,B=(X&&X.enableViewTransition)===!0;let ce=u||c,me=X&&X.overrideNavigation,ke=X?.initialHydration&&w.matches&&w.matches.length>0&&!N?w.matches:ka(ce,q,d),Oe=(X&&X.flushSync)===!0;if(ke&&w.initialized&&!be&&gN(w.location,q)&&!(X&&X.submission&&En(X.submission.formMethod))){Vt(q,{matches:ke},{flushSync:Oe});return}let _e=Ka(ke,ce,q.pathname);if(_e.active&&_e.matches&&(ke=_e.matches),!ke){let{error:wt,notFoundMatches:ze,route:ct}=Bs(q.pathname);Vt(q,{matches:ze,loaderData:{},errors:{[ct.id]:wt}},{flushSync:Oe});return}D=new AbortController;let Me=Ao(t.history,q,D.signal,X&&X.submission),Le=t.unstable_getContext?await t.unstable_getContext():new ET,we;if(X&&X.pendingError)we=[_a(ke).route.id,{type:"error",error:X.pendingError}];else if(X&&X.submission&&En(X.submission.formMethod)){let wt=await hl(Me,q,X.submission,ke,Le,_e.active,X&&X.initialHydration===!0,{replace:X.replace,flushSync:Oe});if(wt.shortCircuited)return;if(wt.pendingActionResult){let[ze,ct]=wt.pendingActionResult;if(Vn(ct)&&jc(ct.error)&&ct.error.status===404){D=null,Vt(q,{matches:wt.matches,loaderData:{},errors:{[ze]:ct.error}});return}}ke=wt.matches||ke,we=wt.pendingActionResult,me=yp(q,X.submission),Oe=!1,_e.active=!1,Me=Ao(t.history,Me.url,Me.signal)}let{shortCircuited:Re,matches:Fe,loaderData:rt,errors:Tt}=await js(Me,q,ke,Le,_e.active,me,X&&X.submission,X&&X.fetcherSubmission,X&&X.replace,X&&X.initialHydration===!0,Oe,we);Re||(D=null,Vt(q,{matches:Fe||ke,...PT(we),loaderData:rt,errors:Tt}))}async function hl(U,q,X,ce,me,ke,Oe,_e={}){Yr();let Me=TN(q,X);if(st({navigation:Me},{flushSync:_e.flushSync===!0}),ke){let Re=await Qa(ce,q.pathname,U.signal);if(Re.type==="aborted")return{shortCircuited:!0};if(Re.type==="error"){if(Re.partialMatches.length===0){let{matches:rt,route:Tt}=Sd(c);return{matches:rt,pendingActionResult:[Tt.id,{type:"error",error:Re.error}]}}let Fe=_a(Re.partialMatches).route.id;return{matches:Re.partialMatches,pendingActionResult:[Fe,{type:"error",error:Re.error}]}}else if(Re.matches)ce=Re.matches;else{let{notFoundMatches:Fe,error:rt,route:Tt}=Bs(q.pathname);return{matches:Fe,pendingActionResult:[Tt.id,{type:"error",error:rt}]}}}let Le,we=Bd(ce,q);if(!we.route.action&&!we.route.lazy)Le={type:"error",error:li(405,{method:U.method,pathname:q.pathname,routeId:we.route.id})};else{let Re=Io(a,o,U,ce,we,Oe?[]:i,me),Fe=await vi(U,Re,me,null);if(Le=Fe[we.route.id],!Le){for(let rt of ce)if(Fe[rt.route.id]){Le=Fe[rt.route.id];break}}if(U.signal.aborted)return{shortCircuited:!0}}if(gs(Le)){let Re;return _e&&_e.replace!=null?Re=_e.replace:Re=OT(Le.response.headers.get("Location"),new URL(U.url),d)===w.location.pathname+w.location.search,await Xn(U,Le,!0,{submission:X,replace:Re}),{shortCircuited:!0}}if(Vn(Le)){let Re=_a(ce,we.route.id);return(_e&&_e.replace)!==!0&&(V="PUSH"),{matches:ce,pendingActionResult:[Re.route.id,Le,we.route.id]}}return{matches:ce,pendingActionResult:[we.route.id,Le]}}async function js(U,q,X,ce,me,ke,Oe,_e,Me,Le,we,Re){let Fe=ke||yp(q,Oe),rt=Oe||_e||IT(Fe),Tt=!de&&!Le;if(me){if(Tt){let It=cn(Re);st({navigation:Fe,...It!==void 0?{actionData:It}:{}},{flushSync:we})}let Ve=await Qa(X,q.pathname,U.signal);if(Ve.type==="aborted")return{shortCircuited:!0};if(Ve.type==="error"){if(Ve.partialMatches.length===0){let{matches:mr,route:vn}=Sd(c);return{matches:mr,loaderData:{},errors:{[vn.id]:Ve.error}}}let It=_a(Ve.partialMatches).route.id;return{matches:Ve.partialMatches,loaderData:{},errors:{[It]:Ve.error}}}else if(Ve.matches)X=Ve.matches;else{let{error:It,notFoundMatches:mr,route:vn}=Bs(q.pathname);return{matches:mr,loaderData:{},errors:{[vn.id]:It}}}}let wt=u||c,{dsMatches:ze,revalidatingFetchers:ct}=_T(U,ce,a,o,t.history,w,X,rt,q,Le?[]:i,Le===!0,be,xe,le,te,j,wt,d,t.patchRoutesOnNavigation!=null,Re);if(ee=++ae,!t.dataStrategy&&!ze.some(Ve=>Ve.shouldLoad)&&!ze.some(Ve=>Ve.route.unstable_middleware)&&ct.length===0){let Ve=qa();return Vt(q,{matches:X,loaderData:{},errors:Re&&Vn(Re[1])?{[Re[0]]:Re[1].error}:null,...PT(Re),...Ve?{fetchers:new Map(w.fetchers)}:{}},{flushSync:we}),{shortCircuited:!0}}if(Tt){let Ve={};if(!me){Ve.navigation=Fe;let It=cn(Re);It!==void 0&&(Ve.actionData=It)}ct.length>0&&(Ve.fetchers=ml(ct)),st(Ve,{flushSync:we})}ct.forEach(Ve=>{Vi(Ve.key),Ve.controller&&H.set(Ve.key,Ve.controller)});let Fi=()=>ct.forEach(Ve=>Vi(Ve.key));D&&D.signal.addEventListener("abort",Fi);let{loaderResults:Mn,fetcherResults:fn}=await Gr(ze,ct,U,ce);if(U.signal.aborted)return{shortCircuited:!0};D&&D.signal.removeEventListener("abort",Fi),ct.forEach(Ve=>H.delete(Ve.key));let Zn=Td(Mn);if(Zn)return await Xn(U,Zn.result,!0,{replace:Me}),{shortCircuited:!0};if(Zn=Td(fn),Zn)return j.add(Zn.key),await Xn(U,Zn.result,!0,{replace:Me}),{shortCircuited:!0};let{loaderData:Vs,errors:Kr}=DT(w,X,Mn,Re,ct,fn);Le&&w.errors&&(Kr={...w.errors,...Kr});let dr=qa(),fr=$a(ee),hr=dr||fr||ct.length>0;return{matches:X,loaderData:Vs,errors:Kr,...hr?{fetchers:new Map(w.fetchers)}:{}}}function cn(U){if(U&&!Vn(U[1]))return{[U[0]]:U[1].data};if(w.actionData)return Object.keys(w.actionData).length===0?null:w.actionData}function ml(U){return U.forEach(q=>{let X=w.fetchers.get(q.key),ce=fc(void 0,X?X.data:void 0);w.fetchers.set(q.key,ce)}),new Map(w.fetchers)}async function Us(U,q,X,ce){Vi(U);let me=(ce&&ce.flushSync)===!0,ke=u||c,Oe=pg(w.location,w.matches,d,X,q,ce?.relative),_e=ka(ke,Oe,d),Me=Ka(_e,ke,Oe);if(Me.active&&Me.matches&&(_e=Me.matches),!_e){gt(U,q,li(404,{pathname:Oe}),{flushSync:me});return}let{path:Le,submission:we,error:Re}=kT(!0,Oe,ce);if(Re){gt(U,q,Re,{flushSync:me});return}let Fe=t.unstable_getContext?await t.unstable_getContext():new ET,rt=(ce&&ce.preventScrollReset)===!0;if(we&&En(we.formMethod)){await Wn(U,q,Le,_e,Fe,Me.active,me,rt,we);return}te.set(U,{routeId:q,path:Le}),await gi(U,q,Le,_e,Fe,Me.active,me,rt,we)}async function Wn(U,q,X,ce,me,ke,Oe,_e,Me){Yr(),te.delete(U);let Le=w.fetchers.get(U);tn(U,EN(Me,Le),{flushSync:Oe});let we=new AbortController,Re=Ao(t.history,X,we.signal,Me);if(ke){let kt=await Qa(ce,new URL(Re.url).pathname,Re.signal,U);if(kt.type==="aborted")return;if(kt.type==="error"){gt(U,q,kt.error,{flushSync:Oe});return}else if(kt.matches)ce=kt.matches;else{gt(U,q,li(404,{pathname:X}),{flushSync:Oe});return}}let Fe=Bd(ce,X);if(!Fe.route.action&&!Fe.route.lazy){let kt=li(405,{method:Me.formMethod,pathname:X,routeId:q});gt(U,q,kt,{flushSync:Oe});return}H.set(U,we);let rt=ae,Tt=Io(a,o,Re,ce,Fe,i,me),ze=(await vi(Re,Tt,me,U))[Fe.route.id];if(Re.signal.aborted){H.get(U)===we&&H.delete(U);return}if(le.has(U)){if(gs(ze)||Vn(ze)){tn(U,Ea(void 0));return}}else{if(gs(ze))if(H.delete(U),ee>rt){tn(U,Ea(void 0));return}else return j.add(U),tn(U,fc(Me)),Xn(Re,ze,!1,{fetcherSubmission:Me,preventScrollReset:_e});if(Vn(ze)){gt(U,q,ze.error);return}}let ct=w.navigation.location||w.location,Fi=Ao(t.history,ct,we.signal),Mn=u||c,fn=w.navigation.state!=="idle"?ka(Mn,w.navigation.location,d):w.matches;We(fn,"Didn't find any matches after fetcher action");let Zn=++ae;Se.set(U,Zn);let Vs=fc(Me,ze.data);w.fetchers.set(U,Vs);let{dsMatches:Kr,revalidatingFetchers:dr}=_T(Fi,me,a,o,t.history,w,fn,Me,ct,i,!1,be,xe,le,te,j,Mn,d,t.patchRoutesOnNavigation!=null,[Fe.route.id,ze]);dr.filter(kt=>kt.key!==U).forEach(kt=>{let Qr=kt.key,uu=w.fetchers.get(Qr),du=fc(void 0,uu?uu.data:void 0);w.fetchers.set(Qr,du),Vi(Qr),kt.controller&&H.set(Qr,kt.controller)}),st({fetchers:new Map(w.fetchers)});let fr=()=>dr.forEach(kt=>Vi(kt.key));we.signal.addEventListener("abort",fr);let{loaderResults:hr,fetcherResults:Ve}=await Gr(Kr,dr,Fi,me);if(we.signal.aborted)return;if(we.signal.removeEventListener("abort",fr),Se.delete(U),H.delete(U),dr.forEach(kt=>H.delete(kt.key)),w.fetchers.has(U)){let kt=Ea(ze.data);w.fetchers.set(U,kt)}let It=Td(hr);if(It)return Xn(Fi,It.result,!1,{preventScrollReset:_e});if(It=Td(Ve),It)return j.add(It.key),Xn(Fi,It.result,!1,{preventScrollReset:_e});let{loaderData:mr,errors:vn}=DT(w,fn,hr,void 0,dr,Ve);$a(Zn),w.navigation.state==="loading"&&Zn>ee?(We(V,"Expected pending action"),D&&D.abort(),Vt(w.navigation.location,{matches:fn,loaderData:mr,errors:vn,fetchers:new Map(w.fetchers)})):(st({errors:vn,loaderData:MT(w.loaderData,mr,fn,vn),fetchers:new Map(w.fetchers)}),be=!1)}async function gi(U,q,X,ce,me,ke,Oe,_e,Me){let Le=w.fetchers.get(U);tn(U,fc(Me,Le?Le.data:void 0),{flushSync:Oe});let we=new AbortController,Re=Ao(t.history,X,we.signal);if(ke){let ct=await Qa(ce,new URL(Re.url).pathname,Re.signal,U);if(ct.type==="aborted")return;if(ct.type==="error"){gt(U,q,ct.error,{flushSync:Oe});return}else if(ct.matches)ce=ct.matches;else{gt(U,q,li(404,{pathname:X}),{flushSync:Oe});return}}let Fe=Bd(ce,X);H.set(U,we);let rt=ae,Tt=Io(a,o,Re,ce,Fe,i,me),ze=(await vi(Re,Tt,me,U))[Fe.route.id];if(H.get(U)===we&&H.delete(U),!Re.signal.aborted){if(le.has(U)){tn(U,Ea(void 0));return}if(gs(ze))if(ee>rt){tn(U,Ea(void 0));return}else{j.add(U),await Xn(Re,ze,!1,{preventScrollReset:_e});return}if(Vn(ze)){gt(U,q,ze.error);return}tn(U,Ea(ze.data))}}async function Xn(U,q,X,{submission:ce,fetcherSubmission:me,preventScrollReset:ke,replace:Oe}={}){q.response.headers.has("X-Remix-Revalidate")&&(be=!0);let _e=q.response.headers.get("Location");We(_e,"Expected a Location header on the redirect Response"),_e=OT(_e,new URL(U.url),d);let Me=Lc(w.location,_e,{_isRedirect:!0});if(n){let Tt=!1;if(q.response.headers.has("X-Remix-Reload-Document"))Tt=!0;else if(Cv(_e)){const wt=Ek(_e,!0);Tt=wt.origin!==e.location.origin||ui(wt.pathname,d)==null}if(Tt){Oe?e.location.replace(_e):e.location.assign(_e);return}}D=null;let Le=Oe===!0||q.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:we,formAction:Re,formEncType:Fe}=w.navigation;!ce&&!me&&we&&Re&&Fe&&(ce=IT(w.navigation));let rt=ce||me;if(JO.has(q.response.status)&&rt&&En(rt.formMethod))await Dn(Le,Me,{submission:{...rt,formAction:_e},preventScrollReset:ke||M,enableViewTransition:X?B:void 0});else{let Tt=yp(Me,ce);await Dn(Le,Me,{overrideNavigation:Tt,fetcherSubmission:me,preventScrollReset:ke||M,enableViewTransition:X?B:void 0})}}async function vi(U,q,X,ce){let me,ke={};try{me=await uN(h,U,q,ce,X,!1)}catch(Oe){return q.filter(_e=>_e.shouldLoad).forEach(_e=>{ke[_e.route.id]={type:"error",error:Oe}}),ke}if(U.signal.aborted)return ke;for(let[Oe,_e]of Object.entries(me))if(yN(_e)){let Me=_e.result;ke[Oe]={type:"redirect",response:mN(Me,U,Oe,q,d)}}else ke[Oe]=await hN(_e);return ke}async function Gr(U,q,X,ce){let me=vi(X,U,ce,null),ke=Promise.all(q.map(async Me=>{if(Me.matches&&Me.match&&Me.request&&Me.controller){let we=(await vi(Me.request,Me.matches,ce,Me.key))[Me.match.route.id];return{[Me.key]:we}}else return Promise.resolve({[Me.key]:{type:"error",error:li(404,{pathname:Me.path})}})})),Oe=await me,_e=(await ke).reduce((Me,Le)=>Object.assign(Me,Le),{});return{loaderResults:Oe,fetcherResults:_e}}function Yr(){be=!0,te.forEach((U,q)=>{H.has(q)&&xe.add(q),Vi(q)})}function tn(U,q,X={}){w.fetchers.set(U,q),st({fetchers:new Map(w.fetchers)},{flushSync:(X&&X.flushSync)===!0})}function gt(U,q,X,ce={}){let me=_a(w.matches,q);nn(U),st({errors:{[me.route.id]:X},fetchers:new Map(w.fetchers)},{flushSync:(ce&&ce.flushSync)===!0})}function gn(U){return he.set(U,(he.get(U)||0)+1),le.has(U)&&le.delete(U),w.fetchers.get(U)||eN}function nn(U){let q=w.fetchers.get(U);H.has(U)&&!(q&&q.state==="loading"&&Se.has(U))&&Vi(U),te.delete(U),Se.delete(U),j.delete(U),le.delete(U),xe.delete(U),w.fetchers.delete(U)}function sh(U){let q=(he.get(U)||0)-1;q<=0?(he.delete(U),le.add(U)):he.set(U,q),st({fetchers:new Map(w.fetchers)})}function Vi(U){let q=H.get(U);q&&(q.abort(),H.delete(U))}function su(U){for(let q of U){let X=gn(q),ce=Ea(X.data);w.fetchers.set(q,ce)}}function qa(){let U=[],q=!1;for(let X of j){let ce=w.fetchers.get(X);We(ce,`Expected fetcher: ${X}`),ce.state==="loading"&&(j.delete(X),U.push(X),q=!0)}return su(U),q}function $a(U){let q=[];for(let[X,ce]of Se)if(ce<U){let me=w.fetchers.get(X);We(me,`Expected fetcher: ${X}`),me.state==="loading"&&(Vi(X),Se.delete(X),q.push(X))}return su(q),q.length>0}function ur(U,q){let X=w.blockers.get(U)||dc;return ge.get(U)!==q&&ge.set(U,q),X}function Ga(U){w.blockers.delete(U),ge.delete(U)}function Hi(U,q){let X=w.blockers.get(U)||dc;We(X.state==="unblocked"&&q.state==="blocked"||X.state==="blocked"&&q.state==="blocked"||X.state==="blocked"&&q.state==="proceeding"||X.state==="blocked"&&q.state==="unblocked"||X.state==="proceeding"&&q.state==="unblocked",`Invalid blocker state transition: ${X.state} -> ${q.state}`);let ce=new Map(w.blockers);ce.set(U,q),st({blockers:ce})}function ou({currentLocation:U,nextLocation:q,historyAction:X}){if(ge.size===0)return;ge.size>1&&Dt(!1,"A router only supports one blocker at a time");let ce=Array.from(ge.entries()),[me,ke]=ce[ce.length-1],Oe=w.blockers.get(me);if(!(Oe&&Oe.state==="proceeding")&&ke({currentLocation:U,nextLocation:q,historyAction:X}))return me}function Bs(U){let q=li(404,{pathname:U}),X=u||c,{matches:ce,route:me}=Sd(X);return{notFoundMatches:ce,route:me,error:q}}function lu(U,q,X){if(T=U,E=q,k=X||null,!x&&w.navigation===bp){x=!0;let ce=cu(w.location,w.matches);ce!=null&&st({restoreScrollPosition:ce})}return()=>{T=null,E=null,k=null}}function zs(U,q){return k&&k(U,q.map(ce=>OO(ce,w.loaderData)))||U.key}function Ya(U,q){if(T&&E){let X=zs(U,q);T[X]=E()}}function cu(U,q){if(T){let X=zs(U,q),ce=T[X];if(typeof ce=="number")return ce}return null}function Ka(U,q,X){if(t.patchRoutesOnNavigation)if(U){if(Object.keys(U[0].params).length>0)return{active:!0,matches:Ud(q,X,d,!0)}}else return{active:!0,matches:Ud(q,X,d,!0)||[]};return{active:!1,matches:null}}async function Qa(U,q,X,ce){if(!t.patchRoutesOnNavigation)return{type:"success",matches:U};let me=U;for(;;){let ke=u==null,Oe=u||c,_e=o;try{await t.patchRoutesOnNavigation({signal:X,path:q,matches:me,fetcherKey:ce,patch:(we,Re)=>{X.aborted||wT(we,Re,Oe,_e,a,!1)}})}catch(we){return{type:"error",error:we,partialMatches:me}}finally{ke&&!X.aborted&&(c=[...c])}if(X.aborted)return{type:"aborted"};let Me=ka(Oe,q,d);if(Me)return{type:"success",matches:Me};let Le=Ud(Oe,q,d,!0);if(!Le||me.length===Le.length&&me.every((we,Re)=>we.route.id===Le[Re].route.id))return{type:"success",matches:null};me=Le}}function pl(U){o={},u=Ic(U,a,void 0,o)}function gl(U,q,X=!1){let ce=u==null;wT(U,q,u||c,o,a,X),ce&&(c=[...c],st({}))}return A={get basename(){return d},get future(){return m},get state(){return w},get routes(){return c},get window(){return e},initialize:Ae,subscribe:yt,enableScrollRestoration:lu,navigate:Nn,fetch:Us,revalidate:$r,createHref:U=>t.history.createHref(U),encodeLocation:U=>t.history.encodeLocation(U),getFetcher:gn,deleteFetcher:sh,dispose:Be,getBlocker:ur,deleteBlocker:Ga,patchRoutes:gl,_internalFetchControllers:H,_internalSetRoutes:pl,_internalSetStateDoNotUseOrYouWillBreakYourApp(U){st(U)}},A}function rN(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function pg(t,e,n,i,a,o){let c,u;if(a){c=[];for(let h of e)if(c.push(h),h.route.id===a){u=h;break}}else c=e,u=e[e.length-1];let d=Nf(i||".",Of(c),ui(t.pathname,n)||t.pathname,o==="path");if(i==null&&(d.search=t.search,d.hash=t.hash),(i==null||i===""||i===".")&&u){let h=kv(d.search);if(u.route.index&&!h)d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index";else if(!u.route.index&&h){let m=new URLSearchParams(d.search),v=m.getAll("index");m.delete("index"),v.filter(T=>T).forEach(T=>m.append("index",T));let y=m.toString();d.search=y?`?${y}`:""}}return n!=="/"&&(d.pathname=FO({basename:n,pathname:d.pathname})),Da(d)}function kT(t,e,n){if(!n||!rN(n))return{path:e};if(n.formMethod&&!SN(n.formMethod))return{path:e,error:li(405,{method:n.formMethod})};let i=()=>({path:e,error:li(400,{type:"invalid-body"})}),o=(n.formMethod||"get").toUpperCase(),c=Pk(e);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!En(o))return i();let v=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((y,[T,k])=>`${y}${T}=${k}
`,""):String(n.body);return{path:e,submission:{formMethod:o,formAction:c,formEncType:n.formEncType,formData:void 0,json:void 0,text:v}}}else if(n.formEncType==="application/json"){if(!En(o))return i();try{let v=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:e,submission:{formMethod:o,formAction:c,formEncType:n.formEncType,formData:void 0,json:v,text:void 0}}}catch{return i()}}}We(typeof FormData=="function","FormData is not available in this environment");let u,d;if(n.formData)u=bg(n.formData),d=n.formData;else if(n.body instanceof FormData)u=bg(n.body),d=n.body;else if(n.body instanceof URLSearchParams)u=n.body,d=NT(u);else if(n.body==null)u=new URLSearchParams,d=new FormData;else try{u=new URLSearchParams(n.body),d=NT(u)}catch{return i()}let h={formMethod:o,formAction:c,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:d,json:void 0,text:void 0};if(En(h.formMethod))return{path:e,submission:h};let m=Ua(e);return t&&m.search&&kv(m.search)&&u.append("index",""),m.search=`?${u}`,{path:Da(m),submission:h}}function _T(t,e,n,i,a,o,c,u,d,h,m,v,y,T,k,E,x,_,N,P){let O=P?Vn(P[1])?P[1].error:P[1].data:void 0,A=a.createURL(o.location),w=a.createURL(d),V;if(m&&o.errors){let de=Object.keys(o.errors)[0];V=c.findIndex(be=>be.route.id===de)}else if(P&&Vn(P[1])){let de=P[0];V=c.findIndex(be=>be.route.id===de)-1}let M=P?P[1].statusCode:void 0,D=M&&M>=400,B={currentUrl:A,currentParams:o.matches[0]?.params||{},nextUrl:w,nextParams:c[0].params,...u,actionResult:O,actionStatus:M},Y=c.map((de,be)=>{let{route:xe}=de,H=null;if(V!=null&&be>V?H=!1:xe.lazy?H=!0:xe.loader==null?H=!1:m?H=gg(xe,o.loaderData,o.errors):aN(o.loaderData,o.matches[be],de)&&(H=!0),H!==null)return vg(n,i,t,de,h,e,H);let ae=D?!1:v||A.pathname+A.search===w.pathname+w.search||A.search!==w.search||sN(o.matches[be],de),ee={...B,defaultShouldRevalidate:ae},Se=lf(de,ee);return vg(n,i,t,de,h,e,Se,ee)}),re=[];return k.forEach((de,be)=>{if(m||!c.some(he=>he.route.id===de.routeId)||T.has(be))return;let xe=o.fetchers.get(be),H=xe&&xe.state!=="idle"&&xe.data===void 0,ae=ka(x,de.path,_);if(!ae){if(N&&H)return;re.push({key:be,routeId:de.routeId,path:de.path,matches:null,match:null,request:null,controller:null});return}if(E.has(be))return;let ee=Bd(ae,de.path),Se=new AbortController,j=Ao(a,de.path,Se.signal),te=null;if(y.has(be))y.delete(be),te=Io(n,i,j,ae,ee,h,e);else if(H)v&&(te=Io(n,i,j,ae,ee,h,e));else{let he={...B,defaultShouldRevalidate:D?!1:v};lf(ee,he)&&(te=Io(n,i,j,ae,ee,h,e,he))}te&&re.push({key:be,routeId:de.routeId,path:de.path,matches:te,match:ee,request:j,controller:Se})}),{dsMatches:Y,revalidatingFetchers:re}}function gg(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let i=e!=null&&t.id in e,a=n!=null&&n[t.id]!==void 0;return!i&&a?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!i&&!a}function aN(t,e,n){let i=!e||n.route.id!==e.route.id,a=!t.hasOwnProperty(n.route.id);return i||a}function sN(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function lf(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function wT(t,e,n,i,a,o){let c;if(t){let h=i[t];We(h,`No route found to patch children into: routeId = ${t}`),h.children||(h.children=[]),c=h.children}else c=n;let u=[],d=[];if(e.forEach(h=>{let m=c.find(v=>Ak(h,v));m?d.push({existingRoute:m,newRoute:h}):u.push(h)}),u.length>0){let h=Ic(u,a,[t||"_","patch",String(c?.length||"0")],i);c.push(...h)}if(o&&d.length>0)for(let h=0;h<d.length;h++){let{existingRoute:m,newRoute:v}=d[h],y=m,[T]=Ic([v],a,[],{},!0);Object.assign(y,{element:T.element?T.element:y.element,errorElement:T.errorElement?T.errorElement:y.errorElement,hydrateFallbackElement:T.hydrateFallbackElement?T.hydrateFallbackElement:y.hydrateFallbackElement})}}function Ak(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,i)=>e.children?.some(a=>Ak(n,a))):!1}var xT=new WeakMap,Ok=({key:t,route:e,manifest:n,mapRouteProperties:i})=>{let a=n[e.id];if(We(a,"No route found in manifest"),!a.lazy||typeof a.lazy!="object")return;let o=a.lazy[t];if(!o)return;let c=xT.get(a);c||(c={},xT.set(a,c));let u=c[t];if(u)return u;let d=(async()=>{let h=wO(t),v=a[t]!==void 0&&t!=="hasErrorBoundary";if(h)Dt(!h,"Route property "+t+" is not a supported lazy route property. This property will be ignored."),c[t]=Promise.resolve();else if(v)Dt(!1,`Route "${a.id}" has a static property "${t}" defined. The lazy property will be ignored.`);else{let y=await o();y!=null&&(Object.assign(a,{[t]:y}),Object.assign(a,i(a)))}typeof a.lazy=="object"&&(a.lazy[t]=void 0,Object.values(a.lazy).every(y=>y===void 0)&&(a.lazy=void 0))})();return c[t]=d,d},RT=new WeakMap;function oN(t,e,n,i,a){let o=n[t.id];if(We(o,"No route found in manifest"),!t.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof t.lazy=="function"){let m=RT.get(o);if(m)return{lazyRoutePromise:m,lazyHandlerPromise:m};let v=(async()=>{We(typeof t.lazy=="function","No lazy route function found");let y=await t.lazy(),T={};for(let k in y){let E=y[k];if(E===void 0)continue;let x=RO(k),N=o[k]!==void 0&&k!=="hasErrorBoundary";x?Dt(!x,"Route property "+k+" is not a supported property to be returned from a lazy route function. This property will be ignored."):N?Dt(!N,`Route "${o.id}" has a static property "${k}" defined but its lazy function is also returning a value for this property. The lazy route property "${k}" will be ignored.`):T[k]=E}Object.assign(o,T),Object.assign(o,{...i(o),lazy:void 0})})();return RT.set(o,v),v.catch(()=>{}),{lazyRoutePromise:v,lazyHandlerPromise:v}}let c=Object.keys(t.lazy),u=[],d;for(let m of c){if(a&&a.includes(m))continue;let v=Ok({key:m,route:t,manifest:n,mapRouteProperties:i});v&&(u.push(v),m===e&&(d=v))}let h=u.length>0?Promise.all(u).then(()=>{}):void 0;return h?.catch(()=>{}),d?.catch(()=>{}),{lazyRoutePromise:h,lazyHandlerPromise:d}}async function AT(t){let e=t.matches.filter(a=>a.shouldLoad),n={};return(await Promise.all(e.map(a=>a.resolve()))).forEach((a,o)=>{n[e[o].route.id]=a}),n}async function lN(t){return t.matches.some(e=>e.route.unstable_middleware)?Nk(t,()=>AT(t)):AT(t)}function Nk(t,e){return cN(t,e,i=>i,vN,n);function n(i,a,o){if(o)return Promise.resolve(Object.assign(o.value,{[a]:{type:"error",result:i}}));{let{matches:c}=t,u=Math.min(c.findIndex(h=>h.route.id===a)||0,c.findIndex(h=>h.unstable_shouldCallHandler())||0),d=_a(c,c[u].route.id).route.id;return Promise.resolve({[d]:{type:"error",result:i}})}}}async function cN(t,e,n,i,a){let{matches:o,request:c,params:u,context:d}=t,h=o.flatMap(v=>v.route.unstable_middleware?v.route.unstable_middleware.map(y=>[v.route.id,y]):[]);return await Dk({request:c,params:u,context:d},h,e,n,i,a)}async function Dk(t,e,n,i,a,o,c=0){let{request:u}=t;if(u.signal.aborted)throw u.signal.reason??new Error(`Request aborted: ${u.method} ${u.url}`);let d=e[c];if(!d)return await n();let[h,m]=d,v,y=async()=>{if(v)throw new Error("You may only call `next()` once per middleware");try{return v={value:await Dk(t,e,n,i,a,o,c+1)},v.value}catch(T){return v={value:await o(T,h,v)},v.value}};try{let T=await m(t,y),k=T!=null?i(T):void 0;return a(k)?k:v?k??v.value:(v={value:await y()},v.value)}catch(T){return await o(T,h,v)}}function Mk(t,e,n,i,a){let o=Ok({key:"unstable_middleware",route:i.route,manifest:e,mapRouteProperties:t}),c=oN(i.route,En(n.method)?"action":"loader",e,t,a);return{middleware:o,route:c.lazyRoutePromise,handler:c.lazyHandlerPromise}}function vg(t,e,n,i,a,o,c,u=null){let d=!1,h=Mk(t,e,n,i,a);return{...i,_lazyPromises:h,shouldLoad:c,unstable_shouldRevalidateArgs:u,unstable_shouldCallHandler(m){return d=!0,u?typeof m=="boolean"?lf(i,{...u,defaultShouldRevalidate:m}):lf(i,u):c},resolve(m){return d||c||m&&!En(n.method)&&(i.route.lazy||i.route.loader)?dN({request:n,match:i,lazyHandlerPromise:h?.handler,lazyRoutePromise:h?.route,handlerOverride:m,scopedContext:o}):Promise.resolve({type:"data",result:void 0})}}}function Io(t,e,n,i,a,o,c,u=null){return i.map(d=>d.route.id!==a.route.id?{...d,shouldLoad:!1,unstable_shouldRevalidateArgs:u,unstable_shouldCallHandler:()=>!1,_lazyPromises:Mk(t,e,n,d,o),resolve:()=>Promise.resolve({type:"data",result:void 0})}:vg(t,e,n,d,o,c,!0,u))}async function uN(t,e,n,i,a,o){n.some(h=>h._lazyPromises?.middleware)&&await Promise.all(n.map(h=>h._lazyPromises?.middleware));let c={request:e,params:n[0].params,context:a,matches:n},d=await t({...c,fetcherKey:i,unstable_runClientMiddleware:h=>{let m=c;return Nk(m,()=>h({...m,fetcherKey:i,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}}))}});try{await Promise.all(n.flatMap(h=>[h._lazyPromises?.handler,h._lazyPromises?.route]))}catch{}return d}async function dN({request:t,match:e,lazyHandlerPromise:n,lazyRoutePromise:i,handlerOverride:a,scopedContext:o}){let c,u,d=En(t.method),h=d?"action":"loader",m=v=>{let y,T=new Promise((x,_)=>y=_);u=()=>y(),t.signal.addEventListener("abort",u);let k=x=>typeof v!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${h}" [routeId: ${e.route.id}]`)):v({request:t,params:e.params,context:o},...x!==void 0?[x]:[]),E=(async()=>{try{return{type:"data",result:await(a?a(_=>k(_)):k())}}catch(x){return{type:"error",result:x}}})();return Promise.race([E,T])};try{let v=d?e.route.action:e.route.loader;if(n||i)if(v){let y,[T]=await Promise.all([m(v).catch(k=>{y=k}),n,i]);if(y!==void 0)throw y;c=T}else{await n;let y=d?e.route.action:e.route.loader;if(y)[c]=await Promise.all([m(y),i]);else if(h==="action"){let T=new URL(t.url),k=T.pathname+T.search;throw li(405,{method:t.method,pathname:k,routeId:e.route.id})}else return{type:"data",result:void 0}}else if(v)c=await m(v);else{let y=new URL(t.url),T=y.pathname+y.search;throw li(404,{pathname:T})}}catch(v){return{type:"error",result:v}}finally{u&&t.signal.removeEventListener("abort",u)}return c}async function fN(t){let e=t.headers.get("Content-Type");return e&&/\bapplication\/json\b/.test(e)?t.body==null?null:t.json():t.text()}async function hN(t){let{result:e,type:n}=t;if(Lk(e)){let i;try{i=await fN(e)}catch(a){return{type:"error",error:a}}return n==="error"?{type:"error",error:new of(e.status,e.statusText,i),statusCode:e.status,headers:e.headers}:{type:"data",data:i,statusCode:e.status,headers:e.headers}}return n==="error"?LT(e)?e.data instanceof Error?{type:"error",error:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:new of(e.init?.status||500,void 0,e.data),statusCode:jc(e)?e.status:void 0,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:e,statusCode:jc(e)?e.status:void 0}:LT(e)?{type:"data",data:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function mN(t,e,n,i,a){let o=t.headers.get("Location");if(We(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!Cv(o)){let c=i.slice(0,i.findIndex(u=>u.route.id===n)+1);o=pg(new URL(e.url),c,a,o),t.headers.set("Location",o)}return t}function OT(t,e,n){if(Cv(t)){let i=t,a=i.startsWith("//")?new URL(e.protocol+i):new URL(i),o=ui(a.pathname,n)!=null;if(a.origin===e.origin&&o)return a.pathname+a.search+a.hash}return t}function Ao(t,e,n,i){let a=t.createURL(Pk(e)).toString(),o={signal:n};if(i&&En(i.formMethod)){let{formMethod:c,formEncType:u}=i;o.method=c.toUpperCase(),u==="application/json"?(o.headers=new Headers({"Content-Type":u}),o.body=JSON.stringify(i.json)):u==="text/plain"?o.body=i.text:u==="application/x-www-form-urlencoded"&&i.formData?o.body=bg(i.formData):o.body=i.formData}return new Request(a,o)}function bg(t){let e=new URLSearchParams;for(let[n,i]of t.entries())e.append(n,typeof i=="string"?i:i.name);return e}function NT(t){let e=new FormData;for(let[n,i]of t.entries())e.append(n,i);return e}function pN(t,e,n,i=!1,a=!1){let o={},c=null,u,d=!1,h={},m=n&&Vn(n[1])?n[1].error:void 0;return t.forEach(v=>{if(!(v.route.id in e))return;let y=v.route.id,T=e[y];if(We(!gs(T),"Cannot handle redirect results in processLoaderData"),Vn(T)){let k=T.error;if(m!==void 0&&(k=m,m=void 0),c=c||{},a)c[y]=k;else{let E=_a(t,y);c[E.route.id]==null&&(c[E.route.id]=k)}i||(o[y]=Rk),d||(d=!0,u=jc(T.error)?T.error.status:500),T.headers&&(h[y]=T.headers)}else o[y]=T.data,T.statusCode&&T.statusCode!==200&&!d&&(u=T.statusCode),T.headers&&(h[y]=T.headers)}),m!==void 0&&n&&(c={[n[0]]:m},n[2]&&(o[n[2]]=void 0)),{loaderData:o,errors:c,statusCode:u||200,loaderHeaders:h}}function DT(t,e,n,i,a,o){let{loaderData:c,errors:u}=pN(e,n,i);return a.filter(d=>!d.matches||d.matches.some(h=>h.shouldLoad)).forEach(d=>{let{key:h,match:m,controller:v}=d;if(v&&v.signal.aborted)return;let y=o[h];if(We(y,"Did not find corresponding fetcher result"),Vn(y)){let T=_a(t.matches,m?.route.id);u&&u[T.route.id]||(u={...u,[T.route.id]:y.error}),t.fetchers.delete(h)}else if(gs(y))We(!1,"Unhandled fetcher revalidation redirect");else{let T=Ea(y.data);t.fetchers.set(h,T)}}),{loaderData:c,errors:u}}function MT(t,e,n,i){let a=Object.entries(e).filter(([,o])=>o!==Rk).reduce((o,[c,u])=>(o[c]=u,o),{});for(let o of n){let c=o.route.id;if(!e.hasOwnProperty(c)&&t.hasOwnProperty(c)&&o.route.loader&&(a[c]=t[c]),i&&i.hasOwnProperty(c))break}return a}function PT(t){return t?Vn(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function _a(t,e){return(e?t.slice(0,t.findIndex(i=>i.route.id===e)+1):[...t]).reverse().find(i=>i.route.hasErrorBoundary===!0)||t[0]}function Sd(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function li(t,{pathname:e,routeId:n,method:i,type:a,message:o}={}){let c="Unknown Server Error",u="Unknown @remix-run/router error";return t===400?(c="Bad Request",i&&e&&n?u=`You made a ${i} request to "${e}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:a==="invalid-body"&&(u="Unable to encode submission body")):t===403?(c="Forbidden",u=`Route "${n}" does not match URL "${e}"`):t===404?(c="Not Found",u=`No route matches URL "${e}"`):t===405&&(c="Method Not Allowed",i&&e&&n?u=`You made a ${i.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:i&&(u=`Invalid request method "${i.toUpperCase()}"`)),new of(t||500,c,new Error(u),!0)}function Td(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[i,a]=e[n];if(gs(a))return{key:i,result:a}}}function Pk(t){let e=typeof t=="string"?Ua(t):t;return Da({...e,hash:""})}function gN(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function vN(t){return t!=null&&typeof t=="object"&&Object.entries(t).every(([e,n])=>typeof e=="string"&&bN(n))}function bN(t){return t!=null&&typeof t=="object"&&"type"in t&&"result"in t&&(t.type==="data"||t.type==="error")}function yN(t){return Lk(t.result)&&ZO.has(t.result.status)}function Vn(t){return t.type==="error"}function gs(t){return(t&&t.type)==="redirect"}function LT(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function Lk(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function SN(t){return XO.has(t.toUpperCase())}function En(t){return QO.has(t.toUpperCase())}function kv(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Bd(t,e){let n=typeof e=="string"?Ua(e).search:e.search;if(t[t.length-1].route.index&&kv(n||""))return t[t.length-1];let i=_k(t);return i[i.length-1]}function IT(t){let{formMethod:e,formAction:n,formEncType:i,text:a,formData:o,json:c}=t;if(!(!e||!n||!i)){if(a!=null)return{formMethod:e,formAction:n,formEncType:i,formData:void 0,json:void 0,text:a};if(o!=null)return{formMethod:e,formAction:n,formEncType:i,formData:o,json:void 0,text:void 0};if(c!==void 0)return{formMethod:e,formAction:n,formEncType:i,formData:void 0,json:c,text:void 0}}}function yp(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function TN(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function fc(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function EN(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Ea(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function CN(t,e){try{let n=t.sessionStorage.getItem(xk);if(n){let i=JSON.parse(n);for(let[a,o]of Object.entries(i||{}))o&&Array.isArray(o)&&e.set(a,new Set(o||[]))}}catch{}}function kN(t,e){if(e.size>0){let n={};for(let[i,a]of e)n[i]=[...a];try{t.sessionStorage.setItem(xk,JSON.stringify(n))}catch(i){Dt(!1,`Failed to save applied view transitions in sessionStorage (${i}).`)}}}function _N(){let t,e,n=new Promise((i,a)=>{t=async o=>{i(o);try{await n}catch{}},e=async o=>{a(o);try{await n}catch{}}});return{promise:n,resolve:t,reject:e}}var Ds=b.createContext(null);Ds.displayName="DataRouter";var Yc=b.createContext(null);Yc.displayName="DataRouterState";b.createContext(!1);var _v=b.createContext({isTransitioning:!1});_v.displayName="ViewTransition";var Ik=b.createContext(new Map);Ik.displayName="Fetchers";var wN=b.createContext(null);wN.displayName="Await";var Ii=b.createContext(null);Ii.displayName="Navigation";var Df=b.createContext(null);Df.displayName="Location";var mi=b.createContext({outlet:null,matches:[],isDataRoute:!1});mi.displayName="Route";var wv=b.createContext(null);wv.displayName="RouteError";function xN(t,{relative:e}={}){We(il(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=b.useContext(Ii),{hash:a,pathname:o,search:c}=Qc(t,{relative:e}),u=o;return n!=="/"&&(u=o==="/"?n:Ji([n,o])),i.createHref({pathname:u,search:c,hash:a})}function il(){return b.useContext(Df)!=null}function ji(){return We(il(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(Df).location}var jk="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Uk(t){b.useContext(Ii).static||b.useLayoutEffect(t)}function Ms(){let{isDataRoute:t}=b.useContext(mi);return t?HN():RN()}function RN(){We(il(),"useNavigate() may be used only in the context of a <Router> component.");let t=b.useContext(Ds),{basename:e,navigator:n}=b.useContext(Ii),{matches:i}=b.useContext(mi),{pathname:a}=ji(),o=JSON.stringify(Of(i)),c=b.useRef(!1);return Uk(()=>{c.current=!0}),b.useCallback((d,h={})=>{if(Dt(c.current,jk),!c.current)return;if(typeof d=="number"){n.go(d);return}let m=Nf(d,JSON.parse(o),a,h.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Ji([e,m.pathname])),(h.replace?n.replace:n.push)(m,h.state,h)},[e,n,o,a,t])}var AN=b.createContext(null);function ON(t){let e=b.useContext(mi).outlet;return e&&b.createElement(AN.Provider,{value:t},e)}function Kc(){let{matches:t}=b.useContext(mi),e=t[t.length-1];return e?e.params:{}}function Qc(t,{relative:e}={}){let{matches:n}=b.useContext(mi),{pathname:i}=ji(),a=JSON.stringify(Of(n));return b.useMemo(()=>Nf(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function NN(t,e,n,i,a){We(il(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=b.useContext(Ii),{matches:c}=b.useContext(mi),u=c[c.length-1],d=u?u.params:{},h=u?u.pathname:"/",m=u?u.pathnameBase:"/",v=u&&u.route;{let N=v&&v.path||"";zk(h,!v||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let y=ji(),T;T=y;let k=T.pathname||"/",E=k;if(m!=="/"){let N=m.replace(/^\//,"").split("/");E="/"+k.replace(/^\//,"").split("/").slice(N.length).join("/")}let x=ka(t,{pathname:E});return Dt(v||x!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),Dt(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),IN(x&&x.map(N=>Object.assign({},N,{params:Object.assign({},d,N.params),pathname:Ji([m,o.encodeLocation?o.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?m:Ji([m,o.encodeLocation?o.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),c,n,i,a)}function DN(){let t=VN(),e=jc(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=b.createElement(b.Fragment,null,b.createElement("p",null," Hey developer "),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:o},"ErrorBoundary")," or"," ",b.createElement("code",{style:o},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:a},n):null,c)}var MN=b.createElement(DN,null),PN=class extends b.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?b.createElement(mi.Provider,{value:this.props.routeContext},b.createElement(wv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function LN({routeContext:t,match:e,children:n}){let i=b.useContext(Ds);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),b.createElement(mi.Provider,{value:t},n)}function IN(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,c=n?.errors;if(c!=null){let h=o.findIndex(m=>m.route.id&&c?.[m.route.id]!==void 0);We(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),o=o.slice(0,Math.min(o.length,h+1))}let u=!1,d=-1;if(n)for(let h=0;h<o.length;h++){let m=o[h];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=h),m.route.id){let{loaderData:v,errors:y}=n,T=m.route.loader&&!v.hasOwnProperty(m.route.id)&&(!y||y[m.route.id]===void 0);if(m.route.lazy||T){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,m,v)=>{let y,T=!1,k=null,E=null;n&&(y=c&&m.route.id?c[m.route.id]:void 0,k=m.route.errorElement||MN,u&&(d<0&&v===0?(zk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),T=!0,E=null):d===v&&(T=!0,E=m.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,v+1)),_=()=>{let N;return y?N=k:T?N=E:m.route.Component?N=b.createElement(m.route.Component,null):m.route.element?N=m.route.element:N=h,b.createElement(LN,{match:m,routeContext:{outlet:h,matches:x,isDataRoute:n!=null},children:N})};return n&&(m.route.ErrorBoundary||m.route.errorElement||v===0)?b.createElement(PN,{location:n.location,revalidation:n.revalidation,component:k,error:y,children:_(),routeContext:{outlet:null,matches:x,isDataRoute:!0},unstable_onError:i}):_()},null)}function xv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jN(t){let e=b.useContext(Ds);return We(e,xv(t)),e}function Bk(t){let e=b.useContext(Yc);return We(e,xv(t)),e}function UN(t){let e=b.useContext(mi);return We(e,xv(t)),e}function Mf(t){let e=UN(t),n=e.matches[e.matches.length-1];return We(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function BN(){return Mf("useRouteId")}function zN(){let t=Bk("useLoaderData"),e=Mf("useLoaderData");return t.loaderData[e]}function VN(){let t=b.useContext(wv),e=Bk("useRouteError"),n=Mf("useRouteError");return t!==void 0?t:e.errors?.[n]}function HN(){let{router:t}=jN("useNavigate"),e=Mf("useNavigate"),n=b.useRef(!1);return Uk(()=>{n.current=!0}),b.useCallback(async(a,o={})=>{Dt(n.current,jk),n.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...o}))},[t,e])}var jT={};function zk(t,e,n){!e&&!jT[t]&&(jT[t]=!0,Dt(!1,n))}var UT={};function BT(t,e){!t&&!UT[e]&&(UT[e]=!0,console.warn(e))}function FN(t){let e={hasErrorBoundary:t.hasErrorBoundary||t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&(t.element&&Dt(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:b.createElement(t.Component),Component:void 0})),t.HydrateFallback&&(t.hydrateFallbackElement&&Dt(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:b.createElement(t.HydrateFallback),HydrateFallback:void 0})),t.ErrorBoundary&&(t.errorElement&&Dt(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:b.createElement(t.ErrorBoundary),ErrorBoundary:void 0})),e}var qN=["HydrateFallback","hydrateFallbackElement"],$N=class{constructor(){this.status="pending",this.promise=new Promise((t,e)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",e(n))}})}};function GN({router:t,flushSync:e,unstable_onError:n}){let[i,a]=b.useState(t.state),[o,c]=b.useState(),[u,d]=b.useState({isTransitioning:!1}),[h,m]=b.useState(),[v,y]=b.useState(),[T,k]=b.useState(),E=b.useRef(new Map),x=b.useCallback(A=>{a(w=>(A.errors&&n&&Object.entries(A.errors).forEach(([V,M])=>{w.errors?.[V]!==M&&n(M)}),A))},[n]),_=b.useCallback((A,{deletedFetchers:w,flushSync:V,viewTransitionOpts:M})=>{A.fetchers.forEach((B,Y)=>{B.data!==void 0&&E.current.set(Y,B.data)}),w.forEach(B=>E.current.delete(B)),BT(V===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let D=t.window!=null&&t.window.document!=null&&typeof t.window.document.startViewTransition=="function";if(BT(M==null||D,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!M||!D){e&&V?e(()=>x(A)):b.startTransition(()=>x(A));return}if(e&&V){e(()=>{v&&(h&&h.resolve(),v.skipTransition()),d({isTransitioning:!0,flushSync:!0,currentLocation:M.currentLocation,nextLocation:M.nextLocation})});let B=t.window.document.startViewTransition(()=>{e(()=>x(A))});B.finished.finally(()=>{e(()=>{m(void 0),y(void 0),c(void 0),d({isTransitioning:!1})})}),e(()=>y(B));return}v?(h&&h.resolve(),v.skipTransition(),k({state:A,currentLocation:M.currentLocation,nextLocation:M.nextLocation})):(c(A),d({isTransitioning:!0,flushSync:!1,currentLocation:M.currentLocation,nextLocation:M.nextLocation}))},[t.window,e,v,h,x]);b.useLayoutEffect(()=>t.subscribe(_),[t,_]),b.useEffect(()=>{u.isTransitioning&&!u.flushSync&&m(new $N)},[u]),b.useEffect(()=>{if(h&&o&&t.window){let A=o,w=h.promise,V=t.window.document.startViewTransition(async()=>{b.startTransition(()=>x(A)),await w});V.finished.finally(()=>{m(void 0),y(void 0),c(void 0),d({isTransitioning:!1})}),y(V)}},[o,h,t.window,x]),b.useEffect(()=>{h&&o&&i.location.key===o.location.key&&h.resolve()},[h,v,i.location,o]),b.useEffect(()=>{!u.isTransitioning&&T&&(c(T.state),d({isTransitioning:!0,flushSync:!1,currentLocation:T.currentLocation,nextLocation:T.nextLocation}),k(void 0))},[u.isTransitioning,T]);let N=b.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:A=>t.navigate(A),push:(A,w,V)=>t.navigate(A,{state:w,preventScrollReset:V?.preventScrollReset}),replace:(A,w,V)=>t.navigate(A,{replace:!0,state:w,preventScrollReset:V?.preventScrollReset})}),[t]),P=t.basename||"/",O=b.useMemo(()=>({router:t,navigator:N,static:!1,basename:P,unstable_onError:n}),[t,N,P,n]);return b.createElement(b.Fragment,null,b.createElement(Ds.Provider,{value:O},b.createElement(Yc.Provider,{value:i},b.createElement(Ik.Provider,{value:E.current},b.createElement(_v.Provider,{value:u},b.createElement(QN,{basename:P,location:i.location,navigationType:i.historyAction,navigator:N},b.createElement(YN,{routes:t.routes,future:t.future,state:i,unstable_onError:n})))))),null)}var YN=b.memo(KN);function KN({routes:t,future:e,state:n,unstable_onError:i}){return NN(t,void 0,n,i,e)}function Vk({to:t,replace:e,state:n,relative:i}){We(il(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=b.useContext(Ii);Dt(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=b.useContext(mi),{pathname:c}=ji(),u=Ms(),d=Nf(t,Of(o),c,i==="path"),h=JSON.stringify(d);return b.useEffect(()=>{u(JSON.parse(h),{replace:e,state:n,relative:i})},[u,h,i,e,n]),null}function Rv(t){return ON(t.context)}function QN({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:o=!1}){We(!il(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=b.useMemo(()=>({basename:c,navigator:a,static:o,future:{}}),[c,a,o]);typeof n=="string"&&(n=Ua(n));let{pathname:d="/",search:h="",hash:m="",state:v=null,key:y="default"}=n,T=b.useMemo(()=>{let k=ui(d,c);return k==null?null:{location:{pathname:k,search:h,hash:m,state:v,key:y},navigationType:i}},[c,d,h,m,v,y,i]);return Dt(T!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${m}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:b.createElement(Ii.Provider,{value:u},b.createElement(Df.Provider,{children:e,value:T}))}var zd="get",Vd="application/x-www-form-urlencoded";function Pf(t){return t!=null&&typeof t.tagName=="string"}function WN(t){return Pf(t)&&t.tagName.toLowerCase()==="button"}function XN(t){return Pf(t)&&t.tagName.toLowerCase()==="form"}function ZN(t){return Pf(t)&&t.tagName.toLowerCase()==="input"}function JN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function eD(t,e){return t.button===0&&(!e||e==="_self")&&!JN(t)}function yg(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(a=>[n,a]):[[n,i]])},[]))}function tD(t,e){let n=yg(t);return e&&e.forEach((i,a)=>{n.has(a)||e.getAll(a).forEach(o=>{n.append(a,o)})}),n}var Ed=null;function nD(){if(Ed===null)try{new FormData(document.createElement("form"),0),Ed=!1}catch{Ed=!0}return Ed}var iD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sp(t){return t!=null&&!iD.has(t)?(Dt(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Vd}"`),null):t}function rD(t,e){let n,i,a,o,c;if(XN(t)){let u=t.getAttribute("action");i=u?ui(u,e):null,n=t.getAttribute("method")||zd,a=Sp(t.getAttribute("enctype"))||Vd,o=new FormData(t)}else if(WN(t)||ZN(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||u.getAttribute("action");if(i=d?ui(d,e):null,n=t.getAttribute("formmethod")||u.getAttribute("method")||zd,a=Sp(t.getAttribute("formenctype"))||Sp(u.getAttribute("enctype"))||Vd,o=new FormData(u,t),!nD()){let{name:h,type:m,value:v}=t;if(m==="image"){let y=h?`${h}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else h&&o.append(h,v)}}else{if(Pf(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=zd,i=null,a=Vd,c=t}return o&&a==="text/plain"&&(c=o,o=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:o,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Av(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function aD(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&ui(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function sD(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function oD(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function lD(t,e,n){let i=await Promise.all(t.map(async a=>{let o=e.routes[a.route.id];if(o){let c=await sD(o,n);return c.links?c.links():[]}return[]}));return fD(i.flat(1).filter(oD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function zT(t,e,n,i,a,o){let c=(d,h)=>n[h]?d.route.id!==n[h].route.id:!0,u=(d,h)=>n[h].pathname!==d.pathname||n[h].route.path?.endsWith("*")&&n[h].params["*"]!==d.params["*"];return o==="assets"?e.filter((d,h)=>c(d,h)||u(d,h)):o==="data"?e.filter((d,h)=>{let m=i.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(c(d,h)||u(d,h))return!0;if(d.route.shouldRevalidate){let v=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function cD(t,e,{includeHydrateFallback:n}={}){return uD(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function uD(t){return[...new Set(t)]}function dD(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function fD(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let o=JSON.stringify(dD(a));return n.has(o)||(n.add(o),i.push({key:o,link:a})),i},[])}function Hk(){let t=b.useContext(Ds);return Av(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function hD(){let t=b.useContext(Yc);return Av(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Ov=b.createContext(void 0);Ov.displayName="FrameworkContext";function Fk(){let t=b.useContext(Ov);return Av(t,"You must render this element inside a <HydratedRouter> element"),t}function mD(t,e){let n=b.useContext(Ov),[i,a]=b.useState(!1),[o,c]=b.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:h,onMouseLeave:m,onTouchStart:v}=e,y=b.useRef(null);b.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let E=_=>{_.forEach(N=>{c(N.isIntersecting)})},x=new IntersectionObserver(E,{threshold:.5});return y.current&&x.observe(y.current),()=>{x.disconnect()}}},[t]),b.useEffect(()=>{if(i){let E=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(E)}}},[i]);let T=()=>{a(!0)},k=()=>{a(!1),c(!1)};return n?t!=="intent"?[o,y,{}]:[o,y,{onFocus:hc(u,T),onBlur:hc(d,k),onMouseEnter:hc(h,T),onMouseLeave:hc(m,k),onTouchStart:hc(v,T)}]:[!1,y,{}]}function hc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function pD({page:t,...e}){let{router:n}=Hk(),i=b.useMemo(()=>ka(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?b.createElement(vD,{page:t,matches:i,...e}):null}function gD(t){let{manifest:e,routeModules:n}=Fk(),[i,a]=b.useState([]);return b.useEffect(()=>{let o=!1;return lD(t,e,n).then(c=>{o||a(c)}),()=>{o=!0}},[t,e,n]),i}function vD({page:t,matches:e,...n}){let i=ji(),{manifest:a,routeModules:o}=Fk(),{basename:c}=Hk(),{loaderData:u,matches:d}=hD(),h=b.useMemo(()=>zT(t,e,d,a,i,"data"),[t,e,d,a,i]),m=b.useMemo(()=>zT(t,e,d,a,i,"assets"),[t,e,d,a,i]),v=b.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let k=new Set,E=!1;if(e.forEach(_=>{let N=a.routes[_.route.id];!N||!N.hasLoader||(!h.some(P=>P.route.id===_.route.id)&&_.route.id in u&&o[_.route.id]?.shouldRevalidate||N.hasClientLoader?E=!0:k.add(_.route.id))}),k.size===0)return[];let x=aD(t,c,"data");return E&&k.size>0&&x.searchParams.set("_routes",e.filter(_=>k.has(_.route.id)).map(_=>_.route.id).join(",")),[x.pathname+x.search]},[c,u,i,a,h,e,t,o]),y=b.useMemo(()=>cD(m,a),[m,a]),T=gD(m);return b.createElement(b.Fragment,null,v.map(k=>b.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...n})),y.map(k=>b.createElement("link",{key:k,rel:"modulepreload",href:k,...n})),T.map(({key:k,link:E})=>b.createElement("link",{key:k,nonce:n.nonce,...E})))}function bD(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var qk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{qk&&(window.__reactRouterVersion="7.8.2")}catch{}function yD(t,e){return iN({basename:e?.basename,unstable_getContext:e?.unstable_getContext,future:e?.future,history:EO({window:e?.window}),hydrationData:SD(),routes:t,mapRouteProperties:FN,hydrationRouteProperties:qN,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window}).initialize()}function SD(){let t=window?.__staticRouterHydrationData;return t&&t.errors&&(t={...t,errors:TD(t.errors)}),t}function TD(t){if(!t)return null;let e=Object.entries(t),n={};for(let[i,a]of e)if(a&&a.__type==="RouteErrorResponse")n[i]=new of(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let o=window[a.__subType];if(typeof o=="function")try{let c=new o(a.message);c.stack="",n[i]=c}catch{}}if(n[i]==null){let o=new Error(a.message);o.stack="",n[i]=o}}else n[i]=a;return n}var $k=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Hn=b.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:o,replace:c,state:u,target:d,to:h,preventScrollReset:m,viewTransition:v,...y},T){let{basename:k}=b.useContext(Ii),E=typeof h=="string"&&$k.test(h),x,_=!1;if(typeof h=="string"&&E&&(x=h,qk))try{let D=new URL(window.location.href),B=h.startsWith("//")?new URL(D.protocol+h):new URL(h),Y=ui(B.pathname,k);B.origin===D.origin&&Y!=null?h=Y+B.search+B.hash:_=!0}catch{Dt(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=xN(h,{relative:a}),[P,O,A]=mD(i,y),w=kD(h,{replace:c,state:u,target:d,preventScrollReset:m,relative:a,viewTransition:v});function V(D){e&&e(D),D.defaultPrevented||w(D)}let M=b.createElement("a",{...y,...A,href:x||N,onClick:_||o?e:V,ref:bD(T,O),target:d,"data-discover":!E&&n==="render"?"true":void 0});return P&&!E?b.createElement(b.Fragment,null,M,b.createElement(pD,{page:N})):M});Hn.displayName="Link";var wc=b.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:o,to:c,viewTransition:u,children:d,...h},m){let v=Qc(c,{relative:h.relative}),y=ji(),T=b.useContext(Yc),{navigator:k,basename:E}=b.useContext(Ii),x=T!=null&&OD(v)&&u===!0,_=k.encodeLocation?k.encodeLocation(v).pathname:v.pathname,N=y.pathname,P=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(N=N.toLowerCase(),P=P?P.toLowerCase():null,_=_.toLowerCase()),P&&E&&(P=ui(P,E)||P);const O=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let A=N===_||!a&&N.startsWith(_)&&N.charAt(O)==="/",w=P!=null&&(P===_||!a&&P.startsWith(_)&&P.charAt(_.length)==="/"),V={isActive:A,isPending:w,isTransitioning:x},M=A?e:void 0,D;typeof i=="function"?D=i(V):D=[i,A?"active":null,w?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let B=typeof o=="function"?o(V):o;return b.createElement(Hn,{...h,"aria-current":M,className:D,ref:m,style:B,to:c,viewTransition:u},typeof d=="function"?d(V):d)});wc.displayName="NavLink";var ED=b.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:o,method:c=zd,action:u,onSubmit:d,relative:h,preventScrollReset:m,viewTransition:v,...y},T)=>{let k=RD(),E=AD(u,{relative:h}),x=c.toLowerCase()==="get"?"get":"post",_=typeof u=="string"&&$k.test(u),N=P=>{if(d&&d(P),P.defaultPrevented)return;P.preventDefault();let O=P.nativeEvent.submitter,A=O?.getAttribute("formmethod")||c;k(O||P.currentTarget,{fetcherKey:e,method:A,navigate:n,replace:a,state:o,relative:h,preventScrollReset:m,viewTransition:v})};return b.createElement("form",{ref:T,method:x,action:E,onSubmit:i?d:N,...y,"data-discover":!_&&t==="render"?"true":void 0})});ED.displayName="Form";function CD(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Gk(t){let e=b.useContext(Ds);return We(e,CD(t)),e}function kD(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:o,viewTransition:c}={}){let u=Ms(),d=ji(),h=Qc(t,{relative:o});return b.useCallback(m=>{if(eD(m,e)){m.preventDefault();let v=n!==void 0?n:Da(d)===Da(h);u(t,{replace:v,state:i,preventScrollReset:a,relative:o,viewTransition:c})}},[d,u,h,n,i,e,t,a,o,c])}function _D(t){Dt(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=b.useRef(yg(t)),n=b.useRef(!1),i=ji(),a=b.useMemo(()=>tD(i.search,n.current?null:e.current),[i.search]),o=Ms(),c=b.useCallback((u,d)=>{const h=yg(typeof u=="function"?u(new URLSearchParams(a)):u);n.current=!0,o("?"+h,d)},[o,a]);return[a,c]}var wD=0,xD=()=>`__${String(++wD)}__`;function RD(){let{router:t}=Gk("useSubmit"),{basename:e}=b.useContext(Ii),n=BN();return b.useCallback(async(i,a={})=>{let{action:o,method:c,encType:u,formData:d,body:h}=rD(i,e);if(a.navigate===!1){let m=a.fetcherKey||xD();await t.fetch(m,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:h,formMethod:a.method||c,formEncType:a.encType||u,flushSync:a.flushSync})}else await t.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:h,formMethod:a.method||c,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function AD(t,{relative:e}={}){let{basename:n}=b.useContext(Ii),i=b.useContext(mi);We(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),o={...Qc(t||".",{relative:e})},c=ji();if(t==null){o.search=c.search;let u=new URLSearchParams(o.search),d=u.getAll("index");if(d.some(m=>m==="")){u.delete("index"),d.filter(v=>v).forEach(v=>u.append("index",v));let m=u.toString();o.search=m?`?${m}`:""}}return(!t||t===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:Ji([n,o.pathname])),Da(o)}function OD(t,{relative:e}={}){let n=b.useContext(_v);We(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Gk("useViewTransitionState"),a=Qc(t,{relative:e});if(!n.isTransitioning)return!1;let o=ui(n.currentLocation.pathname,i)||n.currentLocation.pathname,c=ui(n.nextLocation.pathname,i)||n.nextLocation.pathname;return sf(a.pathname,c)!=null||sf(a.pathname,o)!=null}var ND=Sk();function DD(t){return b.createElement(GN,{flushSync:ND.flushSync,...t})}const MD={},Sg="admin_token";function qo(t){t?localStorage.setItem(Sg,t):localStorage.removeItem(Sg)}function PD(){return localStorage.getItem(Sg)}async function di(t,e={}){const n=new Headers(e.headers||{});n.has("Content-Type")||n.set("Content-Type","application/json");const i=PD();i&&n.set("Authorization",`Bearer ${i}`);const a=await fetch(`/api${t}`,{...e,headers:n});if(a.status===401)throw new Error("UNAUTH");if(!a.ok)throw new Error(await a.text());return a.status===204?void 0:a.json()}const VT={async login(t,e){const n=await di("/auth/token",{method:"POST",body:JSON.stringify({email:t,password:e})});return qo(n.token),n.user},me(){return di("/whoami")},logout(){qo(null)}},HT=MD?.VITE_API_TOKEN??null;HT&&qo(HT);function LD(t){return new Proxy(t,{set(e,n,i){return e[n]=i,queueMicrotask(()=>document.querySelectorAll("[data-bind]").forEach(a=>a.dispatchEvent(new CustomEvent("bind:update")))),!0}})}const FT={brandName:"Regal",logoUrl:"",heroTitle:"",heroSubtitle:"URLLiveKit",heroImageUrl:"",accentHex:"#4f46e5"};function ID(){try{const t=localStorage.getItem("_site_settings");if(t)return{...FT,...JSON.parse(t)}}catch{}return FT}function jD(t){localStorage.setItem("_site_settings",JSON.stringify(t))}function Yk(){const t=LD({...ID(),overwrite:e=>{jD(e),Object.assign(t,e),document.documentElement.style.setProperty("--accent",e.accentHex||"#4f46e5")},export:()=>({brandName:t.brandName,logoUrl:t.logoUrl,heroTitle:t.heroTitle,heroSubtitle:t.heroSubtitle,heroImageUrl:t.heroImageUrl,accentHex:t.accentHex})});return document.documentElement.style.setProperty("--accent",t.accentHex||"#4f46e5"),t}function UD(){const t=Yk();return S.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-white to-slate-50 text-slate-800",children:[S.jsx("main",{className:"flex-1",children:S.jsx(Rv,{})}),S.jsx("footer",{className:"mt-14 border-t border-slate-200/70",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-10 text-sm text-slate-500 flex flex-col md:flex-row items-center justify-between gap-3",children:[S.jsxs("p",{children:[" ",new Date().getFullYear()," ",t.brandName||"Regal",". All rights reserved."]}),S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("a",{className:"hover:text-slate-700",href:"#",children:""}),S.jsx("a",{className:"hover:text-slate-700",href:"#",children:""}),S.jsx("a",{className:"hover:text-slate-700",href:"#",children:""})]})]})})]})}var qT={};function BD(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(i){if(i!=="default"&&!(i in t)){var a=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:function(){return n[i]}})}})}),Object.freeze(t)}var zD=Object.defineProperty,VD=(t,e,n)=>e in t?zD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$T=(t,e,n)=>VD(t,typeof e!="symbol"?e+"":e,n);class xn{constructor(){$T(this,"_locking"),$T(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(a=>e=()=>{this._locks-=1,a()}),i=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),i}}function Ot(t,e){if(!t)throw new Error(e)}const HD=34028234663852886e22,FD=-34028234663852886e22,qD=4294967295,$D=2147483647,GD=-2147483648;function Hd(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>$D||t<GD)throw new Error("invalid int 32: "+t)}function Tg(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>qD||t<0)throw new Error("invalid uint 32: "+t)}function Kk(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>HD||t<FD))throw new Error("invalid float 32: "+t)}const Qk=Symbol("@bufbuild/protobuf/enum-type");function YD(t){const e=t[Qk];return Ot(e,"missing enum type on enum object"),e}function Wk(t,e,n,i){t[Qk]=Xk(e,n.map(a=>({no:a.no,name:a.name,localName:t[a.no]})))}function Xk(t,e,n){const i=Object.create(null),a=Object.create(null),o=[];for(const c of e){const u=Zk(c);o.push(u),i[c.name]=u,a[c.no]=u}return{typeName:t,values:o,findName(c){return i[c]},findNumber(c){return a[c]}}}function KD(t,e,n){const i={};for(const a of e){const o=Zk(a);i[o.localName]=o.no,i[o.no]=o.localName}return Wk(i,t,e),i}function Zk(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class Nv{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const i=this.getType(),a=i.runtime.bin,o=a.makeReadOptions(n);return a.readMessage(this,o.readerFactory(e),e.byteLength,o),this}fromJson(e,n){const i=this.getType(),a=i.runtime.json,o=a.makeReadOptions(n);return a.readMessage(i,e,o,this),this}fromJsonString(e,n){let i;try{i=JSON.parse(e)}catch(a){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(a instanceof Error?a.message:String(a)))}return this.fromJson(i,n)}toBinary(e){const n=this.getType(),i=n.runtime.bin,a=i.makeWriteOptions(e),o=a.writerFactory();return i.writeMessage(this,o,a),o.finish()}toJson(e){const n=this.getType(),i=n.runtime.json,a=i.makeWriteOptions(e);return i.writeMessage(this,a)}toJsonString(e){var n;const i=this.toJson(e);return JSON.stringify(i,null,(n=e?.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function QD(t,e,n,i){var a;const o=(a=i?.localName)!==null&&a!==void 0?a:e.substring(e.lastIndexOf(".")+1),c={[o]:function(u){t.util.initFields(this),t.util.initPartial(u,this)}}[o];return Object.setPrototypeOf(c.prototype,new Nv),Object.assign(c,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(u,d){return new c().fromBinary(u,d)},fromJson(u,d){return new c().fromJson(u,d)},fromJsonString(u,d){return new c().fromJsonString(u,d)},equals(u,d){return t.util.equals(c,u,d)}}),c}function WD(){let t=0,e=0;for(let i=0;i<28;i+=7){let a=this.buf[this.pos++];if(t|=(a&127)<<i,(a&128)==0)return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,(n&128)==0)return this.assertBounds(),[t,e];for(let i=3;i<=31;i+=7){let a=this.buf[this.pos++];if(e|=(a&127)<<i,(a&128)==0)return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Tp(t,e,n){for(let o=0;o<28;o=o+7){const c=t>>>o,u=!(!(c>>>7)&&e==0),d=(u?c|128:c)&255;if(n.push(d),!u)return}const i=t>>>28&15|(e&7)<<4,a=e>>3!=0;if(n.push((a?i|128:i)&255),!!a){for(let o=3;o<31;o=o+7){const c=e>>>o,u=!!(c>>>7),d=(u?c|128:c)&255;if(n.push(d),!u)return}n.push(e>>>31&1)}}const Fd=4294967296;function GT(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let i=0,a=0;function o(c,u){const d=Number(t.slice(c,u));a*=n,i=i*n+d,i>=Fd&&(a=a+(i/Fd|0),i=i%Fd)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),e?e_(i,a):Dv(i,a)}function XD(t,e){let n=Dv(t,e);const i=n.hi&2147483648;i&&(n=e_(n.lo,n.hi));const a=Jk(n.lo,n.hi);return i?"-"+a:a}function Jk(t,e){if({lo:t,hi:e}=ZD(t,e),e<=2097151)return String(Fd*e+t);const n=t&16777215,i=(t>>>24|e<<8)&16777215,a=e>>16&65535;let o=n+i*6777216+a*6710656,c=i+a*8147497,u=a*2;const d=1e7;return o>=d&&(c+=Math.floor(o/d),o%=d),c>=d&&(u+=Math.floor(c/d),c%=d),u.toString()+YT(c)+YT(o)}function ZD(t,e){return{lo:t>>>0,hi:e>>>0}}function Dv(t,e){return{lo:t|0,hi:e|0}}function e_(t,e){return e=~e,t?t=~t+1:e+=1,Dv(t,e)}const YT=t=>{const e=String(t);return"0000000".slice(e.length)+e};function KT(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function JD(){let t=this.buf[this.pos++],e=t&127;if((t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,(t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,(t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,(t&128)==0)return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;(t&128)!==0&&n<10;n++)t=this.buf[this.pos++];if((t&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function eM(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof qT!="object"||qT.BUF_BIGINT_DISABLE!=="1")){const a=BigInt("-9223372036854775808"),o=BigInt("9223372036854775807"),c=BigInt("0"),u=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(d){const h=typeof d=="bigint"?d:BigInt(d);if(h>o||h<a)throw new Error("int64 invalid: ".concat(d));return h},uParse(d){const h=typeof d=="bigint"?d:BigInt(d);if(h>u||h<c)throw new Error("uint64 invalid: ".concat(d));return h},enc(d){return t.setBigInt64(0,this.parse(d),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(d){return t.setBigInt64(0,this.uParse(d),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(d,h){return t.setInt32(0,d,!0),t.setInt32(4,h,!0),t.getBigInt64(0,!0)},uDec(d,h){return t.setInt32(0,d,!0),t.setInt32(4,h,!0),t.getBigUint64(0,!0)}}}const n=a=>Ot(/^-?[0-9]+$/.test(a),"int64 invalid: ".concat(a)),i=a=>Ot(/^[0-9]+$/.test(a),"uint64 invalid: ".concat(a));return{zero:"0",supported:!1,parse(a){return typeof a!="string"&&(a=a.toString()),n(a),a},uParse(a){return typeof a!="string"&&(a=a.toString()),i(a),a},enc(a){return typeof a!="string"&&(a=a.toString()),n(a),GT(a)},uEnc(a){return typeof a!="string"&&(a=a.toString()),i(a),GT(a)},dec(a,o){return XD(a,o)},uDec(a,o){return Jk(a,o)}}}const Ct=eM();var ue;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(ue||(ue={}));var Ma;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Ma||(Ma={}));function ba(t,e,n){if(e===n)return!0;if(t==ue.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==n[i])return!1;return!0}switch(t){case ue.UINT64:case ue.FIXED64:case ue.INT64:case ue.SFIXED64:case ue.SINT64:return e==n}return!1}function $o(t,e){switch(t){case ue.BOOL:return!1;case ue.UINT64:case ue.FIXED64:case ue.INT64:case ue.SFIXED64:case ue.SINT64:return e==0?Ct.zero:"0";case ue.DOUBLE:case ue.FLOAT:return 0;case ue.BYTES:return new Uint8Array(0);case ue.STRING:return"";default:return 0}}function t_(t,e){switch(t){case ue.BOOL:return e===!1;case ue.STRING:return e==="";case ue.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var Lt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Lt||(Lt={}));class tM{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let a=0;a<this.chunks.length;a++)e+=this.chunks[a].length;let n=new Uint8Array(e),i=0;for(let a=0;a<this.chunks.length;a++)n.set(this.chunks[a],i),i+=this.chunks[a].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Tg(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Hd(e),KT(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){Kk(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Tg(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Hd(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Hd(e),e=(e<<1^e>>31)>>>0,KT(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),i=new DataView(n.buffer),a=Ct.enc(e);return i.setInt32(0,a.lo,!0),i.setInt32(4,a.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),i=new DataView(n.buffer),a=Ct.uEnc(e);return i.setInt32(0,a.lo,!0),i.setInt32(4,a.hi,!0),this.raw(n)}int64(e){let n=Ct.enc(e);return Tp(n.lo,n.hi,this.buf),this}sint64(e){let n=Ct.enc(e),i=n.hi>>31,a=n.lo<<1^i,o=(n.hi<<1|n.lo>>>31)^i;return Tp(a,o,this.buf),this}uint64(e){let n=Ct.uEnc(e);return Tp(n.lo,n.hi,this.buf),this}}class nM{constructor(e,n){this.varint64=WD,this.uint32=JD,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,i=e&7;if(n<=0||i<0||i>5)throw new Error("illegal tag: field no "+n+" wire type "+i);return[n,i]}skip(e,n){let i=this.pos;switch(e){case Lt.Varint:for(;this.buf[this.pos++]&128;);break;case Lt.Bit64:this.pos+=4;case Lt.Bit32:this.pos+=4;break;case Lt.LengthDelimited:let a=this.uint32();this.pos+=a;break;case Lt.StartGroup:for(;;){const[o,c]=this.tag();if(c===Lt.EndGroup){if(n!==void 0&&o!==n)throw new Error("invalid end group tag");break}this.skip(c,o)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(i,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Ct.dec(...this.varint64())}uint64(){return Ct.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),i=-(e&1);return e=(e>>>1|(n&1)<<31)^i,n=n>>>1^i,Ct.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ct.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ct.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function iM(t,e,n,i){let a;return{typeName:e,extendee:n,get field(){if(!a){const o=typeof i=="function"?i():i;o.name=e.split(".").pop(),o.jsonName="[".concat(e,"]"),a=t.util.newFieldList([o]).list()[0]}return a},runtime:t}}function n_(t){const e=t.field.localName,n=Object.create(null);return n[e]=rM(t),[n,()=>n[e]]}function rM(t){const e=t.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return $o(e.T,e.L);case"message":const n=e.T,i=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(i):i;case"map":throw"map fields are not allowed to be extensions"}}function aM(t,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.no)return[t[n]];return[]}return t.filter(n=>n.no===e.no)}let Dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Lf=[];for(let t=0;t<Dr.length;t++)Lf[Dr[t].charCodeAt(0)]=t;Lf[45]=Dr.indexOf("+");Lf[95]=Dr.indexOf("/");const i_={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),i=0,a=0,o,c=0;for(let u=0;u<t.length;u++){if(o=Lf[t.charCodeAt(u)],o===void 0)switch(t[u]){case"=":a=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(a){case 0:c=o,a=1;break;case 1:n[i++]=c<<2|(o&48)>>4,c=o,a=2;break;case 2:n[i++]=(c&15)<<4|(o&60)>>2,c=o,a=3;break;case 3:n[i++]=(c&3)<<6|o,a=0;break}}if(a==1)throw Error("invalid base64 string.");return n.subarray(0,i)},enc(t){let e="",n=0,i,a=0;for(let o=0;o<t.length;o++)switch(i=t[o],n){case 0:e+=Dr[i>>2],a=(i&3)<<4,n=1;break;case 1:e+=Dr[a|i>>4],a=(i&15)<<2,n=2;break;case 2:e+=Dr[a|i>>6],e+=Dr[i&63],n=0;break}return n&&(e+=Dr[a],e+="=",n==1&&(e+="=")),e}};function sM(t,e,n){a_(e,t);const i=e.runtime.bin.makeReadOptions(n),a=aM(t.getType().runtime.bin.listUnknownFields(t),e.field),[o,c]=n_(e);for(const u of a)e.runtime.bin.readField(o,i.readerFactory(u.data),e.field,u.wireType,i);return c()}function oM(t,e,n,i){a_(e,t);const a=e.runtime.bin.makeReadOptions(i),o=e.runtime.bin.makeWriteOptions(i);if(r_(t,e)){const h=t.getType().runtime.bin.listUnknownFields(t).filter(m=>m.no!=e.field.no);t.getType().runtime.bin.discardUnknownFields(t);for(const m of h)t.getType().runtime.bin.onUnknownField(t,m.no,m.wireType,m.data)}const c=o.writerFactory();let u=e.field;!u.opt&&!u.repeated&&(u.kind=="enum"||u.kind=="scalar")&&(u=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(u,n,c,o);const d=a.readerFactory(c.finish());for(;d.pos<d.len;){const[h,m]=d.tag(),v=d.skip(m,h);t.getType().runtime.bin.onUnknownField(t,h,m,v)}}function r_(t,e){const n=t.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(t).find(i=>i.no==e.field.no)}function a_(t,e){Ot(t.extendee.typeName==e.getType().typeName,"extension ".concat(t.typeName," can only be applied to message ").concat(t.extendee.typeName))}function s_(t,e){const n=t.localName;if(t.repeated)return e[n].length>0;if(t.oneof)return e[t.oneof.localName].case===n;switch(t.kind){case"enum":case"scalar":return t.opt||t.req?e[n]!==void 0:t.kind=="enum"?e[n]!==t.T.values[0].no:!t_(t.T,e[n]);case"message":return e[n]!==void 0;case"map":return Object.keys(e[n]).length>0}}function QT(t,e){const n=t.localName,i=!t.opt&&!t.req;if(t.repeated)e[n]=[];else if(t.oneof)e[t.oneof.localName]={case:void 0};else switch(t.kind){case"map":e[n]={};break;case"enum":e[n]=i?t.T.values[0].no:void 0;break;case"scalar":e[n]=i?$o(t.T,t.L):void 0;break;case"message":e[n]=void 0;break}}function Mr(t,e){if(t===null||typeof t!="object"||!Object.getOwnPropertyNames(Nv.prototype).every(i=>i in t&&typeof t[i]=="function"))return!1;const n=t.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:e===void 0?!0:n.typeName==e.typeName}function o_(t,e){return Mr(e)||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}ue.DOUBLE,ue.FLOAT,ue.INT64,ue.UINT64,ue.INT32,ue.UINT32,ue.BOOL,ue.STRING,ue.BYTES;const WT={ignoreUnknownFields:!1},XT={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function lM(t){return t?Object.assign(Object.assign({},WT),t):WT}function cM(t){return t?Object.assign(Object.assign({},XT),t):XT}const cf=Symbol(),qd=Symbol();function uM(){return{makeReadOptions:lM,makeWriteOptions:cM,readMessage(t,e,n,i){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(Wi(e)));i=i??new t;const a=new Map,o=n.typeRegistry;for(const[c,u]of Object.entries(e)){const d=t.fields.findJsonName(c);if(d){if(d.oneof){if(u===null&&d.kind=="scalar")continue;const h=a.get(d.oneof);if(h!==void 0)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(d.oneof.name,'" present: "').concat(h,'", "').concat(c,'"'));a.set(d.oneof,c)}ZT(i,u,d,n,t)}else{let h=!1;if(o?.findExtension&&c.startsWith("[")&&c.endsWith("]")){const m=o.findExtension(c.substring(1,c.length-1));if(m&&m.extendee.typeName==t.typeName){h=!0;const[v,y]=n_(m);ZT(v,u,m.field,n,m),oM(i,m,y(),n)}}if(!h&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(c,'" is unknown'))}}return i},writeMessage(t,e){const n=t.getType(),i={};let a;try{for(a of n.fields.byNumber()){if(!s_(a,t)){if(a.req)throw"required field not set";if(!e.emitDefaultValues||!fM(a))continue}const c=a.oneof?t[a.oneof.localName].value:t[a.localName],u=JT(a,c,e);u!==void 0&&(i[e.useProtoFieldName?a.name:a.jsonName]=u)}const o=e.typeRegistry;if(o?.findExtensionFor)for(const c of n.runtime.bin.listUnknownFields(t)){const u=o.findExtensionFor(n.typeName,c.no);if(u&&r_(t,u)){const d=sM(t,u,e),h=JT(u.field,d,e);h!==void 0&&(i[u.field.jsonName]=h)}}}catch(o){const c=a?"cannot encode field ".concat(n.typeName,".").concat(a.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),u=o instanceof Error?o.message:String(o);throw new Error(c+(u.length>0?": ".concat(u):""))}return i},readScalar(t,e,n){return Ac(t,e,n??Ma.BIGINT,!0)},writeScalar(t,e,n){if(e!==void 0&&(n||t_(t,e)))return $d(t,e)},debug:Wi}}function Wi(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function ZT(t,e,n,i,a){let o=n.localName;if(n.repeated){if(Ot(n.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(a.typeName,".").concat(n.name," from JSON: ").concat(Wi(e)));const c=t[o];for(const u of e){if(u===null)throw new Error("cannot decode field ".concat(a.typeName,".").concat(n.name," from JSON: ").concat(Wi(u)));switch(n.kind){case"message":c.push(n.T.fromJson(u,i));break;case"enum":const d=Ep(n.T,u,i.ignoreUnknownFields,!0);d!==qd&&c.push(d);break;case"scalar":try{c.push(Ac(n.T,u,n.L,!0))}catch(h){let m="cannot decode field ".concat(a.typeName,".").concat(n.name," from JSON: ").concat(Wi(u));throw h instanceof Error&&h.message.length>0&&(m+=": ".concat(h.message)),new Error(m)}break}}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(a.typeName,".").concat(n.name," from JSON: ").concat(Wi(e)));const c=t[o];for(const[u,d]of Object.entries(e)){if(d===null)throw new Error("cannot decode field ".concat(a.typeName,".").concat(n.name," from JSON: map value null"));let h;try{h=dM(n.K,u)}catch(m){let v="cannot decode map key for field ".concat(a.typeName,".").concat(n.name," from JSON: ").concat(Wi(e));throw m instanceof Error&&m.message.length>0&&(v+=": ".concat(m.message)),new Error(v)}switch(n.V.kind){case"message":c[h]=n.V.T.fromJson(d,i);break;case"enum":const m=Ep(n.V.T,d,i.ignoreUnknownFields,!0);m!==qd&&(c[h]=m);break;case"scalar":try{c[h]=Ac(n.V.T,d,Ma.BIGINT,!0)}catch(v){let y="cannot decode map value for field ".concat(a.typeName,".").concat(n.name," from JSON: ").concat(Wi(e));throw v instanceof Error&&v.message.length>0&&(y+=": ".concat(v.message)),new Error(y)}break}}}else switch(n.oneof&&(t=t[n.oneof.localName]={case:o},o="value"),n.kind){case"message":const c=n.T;if(e===null&&c.typeName!="google.protobuf.Value")return;let u=t[o];Mr(u)?u.fromJson(e,i):(t[o]=u=c.fromJson(e,i),c.fieldWrapper&&!n.oneof&&(t[o]=c.fieldWrapper.unwrapField(u)));break;case"enum":const d=Ep(n.T,e,i.ignoreUnknownFields,!1);switch(d){case cf:QT(n,t);break;case qd:break;default:t[o]=d;break}break;case"scalar":try{const h=Ac(n.T,e,n.L,!1);switch(h){case cf:QT(n,t);break;default:t[o]=h;break}}catch(h){let m="cannot decode field ".concat(a.typeName,".").concat(n.name," from JSON: ").concat(Wi(e));throw h instanceof Error&&h.message.length>0&&(m+=": ".concat(h.message)),new Error(m)}break}}function dM(t,e){if(t===ue.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Ac(t,e,Ma.BIGINT,!0).toString()}function Ac(t,e,n,i){if(e===null)return i?$o(t,n):cf;switch(t){case ue.DOUBLE:case ue.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const a=Number(e);if(Number.isNaN(a)||!Number.isFinite(a))break;return t==ue.FLOAT&&Kk(a),a;case ue.INT32:case ue.FIXED32:case ue.SFIXED32:case ue.SINT32:case ue.UINT32:let o;if(typeof e=="number"?o=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(o=Number(e)),o===void 0)break;return t==ue.UINT32||t==ue.FIXED32?Tg(o):Hd(o),o;case ue.INT64:case ue.SFIXED64:case ue.SINT64:if(typeof e!="number"&&typeof e!="string")break;const c=Ct.parse(e);return n?c.toString():c;case ue.FIXED64:case ue.UINT64:if(typeof e!="number"&&typeof e!="string")break;const u=Ct.uParse(e);return n?u.toString():u;case ue.BOOL:if(typeof e!="boolean")break;return e;case ue.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case ue.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return i_.dec(e)}throw new Error}function Ep(t,e,n,i){if(e===null)return t.typeName=="google.protobuf.NullValue"?0:i?t.values[0].no:cf;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const a=t.findName(e);if(a!==void 0)return a.no;if(n)return qd;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(Wi(e)))}function fM(t){return t.repeated||t.kind=="map"?!0:!(t.oneof||t.kind=="message"||t.opt||t.req)}function JT(t,e,n){if(t.kind=="map"){Ot(typeof e=="object"&&e!=null);const i={},a=Object.entries(e);switch(t.V.kind){case"scalar":for(const[c,u]of a)i[c.toString()]=$d(t.V.T,u);break;case"message":for(const[c,u]of a)i[c.toString()]=u.toJson(n);break;case"enum":const o=t.V.T;for(const[c,u]of a)i[c.toString()]=Cp(o,u,n.enumAsInteger);break}return n.emitDefaultValues||a.length>0?i:void 0}if(t.repeated){Ot(Array.isArray(e));const i=[];switch(t.kind){case"scalar":for(let a=0;a<e.length;a++)i.push($d(t.T,e[a]));break;case"enum":for(let a=0;a<e.length;a++)i.push(Cp(t.T,e[a],n.enumAsInteger));break;case"message":for(let a=0;a<e.length;a++)i.push(e[a].toJson(n));break}return n.emitDefaultValues||i.length>0?i:void 0}switch(t.kind){case"scalar":return $d(t.T,e);case"enum":return Cp(t.T,e,n.enumAsInteger);case"message":return o_(t.T,e).toJson(n)}}function Cp(t,e,n){var i;if(Ot(typeof e=="number"),t.typeName=="google.protobuf.NullValue")return null;if(n)return e;const a=t.findNumber(e);return(i=a?.name)!==null&&i!==void 0?i:e}function $d(t,e){switch(t){case ue.INT32:case ue.SFIXED32:case ue.SINT32:case ue.FIXED32:case ue.UINT32:return Ot(typeof e=="number"),e;case ue.FLOAT:case ue.DOUBLE:return Ot(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case ue.STRING:return Ot(typeof e=="string"),e;case ue.BOOL:return Ot(typeof e=="boolean"),e;case ue.UINT64:case ue.FIXED64:case ue.INT64:case ue.SFIXED64:case ue.SINT64:return Ot(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case ue.BYTES:return Ot(e instanceof Uint8Array),i_.enc(e)}}const Eo=Symbol("@bufbuild/protobuf/unknown-fields"),eE={readUnknownFields:!0,readerFactory:t=>new nM(t)},tE={writeUnknownFields:!0,writerFactory:()=>new tM};function hM(t){return t?Object.assign(Object.assign({},eE),t):eE}function mM(t){return t?Object.assign(Object.assign({},tE),t):tE}function pM(){return{makeReadOptions:hM,makeWriteOptions:mM,listUnknownFields(t){var e;return(e=t[Eo])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Eo]},writeUnknownFields(t,e){const i=t[Eo];if(i)for(const a of i)e.tag(a.no,a.wireType).raw(a.data)},onUnknownField(t,e,n,i){const a=t;Array.isArray(a[Eo])||(a[Eo]=[]),a[Eo].push({no:e,wireType:n,data:i})},readMessage(t,e,n,i,a){const o=t.getType(),c=a?e.len:e.pos+n;let u,d;for(;e.pos<c&&([u,d]=e.tag(),!(a===!0&&d==Lt.EndGroup));){const h=o.fields.find(u);if(!h){const m=e.skip(d,u);i.readUnknownFields&&this.onUnknownField(t,u,d,m);continue}nE(t,e,h,d,i)}if(a&&(d!=Lt.EndGroup||u!==n))throw new Error("invalid end group tag")},readField:nE,writeMessage(t,e,n){const i=t.getType();for(const a of i.fields.byNumber()){if(!s_(a,t)){if(a.req)throw new Error("cannot encode field ".concat(i.typeName,".").concat(a.name," to binary: required field not set"));continue}const o=a.oneof?t[a.oneof.localName].value:t[a.localName];iE(a,o,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e},writeField(t,e,n,i){e!==void 0&&iE(t,e,n,i)}}}function nE(t,e,n,i,a){let{repeated:o,localName:c}=n;switch(n.oneof&&(t=t[n.oneof.localName],t.case!=c&&delete t.value,t.case=c,c="value"),n.kind){case"scalar":case"enum":const u=n.kind=="enum"?ue.INT32:n.T;let d=uf;if(n.kind=="scalar"&&n.L>0&&(d=vM),o){let y=t[c];if(i==Lt.LengthDelimited&&u!=ue.STRING&&u!=ue.BYTES){let k=e.uint32()+e.pos;for(;e.pos<k;)y.push(d(e,u))}else y.push(d(e,u))}else t[c]=d(e,u);break;case"message":const h=n.T;o?t[c].push(Gd(e,new h,a,n)):Mr(t[c])?Gd(e,t[c],a,n):(t[c]=Gd(e,new h,a,n),h.fieldWrapper&&!n.oneof&&!n.repeated&&(t[c]=h.fieldWrapper.unwrapField(t[c])));break;case"map":let[m,v]=gM(n,e,a);t[c][m]=v;break}}function Gd(t,e,n,i){const a=e.getType().runtime.bin,o=i?.delimited;return a.readMessage(e,t,o?i.no:t.uint32(),n,o),e}function gM(t,e,n){const i=e.uint32(),a=e.pos+i;let o,c;for(;e.pos<a;){const[u]=e.tag();switch(u){case 1:o=uf(e,t.K);break;case 2:switch(t.V.kind){case"scalar":c=uf(e,t.V.T);break;case"enum":c=e.int32();break;case"message":c=Gd(e,new t.V.T,n,void 0);break}break}}if(o===void 0&&(o=$o(t.K,Ma.BIGINT)),typeof o!="string"&&typeof o!="number"&&(o=o.toString()),c===void 0)switch(t.V.kind){case"scalar":c=$o(t.V.T,Ma.BIGINT);break;case"enum":c=t.V.T.values[0].no;break;case"message":c=new t.V.T;break}return[o,c]}function vM(t,e){const n=uf(t,e);return typeof n=="bigint"?n.toString():n}function uf(t,e){switch(e){case ue.STRING:return t.string();case ue.BOOL:return t.bool();case ue.DOUBLE:return t.double();case ue.FLOAT:return t.float();case ue.INT32:return t.int32();case ue.INT64:return t.int64();case ue.UINT64:return t.uint64();case ue.FIXED64:return t.fixed64();case ue.BYTES:return t.bytes();case ue.FIXED32:return t.fixed32();case ue.SFIXED32:return t.sfixed32();case ue.SFIXED64:return t.sfixed64();case ue.SINT64:return t.sint64();case ue.UINT32:return t.uint32();case ue.SINT32:return t.sint32()}}function iE(t,e,n,i){Ot(e!==void 0);const a=t.repeated;switch(t.kind){case"scalar":case"enum":let o=t.kind=="enum"?ue.INT32:t.T;if(a)if(Ot(Array.isArray(e)),t.packed)yM(n,o,t.no,e);else for(const c of e)Oc(n,o,t.no,c);else Oc(n,o,t.no,e);break;case"message":if(a){Ot(Array.isArray(e));for(const c of e)rE(n,i,t,c)}else rE(n,i,t,e);break;case"map":Ot(typeof e=="object"&&e!=null);for(const[c,u]of Object.entries(e))bM(n,i,t,c,u);break}}function bM(t,e,n,i,a){t.tag(n.no,Lt.LengthDelimited),t.fork();let o=i;switch(n.K){case ue.INT32:case ue.FIXED32:case ue.UINT32:case ue.SFIXED32:case ue.SINT32:o=Number.parseInt(i);break;case ue.BOOL:Ot(i=="true"||i=="false"),o=i=="true";break}switch(Oc(t,n.K,1,o),n.V.kind){case"scalar":Oc(t,n.V.T,2,a);break;case"enum":Oc(t,ue.INT32,2,a);break;case"message":Ot(a!==void 0),t.tag(2,Lt.LengthDelimited).bytes(a.toBinary(e));break}t.join()}function rE(t,e,n,i){const a=o_(n.T,i);n.delimited?t.tag(n.no,Lt.StartGroup).raw(a.toBinary(e)).tag(n.no,Lt.EndGroup):t.tag(n.no,Lt.LengthDelimited).bytes(a.toBinary(e))}function Oc(t,e,n,i){Ot(i!==void 0);let[a,o]=l_(e);t.tag(n,a)[o](i)}function yM(t,e,n,i){if(!i.length)return;t.tag(n,Lt.LengthDelimited).fork();let[,a]=l_(e);for(let o=0;o<i.length;o++)t[a](i[o]);t.join()}function l_(t){let e=Lt.Varint;switch(t){case ue.BYTES:case ue.STRING:e=Lt.LengthDelimited;break;case ue.DOUBLE:case ue.FIXED64:case ue.SFIXED64:e=Lt.Bit64;break;case ue.FIXED32:case ue.SFIXED32:case ue.FLOAT:e=Lt.Bit32;break}const n=ue[t].toLowerCase();return[e,n]}function SM(){return{setEnumType:Wk,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const i of n.fields.byMember()){const a=i.localName,o=e,c=t;if(c[a]!=null)switch(i.kind){case"oneof":const u=c[a].case;if(u===void 0)continue;const d=i.findField(u);let h=c[a].value;d&&d.kind=="message"&&!Mr(h,d.T)?h=new d.T(h):d&&d.kind==="scalar"&&d.T===ue.BYTES&&(h=mc(h)),o[a]={case:u,value:h};break;case"scalar":case"enum":let m=c[a];i.T===ue.BYTES&&(m=i.repeated?m.map(mc):mc(m)),o[a]=m;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===ue.BYTES)for(const[T,k]of Object.entries(c[a]))o[a][T]=mc(k);else Object.assign(o[a],c[a]);break;case"message":const y=i.V.T;for(const T of Object.keys(c[a])){let k=c[a][T];y.fieldWrapper||(k=new y(k)),o[a][T]=k}break}break;case"message":const v=i.T;if(i.repeated)o[a]=c[a].map(y=>Mr(y,v)?y:new v(y));else{const y=c[a];v.fieldWrapper?v.typeName==="google.protobuf.BytesValue"?o[a]=mc(y):o[a]=y:o[a]=Mr(y,v)?y:new v(y)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(i=>{const a=e[i.localName],o=n[i.localName];if(i.repeated){if(a.length!==o.length)return!1;switch(i.kind){case"message":return a.every((c,u)=>i.T.equals(c,o[u]));case"scalar":return a.every((c,u)=>ba(i.T,c,o[u]));case"enum":return a.every((c,u)=>ba(ue.INT32,c,o[u]))}throw new Error("repeated cannot contain ".concat(i.kind))}switch(i.kind){case"message":let c=a,u=o;return i.T.fieldWrapper&&(c!==void 0&&!Mr(c)&&(c=i.T.fieldWrapper.wrapField(c)),u!==void 0&&!Mr(u)&&(u=i.T.fieldWrapper.wrapField(u))),i.T.equals(c,u);case"enum":return ba(ue.INT32,a,o);case"scalar":return ba(i.T,a,o);case"oneof":if(a.case!==o.case)return!1;const d=i.findField(a.case);if(d===void 0)return!0;switch(d.kind){case"message":return d.T.equals(a.value,o.value);case"enum":return ba(ue.INT32,a.value,o.value);case"scalar":return ba(d.T,a.value,o.value)}throw new Error("oneof cannot contain ".concat(d.kind));case"map":const h=Object.keys(a).concat(Object.keys(o));switch(i.V.kind){case"message":const m=i.V.T;return h.every(y=>m.equals(a[y],o[y]));case"enum":return h.every(y=>ba(ue.INT32,a[y],o[y]));case"scalar":const v=i.V.T;return h.every(y=>ba(v,a[y],o[y]))}break}})},clone(t){const e=t.getType(),n=new e,i=n;for(const a of e.fields.byMember()){const o=t[a.localName];let c;if(a.repeated)c=o.map(Cd);else if(a.kind=="map"){c=i[a.localName];for(const[u,d]of Object.entries(o))c[u]=Cd(d)}else a.kind=="oneof"?c=a.findField(o.case)?{case:o.case,value:Cd(o.value)}:{case:void 0}:c=Cd(o);i[a.localName]=c}for(const a of e.runtime.bin.listUnknownFields(t))e.runtime.bin.onUnknownField(i,a.no,a.wireType,a.data);return n}}}function Cd(t){if(t===void 0)return t;if(Mr(t))return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function mc(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function TM(t,e,n){return{syntax:t,json:uM(),bin:pM(),util:Object.assign(Object.assign({},SM()),{newFieldList:e,initFields:n}),makeMessageType(i,a,o){return QD(this,i,a,o)},makeEnum:KD,makeEnumType:Xk,getEnumType:YD,makeExtension(i,a,o){return iM(this,i,a,o)}}}class EM{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const i of this.list())n[i.jsonName]=n[i.name]=i;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const i of this.list())n[i.no]=i;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const i of this.list())i.oneof?i.oneof!==n&&(n=i.oneof,e.push(n)):e.push(i)}return this.members}}function c_(t,e){const n=u_(t);return e?n:RM(xM(n))}function CM(t){return c_(t,!1)}const kM=u_;function u_(t){let e=!1;const n=[];for(let i=0;i<t.length;i++){let a=t.charAt(i);switch(a){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(a),e=!1;break;default:e&&(e=!1,a=a.toUpperCase()),n.push(a);break}}return n.join("")}const _M=new Set(["constructor","toString","toJSON","valueOf"]),wM=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),d_=t=>"".concat(t,"$"),xM=t=>wM.has(t)?d_(t):t,RM=t=>_M.has(t)?d_(t):t;class AM{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=CM(e)}addField(e){Ot(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}function OM(t,e){var n,i,a,o,c,u;const d=[];let h;for(const m of typeof t=="function"?t():t){const v=m;if(v.localName=c_(m.name,m.oneof!==void 0),v.jsonName=(n=m.jsonName)!==null&&n!==void 0?n:kM(m.name),v.repeated=(i=m.repeated)!==null&&i!==void 0?i:!1,m.kind=="scalar"&&(v.L=(a=m.L)!==null&&a!==void 0?a:Ma.BIGINT),v.delimited=(o=m.delimited)!==null&&o!==void 0?o:!1,v.req=(c=m.req)!==null&&c!==void 0?c:!1,v.opt=(u=m.opt)!==null&&u!==void 0?u:!1,m.packed===void 0&&(v.packed=m.kind=="enum"||m.kind=="scalar"&&m.T!=ue.BYTES&&m.T!=ue.STRING),m.oneof!==void 0){const y=typeof m.oneof=="string"?m.oneof:m.oneof.name;(!h||h.name!=y)&&(h=new AM(y)),v.oneof=h,h.addField(v)}d.push(v)}return d}const Z=TM("proto3",t=>new EM(t,e=>OM(e)),t=>{for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,i=t;if(e.repeated){i[n]=[];continue}switch(e.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=$o(e.T,e.L);break}}});class Cn extends Nv{constructor(e){super(),this.seconds=Ct.zero,this.nanos=0,Z.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(Z.json.debug(e)));const i=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!i)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const a=Date.parse(i[1]+"-"+i[2]+"-"+i[3]+"T"+i[4]+":"+i[5]+":"+i[6]+(i[8]?i[8]:"Z"));if(Number.isNaN(a))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(a<Date.parse("0001-01-01T00:00:00Z")||a>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ct.parse(a/1e3),this.nanos=0,i[7]&&(this.nanos=parseInt("1"+i[7]+"0".repeat(9-i[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let i="Z";if(this.nanos>0){const a=(this.nanos+1e9).toString().substring(1);a.substring(3)==="000000"?i="."+a.substring(0,3)+"Z":a.substring(6)==="000"?i="."+a.substring(0,6)+"Z":i="."+a+"Z"}return new Date(n).toISOString().replace(".000Z",i)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Cn.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new Cn({seconds:Ct.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new Cn().fromBinary(e,n)}static fromJson(e,n){return new Cn().fromJson(e,n)}static fromJsonString(e,n){return new Cn().fromJsonString(e,n)}static equals(e,n){return Z.util.equals(Cn,e,n)}}Cn.runtime=Z;Cn.typeName="google.protobuf.Timestamp";Cn.fields=Z.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const NM=Z.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Cn},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:DM,repeated:!0},{no:5,name:"events",kind:"message",T:PM,repeated:!0}]),DM=Z.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:MM,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),MM=Z.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Cn},{no:3,name:"value",kind:"scalar",T:2}]),PM=Z.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Cn},{no:7,name:"normalized_end_timestamp",kind:"message",T:Cn,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),f_=Z.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),ki=Z.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),Bt=Z.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),Mv=Z.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),xc=Z.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Uc=Z.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Ri=Z.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),Co=Z.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),LM=Z.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Zt=Z.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),If=Z.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:df,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:__}]),df=Z.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),IM=Z.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:Z.getEnumType(Bt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Cs=Z.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Z.getEnumType(jo)},{no:4,name:"tracks",kind:"message",T:Mo,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:IM},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:Z.getEnumType(Bc)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:Z.getEnumType(Ri)},{no:18,name:"kind_details",kind:"enum",T:Z.getEnumType(jM),repeated:!0}]),jo=Z.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Bc=Z.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),jM=Z.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),Fn=Z.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),UM=Z.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ys,repeated:!0}]),Mo=Z.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:Z.getEnumType(ki)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:Z.getEnumType(Bt)},{no:10,name:"layers",kind:"message",T:ys,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:UM,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:Z.getEnumType(Fn)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:__},{no:19,name:"audio_features",kind:"enum",T:Z.getEnumType(Zt),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:Z.getEnumType(f_)}]),ys=Z.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:Z.getEnumType(Mv)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),kn=Z.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:Z.getEnumType(Ge)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:m_,oneof:"value"},{no:3,name:"speaker",kind:"message",T:BM,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:p_,oneof:"value"},{no:7,name:"transcription",kind:"message",T:zM,oneof:"value"},{no:8,name:"metrics",kind:"message",T:NM,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Eg,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:g_,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:v_,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:b_,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:kg,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:_g,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:wg,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),Ge=Z.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),BM=Z.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:h_,repeated:!0}]),h_=Z.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),m_=Z.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),p_=Z.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),zM=Z.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:VM,repeated:!0}]),VM=Z.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Eg=Z.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),g_=Z.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),v_=Z.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),b_=Z.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:y_,oneof:"value"}]),y_=Z.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),S_=Z.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),T_=Z.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:Z.getEnumType(E_)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),E_=Z.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),HM=Z.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:Z.getEnumType(C_)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),C_=Z.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),k_=Z.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:aE},{no:2,name:"screen",kind:"message",T:aE},{no:3,name:"resume_connection",kind:"enum",T:Z.getEnumType(Uc)},{no:4,name:"disabled_codecs",kind:"message",T:FM},{no:5,name:"force_relay",kind:"enum",T:Z.getEnumType(Uc)}]),aE=Z.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:Z.getEnumType(Uc)}]),FM=Z.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:df,repeated:!0},{no:2,name:"publish",kind:"message",T:df,repeated:!0}]),__=Z.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),Cg=Z.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),w_=Z.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:Z.getEnumType(Cg)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),x_=Z.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),kg=Z.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:Z.getEnumType(Fn)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:w_,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:x_,oneof:"content_header"}],{localName:"DataStream_Header"}),_g=Z.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),wg=Z.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),_i=Z.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),xg=Z.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),qM=Z.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),$M=Z.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:ks,oneof:"message"},{no:2,name:"answer",kind:"message",T:ks,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Pv,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Ag,oneof:"message"},{no:5,name:"mute",kind:"message",T:Lv,oneof:"message"},{no:6,name:"subscription",kind:"message",T:jf,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:R_,oneof:"message"},{no:8,name:"leave",kind:"message",T:Uf,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:O_,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:P_,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:L_,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Qi,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:N_,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:U_,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:A_,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:WM,oneof:"message"}]),sE=Z.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:GM,oneof:"message"},{no:2,name:"answer",kind:"message",T:ks,oneof:"message"},{no:3,name:"offer",kind:"message",T:ks,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Pv,oneof:"message"},{no:5,name:"update",kind:"message",T:QM,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Iv,oneof:"message"},{no:8,name:"leave",kind:"message",T:Uf,oneof:"message"},{no:9,name:"mute",kind:"message",T:Lv,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:XM,oneof:"message"},{no:11,name:"room_update",kind:"message",T:ZM,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:eP,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:nP,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:rP,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:aP,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:KM,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:YM,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:oP,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:uP,oneof:"message"},{no:22,name:"request_response",kind:"message",T:dP,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:fP,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:sP,oneof:"message"}]),Rg=Z.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),Ag=Z.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:Z.getEnumType(ki)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:Z.getEnumType(Bt)},{no:9,name:"layers",kind:"message",T:ys,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Rg,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:Z.getEnumType(Fn)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:Z.getEnumType(f_)},{no:17,name:"audio_features",kind:"enum",T:Z.getEnumType(Zt),repeated:!0}]),Pv=Z.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:Z.getEnumType(_i)},{no:3,name:"final",kind:"scalar",T:8}]),Lv=Z.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),GM=Z.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:If},{no:2,name:"participant",kind:"message",T:Cs},{no:3,name:"other_participants",kind:"message",T:Cs,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:D_,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:k_},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:T_},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:df,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),YM=Z.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:D_,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:k_},{no:3,name:"server_info",kind:"message",T:T_},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),Iv=Z.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Mo}]),KM=Z.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),ks=Z.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13}]),QM=Z.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Cs,repeated:!0}]),jf=Z.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:S_,repeated:!0}]),R_=Z.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:Z.getEnumType(Mv)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),A_=Z.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:Z.getEnumType(Zt),repeated:!0}]),WM=Z.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Uf=Z.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:Z.getEnumType(Ri)},{no:3,name:"action",kind:"enum",T:Z.getEnumType(Uo)},{no:4,name:"regions",kind:"message",T:lP}]),Uo=Z.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),O_=Z.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:ys,repeated:!0}]),N_=Z.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),D_=Z.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),XM=Z.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:h_,repeated:!0}]),ZM=Z.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:If}]),JM=Z.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:Z.getEnumType(xc)},{no:3,name:"score",kind:"scalar",T:2}]),eP=Z.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:JM,repeated:!0}]),tP=Z.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Z.getEnumType(xg)}]),nP=Z.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:tP,repeated:!0}]),jv=Z.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:Z.getEnumType(Mv)},{no:2,name:"enabled",kind:"scalar",T:8}]),iP=Z.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:jv,repeated:!0}]),rP=Z.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:jv,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:iP,repeated:!0}]),M_=Z.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),P_=Z.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:M_,repeated:!0}]),aP=Z.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),sP=Z.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:If},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Cs},{no:4,name:"other_participants",kind:"message",T:Cs,repeated:!0}]),L_=Z.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:ks},{no:2,name:"subscription",kind:"message",T:jf},{no:3,name:"publish_tracks",kind:"message",T:Iv,repeated:!0},{no:4,name:"data_channels",kind:"message",T:j_,repeated:!0},{no:5,name:"offer",kind:"message",T:ks},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:I_,repeated:!0}]),I_=Z.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),j_=Z.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:Z.getEnumType(_i)}]),Qi=Z.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:Z.getEnumType(qM),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),U_=Z.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),oP=Z.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),lP=Z.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:cP,repeated:!0}]),cP=Z.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),uP=Z.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:Z.getEnumType(LM)}]),dP=Z.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:Z.getEnumType(Uv)},{no:3,name:"message",kind:"scalar",T:9}]),Uv=Z.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),fP=Z.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function hP(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Yd={exports:{}},mP=Yd.exports,oE;function pP(){return oE||(oE=1,function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(mP,function(){var e=function(){},n="undefined",i=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),a=["trace","debug","info","warn","error"],o={},c=null;function u(E,x){var _=E[x];if(typeof _.bind=="function")return _.bind(E);try{return Function.prototype.bind.call(_,E)}catch{return function(){return Function.prototype.apply.apply(_,[E,arguments])}}}function d(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function h(E){return E==="debug"&&(E="log"),typeof console===n?!1:E==="trace"&&i?d:console[E]!==void 0?u(console,E):console.log!==void 0?u(console,"log"):e}function m(){for(var E=this.getLevel(),x=0;x<a.length;x++){var _=a[x];this[_]=x<E?e:this.methodFactory(_,E,this.name)}if(this.log=this.debug,typeof console===n&&E<this.levels.SILENT)return"No console available for logging"}function v(E){return function(){typeof console!==n&&(m.call(this),this[E].apply(this,arguments))}}function y(E,x,_){return h(E)||v.apply(this,arguments)}function T(E,x){var _=this,N,P,O,A="loglevel";typeof E=="string"?A+=":"+E:typeof E=="symbol"&&(A=void 0);function w(Y){var re=(a[Y]||"silent").toUpperCase();if(!(typeof window===n||!A)){try{window.localStorage[A]=re;return}catch{}try{window.document.cookie=encodeURIComponent(A)+"="+re+";"}catch{}}}function V(){var Y;if(!(typeof window===n||!A)){try{Y=window.localStorage[A]}catch{}if(typeof Y===n)try{var re=window.document.cookie,de=encodeURIComponent(A),be=re.indexOf(de+"=");be!==-1&&(Y=/^([^;]+)/.exec(re.slice(be+de.length+1))[1])}catch{}return _.levels[Y]===void 0&&(Y=void 0),Y}}function M(){if(!(typeof window===n||!A)){try{window.localStorage.removeItem(A)}catch{}try{window.document.cookie=encodeURIComponent(A)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function D(Y){var re=Y;if(typeof re=="string"&&_.levels[re.toUpperCase()]!==void 0&&(re=_.levels[re.toUpperCase()]),typeof re=="number"&&re>=0&&re<=_.levels.SILENT)return re;throw new TypeError("log.setLevel() called with invalid level: "+Y)}_.name=E,_.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},_.methodFactory=x||y,_.getLevel=function(){return O??P??N},_.setLevel=function(Y,re){return O=D(Y),re!==!1&&w(O),m.call(_)},_.setDefaultLevel=function(Y){P=D(Y),V()||_.setLevel(Y,!1)},_.resetLevel=function(){O=null,M(),m.call(_)},_.enableAll=function(Y){_.setLevel(_.levels.TRACE,Y)},_.disableAll=function(Y){_.setLevel(_.levels.SILENT,Y)},_.rebuild=function(){if(c!==_&&(N=D(c.getLevel())),m.call(_),c===_)for(var Y in o)o[Y].rebuild()},N=D(c?c.getLevel():"WARN");var B=V();B!=null&&(O=D(B)),m.call(_)}c=new T,c.getLogger=function(x){if(typeof x!="symbol"&&typeof x!="string"||x==="")throw new TypeError("You must supply a name when creating a logger.");var _=o[x];return _||(_=o[x]=new T(x,c.methodFactory)),_};var k=typeof window!==n?window.log:void 0;return c.noConflict=function(){return typeof window!==n&&window.log===c&&(window.log=k),c},c.getLoggers=function(){return o},c.default=c,c})}(Yd)),Yd.exports}var Bf=pP(),Og;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(Og||(Og={}));var Ai;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(Ai||(Ai={}));let Qe=Bf.getLogger("livekit");Object.values(Ai).map(t=>Bf.getLogger(t));Qe.setDefaultLevel(Og.info);function Ur(t){const e=Bf.getLogger(t);return e.setDefaultLevel(Qe.getLevel()),e}const gP=Bf.getLogger("lk-e2ee"),pc=7e3,vP=[0,300,4*300,9*300,16*300,pc,pc,pc,pc,pc];class bP{constructor(e){this._retryDelays=e!==void 0?[...e]:vP}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function yP(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(t);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(n[i[a]]=t[i[a]]);return n}function L(t,e,n,i){function a(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function u(m){try{h(i.next(m))}catch(v){c(v)}}function d(m){try{h(i.throw(m))}catch(v){c(v)}}function h(m){m.done?o(m.value):a(m.value).then(u,d)}h((i=i.apply(t,e||[])).next())})}function lE(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pr(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof lE=="function"?lE(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=t[o]&&function(c){return new Promise(function(u,d){c=t[o](c),a(u,d,c.done,c.value)})}}function a(o,c,u,d){Promise.resolve(d).then(function(h){o({value:h,done:u})},c)}}var kd={exports:{}},cE;function SP(){if(cE)return kd.exports;cE=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(A,w,V){return Function.prototype.apply.call(A,w,V)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:n=function(A){return Object.getOwnPropertyNames(A)};function i(O){console&&console.warn&&console.warn(O)}var a=Number.isNaN||function(A){return A!==A};function o(){o.init.call(this)}kd.exports=o,kd.exports.once=_,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var c=10;function u(O){if(typeof O!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof O)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(O){if(typeof O!="number"||O<0||a(O))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+O+".");c=O}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(A){if(typeof A!="number"||A<0||a(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this};function d(O){return O._maxListeners===void 0?o.defaultMaxListeners:O._maxListeners}o.prototype.getMaxListeners=function(){return d(this)},o.prototype.emit=function(A){for(var w=[],V=1;V<arguments.length;V++)w.push(arguments[V]);var M=A==="error",D=this._events;if(D!==void 0)M=M&&D.error===void 0;else if(!M)return!1;if(M){var B;if(w.length>0&&(B=w[0]),B instanceof Error)throw B;var Y=new Error("Unhandled error."+(B?" ("+B.message+")":""));throw Y.context=B,Y}var re=D[A];if(re===void 0)return!1;if(typeof re=="function")e(re,this,w);else for(var de=re.length,be=k(re,de),V=0;V<de;++V)e(be[V],this,w);return!0};function h(O,A,w,V){var M,D,B;if(u(w),D=O._events,D===void 0?(D=O._events=Object.create(null),O._eventsCount=0):(D.newListener!==void 0&&(O.emit("newListener",A,w.listener?w.listener:w),D=O._events),B=D[A]),B===void 0)B=D[A]=w,++O._eventsCount;else if(typeof B=="function"?B=D[A]=V?[w,B]:[B,w]:V?B.unshift(w):B.push(w),M=d(O),M>0&&B.length>M&&!B.warned){B.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+B.length+" "+String(A)+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=O,Y.type=A,Y.count=B.length,i(Y)}return O}o.prototype.addListener=function(A,w){return h(this,A,w,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(A,w){return h(this,A,w,!0)};function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(O,A,w){var V={fired:!1,wrapFn:void 0,target:O,type:A,listener:w},M=m.bind(V);return M.listener=w,V.wrapFn=M,M}o.prototype.once=function(A,w){return u(w),this.on(A,v(this,A,w)),this},o.prototype.prependOnceListener=function(A,w){return u(w),this.prependListener(A,v(this,A,w)),this},o.prototype.removeListener=function(A,w){var V,M,D,B,Y;if(u(w),M=this._events,M===void 0)return this;if(V=M[A],V===void 0)return this;if(V===w||V.listener===w)--this._eventsCount===0?this._events=Object.create(null):(delete M[A],M.removeListener&&this.emit("removeListener",A,V.listener||w));else if(typeof V!="function"){for(D=-1,B=V.length-1;B>=0;B--)if(V[B]===w||V[B].listener===w){Y=V[B].listener,D=B;break}if(D<0)return this;D===0?V.shift():E(V,D),V.length===1&&(M[A]=V[0]),M.removeListener!==void 0&&this.emit("removeListener",A,Y||w)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(A){var w,V,M;if(V=this._events,V===void 0)return this;if(V.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):V[A]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete V[A]),this;if(arguments.length===0){var D=Object.keys(V),B;for(M=0;M<D.length;++M)B=D[M],B!=="removeListener"&&this.removeAllListeners(B);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(w=V[A],typeof w=="function")this.removeListener(A,w);else if(w!==void 0)for(M=w.length-1;M>=0;M--)this.removeListener(A,w[M]);return this};function y(O,A,w){var V=O._events;if(V===void 0)return[];var M=V[A];return M===void 0?[]:typeof M=="function"?w?[M.listener||M]:[M]:w?x(M):k(M,M.length)}o.prototype.listeners=function(A){return y(this,A,!0)},o.prototype.rawListeners=function(A){return y(this,A,!1)},o.listenerCount=function(O,A){return typeof O.listenerCount=="function"?O.listenerCount(A):T.call(O,A)},o.prototype.listenerCount=T;function T(O){var A=this._events;if(A!==void 0){var w=A[O];if(typeof w=="function")return 1;if(w!==void 0)return w.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function k(O,A){for(var w=new Array(A),V=0;V<A;++V)w[V]=O[V];return w}function E(O,A){for(;A+1<O.length;A++)O[A]=O[A+1];O.pop()}function x(O){for(var A=new Array(O.length),w=0;w<A.length;++w)A[w]=O[w].listener||O[w];return A}function _(O,A){return new Promise(function(w,V){function M(B){O.removeListener(A,D),V(B)}function D(){typeof O.removeListener=="function"&&O.removeListener("error",M),w([].slice.call(arguments))}P(O,A,D,{once:!0}),A!=="error"&&N(O,M,{once:!0})})}function N(O,A,w){typeof O.on=="function"&&P(O,"error",A,w)}function P(O,A,w,V){if(typeof O.on=="function")V.once?O.once(A,w):O.on(A,w);else if(typeof O.addEventListener=="function")O.addEventListener(A,function M(D){V.once&&O.removeEventListener(A,M),w(D)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof O)}return kd.exports}var or=SP();let B_=!0,z_=!0;function Rc(t,e,n){const i=t.match(e);return i&&i.length>=n&&parseFloat(i[n],10)}function Ps(t,e,n){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,a=i.addEventListener;i.addEventListener=function(c,u){if(c!==e)return a.apply(this,arguments);const d=h=>{const m=n(h);m&&(u.handleEvent?u.handleEvent(m):u(m))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(u,d),a.apply(this,[c,d])};const o=i.removeEventListener;i.removeEventListener=function(c,u){if(c!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(u))return o.apply(this,arguments);const d=this._eventMap[e].get(u);return this._eventMap[e].delete(u),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[c,d])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(c){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),c&&this.addEventListener(e,this["_on"+e]=c)},enumerable:!0,configurable:!0})}function TP(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(B_=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function EP(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(z_=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function V_(){if(typeof window=="object"){if(B_)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Bv(t,e){z_&&console.warn(t+" is deprecated, please use "+e+" instead.")}function CP(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const i=n.userAgentData.brands.find(a=>a.brand==="Chromium");if(i)return{browser:"chrome",version:parseInt(i.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Rc(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Rc(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Rc(n.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype,e._safariVersion=Rc(n.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function uE(t){return Object.prototype.toString.call(t)==="[object Object]"}function H_(t){return uE(t)?Object.keys(t).reduce(function(e,n){const i=uE(t[n]),a=i?H_(t[n]):t[n],o=i&&!Object.keys(a).length;return a===void 0||o?e:Object.assign(e,{[n]:a})},{}):t}function Ng(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?Ng(t,t.get(e[i]),n):i.endsWith("Ids")&&e[i].forEach(a=>{Ng(t,t.get(a),n)})}))}function dE(t,e,n){const i=n?"outbound-rtp":"inbound-rtp",a=new Map;if(e===null)return a;const o=[];return t.forEach(c=>{c.type==="track"&&c.trackIdentifier===e.id&&o.push(c)}),o.forEach(c=>{t.forEach(u=>{u.type===i&&u.trackId===c.id&&Ng(t,u,a)})}),a}const fE=V_;function F_(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const i=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const d={};return Object.keys(u).forEach(h=>{if(h==="require"||h==="advanced"||h==="mediaSource")return;const m=typeof u[h]=="object"?u[h]:{ideal:u[h]};m.exact!==void 0&&typeof m.exact=="number"&&(m.min=m.max=m.exact);const v=function(y,T){return y?y+T.charAt(0).toUpperCase()+T.slice(1):T==="deviceId"?"sourceId":T};if(m.ideal!==void 0){d.optional=d.optional||[];let y={};typeof m.ideal=="number"?(y[v("min",h)]=m.ideal,d.optional.push(y),y={},y[v("max",h)]=m.ideal,d.optional.push(y)):(y[v("",h)]=m.ideal,d.optional.push(y))}m.exact!==void 0&&typeof m.exact!="number"?(d.mandatory=d.mandatory||{},d.mandatory[v("",h)]=m.exact):["min","max"].forEach(y=>{m[y]!==void 0&&(d.mandatory=d.mandatory||{},d.mandatory[v(y,h)]=m[y])})}),u.advanced&&(d.optional=(d.optional||[]).concat(u.advanced)),d},a=function(u,d){if(e.version>=61)return d(u);if(u=JSON.parse(JSON.stringify(u)),u&&typeof u.audio=="object"){const h=function(m,v,y){v in m&&!(y in m)&&(m[y]=m[v],delete m[v])};u=JSON.parse(JSON.stringify(u)),h(u.audio,"autoGainControl","googAutoGainControl"),h(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=i(u.audio)}if(u&&typeof u.video=="object"){let h=u.video.facingMode;h=h&&(typeof h=="object"?h:{ideal:h});const m=e.version<66;if(h&&(h.exact==="user"||h.exact==="environment"||h.ideal==="user"||h.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!m)){delete u.video.facingMode;let v;if(h.exact==="environment"||h.ideal==="environment"?v=["back","rear"]:(h.exact==="user"||h.ideal==="user")&&(v=["front"]),v)return n.mediaDevices.enumerateDevices().then(y=>{y=y.filter(k=>k.kind==="videoinput");let T=y.find(k=>v.some(E=>k.label.toLowerCase().includes(E)));return!T&&y.length&&v.includes("back")&&(T=y[y.length-1]),T&&(u.video.deviceId=h.exact?{exact:T.deviceId}:{ideal:T.deviceId}),u.video=i(u.video),fE("chrome: "+JSON.stringify(u)),d(u)})}u.video=i(u.video)}return fE("chrome: "+JSON.stringify(u)),d(u)},o=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},c=function(u,d,h){a(u,m=>{n.webkitGetUserMedia(m,d,v=>{h&&h(o(v))})})};if(n.getUserMedia=c.bind(n),n.mediaDevices.getUserMedia){const u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(d){return a(d,h=>u(h).then(m=>{if(h.audio&&!m.getAudioTracks().length||h.video&&!m.getVideoTracks().length)throw m.getTracks().forEach(v=>{v.stop()}),new DOMException("","NotFoundError");return m},m=>Promise.reject(o(m))))}}}function q_(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function $_(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",a=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(u=>u.track&&u.track.id===a.track.id):o={track:a.track};const c=new Event("track");c.track=a.track,c.receiver=o,c.transceiver={receiver:o},c.streams=[i.stream],this.dispatchEvent(c)}),i.stream.getTracks().forEach(a=>{let o;t.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(u=>u.track&&u.track.id===a.id):o={track:a};const c=new Event("track");c.track=a,c.receiver=o,c.transceiver={receiver:o},c.streams=[i.stream],this.dispatchEvent(c)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Ps(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function G_(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(a,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=a.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:a}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const a=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(u,d){let h=a.apply(this,arguments);return h||(h=e(this,u),this._senders.push(h)),h};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(u){o.apply(this,arguments);const d=this._senders.indexOf(u);d!==-1&&this._senders.splice(d,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(c=>{this._senders.push(e(this,c))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],i.apply(this,[o]),o.getTracks().forEach(c=>{const u=this._senders.find(d=>d.track===c);u&&this._senders.splice(this._senders.indexOf(u),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(a=>a._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Y_(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=n.apply(this,[]);return o.forEach(c=>c._pc=this),o});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=i.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(c=>dE(c,o.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const a=n.apply(this,[]);return a.forEach(o=>o._pc=this),a}),Ps(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const a=this;return this._pc.getStats().then(o=>dE(o,a.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let a,o,c;return this.getSenders().forEach(u=>{u.track===i&&(a?c=!0:a=u)}),this.getReceivers().forEach(u=>(u.track===i&&(o?c=!0:o=u),u.track===i)),c||a&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function K_(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(c=>this._shimmedLocalStreams[c][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(c,u){if(!u)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const d=e.apply(this,arguments);return this._shimmedLocalStreams[u.id]?this._shimmedLocalStreams[u.id].indexOf(d)===-1&&this._shimmedLocalStreams[u.id].push(d):this._shimmedLocalStreams[u.id]=[u,d],d};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(c){this._shimmedLocalStreams=this._shimmedLocalStreams||{},c.getTracks().forEach(h=>{if(this.getSenders().find(v=>v.track===h))throw new DOMException("Track already exists.","InvalidAccessError")});const u=this.getSenders();n.apply(this,arguments);const d=this.getSenders().filter(h=>u.indexOf(h)===-1);this._shimmedLocalStreams[c.id]=[c].concat(d)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[c.id],i.apply(this,arguments)};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},c&&Object.keys(this._shimmedLocalStreams).forEach(u=>{const d=this._shimmedLocalStreams[u].indexOf(c);d!==-1&&this._shimmedLocalStreams[u].splice(d,1),this._shimmedLocalStreams[u].length===1&&delete this._shimmedLocalStreams[u]}),a.apply(this,arguments)}}function Q_(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return K_(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const m=n.apply(this);return this._reverseStreams=this._reverseStreams||{},m.map(v=>this._reverseStreams[v.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(m){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},m.getTracks().forEach(v=>{if(this.getSenders().find(T=>T.track===v))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[m.id]){const v=new t.MediaStream(m.getTracks());this._streams[m.id]=v,this._reverseStreams[v.id]=m,m=v}i.apply(this,[m])};const a=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(m){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[m.id]||m]),delete this._reverseStreams[this._streams[m.id]?this._streams[m.id].id:m.id],delete this._streams[m.id]},t.RTCPeerConnection.prototype.addTrack=function(m,v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const y=[].slice.call(arguments,1);if(y.length!==1||!y[0].getTracks().find(E=>E===m))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(E=>E.track===m))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const k=this._streams[v.id];if(k)k.addTrack(m),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const E=new t.MediaStream([m]);this._streams[v.id]=E,this._reverseStreams[E.id]=v,this.addStream(E)}return this.getSenders().find(E=>E.track===m)};function o(h,m){let v=m.sdp;return Object.keys(h._reverseStreams||[]).forEach(y=>{const T=h._reverseStreams[y],k=h._streams[T.id];v=v.replace(new RegExp(k.id,"g"),T.id)}),new RTCSessionDescription({type:m.type,sdp:v})}function c(h,m){let v=m.sdp;return Object.keys(h._reverseStreams||[]).forEach(y=>{const T=h._reverseStreams[y],k=h._streams[T.id];v=v.replace(new RegExp(T.id,"g"),k.id)}),new RTCSessionDescription({type:m.type,sdp:v})}["createOffer","createAnswer"].forEach(function(h){const m=t.RTCPeerConnection.prototype[h],v={[h](){const y=arguments;return arguments.length&&typeof arguments[0]=="function"?m.apply(this,[k=>{const E=o(this,k);y[0].apply(null,[E])},k=>{y[1]&&y[1].apply(null,k)},arguments[2]]):m.apply(this,arguments).then(k=>o(this,k))}};t.RTCPeerConnection.prototype[h]=v[h]});const u=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?u.apply(this,arguments):(arguments[0]=c(this,arguments[0]),u.apply(this,arguments))};const d=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const h=d.get.apply(this);return h.type===""?h:o(this,h)}}),t.RTCPeerConnection.prototype.removeTrack=function(m){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!m._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(m._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let y;Object.keys(this._streams).forEach(T=>{this._streams[T].getTracks().find(E=>m.track===E)&&(y=this._streams[T])}),y&&(y.getTracks().length===1?this.removeStream(this._reverseStreams[y.id]):y.removeTrack(m.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Dg(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=t.RTCPeerConnection.prototype[n],a={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=a[n]})}function W_(t,e){Ps(t,"negotiationneeded",n=>{const i=n.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return n})}var hE=Object.freeze({__proto__:null,fixNegotiationNeeded:W_,shimAddTrackRemoveTrack:Q_,shimAddTrackRemoveTrackWithNative:K_,shimGetSendersWithDtmf:G_,shimGetUserMedia:F_,shimMediaStream:q_,shimOnTrack:$_,shimPeerConnection:Dg,shimSenderReceiverGetStats:Y_});function X_(t,e){const n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(a,o,c){Bv("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(a).then(o,c)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const a=function(c,u,d){u in c&&!(d in c)&&(c[d]=c[u],delete c[u])},o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(c){return typeof c=="object"&&typeof c.audio=="object"&&(c=JSON.parse(JSON.stringify(c)),a(c.audio,"autoGainControl","mozAutoGainControl"),a(c.audio,"noiseSuppression","mozNoiseSuppression")),o(c)},i&&i.prototype.getSettings){const c=i.prototype.getSettings;i.prototype.getSettings=function(){const u=c.apply(this,arguments);return a(u,"mozAutoGainControl","autoGainControl"),a(u,"mozNoiseSuppression","noiseSuppression"),u}}if(i&&i.prototype.applyConstraints){const c=i.prototype.applyConstraints;i.prototype.applyConstraints=function(u){return this.kind==="audio"&&typeof u=="object"&&(u=JSON.parse(JSON.stringify(u)),a(u,"autoGainControl","mozAutoGainControl"),a(u,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[u])}}}}function kP(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,Promise.reject(a)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(i)})}function Z_(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Mg(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const o=t.RTCPeerConnection.prototype[a],c={[a](){return arguments[0]=new(a==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};t.RTCPeerConnection.prototype[a]=c[a]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[o,c,u]=arguments;return i.apply(this,[o||null]).then(d=>{if(e.version<53&&!c)try{d.forEach(h=>{h.type=n[h.type]||h.type})}catch(h){if(h.name!=="TypeError")throw h;d.forEach((m,v)=>{d.set(v,Object.assign({},m,{type:n[m.type]||m.type}))})}return d}).then(c,u)}}function J_(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const a=e.apply(this,[]);return a.forEach(o=>o._pc=this),a});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const a=n.apply(this,arguments);return a._pc=this,a}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function ew(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(a=>a._pc=this),i}),Ps(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function tw(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){Bv("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&n.getTracks().includes(i.track)&&this.removeTrack(i)})})}function nw(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function iw(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const a=i.length>0;a&&i.forEach(c=>{if("rid"in c&&!/^[a-z0-9]{0,16}$/i.test(c.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in c&&!(parseFloat(c.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in c&&!(parseFloat(c.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(a){const{sender:c}=o,u=c.getParameters();(!("encodings"in u)||u.encodings.length===1&&Object.keys(u.encodings[0]).length===0)&&(u.encodings=i,c.sendEncodings=i,this.setParametersPromises.push(c.setParameters(u).then(()=>{delete c.sendEncodings}).catch(()=>{delete c.sendEncodings})))}return o})}function rw(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function aw(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function sw(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var mE=Object.freeze({__proto__:null,shimAddTransceiver:iw,shimCreateAnswer:sw,shimCreateOffer:aw,shimGetDisplayMedia:kP,shimGetParameters:rw,shimGetUserMedia:X_,shimOnTrack:Z_,shimPeerConnection:Mg,shimRTCDataChannel:nw,shimReceiverGetStats:ew,shimRemoveStream:tw,shimSenderGetStats:J_});function ow(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(a=>e.call(this,a,i)),i.getVideoTracks().forEach(a=>e.call(this,a,i))},t.RTCPeerConnection.prototype.addTrack=function(i){for(var a=arguments.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=arguments[c];return o&&o.forEach(u=>{this._localStreams?this._localStreams.includes(u)||this._localStreams.push(u):this._localStreams=[u]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(n);if(i===-1)return;this._localStreams.splice(i,1);const a=n.getTracks();this.getSenders().forEach(o=>{a.includes(o.track)&&this.removeTrack(o)})})}}function lw(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(a=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(a))return;this._remoteStreams.push(a);const o=new Event("addstream");o.stream=a,this.dispatchEvent(o)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(o=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(o)>=0)return;i._remoteStreams.push(o);const c=new Event("addstream");c.stream=o,i.dispatchEvent(c)})}),e.apply(i,arguments)}}}function cw(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,i=e.createAnswer,a=e.setLocalDescription,o=e.setRemoteDescription,c=e.addIceCandidate;e.createOffer=function(h,m){const v=arguments.length>=2?arguments[2]:arguments[0],y=n.apply(this,[v]);return m?(y.then(h,m),Promise.resolve()):y},e.createAnswer=function(h,m){const v=arguments.length>=2?arguments[2]:arguments[0],y=i.apply(this,[v]);return m?(y.then(h,m),Promise.resolve()):y};let u=function(d,h,m){const v=a.apply(this,[d]);return m?(v.then(h,m),Promise.resolve()):v};e.setLocalDescription=u,u=function(d,h,m){const v=o.apply(this,[d]);return m?(v.then(h,m),Promise.resolve()):v},e.setRemoteDescription=u,u=function(d,h,m){const v=c.apply(this,[d]);return m?(v.then(h,m),Promise.resolve()):v},e.addIceCandidate=u}function uw(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,i=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=a=>i(dw(a))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,a,o){e.mediaDevices.getUserMedia(i).then(a,o)}).bind(e))}function dw(t){return t&&t.video!==void 0?Object.assign({},t,{video:H_(t.video)}):t}function fw(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(i,a){if(i&&i.iceServers){const o=[];for(let c=0;c<i.iceServers.length;c++){let u=i.iceServers[c];u.urls===void 0&&u.url?(Bv("RTCIceServer.url","RTCIceServer.urls"),u=JSON.parse(JSON.stringify(u)),u.urls=u.url,delete u.url,o.push(u)):o.push(i.iceServers[c])}i.iceServers=o}return new e(i,a)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function hw(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function mw(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const a=this.getTransceivers().find(c=>c.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):i.offerToReceiveAudio===!0&&!a&&this.addTransceiver("audio",{direction:"recvonly"}),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const o=this.getTransceivers().find(c=>c.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):i.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function pw(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var pE=Object.freeze({__proto__:null,shimAudioContext:pw,shimCallbacksAPI:cw,shimConstraints:dw,shimCreateOfferLegacy:mw,shimGetUserMedia:uw,shimLocalStreamsAPI:ow,shimRTCIceServerUrls:fw,shimRemoteStreamsAPI:lw,shimTrackEventTransceiver:hw}),kp={exports:{}},gE;function _P(){return gE||(gE=1,function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(i=>i.trim())},e.splitSections=function(n){return n.split(`
m=`).map((a,o)=>(o>0?"m="+a:a).trim()+`\r
`)},e.getDescription=function(n){const i=e.splitSections(n);return i&&i[0]},e.getMediaSections=function(n){const i=e.splitSections(n);return i.shift(),i},e.matchPrefix=function(n,i){return e.splitLines(n).filter(a=>a.indexOf(i)===0)},e.parseCandidate=function(n){let i;n.indexOf("a=candidate:")===0?i=n.substring(12).split(" "):i=n.substring(10).split(" ");const a={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let o=8;o<i.length;o+=2)switch(i[o]){case"raddr":a.relatedAddress=i[o+1];break;case"rport":a.relatedPort=parseInt(i[o+1],10);break;case"tcptype":a.tcpType=i[o+1];break;case"ufrag":a.ufrag=i[o+1],a.usernameFragment=i[o+1];break;default:a[i[o]]===void 0&&(a[i[o]]=i[o+1]);break}return a},e.writeCandidate=function(n){const i=[];i.push(n.foundation);const a=n.component;a==="rtp"?i.push(1):a==="rtcp"?i.push(2):i.push(a),i.push(n.protocol.toUpperCase()),i.push(n.priority),i.push(n.address||n.ip),i.push(n.port);const o=n.type;return i.push("typ"),i.push(o),o!=="host"&&n.relatedAddress&&n.relatedPort&&(i.push("raddr"),i.push(n.relatedAddress),i.push("rport"),i.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(i.push("ufrag"),i.push(n.usernameFragment||n.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let i=n.substring(9).split(" ");const a={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),a.name=i[0],a.clockRate=parseInt(i[1],10),a.channels=i.length===3?parseInt(i[2],10):1,a.numChannels=a.channels,a},e.writeRtpMap=function(n){let i=n.payloadType;n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType);const a=n.channels||n.numChannels||1;return"a=rtpmap:"+i+" "+n.name+"/"+n.clockRate+(a!==1?"/"+a:"")+`\r
`},e.parseExtmap=function(n){const i=n.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const i={};let a;const o=n.substring(n.indexOf(" ")+1).split(";");for(let c=0;c<o.length;c++)a=o[c].trim().split("="),i[a[0].trim()]=a[1];return i},e.writeFmtp=function(n){let i="",a=n.payloadType;if(n.preferredPayloadType!==void 0&&(a=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const o=[];Object.keys(n.parameters).forEach(c=>{n.parameters[c]!==void 0?o.push(c+"="+n.parameters[c]):o.push(c)}),i+="a=fmtp:"+a+" "+o.join(";")+`\r
`}return i},e.parseRtcpFb=function(n){const i=n.substring(n.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(n){let i="",a=n.payloadType;return n.preferredPayloadType!==void 0&&(a=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(o=>{i+="a=rtcp-fb:"+a+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(n){const i=n.indexOf(" "),a={ssrc:parseInt(n.substring(7,i),10)},o=n.indexOf(":",i);return o>-1?(a.attribute=n.substring(i+1,o),a.value=n.substring(o+1)):a.attribute=n.substring(i+1),a},e.parseSsrcGroup=function(n){const i=n.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(a=>parseInt(a,10))}},e.getMid=function(n){const i=e.matchPrefix(n,"a=mid:")[0];if(i)return i.substring(6)},e.parseFingerprint=function(n){const i=n.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},e.getDtlsParameters=function(n,i){return{role:"auto",fingerprints:e.matchPrefix(n+i,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,i){let a="a=setup:"+i+`\r
`;return n.fingerprints.forEach(o=>{a+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),a},e.parseCryptoLine=function(n){const i=n.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const i=n.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,i){return e.matchPrefix(n+i,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,i){const a=e.matchPrefix(n+i,"a=ice-ufrag:")[0],o=e.matchPrefix(n+i,"a=ice-pwd:")[0];return a&&o?{usernameFragment:a.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(n){let i="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(i+=`a=ice-lite\r
`),i},e.parseRtpParameters=function(n){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(n)[0].split(" ");i.profile=o[2];for(let u=3;u<o.length;u++){const d=o[u],h=e.matchPrefix(n,"a=rtpmap:"+d+" ")[0];if(h){const m=e.parseRtpMap(h),v=e.matchPrefix(n,"a=fmtp:"+d+" ");switch(m.parameters=v.length?e.parseFmtp(v[0]):{},m.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+d+" ").map(e.parseRtcpFb),i.codecs.push(m),m.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(m.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(u=>{i.headerExtensions.push(e.parseExtmap(u))});const c=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return i.codecs.forEach(u=>{c.forEach(d=>{u.rtcpFeedback.find(m=>m.type===d.type&&m.parameter===d.parameter)||u.rtcpFeedback.push(d)})}),i},e.writeRtpDescription=function(n,i){let a="";a+="m="+n+" ",a+=i.codecs.length>0?"9":"0",a+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",a+=i.codecs.map(c=>c.preferredPayloadType!==void 0?c.preferredPayloadType:c.payloadType).join(" ")+`\r
`,a+=`c=IN IP4 0.0.0.0\r
`,a+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(c=>{a+=e.writeRtpMap(c),a+=e.writeFmtp(c),a+=e.writeRtcpFb(c)});let o=0;return i.codecs.forEach(c=>{c.maxptime>o&&(o=c.maxptime)}),o>0&&(a+="a=maxptime:"+o+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(c=>{a+=e.writeExtmap(c)}),a},e.parseRtpEncodingParameters=function(n){const i=[],a=e.parseRtpParameters(n),o=a.fecMechanisms.indexOf("RED")!==-1,c=a.fecMechanisms.indexOf("ULPFEC")!==-1,u=e.matchPrefix(n,"a=ssrc:").map(y=>e.parseSsrcMedia(y)).filter(y=>y.attribute==="cname"),d=u.length>0&&u[0].ssrc;let h;const m=e.matchPrefix(n,"a=ssrc-group:FID").map(y=>y.substring(17).split(" ").map(k=>parseInt(k,10)));m.length>0&&m[0].length>1&&m[0][0]===d&&(h=m[0][1]),a.codecs.forEach(y=>{if(y.name.toUpperCase()==="RTX"&&y.parameters.apt){let T={ssrc:d,codecPayloadType:parseInt(y.parameters.apt,10)};d&&h&&(T.rtx={ssrc:h}),i.push(T),o&&(T=JSON.parse(JSON.stringify(T)),T.fec={ssrc:d,mechanism:c?"red+ulpfec":"red"},i.push(T))}}),i.length===0&&d&&i.push({ssrc:d});let v=e.matchPrefix(n,"b=");return v.length&&(v[0].indexOf("b=TIAS:")===0?v=parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?v=parseInt(v[0].substring(5),10)*1e3*.95-2e3*8:v=void 0,i.forEach(y=>{y.maxBitrate=v})),i},e.parseRtcpParameters=function(n){const i={},a=e.matchPrefix(n,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="cname")[0];a&&(i.cname=a.value,i.ssrc=a.ssrc);const o=e.matchPrefix(n,"a=rtcp-rsize");i.reducedSize=o.length>0,i.compound=o.length===0;const c=e.matchPrefix(n,"a=rtcp-mux");return i.mux=c.length>0,i},e.writeRtcpParameters=function(n){let i="";return n.reducedSize&&(i+=`a=rtcp-rsize\r
`),n.mux&&(i+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(i+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),i},e.parseMsid=function(n){let i;const a=e.matchPrefix(n,"a=msid:");if(a.length===1)return i=a[0].substring(7).split(" "),{stream:i[0],track:i[1]};const o=e.matchPrefix(n,"a=ssrc:").map(c=>e.parseSsrcMedia(c)).filter(c=>c.attribute==="msid");if(o.length>0)return i=o[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(n){const i=e.parseMLine(n),a=e.matchPrefix(n,"a=max-message-size:");let o;a.length>0&&(o=parseInt(a[0].substring(19),10)),isNaN(o)&&(o=65536);const c=e.matchPrefix(n,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substring(12),10),protocol:i.fmt,maxMessageSize:o};const u=e.matchPrefix(n,"a=sctpmap:");if(u.length>0){const d=u[0].substring(10).split(" ");return{port:parseInt(d[0],10),protocol:d[1],maxMessageSize:o}}},e.writeSctpDescription=function(n,i){let a=[];return n.protocol!=="DTLS/SCTP"?a=["m="+n.kind+" 9 "+n.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:a=["m="+n.kind+" 9 "+n.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&a.push("a=max-message-size:"+i.maxMessageSize+`\r
`),a.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,i,a){let o;const c=i!==void 0?i:2;return n?o=n:o=e.generateSessionId(),`v=0\r
o=`+(a||"thisisadapterortc")+" "+o+" "+c+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,i){const a=e.splitLines(n);for(let o=0;o<a.length;o++)switch(a[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[o].substring(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const a=e.splitLines(n)[0].substring(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}},e.parseOLine=function(n){const a=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const i=e.splitLines(n);for(let a=0;a<i.length;a++)if(i[a].length<2||i[a].charAt(1)!=="=")return!1;return!0},t.exports=e}(kp)),kp.exports}var gw=_P(),Bo=hP(gw),wP=BD({__proto__:null,default:Bo},[gw]);function Kd(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substring(2)),i.candidate&&i.candidate.length){const a=new e(i),o=Bo.parseCandidate(i.candidate);for(const c in o)c in a||Object.defineProperty(a,c,{value:o[c]});return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new e(i)},t.RTCIceCandidate.prototype=e.prototype,Ps(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Pg(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Ps(t,"icecandidate",e=>{if(e.candidate){const n=Bo.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Qd(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(u){if(!u||!u.sdp)return!1;const d=Bo.splitSections(u.sdp);return d.shift(),d.some(h=>{const m=Bo.parseMLine(h);return m&&m.kind==="application"&&m.protocol.indexOf("SCTP")!==-1})},i=function(u){const d=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(d===null||d.length<2)return-1;const h=parseInt(d[1],10);return h!==h?-1:h},a=function(u){let d=65536;return e.browser==="firefox"&&(e.version<57?u===-1?d=16384:d=2147483637:e.version<60?d=e.version===57?65535:65536:d=2147483637),d},o=function(u,d){let h=65536;e.browser==="firefox"&&e.version===57&&(h=65535);const m=Bo.matchPrefix(u.sdp,"a=max-message-size:");return m.length>0?h=parseInt(m[0].substring(19),10):e.browser==="firefox"&&d!==-1&&(h=2147483637),h},c=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:d}=this.getConfiguration();d==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const d=i(arguments[0]),h=a(d),m=o(arguments[0],d);let v;h===0&&m===0?v=Number.POSITIVE_INFINITY:h===0||m===0?v=Math.max(h,m):v=Math.min(h,m);const y={};Object.defineProperty(y,"maxMessageSize",{get(){return v}}),this._sctp=y}return c.apply(this,arguments)}}function Wd(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(i,a){const o=i.send;i.send=function(){const u=arguments[0],d=u.length||u.size||u.byteLength;if(i.readyState==="open"&&a.sctp&&d>a.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)");return o.apply(i,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const a=n.apply(this,arguments);return e(a,this),a},Ps(t,"datachannel",i=>(e(i.channel,i.target),i))}function Lg(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const i=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{const o=a.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const c=new Event("connectionstatechange",a);o.dispatchEvent(c)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function Ig(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(a){if(a&&a.sdp&&a.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=a.sdp.split(`
`).filter(c=>c.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&a instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:a.type,sdp:o}):a.sdp=o}return n.apply(this,arguments)}}function Xd(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Zd(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let a=arguments[0]||{};if(typeof a!="object"||a.type&&a.sdp)return n.apply(this,arguments);if(a={type:a.type,sdp:a.sdp},!a.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":a.type="offer";break;default:a.type="answer";break}return a.sdp||a.type!=="offer"&&a.type!=="answer"?n.apply(this,[a]):(a.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(c=>n.apply(this,[c]))})}var xP=Object.freeze({__proto__:null,removeExtmapAllowMixed:Ig,shimAddIceCandidateNullOrEmpty:Xd,shimConnectionState:Lg,shimMaxMessageSize:Qd,shimParameterlessSetLocalDescription:Zd,shimRTCIceCandidate:Kd,shimRTCIceCandidateRelayProtocol:Pg,shimSendThrowTypeError:Wd});function RP(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=V_,i=CP(t),a={browserDetails:i,commonShim:xP,extractVersion:Rc,disableLog:TP,disableWarnings:EP,sdp:wP};switch(i.browser){case"chrome":if(!hE||!Dg||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),a;if(i.version===null)return n("Chrome shim can not determine version, not shimming."),a;n("adapter.js shimming chrome."),a.browserShim=hE,Xd(t,i),Zd(t),F_(t,i),q_(t),Dg(t,i),$_(t),Q_(t,i),G_(t),Y_(t),W_(t,i),Kd(t),Pg(t),Lg(t),Qd(t,i),Wd(t),Ig(t,i);break;case"firefox":if(!mE||!Mg||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),a;n("adapter.js shimming firefox."),a.browserShim=mE,Xd(t,i),Zd(t),X_(t,i),Mg(t,i),Z_(t),tw(t),J_(t),ew(t),nw(t),iw(t),rw(t),aw(t),sw(t),Kd(t),Lg(t),Qd(t,i),Wd(t);break;case"safari":if(!pE||!e.shimSafari)return n("Safari shim is not included in this adapter release."),a;n("adapter.js shimming safari."),a.browserShim=pE,Xd(t,i),Zd(t),fw(t),mw(t),cw(t),ow(t),lw(t),hw(t),uw(t),pw(t),Kd(t),Pg(t),Qd(t,i),Wd(t),Ig(t,i);break;default:n("Unsupported browser!");break}return a}RP({window:typeof window>"u"?void 0:window});const AP=10,gc="lk_e2ee",OP="LKFrameEncryptionKey",NP={sharedKey:!1,ratchetSalt:OP,ratchetWindowSize:8,failureTolerance:AP,keyringSize:16};var Aa;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(Aa||(Aa={}));var vE;(function(t){t.KeyRatcheted="keyRatcheted"})(vE||(vE={}));var Ra;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Ra||(Ra={}));var bE;(function(t){t.Error="cryptorError"})(bE||(bE={}));function DP(){return MP()||jg()}function jg(){return typeof window.RTCRtpScriptTransform<"u"}function MP(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class Mz extends or.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,i,a)=>{Qe.debug("key ratcheted event received",{ratchetResult:n,participantId:i,keyIndex:a})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},NP),e),this.on(Aa.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,i){const a={key:e,participantIdentity:n,keyIndex:i};if(!this.options.sharedKey&&!n)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(n??"shared","-").concat(i??0),a),this.emit(Aa.SetKey,a)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(Aa.RatchetRequest,e,n)}}class zr extends Error{constructor(e,n){super(n||"an error has occured"),this.name="LiveKitError",this.code=e}}var nt;(function(t){t[t.NotAllowed=0]="NotAllowed",t[t.ServerUnreachable=1]="ServerUnreachable",t[t.InternalError=2]="InternalError",t[t.Cancelled=3]="Cancelled",t[t.LeaveRequest=4]="LeaveRequest",t[t.Timeout=5]="Timeout"})(nt||(nt={}));class pt extends zr{constructor(e,n,i,a){super(1,e),this.name="ConnectionError",this.status=i,this.reason=n,this.context=a,this.reasonName=nt[n]}}class zv extends zr{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class Lr extends zr{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class PP extends zr{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class $t extends zr{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Ug extends zr{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class yE extends zr{constructor(e,n){super(15,e),this.name="PublishTrackError",this.status=n}}class SE extends zr{constructor(e,n){super(15,e),this.reason=n,this.reasonName=typeof n=="string"?n:Uv[n]}}var wi;(function(t){t[t.AlreadyOpened=0]="AlreadyOpened",t[t.AbnormalEnd=1]="AbnormalEnd",t[t.DecodeFailed=2]="DecodeFailed",t[t.LengthExceeded=3]="LengthExceeded",t[t.Incomplete=4]="Incomplete",t[t.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered"})(wi||(wi={}));class wa extends zr{constructor(e,n){super(16,e),this.name="DataStreamError",this.reason=n,this.reasonName=wi[n]}}var zc;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(zc||(zc={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(zc||(zc={}));var TE;(function(t){t[t.InvalidKey=0]="InvalidKey",t[t.MissingKey=1]="MissingKey",t[t.InternalError=2]="InternalError"})(TE||(TE={}));var J;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.Moved="moved",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.ParticipantAttributesChanged="participantAttributesChanged",t.ParticipantActive="participantActive",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged",t.ChatMessage="chatMessage",t.LocalTrackSubscribed="localTrackSubscribed",t.MetricsReceived="metricsReceived"})(J||(J={}));var ne;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackCpuConstrained="localTrackCpuConstrained",t.LocalSenderCreated="localSenderCreated",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.TrackCpuConstrained="trackCpuConstrained",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded",t.AttributesChanged="attributesChanged",t.LocalTrackSubscribed="localTrackSubscribed",t.ChatMessage="chatMessage",t.Active="active"})(ne||(ne={}));var ve;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackSubscribed="localTrackSubscribed",t.Offline="offline",t.SignalRequestResponse="signalRequestResponse",t.SignalConnected="signalConnected",t.RoomMoved="roomMoved"})(ve||(ve={}));var pe;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.CpuConstrained="cpuConstrained",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed",t.TrackProcessorUpdate="trackProcessorUpdate",t.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",t.TranscriptionReceived="transcriptionReceived",t.TimeSyncUpdate="timeSyncUpdate",t.PreConnectBufferFlushed="preConnectBufferFlushed"})(pe||(pe={}));function LP(t){return typeof t>"u"?t:typeof structuredClone=="function"?typeof t=="object"&&t!==null?structuredClone(Object.assign({},t)):structuredClone(t):JSON.parse(JSON.stringify(t))}const IP=/version\/(\d+(\.?_?\d+)+)/i;let _p;function $n(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(_p===void 0||e){const i=jP.find(a=>{let{test:o}=a;return o.test(n)});_p=i?.describe(n)}return _p}const jP=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Jd(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:wp(t)}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Jd(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0,osVersion:wp(t)}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Jd(IP,t),os:t.includes("mobile/")?"iOS":"macOS",osVersion:wp(t)}}}];function Jd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=e.match(t);return i&&i.length>=n&&i[n]||""}function wp(t){return t.includes("mac os")?Jd(/\(.+?(\d+_\d+(:?_\d+)?)/,t,1).replace(/_/g,"."):void 0}var UP="2.15.6";const BP=UP,zP=16;class ln{}ln.setTimeout=function(){return setTimeout(...arguments)};ln.setInterval=function(){return setInterval(...arguments)};ln.clearTimeout=function(){return clearTimeout(...arguments)};ln.clearInterval=function(){return clearInterval(...arguments)};const VP=5e3,vc=[];var qn;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH"})(qn||(qn={}));class G extends or.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var a;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=G.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Qe,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),VP):this.handleAppVisibilityChanged()},this.log=Ur((a=i.loggerName)!==null&&a!==void 0?a:Ai.Track),this.loggerContextCb=i.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=G.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Je(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===G.Kind.Video&&(n="video"),this.attachedElements.length===0&&this.kind===G.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(vc.forEach(o=>{o.parentElement===null&&!e&&(e=o)}),e&&vc.splice(vc.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Po(this.mediaStreamTrack,e);const i=e.srcObject.getTracks(),a=i.some(o=>o.kind==="audio");return e.play().then(()=>{this.emit(a?pe.AudioPlaybackStarted:pe.VideoPlaybackStarted)}).catch(o=>{o.name==="NotAllowedError"?this.emit(a?pe.AudioPlaybackFailed:pe.VideoPlaybackFailed,o):o.name==="AbortError"?Qe.debug("".concat(a?"audio":"video"," playback aborted, likely due to new play request")):Qe.warn("could not playback ".concat(a?"audio":"video"),o),a&&e&&i.some(c=>c.kind==="video")&&o.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(pe.ElementAttached,e),e}detach(e){try{if(e){zo(this.mediaStreamTrack,e);const i=this.attachedElements.indexOf(e);return i>=0&&(this.attachedElements.splice(i,1),this.recycleElement(e),this.emit(pe.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(i=>{zo(this.mediaStreamTrack,i),n.push(i),this.recycleElement(i),this.emit(pe.ElementDetached,i)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=Ur(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),vc.forEach(i=>{i.parentElement||(n=!1)}),n&&vc.push(e)}}handleAppVisibilityChanged(){return L(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===G.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){wn()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){wn()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Po(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let i;t.kind==="audio"?i=n.getAudioTracks():i=n.getVideoTracks(),i.includes(t)||(i.forEach(a=>{n.removeTrack(a)}),n.addTrack(t)),(!ws()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(ws()||_s())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function zo(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(h){h.Audio="audio",h.Video="video",h.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(h){h.Camera="camera",h.Microphone="microphone",h.ScreenShare="screen_share",h.ScreenShareAudio="screen_share_audio",h.Unknown="unknown"})(n=t.Source||(t.Source={}));let i;(function(h){h.Active="active",h.Paused="paused",h.Unknown="unknown"})(i=t.StreamState||(t.StreamState={}));function a(h){switch(h){case e.Audio:return ki.AUDIO;case e.Video:return ki.VIDEO;default:return ki.DATA}}t.kindToProto=a;function o(h){switch(h){case ki.AUDIO:return e.Audio;case ki.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=o;function c(h){switch(h){case n.Camera:return Bt.CAMERA;case n.Microphone:return Bt.MICROPHONE;case n.ScreenShare:return Bt.SCREEN_SHARE;case n.ScreenShareAudio:return Bt.SCREEN_SHARE_AUDIO;default:return Bt.UNKNOWN}}t.sourceToProto=c;function u(h){switch(h){case Bt.CAMERA:return n.Camera;case Bt.MICROPHONE:return n.Microphone;case Bt.SCREEN_SHARE:return n.ScreenShare;case Bt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=u;function d(h){switch(h){case xg.ACTIVE:return i.Active;case xg.PAUSED:return i.Paused;default:return i.Unknown}}t.streamStateFromProto=d})(G||(G={}));class ht{constructor(e,n,i,a,o){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(n!==void 0&&i!==void 0)this.width=e,this.height=n,this.aspectRatio=e/n,this.encoding={maxBitrate:i,maxFramerate:a,priority:o};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const HP=["vp8","h264"],FP=["vp8","h264","vp9","av1","h265"];function qP(t){return!!HP.find(e=>e===t)}var EE;(function(t){t[t.PREFER_REGRESSION=0]="PREFER_REGRESSION",t[t.SIMULCAST=1]="SIMULCAST",t[t.REGRESSION=2]="REGRESSION"})(EE||(EE={}));var Bg;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:24e3},t.music={maxBitrate:48e3},t.musicStereo={maxBitrate:64e3},t.musicHighQuality={maxBitrate:96e3},t.musicHighQualityStereo={maxBitrate:128e3}})(Bg||(Bg={}));const Vc={h90:new ht(160,90,9e4,20),h180:new ht(320,180,16e4,20),h216:new ht(384,216,18e4,20),h360:new ht(640,360,45e4,20),h540:new ht(960,540,8e5,25),h720:new ht(1280,720,17e5,30),h1080:new ht(1920,1080,3e6,30),h1440:new ht(2560,1440,5e6,30),h2160:new ht(3840,2160,8e6,30)},zg={h120:new ht(160,120,7e4,20),h180:new ht(240,180,125e3,20),h240:new ht(320,240,14e4,20),h360:new ht(480,360,33e4,20),h480:new ht(640,480,5e5,20),h540:new ht(720,540,6e5,25),h720:new ht(960,720,13e5,30),h1080:new ht(1440,1080,23e5,30),h1440:new ht(1920,1440,38e5,30)},Vv={h360fps3:new ht(640,360,2e5,3,"medium"),h360fps15:new ht(640,360,4e5,15,"medium"),h720fps5:new ht(1280,720,8e5,5,"medium"),h720fps15:new ht(1280,720,15e5,15,"medium"),h720fps30:new ht(1280,720,2e6,30,"medium"),h1080fps15:new ht(1920,1080,25e5,15,"medium"),h1080fps30:new ht(1920,1080,5e6,30,"medium"),original:new ht(0,0,7e6,30,"medium")},$P="|",CE="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function GP(t){const e=t.split($P);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function Rn(t){return L(this,void 0,void 0,function*(){return new Promise(e=>ln.setTimeout(e,t))})}function Vg(){return"addTransceiver"in RTCPeerConnection.prototype}function Hg(){return"addTrack"in RTCPeerConnection.prototype}function YP(){if(!("getCapabilities"in RTCRtpSender)||ws()||_s())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function KP(){if(!("getCapabilities"in RTCRtpSender)||_s())return!1;if(ws()){const n=$n();if(n?.version&&Oi(n.version,"16")<0||n?.os==="iOS"&&n?.osVersion&&Oi(n.osVersion,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function Xi(t){return t==="av1"||t==="vp9"}function Fg(t){return!document||Hc()?!1:(t||(t=document.createElement("audio")),"setSinkId"in t)}function QP(){return typeof RTCPeerConnection>"u"?!1:Vg()||Hg()}function _s(){var t;return((t=$n())===null||t===void 0?void 0:t.name)==="Firefox"}function ws(){var t;return((t=$n())===null||t===void 0?void 0:t.name)==="Safari"}function Hc(){const t=$n();return t?.name==="Safari"||t?.os==="iOS"}function WP(){const t=$n();return t?.name==="Safari"&&t.version.startsWith("17.")||t?.os==="iOS"&&!!t?.osVersion&&Oi(t.osVersion,"17")>=0}function XP(t){return t||(t=$n()),t?.name==="Safari"&&Oi(t.version,"18.3")>0||t?.os==="iOS"&&!!t?.osVersion&&Oi(t.osVersion,"18.3")>0}function vw(){var t,e;return wn()?(e=(t=navigator.userAgentData)===null||t===void 0?void 0:t.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function ZP(){const t=$n(),e="17.2";if(t)return t.name!=="Safari"&&t.os!=="iOS"||t.os==="iOS"&&t.osVersion&&Oi(t.osVersion,e)>=0?!0:t.name==="Safari"&&Oi(t.version,e)>=0}function wn(){return typeof document<"u"}function rr(){return navigator.product=="ReactNative"}function qg(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function bw(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function yw(){if(!rr())return;let t=bw();if(t)return t.platform}function kE(){if(wn())return window.devicePixelRatio;if(rr()){let t=bw();if(t)return t.devicePixelRatio}return 1}function Oi(t,e){const n=t.split("."),i=e.split("."),a=Math.min(n.length,i.length);for(let o=0;o<a;++o){const c=parseInt(n[o],10),u=parseInt(i[o],10);if(c>u)return 1;if(c<u)return-1;if(o===a-1&&c===u)return 0}return t===""&&e!==""?-1:e===""?1:n.length==i.length?0:n.length<i.length?-1:1}function JP(t){for(const e of t)e.target.handleResize(e)}function eL(t){for(const e of t)e.target.handleVisibilityChanged(e)}let xp=null;const _E=()=>(xp||(xp=new ResizeObserver(JP)),xp);let Rp=null;const wE=()=>(Rp||(Rp=new IntersectionObserver(eL,{root:null,rootMargin:"0px"})),Rp);function tL(){var t;const e=new HM({sdk:C_.JS,protocol:zP,version:BP});return rr()&&(e.os=(t=yw())!==null&&t!==void 0?t:""),e}function xE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const a=document.createElement("canvas");a.width=t,a.height=e;const o=a.getContext("2d");o?.fillRect(0,0,a.width,a.height),i&&o&&(o.beginPath(),o.arc(t/2,e/2,50,0,Math.PI*2,!0),o.closePath(),o.fillStyle="grey",o.fill());const c=a.captureStream(),[u]=c.getTracks();if(!u)throw Error("Could not get empty media stream video track");return u.enabled=n,u}let bc;function Ap(){if(!bc){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const i=t.createMediaStreamDestination();if(e.connect(n),n.connect(i),e.start(),[bc]=i.stream.getAudioTracks(),!bc)throw Error("Could not get empty media stream audio track");bc.enabled=!1}return bc.clone()}class Zi{get isResolved(){return this._isResolved}constructor(e,n){this._isResolved=!1,this.onFinally=n,this.promise=new Promise((i,a)=>L(this,void 0,void 0,function*(){this.resolve=i,this.reject=a,e&&(yield e(i,a))})).finally(()=>{var i;this._isResolved=!0,(i=this.onFinally)===null||i===void 0||i.call(this)})}}function nL(t){return FP.includes(t)}function Oa(t){if(typeof t=="string"||typeof t=="number")return t;if(Array.isArray(t))return t[0];if(t.exact!==void 0)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal!==void 0)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function iL(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function $g(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}function rL(t,e){return t.segments.map(n=>{let{id:i,text:a,language:o,startTime:c,endTime:u,final:d}=n;var h;const m=(h=e.get(i))!==null&&h!==void 0?h:Date.now(),v=Date.now();return d?e.delete(i):e.set(i,m),{id:i,text:a,startTime:Number.parseInt(c.toString()),endTime:Number.parseInt(u.toString()),final:d,language:o,firstReceivedTime:m,lastReceivedTime:v}})}function aL(t){const{id:e,timestamp:n,message:i,editTimestamp:a}=t;return{id:e,timestamp:Number.parseInt(n.toString()),editTimestamp:a?Number.parseInt(a.toString()):void 0,message:i}}function RE(t){switch(t.reason){case nt.LeaveRequest:return t.context;case nt.Cancelled:return Ri.CLIENT_INITIATED;case nt.NotAllowed:return Ri.USER_REJECTED;case nt.ServerUnreachable:return Ri.JOIN_FAILURE;default:return Ri.UNKNOWN_REASON}}function ef(t){return t!==void 0?Number(t):void 0}function ps(t){return t!==void 0?BigInt(t):void 0}function Ss(t){return!!t&&!(t instanceof MediaStreamTrack)&&t.isLocal}function er(t){return!!t&&t.kind==G.Kind.Audio}function Ba(t){return!!t&&t.kind==G.Kind.Video}function ya(t){return Ss(t)&&Ba(t)}function Or(t){return Ss(t)&&er(t)}function Gg(t){return!!t&&!t.isLocal}function sL(t){return!!t&&!t.isLocal}function Op(t){return Gg(t)&&Ba(t)}function oL(t){return t.isLocal}function lL(t,e){const n=[];let i=new TextEncoder().encode(t);for(;i.length>e;){let a=e;for(;a>0;){const o=i[a];if(o!==void 0&&(o&192)!==128)break;a--}n.push(i.slice(0,a)),i=i.slice(a)}return i.length>0&&n.push(i),n}function Sw(t,e,n){var i,a,o,c;const{optionsWithoutProcessor:u,audioProcessor:d,videoProcessor:h}=Cw(t??{}),m=e?.processor,v=n?.processor,y=u??{};return y.audio===!0&&(y.audio={}),y.video===!0&&(y.video={}),y.audio&&(Yg(y.audio,e),(i=(o=y.audio).deviceId)!==null&&i!==void 0||(o.deviceId={ideal:"default"}),(d||m)&&(y.audio.processor=d??m)),y.video&&(Yg(y.video,n),(a=(c=y.video).deviceId)!==null&&a!==void 0||(c.deviceId={ideal:"default"}),(h||v)&&(y.video.processor=h??v)),y}function Yg(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function Hv(t){var e,n,i,a;const o={};if(t.video)if(typeof t.video=="object"){const c={},u=c,d=t.video;Object.keys(d).forEach(h=>{switch(h){case"resolution":Yg(u,d.resolution);break;default:u[h]=d[h]}}),o.video=c,(e=(i=o.video).deviceId)!==null&&e!==void 0||(i.deviceId={ideal:"default"})}else o.video=t.video?{deviceId:{ideal:"default"}}:!1;else o.video=!1;return t.audio?typeof t.audio=="object"?(o.audio=t.audio,(n=(a=o.audio).deviceId)!==null&&n!==void 0||(a.deviceId={ideal:"default"})):o.audio={deviceId:{ideal:"default"}}:o.audio=!1,o}function Tw(t){return L(this,arguments,void 0,function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const i=Ew();if(i){const a=i.createAnalyser();a.fftSize=2048;const o=a.frequencyBinCount,c=new Uint8Array(o);i.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(a),yield Rn(n),a.getByteTimeDomainData(c);const d=c.some(h=>h!==128&&h!==0);return i.close(),!d}return!1}()})}function Ew(){var t;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const n=new e({latencyHint:"interactive"});if(n.state==="suspended"&&typeof window<"u"&&(!((t=window.document)===null||t===void 0)&&t.body)){const i=()=>L(this,void 0,void 0,function*(){var a;try{n.state==="suspended"&&(yield n.resume())}catch(o){console.warn("Error trying to auto-resume audio context",o)}(a=window.document.body)===null||a===void 0||a.removeEventListener("click",i)});window.document.body.addEventListener("click",i)}return n}}function cL(t){return t==="audioinput"?G.Source.Microphone:t==="videoinput"?G.Source.Camera:G.Source.Unknown}function Kg(t){return t===G.Source.Microphone?"audioinput":t===G.Source.Camera?"videoinput":void 0}function uL(t){var e,n;let i=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(i=typeof i=="boolean"?{}:i,ws()?i=Object.assign(Object.assign({},i),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):i=Object.assign(Object.assign({},i),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:i,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio,preferCurrentTab:t.preferCurrentTab}}function Nc(t){return t.split("/")[1].toLowerCase()}function dL(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new Iv({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function Je(t){return"mediaStreamTrack"in t?{trackID:t.sid,source:t.source,muted:t.isMuted,enabled:t.mediaStreamTrack.enabled,kind:t.kind,streamID:t.mediaStreamID,streamTrackID:t.mediaStreamTrack.id}:{trackID:t.trackSid,enabled:t.isEnabled,muted:t.isMuted,trackInfo:Object.assign({mimeType:t.mimeType,name:t.trackName,encrypted:t.isEncrypted,kind:t.kind,source:t.source},t.track?Je(t.track):{})}}function fL(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function hL(t,e){var n;t===void 0&&(t={}),e===void 0&&(e={});const i=[...Object.keys(e),...Object.keys(t)],a={};for(const o of i)t[o]!==e[o]&&(a[o]=(n=e[o])!==null&&n!==void 0?n:"");return a}function Cw(t){const e=Object.assign({},t);let n,i;return typeof e.audio=="object"&&e.audio.processor&&(n=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(i=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:n,videoProcessor:i,optionsWithoutProcessor:LP(e)}}function mL(t){switch(t){case Bt.CAMERA:return G.Source.Camera;case Bt.MICROPHONE:return G.Source.Microphone;case Bt.SCREEN_SHARE:return G.Source.ScreenShare;case Bt.SCREEN_SHARE_AUDIO:return G.Source.ScreenShareAudio;default:return G.Source.Unknown}}function AE(t,e){return t.width*t.height<e.width*e.height}function pL(t,e){var n;return(n=t.layers)===null||n===void 0?void 0:n.find(i=>i.quality===e)}class gL extends or.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var i,a;const{kind:o,data:c}=n.data;switch(o){case"error":Qe.error(c.error.message),this.emit(Ra.EncryptionError,c.error);break;case"initAck":c.enabled&&this.keyProvider.getKeys().forEach(u=>{this.postKey(u)});break;case"enable":if(c.enabled&&this.keyProvider.getKeys().forEach(u=>{this.postKey(u)}),this.encryptionEnabled!==c.enabled&&c.participantIdentity===((i=this.room)===null||i===void 0?void 0:i.localParticipant.identity))this.emit(Ra.ParticipantEncryptionStatusChanged,c.enabled,this.room.localParticipant),this.encryptionEnabled=c.enabled;else if(c.participantIdentity){const u=(a=this.room)===null||a===void 0?void 0:a.getParticipantByIdentity(c.participantIdentity);if(!u)throw TypeError("couldn't set encryption status, participant not found".concat(c.participantIdentity));this.emit(Ra.ParticipantEncryptionStatusChanged,c.enabled,u)}break;case"ratchetKey":this.keyProvider.emit(Aa.KeyRatcheted,c.ratchetResult,c.participantIdentity,c.keyIndex);break}},this.onWorkerError=n=>{Qe.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Ra.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!DP())throw new zv("tried to setup end-to-end encryption on an unsupported browser");if(Qe.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:gP.getLevel()}};this.worker&&(Qe.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){Qe.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?Qe.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(ve.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(J.TrackPublished,(i,a)=>this.setParticipantCryptorEnabled(i.trackInfo.encryption!==Fn.NONE,a.identity)),e.on(J.ConnectionStateChanged,i=>{i===et.Connected&&e.remoteParticipants.forEach(a=>{a.trackPublications.forEach(o=>{this.setParticipantCryptorEnabled(o.trackInfo.encryption!==Fn.NONE,a.identity)})})}).on(J.TrackUnsubscribed,(i,a,o)=>{var c;const u={kind:"removeTransform",data:{participantIdentity:o.identity,trackId:i.mediaStreamID}};(c=this.worker)===null||c===void 0||c.postMessage(u)}).on(J.TrackSubscribed,(i,a,o)=>{this.setupE2EEReceiver(i,o.identity,a.trackInfo)}).on(J.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");n.getKeys().forEach(i=>{this.postKey(i)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(ne.LocalSenderCreated,(i,a)=>L(this,void 0,void 0,function*(){this.setupE2EESender(a,i)})),e.localParticipant.on(ne.LocalTrackPublished,i=>{if(!Ba(i.track)||!Hc())return;const a={kind:"updateCodec",data:{trackId:i.track.mediaStreamID,codec:Nc(i.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(a)}),n.on(Aa.SetKey,i=>this.postKey(i)).on(Aa.RatchetRequest,(i,a)=>this.postRatchetRequest(i,a))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const i={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(i)}postKey(e){let{key:n,participantIdentity:i,keyIndex:a}=e;var o;if(!this.worker)throw Error("could not set key, worker is missing");const c={kind:"setKey",data:{participantIdentity:i,isPublisher:i===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity),key:n,keyIndex:a}};this.worker.postMessage(c)}postEnable(e,n){if(this.worker){const i={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(i)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const i={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(i)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,i){if(e.receiver){if(!i?.mimeType||i.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?Nc(i.mimeType):void 0)}}setupE2EESender(e,n){if(!Ss(e)||!n){n||Qe.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,i,a){return L(this,void 0,void 0,function*(){if(this.worker){if(jg()){const o={kind:"decode",participantIdentity:i,trackId:n,codec:a};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{if(gc in e&&a){const d={kind:"updateCodec",data:{trackId:n,codec:a,participantIdentity:i}};this.worker.postMessage(d);return}let o=e.writableStream,c=e.readableStream;if(!o||!c){const d=e.createEncodedStreams();e.writableStream=d.writable,o=d.writable,e.readableStream=d.readable,c=d.readable}const u={kind:"decode",data:{readableStream:c,writableStream:o,trackId:n,codec:a,participantIdentity:i,isReuse:gc in e}};this.worker.postMessage(u,[c,o])}e[gc]=!0}})}handleSender(e,n,i){var a;if(!(gc in e||!this.worker)){if(!(!((a=this.room)===null||a===void 0)&&a.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(jg()){Qe.info("initialize script transform");const o={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,o)}else{Qe.info("initialize encoded streams");const o=e.createEncodedStreams(),c={kind:"encode",data:{readableStream:o.readable,writableStream:o.writable,codec:i,trackId:n,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(c,[o.readable,o.writable])}e[gc]=!0}}}const Np="default";class Jt{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new Jt),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return L(this,arguments,void 0,function(n){var i=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o;if(((o=Jt.userMediaPromiseMap)===null||o===void 0?void 0:o.size)>0){Qe.debug("awaiting getUserMedia promise");try{n?yield Jt.userMediaPromiseMap.get(n):yield Promise.all(Jt.userMediaPromiseMap.values())}catch{Qe.warn("error waiting for media permissons")}}let c=yield navigator.mediaDevices.enumerateDevices();if(a&&!(ws()&&i.hasDeviceInUse(n))&&(c.filter(d=>d.kind===n).length===0||c.some(d=>{const h=d.label==="",m=n?d.kind===n:!0;return h&&m}))){const d={video:n!=="audioinput"&&n!=="audiooutput",audio:n!=="videoinput"&&{deviceId:{ideal:"default"}}},h=yield navigator.mediaDevices.getUserMedia(d);c=yield navigator.mediaDevices.enumerateDevices(),h.getTracks().forEach(m=>{m.stop()})}return i._previousDevices=c,n&&(c=c.filter(u=>u.kind===n)),c}()})}normalizeDeviceId(e,n,i){return L(this,void 0,void 0,function*(){if(n!==Np)return n;const a=yield this.getDevices(e),o=a.find(u=>u.deviceId===Np);if(!o){Qe.warn("could not reliably determine default device");return}const c=a.find(u=>u.deviceId!==Np&&u.groupId===(i??o.groupId));if(!c){Qe.warn("could not reliably determine default device");return}return c?.deviceId})}hasDeviceInUse(e){return e?Jt.userMediaPromiseMap.has(e):Jt.userMediaPromiseMap.size>0}}Jt.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Jt.userMediaPromiseMap=new Map;var Dc;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(Dc||(Dc={}));class vL{constructor(){this.pendingTasks=new Map,this.taskMutex=new xn,this.nextTaskIndex=0}run(e){return L(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Dc.WAITING};this.pendingTasks.set(n.id,n);const i=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Dc.RUNNING,yield e()}finally{n.status=Dc.COMPLETED,this.pendingTasks.delete(n.id),i()}})}flush(){return L(this,void 0,void 0,function*(){return this.run(()=>L(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function bL(t,e){const n=new URL(iL(t));return e.forEach((i,a)=>{n.searchParams.set(a,i)}),kw(n,"rtc")}function yL(t){const e=new URL($g(t));return kw(e,"validate")}function SL(t){return t.endsWith("/")?t:"".concat(t,"/")}function kw(t,e){return t.pathname="".concat(SL(t.pathname)).concat(e),t.toString()}const TL=["syncState","trickle","offer","answer","simulate","leave"];function EL(t){const e=TL.indexOf(t.case)>=0;return Qe.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var St;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(St||(St={}));class Fv{get currentState(){return this.state}get isDisconnected(){return this.state===St.DISCONNECTING||this.state===St.DISCONNECTED}get isEstablishingConnection(){return this.state===St.CONNECTING||this.state===St.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var i;this.rtt=0,this.state=St.DISCONNECTED,this.log=Qe,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Ur((i=n.loggerName)!==null&&i!==void 0?i:Ai.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new vL,this.queuedRequests=[],this.closingLock=new xn,this.connectionLock=new xn,this.state=St.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,i,a){return L(this,void 0,void 0,function*(){return this.state=St.CONNECTING,this.options=i,yield this.connect(e,n,i,a)})}reconnect(e,n,i,a){return L(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=St.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:i,reconnectReason:a}))})}connect(e,n,i,a){this.connectOptions=i;const o=tL(),c=CL(n,o,i),u=bL(e,c),d=yL(u);return new Promise((h,m)=>L(this,void 0,void 0,function*(){const v=yield this.connectionLock.lock();try{const y=()=>L(this,void 0,void 0,function*(){this.close(),clearTimeout(T),m(new pt("room connection has been cancelled (signal)",nt.Cancelled))}),T=setTimeout(()=>{this.close(),m(new pt("room connection has timed out (signal)",nt.ServerUnreachable))},i.websocketTimeout);a?.aborted&&y(),a?.addEventListener("abort",y);const k=new URL(u);k.searchParams.has("access_token")&&k.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(k),Object.assign({reconnect:i.reconnect,reconnectReason:i.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(u),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(T)},this.ws.onerror=E=>L(this,void 0,void 0,function*(){if(this.state!==St.CONNECTED){this.state=St.DISCONNECTED,clearTimeout(T);try{const x=yield fetch(d);if(x.status.toFixed(0).startsWith("4")){const _=yield x.text();m(new pt(_,nt.NotAllowed,x.status))}else m(new pt("Encountered unknown websocket error during connection: ".concat(E.toString()),nt.InternalError,x.status))}catch(x){m(new pt(x instanceof Error?x.message:"server was not reachable",nt.ServerUnreachable))}return}this.handleWSError(E)}),this.ws.onmessage=E=>L(this,void 0,void 0,function*(){var x,_,N;let P;if(typeof E.data=="string"){const O=JSON.parse(E.data);P=sE.fromJson(O,{ignoreUnknownFields:!0})}else if(E.data instanceof ArrayBuffer)P=sE.fromBinary(new Uint8Array(E.data));else{this.log.error("could not decode websocket message: ".concat(typeof E.data),this.logContext);return}if(this.state!==St.CONNECTED){let O=!1;if(((x=P.message)===null||x===void 0?void 0:x.case)==="join"?(this.state=St.CONNECTED,a?.removeEventListener("abort",y),this.pingTimeoutDuration=P.message.value.pingTimeout,this.pingIntervalDuration=P.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),h(P.message.value)):this.state===St.RECONNECTING&&P.message.case!=="leave"?(this.state=St.CONNECTED,a?.removeEventListener("abort",y),this.startPingInterval(),((_=P.message)===null||_===void 0?void 0:_.case)==="reconnect"?h(P.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),h(void 0),O=!0)):this.isEstablishingConnection&&P.message.case==="leave"?m(new pt("Received leave request while trying to (re)connect",nt.LeaveRequest,void 0,P.message.value.reason)):i.reconnect||m(new pt("did not receive join response, got ".concat((N=P.message)===null||N===void 0?void 0:N.case," instead"),nt.InternalError)),!O)return}this.signalLatency&&(yield Rn(this.signalLatency)),this.handleSignalResponse(P)}),this.ws.onclose=E=>{this.isEstablishingConnection&&m(new pt("Websocket got closed during a (re)connection attempt",nt.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:E.reason,code:E.code,wasClean:E.wasClean,state:this.state})),this.handleOnClose(E.reason)}}finally{v()}}))}close(){return L(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const i=yield e.closingLock.lock();try{if(e.clearPingInterval(),n&&(e.state=St.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const a=new Promise(o=>{e.ws?e.ws.onclose=()=>{o()}:o()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([a,Rn(250)])),e.ws=void 0}}finally{n&&(e.state=St.DISCONNECTED),i()}}()})}sendOffer(e,n){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:ff(e,n)})}sendAnswer(e,n){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:ff(e,n)})}sendIceCandidate(e,n){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Pv({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new Lv({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return L(this,arguments,void 0,function(i,a){var o=this;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const u=o.getNextRequestId();return yield o.sendRequest({case:"updateMetadata",value:new N_({requestId:u,metadata:i,name:a,attributes:c})}),u}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new O_({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new P_({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ct.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new U_({timestamp:Ct.parse(Date.now()),rtt:Ct.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,n){return this.sendRequest({case:"updateAudioTrack",value:new A_({trackSid:e,features:n})})}sendLeave(){return this.sendRequest({case:"leave",value:new Uf({reason:Ri.CLIENT_INITIATED,action:Uo.DISCONNECT})})}sendRequest(e){return L(this,arguments,void 0,function(n){var i=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!a&&!EL(n)&&i.state===St.RECONNECTING){i.queuedRequests.push(()=>L(i,void 0,void 0,function*(){yield this.sendRequest(n,!0)}));return}if(a||(yield i.requestQueue.flush()),i.signalLatency&&(yield Rn(i.signalLatency)),i.isDisconnected){i.log.debug("skipping signal request (type: ".concat(n.case,") - SignalClient disconnected"));return}if(!i.ws||i.ws.readyState!==i.ws.OPEN){i.log.error("cannot send signal request before connected, type: ".concat(n?.case),i.logContext);return}const c=new $M({message:n});try{i.useJSON?i.ws.send(c.toJsonString()):i.ws.send(c.toBinary())}catch(u){i.log.error("error sending signal message",Object.assign(Object.assign({},i.logContext),{error:u}))}}()})}handleSignalResponse(e){var n,i;const a=e.message;if(a==null){this.log.debug("received unsupported message",this.logContext);return}let o=!1;if(a.case==="answer"){const c=OE(a.value);this.onAnswer&&this.onAnswer(c,a.value.id)}else if(a.case==="offer"){const c=OE(a.value);this.onOffer&&this.onOffer(c,a.value.id)}else if(a.case==="trickle"){const c=JSON.parse(a.value.candidateInit);this.onTrickle&&this.onTrickle(c,a.value.target)}else a.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=a.value.participants)!==null&&n!==void 0?n:[]):a.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(a.value):a.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((i=a.value.speakers)!==null&&i!==void 0?i:[]):a.case==="leave"?this.onLeave&&this.onLeave(a.value):a.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(a.value.sid,a.value.muted):a.case==="roomUpdate"?this.onRoomUpdate&&a.value.room&&this.onRoomUpdate(a.value.room):a.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(a.value):a.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(a.value):a.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(a.value):a.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(a.value):a.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(a.value):a.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(a.value):a.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(a.value):a.case==="pong"||(a.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(a.value.lastPingTimestamp.toString()),this.resetPingTimeout(),o=!0):a.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(a.value):a.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(a.value.trackSid):a.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(a.value.token),this.onRoomMoved&&this.onRoomMoved(a.value)):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:a.case})));o||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return L(this,void 0,void 0,function*(){if(this.state===St.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=ln.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&ln.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=ln.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&ln.clearInterval(this.pingInterval)}}function OE(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function ff(t,e){return new ks({sdp:t.sdp,type:t.type,id:e})}function CL(t,e,n){var i;const a=new URLSearchParams;return a.set("access_token",t),n.reconnect&&(a.set("reconnect","1"),n.sid&&a.set("sid",n.sid)),a.set("auto_subscribe",n.autoSubscribe?"1":"0"),a.set("sdk",rr()?"reactnative":"js"),a.set("version",e.version),a.set("protocol",e.protocol.toString()),e.deviceModel&&a.set("device_model",e.deviceModel),e.os&&a.set("os",e.os),e.osVersion&&a.set("os_version",e.osVersion),e.browser&&a.set("browser",e.browser),e.browserVersion&&a.set("browser_version",e.browserVersion),n.adaptiveStream&&a.set("adaptive_stream","1"),n.reconnectReason&&a.set("reconnect_reason",n.reconnectReason.toString()),!((i=navigator.connection)===null||i===void 0)&&i.type&&a.set("network",navigator.connection.type),a}class NE{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const n=this.buffer[0];if(this._totalSize-n.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class kL{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,n){const i=Date.now();i-this._lastCleanup>this.ttl/2&&this.cleanup();const a=i+this.ttl;return this._map.set(e,{value:n,expiresAt:a}),this}get(e){const n=this._map.get(e);if(n){if(n.expiresAt<Date.now()){this._map.delete(e);return}return n.value}}has(e){const n=this._map.get(e);return n?n.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[n,i]of this._map.entries())i.expiresAt<e&&this._map.delete(n);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[n,i]of this._map.entries())i.expiresAt>=Date.now()&&e(i.value,n,this.asValueMap())}map(e){this.cleanup();const n=[],i=this.asValueMap();for(const[a,o]of i.entries())n.push(e(o,a,i));return n}asValueMap(){const e=new Map;for(const[n,i]of this._map.entries())i.expiresAt>=Date.now()&&e.set(n,i.value);return e}}var Ti={},Dp={},Mp={exports:{}},DE;function qv(){if(DE)return Mp.exports;DE=1;var t=Mp.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var n="candidate:%s %d %s %d %s %d typ %s";return n+=e.raddr!=null?" raddr %s rport %d":"%v%v",n+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(n+=" generation %d"),n+=e["network-id"]!=null?" network-id %d":"%v",n+=e["network-cost"]!=null?" network-cost %d":"%v",n}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var n="ssrc:%d";return e.attribute!=null&&(n+=" %s",e.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var n="mediaclk:";return n+=e.id!=null?"id=%s %s":"%v%s",n+=e.mediaClockValue!=null?"=%s":"",n+=e.rateNumerator!=null?" rate=%s":"",n+=e.rateDenominator!=null?"/%s":"",n}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(t).forEach(function(e){var n=t[e];n.forEach(function(i){i.reg||(i.reg=/(.*)/),i.format||(i.format="%s")})}),Mp.exports}var ME;function _L(){return ME||(ME=1,function(t){var e=function(u){return String(Number(u))===u?Number(u):u},n=function(u,d,h,m){if(m&&!h)d[m]=e(u[1]);else for(var v=0;v<h.length;v+=1)u[v+1]!=null&&(d[h[v]]=e(u[v+1]))},i=function(u,d,h){var m=u.name&&u.names;u.push&&!d[u.push]?d[u.push]=[]:m&&!d[u.name]&&(d[u.name]={});var v=u.push?{}:m?d[u.name]:d;n(h.match(u.reg),v,u.names,u.name),u.push&&d[u.push].push(v)},a=qv(),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(u){var d={},h=[],m=d;return u.split(/(\r\n|\r|\n)/).filter(o).forEach(function(v){var y=v[0],T=v.slice(2);y==="m"&&(h.push({rtp:[],fmtp:[]}),m=h[h.length-1]);for(var k=0;k<(a[y]||[]).length;k+=1){var E=a[y][k];if(E.reg.test(T))return i(E,m,T)}}),d.media=h,d};var c=function(u,d){var h=d.split(/=(.+)/,2);return h.length===2?u[h[0]]=e(h[1]):h.length===1&&d.length>1&&(u[h[0]]=void 0),u};t.parseParams=function(u){return u.split(/;\s?/).reduce(c,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(u){return u.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(u){for(var d=[],h=u.split(" ").map(e),m=0;m<h.length;m+=3)d.push({component:h[m],ip:h[m+1],port:h[m+2]});return d},t.parseImageAttributes=function(u){return u.split(" ").map(function(d){return d.substring(1,d.length-1).split(",").reduce(c,{})})},t.parseSimulcastStreamList=function(u){return u.split(";").map(function(d){return d.split(",").map(function(h){var m,v=!1;return h[0]!=="~"?m=e(h):(m=e(h.substring(1,h.length)),v=!0),{scid:m,paused:v}})})}}(Dp)),Dp}var Pp,PE;function wL(){if(PE)return Pp;PE=1;var t=qv(),e=/%[sdv%]/g,n=function(c){var u=1,d=arguments,h=d.length;return c.replace(e,function(m){if(u>=h)return m;var v=d[u];switch(u+=1,m){case"%%":return"%";case"%s":return String(v);case"%d":return Number(v);case"%v":return""}})},i=function(c,u,d){var h=u.format instanceof Function?u.format(u.push?d:d[u.name]):u.format,m=[c+"="+h];if(u.names)for(var v=0;v<u.names.length;v+=1){var y=u.names[v];u.name?m.push(d[u.name][y]):m.push(d[u.names[v]])}else m.push(d[u.name]);return n.apply(null,m)},a=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];return Pp=function(c,u){u=u||{},c.version==null&&(c.version=0),c.name==null&&(c.name=" "),c.media.forEach(function(v){v.payloads==null&&(v.payloads="")});var d=u.outerOrder||a,h=u.innerOrder||o,m=[];return d.forEach(function(v){t[v].forEach(function(y){y.name in c&&c[y.name]!=null?m.push(i(v,y,c)):y.push in c&&c[y.push]!=null&&c[y.push].forEach(function(T){m.push(i(v,y,T))})})}),c.media.forEach(function(v){m.push(i("m",t.m[0],v)),h.forEach(function(y){t[y].forEach(function(T){T.name in v&&v[T.name]!=null?m.push(i(y,T,v)):T.push in v&&v[T.push]!=null&&v[T.push].forEach(function(k){m.push(i(y,T,k))})})})}),m.join(`\r
`)+`\r
`},Pp}var LE;function xL(){if(LE)return Ti;LE=1;var t=_L(),e=wL(),n=qv();return Ti.grammar=n,Ti.write=e,Ti.parse=t.parse,Ti.parseParams=t.parseParams,Ti.parseFmtpConfig=t.parseFmtpConfig,Ti.parsePayloads=t.parsePayloads,Ti.parseRemoteCandidates=t.parseRemoteCandidates,Ti.parseImageAttributes=t.parseImageAttributes,Ti.parseSimulcastStreamList=t.parseSimulcastStreamList,Ti}var Ca=xL();function $v(t,e,n){var i,a,o;e===void 0&&(e=50),n===void 0&&(n={});var c=(i=n.isImmediate)!=null&&i,u=(a=n.callback)!=null&&a,d=n.maxWait,h=Date.now(),m=[];function v(){if(d!==void 0){var T=Date.now()-h;if(T+e>=d)return d-T}return e}var y=function(){var T=[].slice.call(arguments),k=this;return new Promise(function(E,x){var _=c&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,h=Date.now(),!c){var P=t.apply(k,T);u&&u(P),m.forEach(function(O){return(0,O.resolve)(P)}),m=[]}},v()),_){var N=t.apply(k,T);return u&&u(N),E(N)}m.push({resolve:E,reject:x})})};return y.cancel=function(T){o!==void 0&&clearTimeout(o),m.forEach(function(k){return(0,k.reject)(T)}),m=[]},y}const RL=.7,AL=20,Vo={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class IE extends or.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var i;super(),this.log=Qe,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=$v(a=>L(this,void 0,void 0,function*(){this.emit(Vo.NegotiationStarted);try{yield this.createAndSendOffer()}catch(o){if(a)a(o);else throw o}}),AL),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Ur((i=n.loggerName)!==null&&i!==void 0?i:Ai.PCTransport),this.loggerOptions=n,this.config=e,this._pc=this.createPC(),this.offerLock=new xn}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var i;n.candidate&&((i=this.onIceCandidate)===null||i===void 0||i.call(this,n.candidate))},e.onicecandidateerror=n=>{var i;(i=this.onIceCandidateError)===null||i===void 0||i.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var i;(i=this.onDataChannel)===null||i===void 0||i.call(this,n)},e.ontrack=n=>{var i;(i=this.onTrack)===null||i===void 0||i.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return L(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,n){return L(this,void 0,void 0,function*(){var i;if(e.type==="answer"&&this.latestOfferId>0&&n>0&&n!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:n,latestOfferId:this.latestOfferId})),!1;let a;if(e.type==="offer"){let{stereoMids:o,nackMids:c}=OL(e);this.remoteStereoMids=o,this.remoteNackMids=c}else if(e.type==="answer"){const o=Ca.parse((i=e.sdp)!==null&&i!==void 0?i:"");o.media.forEach(c=>{c.type==="audio"&&this.trackBitrates.some(u=>{if(!u.transceiver||c.mid!=u.transceiver.mid)return!1;let d=0;if(c.rtp.some(m=>m.codec.toUpperCase()===u.codec.toUpperCase()?(d=m.payload,!0):!1),d===0)return!0;let h=!1;for(const m of c.fmtp)if(m.payload===d){m.config=m.config.split(";").filter(v=>!v.includes("maxaveragebitrate")).join(";"),u.maxbr>0&&(m.config+=";maxaveragebitrate=".concat(u.maxbr*1e3)),h=!0;break}return h||u.maxbr>0&&c.fmtp.push({payload:d,config:"maxaveragebitrate=".concat(u.maxbr*1e3)}),!0})}),a=Ca.write(o)}return yield this.setMungedSDP(e,a,!0),this.pendingCandidates.forEach(o=>{this.pc.addIceCandidate(o)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Vo.NegotiationComplete),e.sdp&&Ca.parse(e.sdp).media.forEach(c=>{c.type==="video"&&this.emit(Vo.RTPVideoPayloadTypes,c.rtp)})),!0})}createAndSendOffer(e){return L(this,void 0,void 0,function*(){var n;const i=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e?.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const u=this._pc.remoteDescription;if(e?.iceRestart&&u)yield this._pc.setRemoteDescription(u);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const a=this.latestOfferId+1;this.latestOfferId=a;const o=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:o.sdp},this.logContext));const c=Ca.parse((n=o.sdp)!==null&&n!==void 0?n:"");if(c.media.forEach(u=>{UE(u),u.type==="audio"?jE(u,[],[]):u.type==="video"&&this.trackBitrates.some(d=>{if(!u.msid||!d.cid||!u.msid.includes(d.cid))return!1;let h=0;if(u.rtp.some(v=>v.codec.toUpperCase()===d.codec.toUpperCase()?(h=v.payload,!0):!1),h===0||(Xi(d.codec)&&!ws()&&this.ensureVideoDDExtensionForSVC(u,c),d.codec!=="av1"))return!0;const m=Math.round(d.maxbr*RL);for(const v of u.fmtp)if(v.payload===h){v.config.includes("x-google-start-bitrate")||(v.config+=";x-google-start-bitrate=".concat(m));break}return!0})}),this.latestOfferId>a){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:a}));return}yield this.setMungedSDP(o,Ca.write(c)),this.onOffer(o,this.latestOfferId)}finally{i()}})}createAndSetAnswer(){return L(this,void 0,void 0,function*(){var e;const n=yield this.pc.createAnswer(),i=Ca.parse((e=n.sdp)!==null&&e!==void 0?e:"");return i.media.forEach(a=>{UE(a),a.type==="audio"&&jE(a,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Ca.write(i)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new $t("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new $t("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return L(this,void 0,void 0,function*(){var e;if(!this._pc)return;let n="";const i=new Map,a=new Map;if((yield this._pc.getStats()).forEach(u=>{switch(u.type){case"transport":n=u.selectedCandidatePairId;break;case"candidate-pair":n===""&&u.selected&&(n=u.id),i.set(u.id,u);break;case"remote-candidate":a.set(u.id,"".concat(u.address,":").concat(u.port));break}}),n==="")return;const c=(e=i.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(c!==void 0)return a.get(c)})}setMungedSDP(e,n,i){return L(this,void 0,void 0,function*(){if(n){const a=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(i?"remote":"local"," description"),this.logContext),i?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(o){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:o,sdp:n})),e.sdp=a}}try{i?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(a){let o="unknown error";a instanceof Error?o=a.message:typeof a=="string"&&(o=a);const c={error:o,sdp:e.sdp};throw!i&&this.pc.remoteDescription&&(c.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:c})),new Ug(o)}})}ensureVideoDDExtensionForSVC(e,n){var i,a;if(!((i=e.ext)===null||i===void 0?void 0:i.some(c=>c.uri===CE))){if(this.ddExtID===0){let c=0;n.media.forEach(u=>{var d;u.type==="video"&&((d=u.ext)===null||d===void 0||d.forEach(h=>{h.value>c&&(c=h.value)}))}),this.ddExtID=c+1}(a=e.ext)===null||a===void 0||a.push({value:this.ddExtID,uri:CE})}}}function jE(t,e,n){let i=0;t.rtp.some(a=>a.codec==="opus"?(i=a.payload,!0):!1),i>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(a=>a.payload===i&&a.type==="nack")&&t.rtcpFb.push({payload:i,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(a=>a.payload===i?(a.config.includes("stereo=1")||(a.config+=";stereo=1"),!0):!1))}function OL(t){var e;const n=[],i=[],a=Ca.parse((e=t.sdp)!==null&&e!==void 0?e:"");let o=0;return a.media.forEach(c=>{var u;c.type==="audio"&&(c.rtp.some(d=>d.codec==="opus"?(o=d.payload,!0):!1),!((u=c.rtcpFb)===null||u===void 0)&&u.some(d=>d.payload===o&&d.type==="nack")&&i.push(c.mid),c.fmtp.some(d=>d.payload===o?(d.config.includes("sprop-stereo=1")&&n.push(c.mid),!0):!1))}),{stereoMids:n,nackMids:i}}function UE(t){if(t.connection){const e=t.connection.ip.indexOf(":")>=0;(t.connection.version===4&&e||t.connection.version===6&&!e)&&(t.connection.ip="0.0.0.0",t.connection.version=4)}}const Qg="vp8",NL={audioPreset:Bg.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Vv.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Qg,backupCodec:!0,preConnectBuffer:!1},_w={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},ww={deviceId:{ideal:"default"},resolution:Vc.h720.resolution},DL={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new bP,disconnectOnPageLeave:!0,webAudioMix:!1},Gv={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var At;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(At||(At={}));class ML{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,i){var a;this.peerConnectionTimeout=Gv.peerConnectionTimeout,this.log=Qe,this.updateState=()=>{var o;const c=this.state,u=this.requiredTransports.map(d=>d.getConnectionState());u.every(d=>d==="connected")?this.state=At.CONNECTED:u.some(d=>d==="failed")?this.state=At.FAILED:u.some(d=>d==="connecting")?this.state=At.CONNECTING:u.every(d=>d==="closed")?this.state=At.CLOSED:u.some(d=>d==="closed")?this.state=At.CLOSING:u.every(d=>d==="new")&&(this.state=At.NEW),c!==this.state&&(this.log.debug("pc state change: from ".concat(At[c]," to ").concat(At[this.state]),this.logContext),(o=this.onStateChange)===null||o===void 0||o.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Ur((a=i.loggerName)!==null&&a!==void 0?a:Ai.PCManager),this.loggerOptions=i,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n,this.publisher=new IE(e,i),this.subscriber=new IE(e,i),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=o=>{var c;(c=this.onIceCandidate)===null||c===void 0||c.call(this,o,_i.PUBLISHER)},this.subscriber.onIceCandidate=o=>{var c;(c=this.onIceCandidate)===null||c===void 0||c.call(this,o,_i.SUBSCRIBER)},this.subscriber.onDataChannel=o=>{var c;(c=this.onDataChannel)===null||c===void 0||c.call(this,o)},this.subscriber.onTrack=o=>{var c;(c=this.onTrack)===null||c===void 0||c.call(this,o)},this.publisher.onOffer=(o,c)=>{var u;(u=this.onPublisherOffer)===null||u===void 0||u.call(this,o,c)},this.state=At.NEW,this.connectionLock=new xn,this.remoteOfferLock=new xn}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,n){return this.publisher.setRemoteDescription(e,n)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return L(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(i){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:i}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return L(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return L(this,void 0,void 0,function*(){n===_i.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,n){return L(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const i=yield this.remoteOfferLock.lock();try{return(yield this.subscriber.setRemoteDescription(e,n))?yield this.subscriber.createAndSetAnswer():void 0}finally{i()}})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){return L(this,void 0,void 0,function*(){var i;const a=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((i=this.requiredTransports)===null||i===void 0?void 0:i.map(o=>this.ensureTransportConnected(o,e,n)))}finally{a()}})}negotiate(e){return L(this,void 0,void 0,function*(){return new Promise((n,i)=>L(this,void 0,void 0,function*(){const a=setTimeout(()=>{i("negotiation timed out")},this.peerConnectionTimeout),o=()=>{clearTimeout(a),i("negotiation aborted")};e.signal.addEventListener("abort",o),this.publisher.once(Vo.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Vo.NegotiationComplete,()=>{clearTimeout(a),n()})}),yield this.publisher.negotiate(c=>{clearTimeout(a),i(c)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===_i.PUBLISHER?this.publisher.getConnectedAddress():e===_i.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){return L(this,arguments,void 0,function(i,a){var o=this;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(i.getConnectionState()!=="connected")return new Promise((d,h)=>L(o,void 0,void 0,function*(){const m=()=>{this.log.warn("abort transport connection",this.logContext),ln.clearTimeout(v),h(new pt("room connection has been cancelled",nt.Cancelled))};a?.signal.aborted&&m(),a?.signal.addEventListener("abort",m);const v=ln.setTimeout(()=>{a?.signal.removeEventListener("abort",m),h(new pt("could not establish pc connection",nt.InternalError))},c);for(;this.state!==At.CONNECTED;)if(yield Rn(50),a?.signal.aborted){h(new pt("room connection has been cancelled",nt.Cancelled));return}ln.clearTimeout(v),a?.signal.removeEventListener("abort",m),d()}))}()})}}class Nt extends Error{constructor(e,n,i){super(n),this.code=e,this.message=BE(n,Nt.MAX_MESSAGE_BYTES),this.data=i?BE(i,Nt.MAX_DATA_BYTES):void 0}static fromProto(e){return new Nt(e.code,e.message,e.data)}toProto(){return new y_({code:this.code,message:this.message,data:this.data})}static builtIn(e,n){return new Nt(Nt.ErrorCode[e],Nt.ErrorMessage[e],n)}}Nt.MAX_MESSAGE_BYTES=256;Nt.MAX_DATA_BYTES=15360;Nt.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};Nt.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const xw=15360;function Yv(t){return new TextEncoder().encode(t).length}function BE(t,e){if(Yv(t)<=e)return t;let n=0,i=t.length;const a=new TextEncoder;for(;n<i;){const o=Math.floor((n+i+1)/2);a.encode(t.slice(0,o)).length<=e?n=o:i=o-1}return t.slice(0,n)}const Kv=2e3;function zf(t,e){if(!e)return 0;let n,i;return"bytesReceived"in t?(n=t.bytesReceived,i=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,i=e.bytesSent),n===void 0||i===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-i)*8*1e3/(t.timestamp-e.timestamp)}const Qv=typeof MediaRecorder<"u";class PL{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const LL=Qv?MediaRecorder:PL;class IL extends LL{constructor(e,n){if(!Qv)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),n);let i,a;const o=()=>a===void 0,c=()=>{this.removeEventListener("dataavailable",i),this.removeEventListener("stop",c),this.removeEventListener("error",u),a?.close(),a=void 0},u=d=>{a?.error(d),this.removeEventListener("dataavailable",i),this.removeEventListener("stop",c),this.removeEventListener("error",u),a=void 0};this.byteStream=new ReadableStream({start:d=>{a=d,i=h=>L(this,void 0,void 0,function*(){let m;if(h.data.arrayBuffer){const v=yield h.data.arrayBuffer();m=new Uint8Array(v)}else if(h.data.byteArray)m=h.data.byteArray;else throw new Error("no data available!");o()||d.enqueue(m)}),this.addEventListener("dataavailable",i)},cancel:()=>{c()}}),this.addEventListener("stop",c),this.addEventListener("error",u)}}function jL(){return Qv}const UL=1e3,BL=1e4;class Rw extends G{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,n,i){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;super(e,n,o),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=$v(()=>L(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>L(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(pe.Ended,this)},this.reacquireTrack=!1,this.providedByUser=a,this.muteLock=new xn,this.pauseUpstreamLock=new xn,this.trackChangeLock=new xn,this.trackChangeLock.lock().then(c=>L(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{c()}})),this._constraints=e.getConstraints(),i&&(this._constraints=i)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==G.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,n){return L(this,void 0,void 0,function*(){var i;if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(o=>{zo(this._mediaStreamTrack,o)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let a;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Po(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),a=this.processor.processedTrack}this.sender&&((i=this.sender.transport)===null||i===void 0?void 0:i.state)!=="closed"&&(yield this.sender.replaceTrack(a??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(o=>{Po(a??e,o)}))})}waitForDimensions(){return L(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:UL;return function*(){var i;if(e.kind===G.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((i=$n())===null||i===void 0?void 0:i.os)==="iOS"&&(yield Rn(10));const a=Date.now();for(;Date.now()-a<n;){const o=e.dimensions;if(o)return o;yield Rn(50)}throw new Lr("unable to get track dimensions after timeout")}()})}setDeviceId(e){return L(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Oa(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Oa(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return L(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===G.Source.ScreenShare)return;const{deviceId:i,groupId:a}=e._mediaStreamTrack.getSettings(),o=e.kind===G.Kind.Audio?"audioinput":"videoinput";return n?Jt.getInstance().normalizeDeviceId(o,i,a):i}()})}mute(){return L(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return L(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,n){return L(this,void 0,void 0,function*(){const i=yield this.trackChangeLock.lock();try{if(!this.sender)throw new Lr("unable to replace an unpublished track");let a,o;return typeof n=="boolean"?a=n:n!==void 0&&(a=n.userProvidedTrack,o=n.stopProcessor),this.providedByUser=a??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),o&&this.processor&&(yield this.internalStopProcessor()),this}finally{i()}})}restart(e){return L(this,void 0,void 0,function*(){this.manuallyStopped=!1;const n=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:i,facingMode:a}=e,o=yP(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const c={audio:!1,video:!1};this.kind===G.Kind.Video?c.video=i||a?{deviceId:i,facingMode:a}:!0:c.audio=i?Object.assign({deviceId:i},o):!0,this.attachedElements.forEach(h=>{zo(this.mediaStreamTrack,h)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const d=(yield navigator.mediaDevices.getUserMedia(c)).getTracks()[0];return this.kind===G.Kind.Video&&(yield d.applyConstraints(o)),d.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(d),this._constraints=e,this.emit(pe.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{n()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?pe.Muted:pe.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return L(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),vw()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return L(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(pe.UpstreamPaused,this);const i=$n();if(i?.name==="Safari"&&Oi(i.version,"12.0")<0)throw new zv("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{n()}})}resumeUpstream(){return L(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(pe.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{n()}})}getRTCStatsReport(){return L(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return L(this,arguments,void 0,function(n){var i=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var o;const c=yield i.trackChangeLock.lock();try{i.log.debug("setting up processor",i.logContext);const u=document.createElement(i.kind),d={kind:i.kind,track:i._mediaStreamTrack,element:u,audioContext:i.audioContext};if(yield n.init(d),i.log.debug("processor initialized",i.logContext),i.processor&&(yield i.internalStopProcessor()),i.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Po(i._mediaStreamTrack,u),u.muted=!0,u.play().catch(h=>{h instanceof DOMException&&h.name==="AbortError"?(i.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},i.logContext),{error:h})),setTimeout(()=>{u.play().catch(m=>{i.log.error("failed to play processor element",Object.assign(Object.assign({},i.logContext),{err:m}))})},100)):i.log.error("failed to play processor element",Object.assign(Object.assign({},i.logContext),{error:h}))}),i.processor=n,i.processorElement=u,i.processor.processedTrack){for(const h of i.attachedElements)h!==i.processorElement&&a&&(zo(i._mediaStreamTrack,h),Po(i.processor.processedTrack,h));yield(o=i.sender)===null||o===void 0?void 0:o.replaceTrack(i.processor.processedTrack)}i.emit(pe.TrackProcessorUpdate,i.processor)}finally{c()}}()})}getProcessor(){return this.processor}stopProcessor(){return L(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const i=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(n)}finally{i()}}()})}internalStopProcessor(){return L(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var i,a;e.processor&&(e.log.debug("stopping processor",e.logContext),(i=e.processor.processedTrack)===null||i===void 0||i.stop(),yield e.processor.destroy(),e.processor=void 0,n||((a=e.processorElement)===null||a===void 0||a.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(pe.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!jL()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let n="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(n)||(n="video/mp4"),this.localTrackRecorder=new IL(this,{mimeType:n})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},BL)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class hf extends Rw{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;super(e,G.Kind.Audio,n,i,o),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>L(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let c;try{c=yield this.getSenderStats()}catch(u){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:u}));return}c&&this.prevStats&&(this._currentBitrate=zf(c,this.prevStats)),this.prevStats=c}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(pe.AudioTrackFeatureUpdate,this,Zt.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(pe.AudioTrackFeatureUpdate,this,Zt.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=a,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return L(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===G.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return L(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const i=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Oa(this._constraints.deviceId);return this.source===G.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||i)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return L(this,void 0,void 0,function*(){let n;if(e){const i=Hv({audio:e});typeof i.audio!="boolean"&&(n=i.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return L(this,void 0,void 0,function*(){const i=yield n.restart.call(this,e);return this.checkForSilence(),i})}startMonitor(){wn()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Kv)))}setProcessor(e){return L(this,void 0,void 0,function*(){var n;const i=yield this.trackChangeLock.lock();try{if(!rr()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const a={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(a),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(pe.TrackProcessorUpdate,this.processor)}finally{i()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return L(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let i;return n.forEach(a=>{a.type==="outbound-rtp"&&(i={type:"audio",streamId:a.id,packetsSent:a.packetsSent,packetsLost:a.packetsLost,bytesSent:a.bytesSent,timestamp:a.timestamp,roundTripTime:a.roundTripTime,jitter:a.jitter})}),i})}checkForSilence(){return L(this,void 0,void 0,function*(){const e=yield Tw(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(pe.AudioSilenceDetected)),e})}}function zL(t,e,n){switch(t.kind){case"audio":return new hf(t,e,!1,void 0,n);case"video":return new mf(t,e,!1,n);default:throw new Lr("unsupported track type: ".concat(t.kind))}}const VL=Object.values(Vc),HL=Object.values(zg),FL=Object.values(Vv),qL=[Vc.h180,Vc.h360],$L=[zg.h180,zg.h360],GL=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var i,a;return new ht(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((i=t.encoding.maxFramerate)!==null&&i!==void 0?i:30)/((a=n.fps)!==null&&a!==void 0?a:30))))),n.fps,t.encoding.priority)}),Wg=["q","h","f"];function Xg(t,e,n,i){var a,o;let c=i?.videoEncoding;t&&(c=i?.screenShareEncoding);const u=i?.simulcast,d=i?.scalabilityMode,h=i?.videoCodec;if(!c&&!u&&!d||!e||!n)return[{}];c||(c=KL(t,e,n,h),Qe.debug("using video encoding",c));const m=c.maxFramerate,v=new ht(e,n,c.maxBitrate,c.maxFramerate,c.priority);if(d&&Xi(h)){const k=new Aw(d),E=[];if(k.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(d));const x=$n();if(Hc()||rr()||x?.name==="Chrome"&&Oi(x?.version,"113")<0){const _=k.suffix=="h"?2:3,N=XP(x);for(let P=0;P<k.spatial;P+=1)E.push({rid:Wg[2-P],maxBitrate:c.maxBitrate/Math.pow(_,P),maxFramerate:v.encoding.maxFramerate,scaleResolutionDownBy:N?Math.pow(2,P):void 0});E[0].scalabilityMode=d}else E.push({maxBitrate:c.maxBitrate,maxFramerate:v.encoding.maxFramerate,scalabilityMode:d});return v.encoding.priority&&(E[0].priority=v.encoding.priority,E[0].networkPriority=v.encoding.priority),Qe.debug("using svc encoding",{encodings:E}),E}if(!u)return[c];let y=[];t?y=(a=VE(i?.screenShareSimulcastLayers))!==null&&a!==void 0?a:zE(t,v):y=(o=VE(i?.videoSimulcastLayers))!==null&&o!==void 0?o:zE(t,v);let T;if(y.length>0){const k=y[0];y.length>1&&([,T]=y);const E=Math.max(e,n);if(E>=960&&T)return Lp(e,n,[k,T,v],m);if(E>=480)return Lp(e,n,[k,v],m)}return Lp(e,n,[v])}function YL(t,e,n){var i,a,o,c;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&Qe.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const u=t.mediaStreamTrack.getSettings(),d=(i=u.width)!==null&&i!==void 0?i:(a=t.dimensions)===null||a===void 0?void 0:a.width,h=(o=u.height)!==null&&o!==void 0?o:(c=t.dimensions)===null||c===void 0?void 0:c.height;return t.source===G.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),Xg(t.source===G.Source.ScreenShare,d,h,n)}function KL(t,e,n,i){const a=QL(t,e,n);let{encoding:o}=a[0];const c=Math.max(e,n);for(let u=0;u<a.length;u+=1){const d=a[u];if(o=d.encoding,d.width>=c)break}if(i)switch(i){case"av1":case"h265":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.7;break;case"vp9":o=Object.assign({},o),o.maxBitrate=o.maxBitrate*.85;break}return o}function QL(t,e,n){if(t)return FL;const i=e>n?e/n:n/e;return Math.abs(i-16/9)<Math.abs(i-4/3)?VL:HL}function zE(t,e){if(t)return GL(e);const{width:n,height:i}=e,a=n>i?n/i:i/n;return Math.abs(a-16/9)<Math.abs(a-4/3)?qL:$L}function Lp(t,e,n,i){const a=[];if(n.forEach((o,c)=>{if(c>=Wg.length)return;const u=Math.min(t,e),h={rid:Wg[c],scaleResolutionDownBy:Math.max(1,u/Math.min(o.width,o.height)),maxBitrate:o.encoding.maxBitrate},m=i&&o.encoding.maxFramerate?Math.min(i,o.encoding.maxFramerate):o.encoding.maxFramerate;m&&(h.maxFramerate=m);const v=_s()||c===0;o.encoding.priority&&v&&(h.priority=o.encoding.priority,h.networkPriority=o.encoding.priority),a.push(h)}),rr()&&yw()==="ios"){let o;a.forEach(u=>{o?u.maxFramerate&&u.maxFramerate>o&&(o=u.maxFramerate):o=u.maxFramerate});let c=!0;a.forEach(u=>{var d;u.maxFramerate!=o&&(c&&(c=!1,Qe.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Qe.info('Setting framerate of encoding "'.concat((d=u.rid)!==null&&d!==void 0?d:"",'" to ').concat(o)),u.maxFramerate=o)})}return a}function VE(t){if(t)return t.sort((e,n)=>{const{encoding:i}=e,{encoding:a}=n;return i.maxBitrate>a.maxBitrate?1:i.maxBitrate<a.maxBitrate?-1:i.maxBitrate===a.maxBitrate&&i.maxFramerate&&a.maxFramerate?i.maxFramerate>a.maxFramerate?1:-1:0})}class Aw{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function WL(t){return t.source===G.Source.ScreenShare||t.constraints.height&&Oa(t.constraints.height)>=1080?"maintain-resolution":"balanced"}const XL=5e3;class mf extends Rw{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=arguments.length>3?arguments[3]:void 0;super(e,G.Kind.Video,n,i,a),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>L(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let o;try{o=yield this.getSenderStats()}catch(d){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:d}));return}const c=new Map(o.map(d=>[d.rid,d])),u=o.some(d=>d.qualityLimitationReason==="cpu");if(u!==this.isCpuConstrained&&(this.isCpuConstrained=u,this.isCpuConstrained&&this.emit(pe.CpuConstrained)),this.prevStats){let d=0;c.forEach((h,m)=>{var v;const y=(v=this.prevStats)===null||v===void 0?void 0:v.get(m);d+=zf(h,y)}),this._currentBitrate=d}this.prevStats=c}),this.senderLock=new xn}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!wn())return;const i=(n=this.sender)===null||n===void 0?void 0:n.getParameters();i&&(this.encodings=i.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Kv))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return L(this,void 0,void 0,function*(){var n,i,a,o,c;yield e.pauseUpstream.call(this);try{for(var u=!0,d=Pr(this.simulcastCodecs.values()),h;h=yield d.next(),n=h.done,!n;u=!0)o=h.value,u=!1,yield(c=o.sender)===null||c===void 0?void 0:c.replaceTrack(null)}catch(m){i={error:m}}finally{try{!u&&!n&&(a=d.return)&&(yield a.call(d))}finally{if(i)throw i.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return L(this,void 0,void 0,function*(){var n,i,a,o,c;yield e.resumeUpstream.call(this);try{for(var u=!0,d=Pr(this.simulcastCodecs.values()),h;h=yield d.next(),n=h.done,!n;u=!0){o=h.value,u=!1;const m=o;yield(c=m.sender)===null||c===void 0?void 0:c.replaceTrack(m.mediaStreamTrack)}}catch(m){i={error:m}}finally{try{!u&&!n&&(a=d.return)&&(yield a.call(d))}finally{if(i)throw i.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return L(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===G.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return L(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.source===G.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){return L(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],i=yield this.sender.getStats();return i.forEach(a=>{var o;if(a.type==="outbound-rtp"){const c={type:"video",streamId:a.id,frameHeight:a.frameHeight,frameWidth:a.frameWidth,framesPerSecond:a.framesPerSecond,framesSent:a.framesSent,firCount:a.firCount,pliCount:a.pliCount,nackCount:a.nackCount,packetsSent:a.packetsSent,bytesSent:a.bytesSent,qualityLimitationReason:a.qualityLimitationReason,qualityLimitationDurations:a.qualityLimitationDurations,qualityLimitationResolutionChanges:a.qualityLimitationResolutionChanges,rid:(o=a.rid)!==null&&o!==void 0?o:a.id,retransmittedPacketsSent:a.retransmittedPacketsSent,targetBitrate:a.targetBitrate,timestamp:a.timestamp},u=i.get(a.remoteId);u&&(c.jitter=u.jitter,c.packetsLost=u.packetsLost,c.roundTripTime=u.roundTripTime),n.push(c)}}),n.sort((a,o)=>{var c,u;return((c=o.frameWidth)!==null&&c!==void 0?c:0)-((u=a.frameWidth)!==null&&u!==void 0?u:0)}),n})}setPublishingQuality(e){const n=[];for(let i=qn.LOW;i<=qn.HIGH;i+=1)n.push(new jv({quality:i,enabled:i<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(Xi(this.codec),n)}restartTrack(e){return L(this,void 0,void 0,function*(){var n,i,a,o,c;let u;if(e){const v=Hv({video:e});typeof v.video!="boolean"&&(u=v.video)}yield this.restart(u),this.isCpuConstrained=!1;try{for(var d=!0,h=Pr(this.simulcastCodecs.values()),m;m=yield h.next(),n=m.done,!n;d=!0){o=m.value,d=!1;const v=o;v.sender&&((c=v.sender.transport)===null||c===void 0?void 0:c.state)!=="closed"&&(v.mediaStreamTrack=this.mediaStreamTrack.clone(),yield v.sender.replaceTrack(v.mediaStreamTrack))}}catch(v){i={error:v}}finally{try{!d&&!n&&(a=h.return)&&(yield a.call(h))}finally{if(i)throw i.error}}})}setProcessor(e){const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return L(this,arguments,void 0,function(i){var a=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var c,u,d,h,m,v;if(yield n.setProcessor.call(a,i,o),!((m=a.processor)===null||m===void 0)&&m.processedTrack)try{for(var y=!0,T=Pr(a.simulcastCodecs.values()),k;k=yield T.next(),c=k.done,!c;y=!0)h=k.value,y=!1,yield(v=h.sender)===null||v===void 0?void 0:v.replaceTrack(a.processor.processedTrack)}catch(E){u={error:E}}finally{try{!y&&!c&&(d=T.return)&&(yield d.call(T))}finally{if(u)throw u.error}}}()})}setDegradationPreference(e){return L(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const n=this.sender.getParameters();n.degradationPreference=e,this.sender.setParameters(n)}catch(n){this.log.warn("failed to set degradationPreference",Object.assign({error:n},this.logContext))}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const i={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,i),i}setSimulcastTrackSender(e,n){const i=this.simulcastCodecs.get(e);i&&(i.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},XL))}setPublishingCodecs(e){return L(this,void 0,void 0,function*(){var n,i,a,o,c,u,d;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(Xi(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const h=[];try{for(n=!0,i=Pr(e);a=yield i.next(),o=a.done,!o;n=!0){d=a.value,n=!1;const m=d;if(!this.codec||this.codec===m.codec)yield this.setPublishingLayers(Xi(m.codec),m.qualities);else{const v=this.simulcastCodecs.get(m.codec);if(this.log.debug("try setPublishingCodec for ".concat(m.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:v})),!v||!v.sender){for(const y of m.qualities)if(y.enabled){h.push(m.codec);break}}else v.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(m.codec),this.logContext),yield HE(v.sender,v.encodings,m.qualities,this.senderLock,Xi(m.codec),this.log,this.logContext))}}}catch(m){c={error:m}}finally{try{!n&&!o&&(u=i.return)&&(yield u.call(i))}finally{if(c)throw c.error}}return h})}setPublishingLayers(e,n){return L(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:n}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:n})),!(!this.sender||!this.encodings)&&(yield HE(this.sender,this.encodings,n,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return L(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const n=this.sender.getParameters();n.encodings=n.encodings.map((i,a)=>{var o;return Object.assign(Object.assign({},i),{active:a===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((o=this.mediaStreamTrack.getSettings().height)!==null&&o!==void 0?o:360)/360)),scalabilityMode:a===0&&Xi(this.codec)?"L1T3":void 0,maxFramerate:a===0?15:0,maxBitrate:a===0?i.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:n.encodings})),this.encodings=n.encodings,yield this.sender.setParameters(n)}catch(n){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:n})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return L(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),vw()&&this.isInBackground&&this.source===G.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function HE(t,e,n,i,a,o,c){return L(this,void 0,void 0,function*(){const u=yield i.lock();o.debug("setPublishingLayersForSender",Object.assign(Object.assign({},c),{sender:t,qualities:n,senderEncodings:e}));try{const d=t.getParameters(),{encodings:h}=d;if(!h)return;if(h.length!==e.length){o.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},c),{encodings:h,senderEncodings:e}));return}let m=!1;!1&&h[0].scalabilityMode||(a&&n.some(T=>T.enabled)&&n.forEach(T=>T.enabled=!0),h.forEach((y,T)=>{var k;let E=(k=y.rid)!==null&&k!==void 0?k:"";E===""&&(E="q");const x=Ow(E),_=n.find(N=>N.quality===x);_&&y.active!==_.enabled&&(m=!0,y.active=_.enabled,o.debug("setting layer ".concat(_.quality," to ").concat(y.active?"enabled":"disabled"),c),_s()&&(_.enabled?(y.scaleResolutionDownBy=e[T].scaleResolutionDownBy,y.maxBitrate=e[T].maxBitrate,y.maxFrameRate=e[T].maxFrameRate):(y.scaleResolutionDownBy=4,y.maxBitrate=10,y.maxFrameRate=2)))})),m&&(d.encodings=h,o.debug("setting encodings",Object.assign(Object.assign({},c),{encodings:d.encodings})),yield t.setParameters(d))}finally{u()}})}function Ow(t){switch(t){case"f":return qn.HIGH;case"h":return qn.MEDIUM;case"q":return qn.LOW;default:return qn.HIGH}}function FE(t,e,n,i){if(!n)return[new ys({quality:qn.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(i){const a=n[0].scalabilityMode,o=new Aw(a),c=[],u=o.suffix=="h"?1.5:2,d=o.suffix=="h"?2:3;for(let h=0;h<o.spatial;h+=1)c.push(new ys({quality:Math.min(qn.HIGH,o.spatial-1)-h,width:Math.ceil(t/Math.pow(u,h)),height:Math.ceil(e/Math.pow(u,h)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(d,h)):0,ssrc:0}));return c}return n.map(a=>{var o,c,u;const d=(o=a.scaleResolutionDownBy)!==null&&o!==void 0?o:1;let h=Ow((c=a.rid)!==null&&c!==void 0?c:"");return new ys({quality:h,width:Math.ceil(t/d),height:Math.ceil(e/d),bitrate:(u=a.maxBitrate)!==null&&u!==void 0?u:0,ssrc:0})})}const qE="_lossy",$E="_reliable",ZL=2*1e3,Ip="leave-reconnect",JL=3e4;var Ei;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(Ei||(Ei={}));class e5 extends or.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Gv.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=Ei.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Qe,this.reliableDataSequence=1,this.reliableMessageBuffer=new NE,this.reliableReceivedState=new kL(JL),this.handleDataChannel=i=>L(this,[i],void 0,function(a){var o=this;let{channel:c}=a;return function*(){if(c){if(c.label===$E)o.reliableDCSub=c;else if(c.label===qE)o.lossyDCSub=c;else return;o.log.debug("on data channel ".concat(c.id,", ").concat(c.label),o.logContext),c.onmessage=o.handleDataMessage}}()}),this.handleDataMessage=i=>L(this,void 0,void 0,function*(){var a,o;const c=yield this.dataProcessLock.lock();try{let u;if(i.data instanceof ArrayBuffer)u=i.data;else if(i.data instanceof Blob)u=yield i.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:i.data}));return}const d=kn.fromBinary(new Uint8Array(u));if(d.sequence>0&&d.participantSid!==""){const h=this.reliableReceivedState.get(d.participantSid);if(h&&d.sequence<=h)return;this.reliableReceivedState.set(d.participantSid,d.sequence)}((a=d.value)===null||a===void 0?void 0:a.case)==="speaker"?this.emit(ve.ActiveSpeakersUpdate,d.value.value.speakers):(((o=d.value)===null||o===void 0?void 0:o.case)==="user"&&n5(d,d.value.value),this.emit(ve.DataPacketReceived,d))}finally{c()}}),this.handleDataError=i=>{const o=i.currentTarget.maxRetransmits===0?"lossy":"reliable";if(i instanceof ErrorEvent&&i.error){const{error:c}=i.error;this.log.error("DataChannel error on ".concat(o,": ").concat(i.message),Object.assign(Object.assign({},this.logContext),{error:c}))}else this.log.error("Unknown DataChannel error on ".concat(o),Object.assign(Object.assign({},this.logContext),{event:i}))},this.handleBufferedAmountLow=i=>{const o=i.currentTarget.maxRetransmits===0?Ge.LOSSY:Ge.RELIABLE;this.updateAndEmitDCBufferStatus(o)},this.handleDisconnect=(i,a)=>{if(this._isClosed)return;this.log.warn("".concat(i," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const o=d=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(d,"ms. giving up"),this.logContext),this.emit(ve.Disconnected),this.close()},c=Date.now()-this.reconnectStart;let u=this.getNextRetryDelay({elapsedMs:c,retryCount:this.reconnectAttempts});if(u===null){o(c);return}i===Ip&&(u=0),this.log.debug("reconnecting in ".concat(u,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=ln.setTimeout(()=>this.attemptReconnect(a).finally(()=>this.reconnectTimeout=void 0),u)},this.waitForRestarted=()=>new Promise((i,a)=>{this.pcState===Ei.Connected&&i();const o=()=>{this.off(ve.Disconnected,c),i()},c=()=>{this.off(ve.Restarted,o),a()};this.once(ve.Restarted,o),this.once(ve.Disconnected,c)}),this.updateAndEmitDCBufferStatus=i=>{const a=this.isBufferStatusLow(i);typeof a<"u"&&a!==this.dcBufferStatus.get(i)&&(this.dcBufferStatus.set(i,a),this.emit(ve.DCBufferStatusChanged,a,i))},this.isBufferStatusLow=i=>{const a=this.dataChannelForKind(i);if(a)return i===Ge.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(a.bufferedAmount),a.bufferedAmount<=a.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===St.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Co.RR_SIGNAL_DISCONNECTED))},this.log=Ur((n=e.loggerName)!==null&&n!==void 0?n:Ai.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Fv(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new xn,this.dataProcessLock=new xn,this.dcBufferStatus=new Map([[Ge.LOSSY,!0],[Ge.RELIABLE,!0]]),this.client.onParticipantUpdate=i=>this.emit(ve.ParticipantUpdate,i),this.client.onConnectionQuality=i=>this.emit(ve.ConnectionQualityUpdate,i),this.client.onRoomUpdate=i=>this.emit(ve.RoomUpdate,i),this.client.onSubscriptionError=i=>this.emit(ve.SubscriptionError,i),this.client.onSubscriptionPermissionUpdate=i=>this.emit(ve.SubscriptionPermissionUpdate,i),this.client.onSpeakersChanged=i=>this.emit(ve.SpeakersChanged,i),this.client.onStreamStateUpdate=i=>this.emit(ve.StreamStateChanged,i),this.client.onRequestResponse=i=>this.emit(ve.SignalRequestResponse,i)}get logContext(){var e,n,i,a,o,c;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomID:(a=(i=this.latestJoinResponse)===null||i===void 0?void 0:i.room)===null||a===void 0?void 0:a.sid,participant:(c=(o=this.latestJoinResponse)===null||o===void 0?void 0:o.participant)===null||c===void 0?void 0:c.identity,pID:this.participantSid}}join(e,n,i,a){return L(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=i,this.maxJoinAttempts=i.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const o=yield this.client.join(e,n,i,a);return this._isClosed=!1,this.latestJoinResponse=o,this.subscriberPrimary=o.subscriberPrimary,this.pcManager||(yield this.configure(o)),(!this.subscriberPrimary||o.fastPublish)&&this.negotiate(),this.clientConfiguration=o.clientConfiguration,this.emit(ve.SignalConnected,o),o}catch(o){if(o instanceof pt&&o.reason===nt.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,i,a);throw o}})}close(){return L(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(ve.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return L(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=i=>{i&&(i.close(),i.onbufferedamountlow=null,i.onclose=null,i.onclosing=null,i.onerror=null,i.onmessage=null,i.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new NE,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return L(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Lr("a track with the same ID has already been published");return new Promise((n,i)=>{const a=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],i(new pt("publication of local track timed out, no response from server",nt.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:o=>{clearTimeout(a),n(o)},reject:()=>{clearTimeout(a),i(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return L(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return L(this,void 0,void 0,function*(){var n,i;if(this.pcManager&&this.pcManager.currentState!==At.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const a=this.makeRTCConfiguration(e);this.pcManager=new ML(a,e.subscriberPrimary,this.loggerOptions),this.emit(ve.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(o,c)=>{this.client.sendIceCandidate(o,c)},this.pcManager.onPublisherOffer=(o,c)=>{this.client.sendOffer(o,c)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(o,c,u)=>L(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(o),this.logContext),["closed","disconnected","failed"].includes(c)&&(this.publisherConnectionPromise=void 0),o===At.CONNECTED){const m=this.pcState===Ei.New;this.pcState=Ei.Connected,m&&this.emit(ve.Connected,e)}else o===At.FAILED&&this.pcState===Ei.Connected&&(this.pcState=Ei.Disconnected,this.handleDisconnect("peerconnection failed",u==="failed"?Co.RR_SUBSCRIBER_FAILED:Co.RR_PUBLISHER_FAILED));const d=this.client.isDisconnected||this.client.currentState===St.RECONNECTING,h=[At.FAILED,At.CLOSING,At.CLOSED].includes(o);d&&h&&!this._isClosed&&this.emit(ve.Offline)}),this.pcManager.onTrack=o=>{this.emit(ve.MediaTrackAdded,o.track,o.streams[0],o.receiver)},t5((i=e.serverInfo)===null||i===void 0?void 0:i.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,n)=>L(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e,n))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=(e,n)=>L(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=n,!this.pcManager)return;const i=yield this.pcManager.createSubscriberAnswerFromOffer(e,n);i&&this.client.sendAnswer(i,n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:i}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],i(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(ve.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(ve.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(ve.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(ve.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var n;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(ve.RoomMoved,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Co.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e?.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case Uo.DISCONNECT:this.emit(ve.Disconnected,e?.reason),this.close();break;case Uo.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Ip);break;case Uo.RESUME:this.handleDisconnect(Ip)}}}makeRTCConfiguration(e){var n;const i=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),i.encodedInsertableStreams=!0),e.iceServers&&!i.iceServers){const a=[];e.iceServers.forEach(o=>{const c={urls:o.urls};o.username&&(c.username=o.username),o.credential&&(c.credential=o.credential),a.push(c)}),i.iceServers=a}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Uc.ENABLED&&(i.iceTransportPolicy="relay"),i.sdpSemantics="unified-plan",i.continualGatheringPolicy="gather_continually",i}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(qE,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel($E,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,n,i){return L(this,void 0,void 0,function*(){if(Vg())return yield this.createTransceiverRTCRtpSender(e,n,i);if(Hg())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new $t("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,i,a){return L(this,void 0,void 0,function*(){if(Vg())return this.createSimulcastTransceiverSender(e,n,i,a);if(Hg())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new $t("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,i){return L(this,void 0,void 0,function*(){if(!this.pcManager)throw new $t("publisher is closed");const a=[];e.mediaStream&&a.push(e.mediaStream),Ba(e)&&(e.codec=n.videoCodec);const o={direction:"sendonly",streams:a};return i&&(o.sendEncodings=i),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,o)).sender})}createSimulcastTransceiverSender(e,n,i,a){return L(this,void 0,void 0,function*(){if(!this.pcManager)throw new $t("publisher is closed");const o={direction:"sendonly"};a&&(o.sendEncodings=a);const c=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,o);if(i.videoCodec)return e.setSimulcastTrackSender(i.videoCodec,c.sender),c.sender})}createRTCRtpSender(e){return L(this,void 0,void 0,function*(){if(!this.pcManager)throw new $t("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return L(this,void 0,void 0,function*(){var n,i,a;if(!this._isClosed){if(this.attemptingReconnect){Qe.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Uc.DISABLED||((a=(i=this.pcManager)===null||i===void 0?void 0:i.currentState)!==null&&a!==void 0?a:At.NEW)===At.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(o){this.reconnectAttempts+=1;let c=!0;o instanceof $t?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:o})),c=!1):o instanceof ko||(this.fullReconnectOnNext=!0),c?this.handleDisconnect("reconnect",Co.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(ve.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){return L(this,void 0,void 0,function*(){var n,i,a;try{if(!this.url||!this.token)throw new $t("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(ve.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let o;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new ko;o=yield this.join(e??this.url,this.token,this.signalOpts)}catch(c){throw c instanceof pt&&c.reason===nt.NotAllowed?new $t("could not reconnect, token might be expired"):new ko}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(ve.SignalRestarted,o),yield this.waitForPCReconnected(),this.client.currentState!==St.CONNECTED)throw new ko("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(ve.Restarted)}catch(o){const c=yield(i=this.regionUrlProvider)===null||i===void 0?void 0:i.getNextBestRegionUrl();if(c){yield this.restartConnection(c);return}else throw(a=this.regionUrlProvider)===null||a===void 0||a.resetAttempts(),o}})}resumeConnection(e){return L(this,void 0,void 0,function*(){var n;if(!this.url||!this.token)throw new $t("could not reconnect, url or token not saved");if(!this.pcManager)throw new $t("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(ve.Resuming);let i;try{this.setupSignalClientCallbacks(),i=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(a){let o="";throw a instanceof Error&&(o=a.message,this.log.error(a.message,Object.assign(Object.assign({},this.logContext),{error:a}))),a instanceof pt&&a.reason===nt.NotAllowed?new $t("could not reconnect, token might be expired"):a instanceof pt&&a.reason===nt.LeaveRequest?a:new ko(o)}if(this.emit(ve.SignalResumed),i){const a=this.makeRTCConfiguration(i);this.pcManager.updateConfiguration(a),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=i.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==St.CONNECTED)throw new ko("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),i?.lastMessageSeq&&this.resendReliableMessagesForResume(i.lastMessageSeq),this.emit(ve.Resumed)})}waitForPCInitialConnection(e,n){return L(this,void 0,void 0,function*(){if(!this.pcManager)throw new $t("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return L(this,void 0,void 0,function*(){this.pcState=Ei.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Rn(ZL),!this.pcManager)throw new $t("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Ei.Connected}catch(e){throw this.pcState=Ei.Disconnected,new pt("could not establish PC connection, ".concat(e.message),nt.InternalError)}})}publishRpcResponse(e,n,i,a){return L(this,void 0,void 0,function*(){const o=new kn({destinationIdentities:[e],kind:Ge.RELIABLE,value:{case:"rpcResponse",value:new b_({requestId:n,value:a?{case:"error",value:a.toProto()}:{case:"payload",value:i??""}})}});yield this.sendDataPacket(o,Ge.RELIABLE)})}publishRpcAck(e,n){return L(this,void 0,void 0,function*(){const i=new kn({destinationIdentities:[e],kind:Ge.RELIABLE,value:{case:"rpcAck",value:new v_({requestId:n})}});yield this.sendDataPacket(i,Ge.RELIABLE)})}sendDataPacket(e,n){return L(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(n),n===Ge.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const i=e.toBinary(),a=this.dataChannelForKind(n);if(a){if(n===Ge.RELIABLE&&this.reliableMessageBuffer.push({data:i,sequence:e.sequence}),this.attemptingReconnect)return;a.send(i)}this.updateAndEmitDCBufferStatus(n)})}resendReliableMessagesForResume(e){return L(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(Ge.RELIABLE);const n=this.dataChannelForKind(Ge.RELIABLE);n&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(i=>{n.send(i.data)})),this.updateAndEmitDCBufferStatus(Ge.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((n,i)=>L(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))n();else{const a=()=>i("Engine closed");for(this.once(ve.Closing,a);!this.dcBufferStatus.get(e);)yield Rn(10);this.off(ve.Closing,a),n()}}))}ensureDataTransportConnected(e){return L(this,arguments,void 0,function(n){var i=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var o;if(!i.pcManager)throw new $t("PC manager is closed");const c=a?i.pcManager.subscriber:i.pcManager.publisher,u=a?"Subscriber":"Publisher";if(!c)throw new pt("".concat(u," connection not set"),nt.InternalError);let d=!1;!a&&!i.dataChannelForKind(n,a)&&(i.createDataChannels(),d=!0),!d&&!a&&!i.pcManager.publisher.isICEConnected&&i.pcManager.publisher.getICEConnectionState()!=="checking"&&(d=!0),d&&i.negotiate();const h=i.dataChannelForKind(n,a);if(h?.readyState==="open")return;const m=new Date().getTime()+i.peerConnectionTimeout;for(;new Date().getTime()<m;){if(c.isICEConnected&&((o=i.dataChannelForKind(n,a))===null||o===void 0?void 0:o.readyState)==="open")return;yield Rn(50)}throw new pt("could not establish ".concat(u," connection, state: ").concat(c.getICEConnectionState()),nt.InternalError)}()})}ensurePublisherConnected(e){return L(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==At.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return L(this,void 0,void 0,function*(){return new Promise((e,n)=>L(this,void 0,void 0,function*(){if(!this.pcManager){n(new Ug("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const i=new AbortController,a=()=>{i.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(ve.Closing,a),this.pcManager.publisher.once(Vo.RTPVideoPayloadTypes,o=>{const c=new Map;o.forEach(u=>{const d=u.codec.toLowerCase();nL(d)&&c.set(u.payload,d)}),this.emit(ve.RTPVideoMapUpdate,c)});try{yield this.pcManager.negotiate(i),e()}catch(o){o instanceof Ug&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Co.RR_UNKNOWN),n(o)}finally{this.off(ve.Closing,a)}}))})}dataChannelForKind(e,n){if(n){if(e===Ge.LOSSY)return this.lossyDCSub;if(e===Ge.RELIABLE)return this.reliableDCSub}else{if(e===Ge.LOSSY)return this.lossyDC;if(e===Ge.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var i,a;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const o=this.pcManager.subscriber.getLocalDescription(),c=this.pcManager.subscriber.getRemoteDescription(),u=(a=(i=this.signalOpts)===null||i===void 0?void 0:i.autoSubscribe)!==null&&a!==void 0?a:!0,d=new Array,h=new Array;e.forEach(m=>{m.isDesired!==u&&d.push(m.trackSid),m.isEnabled||h.push(m.trackSid)}),this.client.sendSyncState(new L_({answer:o?ff({sdp:o.sdp,type:o.type}):void 0,offer:c?ff({sdp:c.sdp,type:c.type}):void 0,subscription:new jf({trackSids:d,subscribe:!u,participantTracks:[]}),publishTracks:dL(n),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:h,datachannelReceiveStates:this.reliableReceivedState.map((m,v)=>new I_({publisherSid:v,lastSeq:m}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(i,a)=>{i?.id!==void 0&&i.id!==null&&e.push(new j_({label:i.label,id:i.id,target:a}))};return n(this.dataChannelForKind(Ge.LOSSY),_i.PUBLISHER),n(this.dataChannelForKind(Ge.RELIABLE),_i.PUBLISHER),n(this.dataChannelForKind(Ge.LOSSY,!0),_i.SUBSCRIBER),n(this.dataChannelForKind(Ge.RELIABLE,!0),_i.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&ln.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){wn()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){wn()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class ko extends Error{}function t5(t){return t!==void 0&&t>13}function n5(t,e){const n=t.participantIdentity?t.participantIdentity:e.participantIdentity;t.participantIdentity=n,e.participantIdentity=n;const i=t.destinationIdentities.length!==0?t.destinationIdentities:e.destinationIdentities;t.destinationIdentities=i,e.destinationIdentities=i}class Zg{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return qg(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return L(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(i=>!this.attemptedRegions.find(a=>a.url===i.url));if(n.length>0){const i=n[0];return this.attemptedRegions.push(i),Qe.debug("next region: ".concat(i.region)),i.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return L(this,void 0,void 0,function*(){const n=yield fetch("".concat(i5(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const i=yield n.json();return this.lastUpdateAt=Date.now(),i}else throw new pt("Could not fetch region settings: ".concat(n.statusText),n.status===401?nt.NotAllowed:nt.InternalError,n.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function i5(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}class Nw{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new wa("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),wi.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new wa("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),wi.LengthExceeded)}}constructor(e,n,i,a){this.reader=n,this.totalByteSize=i,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=a}}class r5 extends Nw{handleChunkReceived(e){var n;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const i=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,i)}[Symbol.asyncIterator](){const e=this.reader.getReader();let n=new Zi,i=null,a=null;if(this.signal){const c=this.signal;a=()=>{var u;(u=n.reject)===null||u===void 0||u.call(n,c.reason)},c.addEventListener("abort",a),i=c}const o=()=>{e.releaseLock(),i&&a&&i.removeEventListener("abort",a),this.signal=void 0};return{next:()=>L(this,void 0,void 0,function*(){var c,u;try{const{done:d,value:h}=yield Promise.race([e.read(),n.promise,(u=(c=this.outOfBandFailureRejectingFuture)===null||c===void 0?void 0:c.promise)!==null&&u!==void 0?u:new Promise(()=>{})]);return d?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(h),{done:!1,value:h.content})}catch(d){throw o(),d}}),return(){return L(this,void 0,void 0,function*(){return o(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return L(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var i,a,o,c;let u=new Set;const d=n.signal?e.withAbortSignal(n.signal):e;try{for(var h=!0,m=Pr(d),v;v=yield m.next(),i=v.done,!i;h=!0){c=v.value,h=!1;const y=c;u.add(y)}}catch(y){a={error:y}}finally{try{!h&&!i&&(o=m.return)&&(yield o.call(m))}finally{if(a)throw a.error}}return Array.from(u)}()})}}class a5 extends Nw{constructor(e,n,i,a){super(e,n,i,a),this.receivedChunks=new Map}handleChunkReceived(e){var n;const i=ef(e.chunkIndex),a=this.receivedChunks.get(i);if(a&&a.version>e.version)return;this.receivedChunks.set(i,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const o=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,o)}[Symbol.asyncIterator](){const e=this.reader.getReader(),n=new TextDecoder("utf-8",{fatal:!0});let i=new Zi,a=null,o=null;if(this.signal){const u=this.signal;o=()=>{var d;(d=i.reject)===null||d===void 0||d.call(i,u.reason)},u.addEventListener("abort",o),a=u}const c=()=>{e.releaseLock(),a&&o&&a.removeEventListener("abort",o),this.signal=void 0};return{next:()=>L(this,void 0,void 0,function*(){var u,d;try{const{done:h,value:m}=yield Promise.race([e.read(),i.promise,(d=(u=this.outOfBandFailureRejectingFuture)===null||u===void 0?void 0:u.promise)!==null&&d!==void 0?d:new Promise(()=>{})]);if(h)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(m);let v;try{v=n.decode(m.content)}catch(y){throw new wa("Cannot decode datastream chunk ".concat(m.chunkIndex," as text: ").concat(y),wi.DecodeFailed)}return{done:!1,value:v}}}catch(h){throw c(),h}}),return(){return L(this,void 0,void 0,function*(){return c(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return L(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function*(){var i,a,o,c;let u="";const d=n.signal?e.withAbortSignal(n.signal):e;try{for(var h=!0,m=Pr(d),v;v=yield m.next(),i=v.done,!i;h=!0)c=v.value,h=!1,u+=c}catch(y){a={error:y}}finally{try{!h&&!i&&(o=m.return)&&(yield o.call(m))}finally{if(a)throw a.error}}return u}()})}}class s5{constructor(){this.log=Qe,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,n){if(this.textStreamHandlers.has(e))throw new wa('A text stream handler for topic "'.concat(e,'" has already been set.'),wi.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,n)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,n){if(this.byteStreamHandlers.has(e))throw new wa('A byte stream handler for topic "'.concat(e,'" has already been set.'),wi.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,n)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearHandlersAndControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear(),this.byteStreamHandlers.clear(),this.textStreamHandlers.clear()}validateParticipantHasNoActiveDataStreams(e){var n,i,a,o;const c=Array.from(this.textStreamControllers.entries()).filter(d=>d[1].sendingParticipantIdentity===e),u=Array.from(this.byteStreamControllers.entries()).filter(d=>d[1].sendingParticipantIdentity===e);if(c.length>0||u.length>0){const d=new wa("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),wi.AbnormalEnd);for(const[h,m]of u)(i=(n=m.outOfBandFailureRejectingFuture).reject)===null||i===void 0||i.call(n,d),this.byteStreamControllers.delete(h);for(const[h,m]of c)(o=(a=m.outOfBandFailureRejectingFuture).reject)===null||o===void 0||o.call(a,d),this.textStreamControllers.delete(h)}}handleDataStreamPacket(e){return L(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity);case"streamChunk":return this.handleStreamChunk(e.value.value);case"streamTrailer":return this.handleStreamTrailer(e.value.value);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,n){return L(this,void 0,void 0,function*(){var i;if(e.contentHeader.case==="byteHeader"){const a=this.byteStreamHandlers.get(e.topic);if(!a){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let o;const c=new Zi,u={id:e.streamId,name:(i=e.contentHeader.value.name)!==null&&i!==void 0?i:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:ef(e.timestamp),attributes:e.attributes},d=new ReadableStream({start:h=>{if(o=h,this.textStreamControllers.has(e.streamId))throw new wa("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),wi.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:u,controller:o,startTime:Date.now(),sendingParticipantIdentity:n,outOfBandFailureRejectingFuture:c})}});a(new r5(u,d,ef(e.totalLength),c),{identity:n})}else if(e.contentHeader.case==="textHeader"){const a=this.textStreamHandlers.get(e.topic);if(!a){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let o;const c=new Zi,u={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},d=new ReadableStream({start:h=>{if(o=h,this.textStreamControllers.has(e.streamId))throw new wa("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),wi.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:u,controller:o,startTime:Date.now(),sendingParticipantIdentity:n,outOfBandFailureRejectingFuture:c})}});a(new a5(u,d,ef(e.totalLength),c),{identity:n})}})}handleStreamChunk(e){const n=this.byteStreamControllers.get(e.streamId);n&&e.content.length>0&&n.controller.enqueue(e);const i=this.textStreamControllers.get(e.streamId);i&&e.content.length>0&&i.controller.enqueue(e)}handleStreamTrailer(e){const n=this.textStreamControllers.get(e.streamId);n&&(n.info.attributes=Object.assign(Object.assign({},n.info.attributes),e.attributes),n.controller.close(),this.textStreamControllers.delete(e.streamId));const i=this.byteStreamControllers.get(e.streamId);i&&(i.info.attributes=Object.assign(Object.assign({},i.info.attributes),e.attributes),i.controller.close(),this.byteStreamControllers.delete(e.streamId))}}class Dw{constructor(e,n,i){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=i,this.info=n}write(e){return this.defaultWriter.write(e)}close(){return L(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class o5 extends Dw{}class l5 extends Dw{}const GE=15e3;class c5{constructor(e,n){this.engine=e,this.log=n}setupEngine(e){this.engine=e}sendText(e,n){return L(this,void 0,void 0,function*(){var i;const a=crypto.randomUUID(),c=new TextEncoder().encode(e).byteLength,u=(i=n?.attachments)===null||i===void 0?void 0:i.map(()=>crypto.randomUUID()),d=new Array(u?u.length+1:1).fill(0),h=(v,y)=>{var T;d[y]=v;const k=d.reduce((E,x)=>E+x,0);(T=n?.onProgress)===null||T===void 0||T.call(n,k)},m=yield this.streamText({streamId:a,totalSize:c,destinationIdentities:n?.destinationIdentities,topic:n?.topic,attachedStreamIds:u,attributes:n?.attributes});return yield m.write(e),h(1,0),yield m.close(),n?.attachments&&u&&(yield Promise.all(n.attachments.map((v,y)=>L(this,void 0,void 0,function*(){return this._sendFile(u[y],v,{topic:n.topic,mimeType:v.type,onProgress:T=>{h(T,y+1)}})})))),m.info})}streamText(e){return L(this,void 0,void 0,function*(){var n,i;const a=(n=e?.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),o={id:a,mimeType:"text/plain",timestamp:Date.now(),topic:(i=e?.topic)!==null&&i!==void 0?i:"",size:e?.totalSize,attributes:e?.attributes},c=new kg({streamId:a,mimeType:o.mimeType,topic:o.topic,timestamp:ps(o.timestamp),totalLength:ps(e?.totalSize),attributes:o.attributes,contentHeader:{case:"textHeader",value:new w_({version:e?.version,attachedStreamIds:e?.attachedStreamIds,replyToStreamId:e?.replyToStreamId,operationType:e?.type==="update"?Cg.UPDATE:Cg.CREATE})}}),u=e?.destinationIdentities,d=new kn({destinationIdentities:u,value:{case:"streamHeader",value:c}});yield this.engine.sendDataPacket(d,Ge.RELIABLE);let h=0;const m=this.engine,v=new WritableStream({write(k){return L(this,void 0,void 0,function*(){for(const E of lL(k,GE)){yield m.waitForBufferStatusLow(Ge.RELIABLE);const x=new _g({content:E,streamId:a,chunkIndex:ps(h)}),_=new kn({destinationIdentities:u,value:{case:"streamChunk",value:x}});yield m.sendDataPacket(_,Ge.RELIABLE),h+=1}})},close(){return L(this,void 0,void 0,function*(){const k=new wg({streamId:a}),E=new kn({destinationIdentities:u,value:{case:"streamTrailer",value:k}});yield m.sendDataPacket(E,Ge.RELIABLE)})},abort(k){console.log("Sink error:",k)}});let y=()=>L(this,void 0,void 0,function*(){yield T.close()});m.once(ve.Closing,y);const T=new o5(v,o,()=>this.engine.off(ve.Closing,y));return T})}sendFile(e,n){return L(this,void 0,void 0,function*(){const i=crypto.randomUUID();return yield this._sendFile(i,e,n),{id:i}})}_sendFile(e,n,i){return L(this,void 0,void 0,function*(){var a;const o=yield this.streamBytes({streamId:e,totalSize:n.size,name:n.name,mimeType:(a=i?.mimeType)!==null&&a!==void 0?a:n.type,topic:i?.topic,destinationIdentities:i?.destinationIdentities}),c=n.stream().getReader();for(;;){const{done:u,value:d}=yield c.read();if(u)break;yield o.write(d)}return yield o.close(),o.info})}streamBytes(e){return L(this,void 0,void 0,function*(){var n,i,a,o,c;const u=(n=e?.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),d=e?.destinationIdentities,h={id:u,mimeType:(i=e?.mimeType)!==null&&i!==void 0?i:"application/octet-stream",topic:(a=e?.topic)!==null&&a!==void 0?a:"",timestamp:Date.now(),attributes:e?.attributes,size:e?.totalSize,name:(o=e?.name)!==null&&o!==void 0?o:"unknown"},m=new kg({totalLength:ps((c=h.size)!==null&&c!==void 0?c:0),mimeType:h.mimeType,streamId:u,topic:h.topic,timestamp:ps(Date.now()),attributes:h.attributes,contentHeader:{case:"byteHeader",value:new x_({name:h.name})}}),v=new kn({destinationIdentities:d,value:{case:"streamHeader",value:m}});yield this.engine.sendDataPacket(v,Ge.RELIABLE);let y=0;const T=new xn,k=this.engine,E=this.log,x=new WritableStream({write(N){return L(this,void 0,void 0,function*(){const P=yield T.lock();let O=0;try{for(;O<N.byteLength;){const A=N.slice(O,O+GE);yield k.waitForBufferStatusLow(Ge.RELIABLE);const w=new kn({destinationIdentities:d,value:{case:"streamChunk",value:new _g({content:A,streamId:u,chunkIndex:ps(y)})}});yield k.sendDataPacket(w,Ge.RELIABLE),y+=1,O+=A.byteLength}}finally{P()}})},close(){return L(this,void 0,void 0,function*(){const N=new wg({streamId:u}),P=new kn({destinationIdentities:d,value:{case:"streamTrailer",value:N}});yield k.sendDataPacket(P,Ge.RELIABLE)})},abort(N){E.error("Sink error:",N)}});return new l5(x,h)})}}class Mw extends G{constructor(e,n,i,a,o){super(e,i,o),this.sid=n,this.receiver=a}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?pe.Muted:pe.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=i=>{i.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(pe.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return L(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Kv)),fL()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var n;this.timeSyncHandle=requestAnimationFrame(()=>e());const i=(n=this.receiver)===null||n===void 0?void 0:n.getSynchronizationSources()[0];if(i){const{timestamp:a,rtpTimestamp:o}=i;o&&this.rtpTimestamp!==o&&(this.emit(pe.TimeSyncUpdate,{timestamp:a,rtpTimestamp:o}),this.rtpTimestamp=o)}};e()}}class Pw extends Mw{constructor(e,n,i,a,o,c){super(e,n,G.Kind.Audio,i,c),this.monitorReceiver=()=>L(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=zf(u,this.prevStats)),this.prevStats=u}),this.audioContext=a,this.webAudioPluginNodes=[],o&&(this.sinkId=o.deviceId)}setVolume(e){var n;for(const i of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):i.volume=e;rr()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(rr())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return L(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(Fg(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Fg(e)&&e.setSinkId(this.sinkId).catch(i=>{this.log.error("Failed to set sink id on remote audio track",i,this.logContext)}),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let i=this.sourceNode;this.webAudioPluginNodes.forEach(a=>{i.connect(a),i=a}),this.gainNode=e.createGain(),i.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(pe.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(a=>{this.emit(pe.AudioPlaybackFailed,a)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return L(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(i=>{i.type==="inbound-rtp"&&(n={type:"audio",streamId:i.id,timestamp:i.timestamp,jitter:i.jitter,bytesReceived:i.bytesReceived,concealedSamples:i.concealedSamples,concealmentEvents:i.concealmentEvents,silentConcealedSamples:i.silentConcealedSamples,silentConcealmentEvents:i.silentConcealmentEvents,totalAudioEnergy:i.totalAudioEnergy,totalSamplesDuration:i.totalSamplesDuration})}),n})}}const jp=100;class u5 extends Mw{constructor(e,n,i,a,o){super(e,n,G.Kind.Video,i,o),this.elementInfos=[],this.monitorReceiver=()=>L(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const c=yield this.getReceiverStats();c&&this.prevStats&&this.receiver&&(this._currentBitrate=zf(c,this.prevStats)),this.prevStats=c}),this.debouncedHandleResize=$v(()=>{this.updateDimensions()},jp),this.adaptiveStreamSettings=a}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),console.log("setStreamState",e),e===G.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?zo(this._mediaStreamTrack,n):Po(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new d5(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(i=>i===e);for(const i of n)i.stopObserving();this.elementInfos=this.elementInfos.filter(i=>i!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const i of n)this.stopObservingElement(i);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return L(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,i="",a=new Map;return e.forEach(o=>{o.type==="inbound-rtp"?(i=o.codecId,n={type:"video",streamId:o.id,framesDecoded:o.framesDecoded,framesDropped:o.framesDropped,framesReceived:o.framesReceived,packetsReceived:o.packetsReceived,packetsLost:o.packetsLost,frameWidth:o.frameWidth,frameHeight:o.frameHeight,pliCount:o.pliCount,firCount:o.firCount,nackCount:o.nackCount,jitter:o.jitter,timestamp:o.timestamp,bytesReceived:o.bytesReceived,decoderImplementation:o.decoderImplementation}):o.type==="codec"&&a.set(o.id,o)}),n&&i!==""&&a.get(i)&&(n.mimeType=a.get(i).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(i=>i.element===e);for(const i of n)this.stopObservingElementInfo(i)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return L(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var n,i;const a=this.elementInfos.reduce((d,h)=>Math.max(d,h.visibilityChangedAt||0),0),o=!((i=(n=this.adaptiveStreamSettings)===null||n===void 0?void 0:n.pauseVideoInBackground)!==null&&i!==void 0)||i?this.isInBackground:!1,c=this.elementInfos.some(d=>d.pictureInPicture),u=this.elementInfos.some(d=>d.visible)&&!o||c;if(!(this.lastVisible===u&&!e)){if(!u&&Date.now()-a<jp){ln.setTimeout(()=>{this.updateVisibility()},jp);return}this.lastVisible=u,this.emit(pe.VisibilityChanged,u,this)}}updateDimensions(){var e,n;let i=0,a=0;const o=this.getPixelDensity();for(const c of this.elementInfos){const u=c.width()*o,d=c.height()*o;u+d>i+a&&(i=u,a=d)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===i&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===a||(this.lastDimensions={width:i,height:a},this.emit(pe.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?kE():n||(kE()>2?2:1)}}class d5{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=i=>{var a;const{target:o,isIntersecting:c}=i;o===this.element&&(this.isIntersecting=c,this.isPiP=yc(this.element),this.visibilityChangedAt=Date.now(),(a=this.handleVisibilityChanged)===null||a===void 0||a.call(this))},this.onEnterPiP=()=>{var i,a,o;(a=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||a===void 0||a.addEventListener("pagehide",this.onLeavePiP),this.isPiP=yc(this.element),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this)},this.onLeavePiP=()=>{var i;this.isPiP=yc(this.element),(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this)},this.element=e,this.isIntersecting=n??Jg(e),this.isPiP=wn()&&yc(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,n,i;this.isIntersecting=Jg(this.element),this.isPiP=yc(this.element),this.element.handleResize=()=>{var a;(a=this.handleResize)===null||a===void 0||a.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,wE().observe(this.element),_E().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(i=(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window)===null||i===void 0||i.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,n,i,a,o;(e=wE())===null||e===void 0||e.unobserve(this.element),(n=_E())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(i=window.documentPictureInPicture)===null||i===void 0||i.removeEventListener("enter",this.onEnterPiP),(o=(a=window.documentPictureInPicture)===null||a===void 0?void 0:a.window)===null||o===void 0||o.removeEventListener("pagehide",this.onLeavePiP)}}function yc(t){var e,n;return document.pictureInPictureElement===t?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Jg(t,(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window):!1}function Jg(t,e){const n=e||window;let i=t.offsetTop,a=t.offsetLeft;const o=t.offsetWidth,c=t.offsetHeight,{hidden:u}=t,{display:d}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,i+=t.offsetTop,a+=t.offsetLeft;return i<n.pageYOffset+n.innerHeight&&a<n.pageXOffset+n.innerWidth&&i+c>n.pageYOffset&&a+o>n.pageXOffset&&!u&&d!=="none"}class Nr extends or.EventEmitter{constructor(e,n,i,a){var o;super(),this.metadataMuted=!1,this.encryption=Fn.NONE,this.log=Qe,this.handleMuted=()=>{this.emit(pe.Muted)},this.handleUnmuted=()=>{this.emit(pe.Unmuted)},this.log=Ur((o=a?.loggerName)!==null&&o!==void 0?o:Ai.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=i,this.source=G.Source.Unknown}setTrack(e){this.track&&(this.track.off(pe.Muted,this.handleMuted),this.track.off(pe.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(pe.Muted,this.handleMuted),e.on(pe.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Je(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Fn.NONE}get audioTrack(){if(er(this.track))return this.track}get videoTrack(){if(Ba(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=G.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===G.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(Nr||(Nr={}));class pf extends Nr{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,i,a){super(e,n.sid,n.name,a),this.track=void 0,this.handleTrackEnded=()=>{this.emit(pe.Ended)},this.handleCpuConstrained=()=>{this.track&&Ba(this.track)&&this.emit(pe.CpuConstrained,this.track)},this.updateInfo(n),this.setTrack(i)}setTrack(e){this.track&&(this.track.off(pe.Ended,this.handleTrackEnded),this.track.off(pe.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(pe.Ended,this.handleTrackEnded),e.on(pe.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return L(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return L(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return L(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return L(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(er(this.track)){const n=this.track.getSourceTrackSettings(),i=new Set;return n.autoGainControl&&i.add(Zt.TF_AUTO_GAIN_CONTROL),n.echoCancellation&&i.add(Zt.TF_ECHO_CANCELLATION),n.noiseSuppression&&i.add(Zt.TF_NOISE_SUPPRESSION),n.channelCount&&n.channelCount>1&&i.add(Zt.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||i.add(Zt.TF_NO_DTX),this.track.enhancedNoiseCancellation&&i.add(Zt.TF_ENHANCED_NOISE_CANCELLATION),Array.from(i.values())}else return[]}}function rl(t,e){return L(this,void 0,void 0,function*(){t??(t={});let n=!1;const{audioProcessor:i,videoProcessor:a,optionsWithoutProcessor:o}=Cw(t);let c=o.audio,u=o.video;if(i&&typeof o.audio=="object"&&(o.audio.processor=i),a&&typeof o.video=="object"&&(o.video.processor=a),t.audio&&typeof o.audio=="object"&&typeof o.audio.deviceId=="string"){const v=o.audio.deviceId;o.audio.deviceId={exact:v},n=!0,c=Object.assign(Object.assign({},o.audio),{deviceId:{ideal:v}})}if(o.video&&typeof o.video=="object"&&typeof o.video.deviceId=="string"){const v=o.video.deviceId;o.video.deviceId={exact:v},n=!0,u=Object.assign(Object.assign({},o.video),{deviceId:{ideal:v}})}(o.audio===!0||typeof o.audio=="object"&&!o.audio.deviceId)&&(o.audio={deviceId:"default"}),o.video===!0?o.video={deviceId:"default"}:typeof o.video=="object"&&!o.video.deviceId&&(o.video.deviceId="default");const d=Sw(o,_w,ww),h=Hv(d),m=navigator.mediaDevices.getUserMedia(h);o.audio&&(Jt.userMediaPromiseMap.set("audioinput",m),m.catch(()=>Jt.userMediaPromiseMap.delete("audioinput"))),o.video&&(Jt.userMediaPromiseMap.set("videoinput",m),m.catch(()=>Jt.userMediaPromiseMap.delete("videoinput")));try{const v=yield m;return yield Promise.all(v.getTracks().map(y=>L(this,void 0,void 0,function*(){const T=y.kind==="audio";let k=T?d.audio:d.video;(typeof k=="boolean"||!k)&&(k={});let E;const x=T?h.audio:h.video;typeof x!="boolean"&&(E=x);const _=y.getSettings().deviceId;E?.deviceId&&Oa(E.deviceId)!==_?E.deviceId=_:E||(E={deviceId:_});const N=zL(y,E,e);return N.kind===G.Kind.Video?N.source=G.Source.Camera:N.kind===G.Kind.Audio&&(N.source=G.Source.Microphone),N.mediaStream=v,er(N)&&i?yield N.setProcessor(i):Ba(N)&&a&&(yield N.setProcessor(a)),N})))}catch(v){if(!n)throw v;return rl(Object.assign(Object.assign({},t),{audio:c,video:u}),e)}})}function f5(t){return L(this,void 0,void 0,function*(){return(yield rl({audio:!1,video:!0}))[0]})}function h5(t){return L(this,void 0,void 0,function*(){return(yield rl({audio:!0,video:!1}))[0]})}var xi;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(xi||(xi={}));function m5(t){switch(t){case xc.EXCELLENT:return xi.Excellent;case xc.GOOD:return xi.Good;case xc.POOR:return xi.Poor;case xc.LOST:return xi.Lost;default:return xi.Unknown}}class Lw extends or.EventEmitter{get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===Bc.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===jo.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,n,i,a,o,c){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Bc.STANDARD;var d;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=xi.Unknown,this.log=Qe,this.log=Ur((d=c?.loggerName)!==null&&d!==void 0?d:Ai.Participant),this.loggerOptions=c,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=i,this.metadata=a,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=u,this._attributes=o??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,n]of this.trackPublications)if(n.source===e)return n}getTrackPublicationByName(e){for(const[,n]of this.trackPublications)if(n.trackName===e)return n}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Zi,this.once(ne.Active,()=>{var e,n;(n=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||n===void 0||n.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrackPublication(G.Source.Camera);return!(!((e=n?.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrackPublication(G.Source.Microphone);return!(!((e=n?.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(G.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var n;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===jo.ACTIVE&&((n=this.participantInfo)===null||n===void 0?void 0:n.state)!==jo.ACTIVE&&this.emit(ne.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const n=this.metadata!==e,i=this.metadata;this.metadata=e,n&&this.emit(ne.ParticipantMetadataChanged,i)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(ne.ParticipantNameChanged,e)}_setAttributes(e){const n=hL(this.attributes,e);this._attributes=e,Object.keys(n).length>0&&this.emit(ne.AttributesChanged,n)}setPermissions(e){var n,i,a,o,c,u;const d=this.permissions,h=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((i=this.permissions)===null||i===void 0?void 0:i.canSubscribe)||e.canPublishData!==((a=this.permissions)===null||a===void 0?void 0:a.canPublishData)||e.hidden!==((o=this.permissions)===null||o===void 0?void 0:o.hidden)||e.recorder!==((c=this.permissions)===null||c===void 0?void 0:c.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((m,v)=>{var y;return m!==((y=this.permissions)===null||y===void 0?void 0:y.canPublishSources[v])})||e.canSubscribeMetrics!==((u=this.permissions)===null||u===void 0?void 0:u.canSubscribeMetrics);return this.permissions=e,h&&this.emit(ne.ParticipantPermissionsChanged,d),h}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ne.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=m5(e),n!==this._connectionQuality&&this.emit(ne.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,n;this.activeFuture&&((n=(e=this.activeFuture).reject)===null||n===void 0||n.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(n=>er(n.track)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(pe.Muted,()=>{this.emit(ne.TrackMuted,e)}),e.on(pe.Unmuted,()=>{this.emit(ne.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case G.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case G.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function p5(t){var e,n,i;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new M_({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(i=t.allowAll)!==null&&i!==void 0?i:!1,trackSids:t.allowedTrackSids||[]})}class g5 extends Lw{constructor(e,n,i,a,o,c){super(e,n,void 0,void 0,void 0,{loggerName:a.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Fn.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Zi)},this.handleReconnected=()=>{var u,d;(d=(u=this.reconnectFuture)===null||u===void 0?void 0:u.resolve)===null||d===void 0||d.call(u),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var u,d,h,m,v,y;this.reconnectFuture&&(this.reconnectFuture.promise.catch(T=>this.log.warn(T.message,this.logContext)),(d=(u=this.reconnectFuture)===null||u===void 0?void 0:u.reject)===null||d===void 0||d.call(u,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&((m=(h=this.signalConnectedFuture).reject)===null||m===void 0||m.call(h,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),(y=(v=this.activeAgentFuture)===null||v===void 0?void 0:v.reject)===null||y===void 0||y.call(v,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=u=>{var d,h;u.participant&&this.updateInfo(u.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Zi),(h=(d=this.signalConnectedFuture).resolve)===null||h===void 0||h.call(d)},this.handleSignalRequestResponse=u=>{const{requestId:d,reason:h,message:m}=u,v=this.pendingSignalRequests.get(d);v&&(h!==Uv.OK&&v.reject(new SE(m,h)),this.pendingSignalRequests.delete(d))},this.handleDataPacket=u=>{switch(u.value.case){case"rpcResponse":let d=u.value.value,h=null,m=null;d.value.case==="payload"?h=d.value.value:d.value.case==="error"&&(m=Nt.fromProto(d.value.value)),this.handleIncomingRpcResponse(d.requestId,h,m);break;case"rpcAck":let v=u.value.value;this.handleIncomingRpcAck(v.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(u=>p5(u)))},this.onTrackUnmuted=u=>{this.onTrackMuted(u,u.isUpstreamPaused)},this.onTrackMuted=(u,d)=>{if(d===void 0&&(d=!0),!u.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Je(u)));return}this.engine.updateMuteStatus(u.sid,d)},this.onTrackUpstreamPaused=u=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Je(u))),this.onTrackMuted(u,!0)},this.onTrackUpstreamResumed=u=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Je(u))),this.onTrackMuted(u,u.isMuted)},this.onTrackFeatureUpdate=u=>{const d=this.audioTrackPublications.get(u.sid);if(!d){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(u.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(d.trackSid,d.getTrackFeatures())},this.onTrackCpuConstrained=(u,d)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),Je(d))),this.emit(ne.LocalTrackCpuConstrained,u,d)},this.handleSubscribedQualityUpdate=u=>L(this,void 0,void 0,function*(){var d,h,m,v,y;if(!(!((y=this.roomOptions)===null||y===void 0)&&y.dynacast))return;const T=this.videoTrackPublications.get(u.trackSid);if(!T){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}if(!T.videoTrack)return;const k=yield T.videoTrack.setPublishingCodecs(u.subscribedCodecs);try{for(var E=!0,x=Pr(k),_;_=yield x.next(),d=_.done,!d;E=!0){v=_.value,E=!1;const N=v;qP(N)&&(this.log.debug("publish ".concat(N," for ").concat(T.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Je(T))),yield this.publishAdditionalCodecForTrack(T.videoTrack,N,T.options))}}catch(N){h={error:N}}finally{try{!E&&!d&&(m=x.return)&&(yield m.call(x))}finally{if(h)throw h.error}}}),this.handleLocalTrackUnpublished=u=>{const d=this.trackPublications.get(u.trackSid);if(!d){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}this.unpublishTrack(d.track)},this.handleTrackEnded=u=>L(this,void 0,void 0,function*(){if(u.source===G.Source.ScreenShare||u.source===G.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Je(u))),this.unpublishTrack(u);else if(u.isUserProvided)yield u.mute();else if(Or(u)||ya(u))try{if(wn())try{const d=yield navigator?.permissions.query({name:u.source===G.Source.Camera?"camera":"microphone"});if(d&&d.state==="denied")throw this.log.warn("user has revoked access to ".concat(u.source),Object.assign(Object.assign({},this.logContext),Je(u))),d.onchange=()=>{d.state!=="denied"&&(u.isMuted||u.restartTrack(),d.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}u.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Je(u))),Or(u)?yield u.restartTrack({deviceId:"default"}):yield u.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Je(u))),yield u.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=i,this.roomOptions=a,this.setupEngine(i),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=o,this.roomOutgoingDataStreamManager=c}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Fn.NONE}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setupEngine(e){var n;this.engine=e,this.engine.on(ve.RemoteMute,(i,a)=>{const o=this.trackPublications.get(i);!o||!o.track||(a?o.mute():o.unmute())}),!((n=this.signalConnectedFuture)===null||n===void 0)&&n.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(ve.Connected,this.handleReconnected).on(ve.SignalConnected,this.handleSignalConnected).on(ve.SignalRestarted,this.handleReconnected).on(ve.SignalResumed,this.handleReconnected).on(ve.Restarting,this.handleReconnecting).on(ve.Resuming,this.handleReconnecting).on(ve.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(ve.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(ve.Closing,this.handleClosing).on(ve.SignalRequestResponse,this.handleSignalRequestResponse).on(ve.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return L(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return L(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return L(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return L(this,arguments,void 0,function(n){var i=this;let{metadata:a,name:o,attributes:c}=n;return function*(){return new Promise((u,d)=>L(i,void 0,void 0,function*(){var h,m;try{let v=!1;const y=yield this.engine.client.sendUpdateLocalMetadata((h=a??this.metadata)!==null&&h!==void 0?h:"",(m=o??this.name)!==null&&m!==void 0?m:"",c),T=performance.now();for(this.pendingSignalRequests.set(y,{resolve:u,reject:k=>{d(k),v=!0},values:{name:o,metadata:a,attributes:c}});performance.now()-T<5e3&&!v;){if((!o||this.name===o)&&(!a||this.metadata===a)&&(!c||Object.entries(c).every(k=>{let[E,x]=k;return this.attributes[E]===x||x===""&&!this.attributes[E]}))){this.pendingSignalRequests.delete(y),u();return}yield Rn(50)}d(new SE("Request to update local metadata timed out","TimeoutError"))}catch(v){v instanceof Error&&d(v)}}))}()})}setCameraEnabled(e,n,i){return this.setTrackEnabled(G.Source.Camera,e,n,i)}setMicrophoneEnabled(e,n,i){return this.setTrackEnabled(G.Source.Microphone,e,n,i)}setScreenShareEnabled(e,n,i){return this.setTrackEnabled(G.Source.ScreenShare,e,n,i)}setPermissions(e){const n=this.permissions,i=super.setPermissions(e);return i&&n&&this.emit(ne.ParticipantPermissionsChanged,n),i}setE2EEEnabled(e){return L(this,void 0,void 0,function*(){this.encryptionType=e?Fn.GCM:Fn.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,i,a){return L(this,void 0,void 0,function*(){var o,c;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n})),this.republishPromise&&(yield this.republishPromise);let u=this.getTrackPublication(e);if(n)if(u)yield u.unmute();else{let d;if(this.pendingPublishing.has(e)){const h=yield this.waitForPendingPublicationOfSource(e);return h||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield h?.unmute(),h}this.pendingPublishing.add(e);try{switch(e){case G.Source.Camera:d=yield this.createTracks({video:(o=i)!==null&&o!==void 0?o:!0});break;case G.Source.Microphone:d=yield this.createTracks({audio:(c=i)!==null&&c!==void 0?c:!0});break;case G.Source.ScreenShare:d=yield this.createScreenTracks(Object.assign({},i));break;default:throw new Lr(e)}}catch(h){throw d?.forEach(m=>{m.stop()}),h instanceof Error&&this.emit(ne.MediaDevicesError,h,Kg(e)),this.pendingPublishing.delete(e),h}for(const h of d){const m=Object.assign(Object.assign({},this.roomOptions.publishDefaults),i);e===G.Source.Microphone&&er(h)&&m.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),h.startPreConnectBuffer())}try{const h=[];for(const v of d)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Je(v))),h.push(this.publishTrack(v,a));[u]=yield Promise.all(h)}catch(h){throw d?.forEach(m=>{m.stop()}),h}finally{this.pendingPublishing.delete(e)}}else if(!u?.track&&this.pendingPublishing.has(e)&&(u=yield this.waitForPendingPublicationOfSource(e),u||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),u&&u.track)if(e===G.Source.ScreenShare){u=yield this.unpublishTrack(u.track);const d=this.getTrackPublication(G.Source.ScreenShareAudio);d&&d.track&&this.unpublishTrack(d.track)}else yield u.mute();return u})}enableCameraAndMicrophone(){return L(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(G.Source.Camera)||this.pendingPublishing.has(G.Source.Microphone))){this.pendingPublishing.add(G.Source.Camera),this.pendingPublishing.add(G.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(G.Source.Camera),this.pendingPublishing.delete(G.Source.Microphone)}}})}createTracks(e){return L(this,void 0,void 0,function*(){var n,i;e??(e={});const a=Sw(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(i=this.roomOptions)===null||i===void 0?void 0:i.videoCaptureDefaults);try{return(yield rl(a,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(u=>(er(u)&&(this.microphoneError=void 0,u.setAudioContext(this.audioContext),u.source=G.Source.Microphone,this.emit(ne.AudioStreamAcquired)),Ba(u)&&(this.cameraError=void 0,u.source=G.Source.Camera),u))}catch(o){throw o instanceof Error&&(e.audio&&(this.microphoneError=o),e.video&&(this.cameraError=o)),o}})}createScreenTracks(e){return L(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new zv("getDisplayMedia not supported");e.resolution===void 0&&!WP()&&(e.resolution=Vv.h1080fps30.resolution);const n=uL(e),i=yield navigator.mediaDevices.getDisplayMedia(n),a=i.getVideoTracks();if(a.length===0)throw new Lr("no video track found");const o=new mf(a[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=G.Source.ScreenShare,e.contentHint&&(o.mediaStreamTrack.contentHint=e.contentHint);const c=[o];if(i.getAudioTracks().length>0){this.emit(ne.AudioStreamAcquired);const u=new hf(i.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});u.source=G.Source.ScreenShareAudio,c.push(u)}return c})}publishTrack(e,n){return L(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,n)})}publishOrRepublishTrack(e,n){return L(this,arguments,void 0,function(i,a){var o=this;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var u,d,h,m;Or(i)&&i.setAudioContext(o.audioContext),yield(u=o.reconnectFuture)===null||u===void 0?void 0:u.promise,o.republishPromise&&!c&&(yield o.republishPromise),Ss(i)&&o.pendingPublishPromises.has(i)&&(yield o.pendingPublishPromises.get(i));let v;if(i instanceof MediaStreamTrack)v=i.getConstraints();else{v=i.constraints;let _;switch(i.source){case G.Source.Microphone:_="audioinput";break;case G.Source.Camera:_="videoinput"}_&&o.activeDeviceMap.has(_)&&(v=Object.assign(Object.assign({},v),{deviceId:o.activeDeviceMap.get(_)}))}if(i instanceof MediaStreamTrack)switch(i.kind){case"audio":i=new hf(i,v,!0,o.audioContext,{loggerName:o.roomOptions.loggerName,loggerContextCb:()=>o.logContext});break;case"video":i=new mf(i,v,!0,{loggerName:o.roomOptions.loggerName,loggerContextCb:()=>o.logContext});break;default:throw new Lr("unsupported MediaStreamTrack kind ".concat(i.kind))}else i.updateLoggerOptions({loggerName:o.roomOptions.loggerName,loggerContextCb:()=>o.logContext});let y;if(o.trackPublications.forEach(_=>{_.track&&_.track===i&&(y=_)}),y)return o.log.warn("track has already been published, skipping",Object.assign(Object.assign({},o.logContext),Je(y))),y;const T="channelCount"in i.mediaStreamTrack.getSettings()&&i.mediaStreamTrack.getSettings().channelCount===2||i.mediaStreamTrack.getConstraints().channelCount===2,k=(d=a?.forceStereo)!==null&&d!==void 0?d:T;k&&(a||(a={}),a.dtx===void 0&&o.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},o.logContext),Je(i))),a.red===void 0&&o.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(h=a.dtx)!==null&&h!==void 0||(a.dtx=!1),(m=a.red)!==null&&m!==void 0||(a.red=!1));const E=Object.assign(Object.assign({},o.roomOptions.publishDefaults),a);!ZP()&&o.roomOptions.e2ee&&(o.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},o.logContext)),E.simulcast=!1),E.source&&(i.source=E.source);const x=new Promise((_,N)=>L(o,void 0,void 0,function*(){try{if(this.engine.client.currentState!==St.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:Je(i)}));const P=setTimeout(()=>{N(new yE("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(P);const O=yield this.publish(i,E,k);_(O)}else try{const P=yield this.publish(i,E,k);_(P)}catch(P){N(P)}}catch(P){N(P)}}));o.pendingPublishPromises.set(i,x);try{return yield x}catch(_){throw _}finally{o.pendingPublishPromises.delete(i)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Zi),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),Je(e))),!1;const{canPublish:n,canPublishSources:i}=this.permissions;return n&&(i.length===0||i.map(a=>mL(a)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),Je(e))),!1)}publish(e,n,i){return L(this,void 0,void 0,function*(){var a,o,c,u,d,h,m,v,y,T;if(!this.hasPermissionsToPublish(e))throw new yE("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(D=>Ss(e)&&D.source===e.source)&&e.source!==G.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Je(e))),n.stopMicTrackOnMute&&er(e)&&(e.stopOnMute=!0),e.source===G.Source.ScreenShare&&_s()&&(n.simulcast=!1),n.videoCodec==="av1"&&!YP()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!KP()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Qg),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(D=>n.videoCodec===Nc(D.mime))||(n.videoCodec=Nc(this.enabledPublishVideoCodecs[0].mime)));const E=n.videoCodec;e.on(pe.Muted,this.onTrackMuted),e.on(pe.Unmuted,this.onTrackUnmuted),e.on(pe.Ended,this.handleTrackEnded),e.on(pe.UpstreamPaused,this.onTrackUpstreamPaused),e.on(pe.UpstreamResumed,this.onTrackUpstreamResumed),e.on(pe.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const x=[],_=!(!((a=n.dtx)!==null&&a!==void 0)||a),N=e.getSourceTrackSettings();N.autoGainControl&&x.push(Zt.TF_AUTO_GAIN_CONTROL),N.echoCancellation&&x.push(Zt.TF_ECHO_CANCELLATION),N.noiseSuppression&&x.push(Zt.TF_NOISE_SUPPRESSION),N.channelCount&&N.channelCount>1&&x.push(Zt.TF_STEREO),_&&x.push(Zt.TF_NO_DTX),Or(e)&&e.hasPreConnectBuffer&&x.push(Zt.TF_PRECONNECT_BUFFER);const P=new Ag({cid:e.mediaStreamTrack.id,name:n.name,type:G.kindToProto(e.kind),muted:e.isMuted,source:G.sourceToProto(e.source),disableDtx:_,encryption:this.encryptionType,stereo:i,disableRed:this.isE2EEEnabled||!(!((o=n.red)!==null&&o!==void 0)||o),stream:n?.stream,backupCodecPolicy:n?.backupCodecPolicy,audioFeatures:x});let O;if(e.kind===G.Kind.Video){let D={width:0,height:0};try{D=yield e.waitForDimensions()}catch{const Y=(u=(c=this.roomOptions.videoCaptureDefaults)===null||c===void 0?void 0:c.resolution)!==null&&u!==void 0?u:Vc.h720.resolution;D={width:Y.width,height:Y.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Je(e)),{dims:D}))}P.width=D.width,P.height=D.height,ya(e)&&(Xi(E)&&(e.source===G.Source.ScreenShare&&(n.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Je(e))))),n.scalabilityMode=(d=n.scalabilityMode)!==null&&d!==void 0?d:"L3T3_KEY"),P.simulcastCodecs=[new Rg({codec:E,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Qg}),n.backupCodec&&E!==n.backupCodec.codec&&P.encryption===Fn.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),P.simulcastCodecs.push(new Rg({codec:n.backupCodec.codec,cid:""})))),O=Xg(e.source===G.Source.ScreenShare,P.width,P.height,n),P.layers=FE(P.width,P.height,O,Xi(n.videoCodec))}else e.kind===G.Kind.Audio&&(O=[{maxBitrate:(h=n.audioPreset)===null||h===void 0?void 0:h.maxBitrate,priority:(v=(m=n.audioPreset)===null||m===void 0?void 0:m.priority)!==null&&v!==void 0?v:"high",networkPriority:(T=(y=n.audioPreset)===null||y===void 0?void 0:y.priority)!==null&&T!==void 0?T:"high"}]);if(!this.engine||this.engine.isClosed)throw new $t("cannot publish track when not connected");const A=()=>L(this,void 0,void 0,function*(){var D,B,Y;if(!this.engine.pcManager)throw new $t("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,n,O),this.emit(ne.LocalSenderCreated,e.sender,e),ya(e)&&((D=n.degradationPreference)!==null&&D!==void 0||(n.degradationPreference=WL(e)),e.setDegradationPreference(n.degradationPreference)),O)if(_s()&&e.kind===G.Kind.Audio){let re;for(const de of this.engine.pcManager.publisher.getTransceivers())if(de.sender===e.sender){re=de;break}re&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:re,codec:"opus",maxbr:!((B=O[0])===null||B===void 0)&&B.maxBitrate?O[0].maxBitrate/1e3:0})}else e.codec&&Xi(e.codec)&&(!((Y=O[0])===null||Y===void 0)&&Y.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:P.cid,codec:e.codec,maxbr:O[0].maxBitrate/1e3});yield this.engine.negotiate()});let w;const V=new Promise((D,B)=>L(this,void 0,void 0,function*(){var Y;try{w=yield this.engine.addTrack(P),D(w)}catch(re){e.sender&&(!((Y=this.engine.pcManager)===null||Y===void 0)&&Y.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(de=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),Je(e)),{error:de}))})),B(re)}}));if(this.enabledPublishVideoCodecs.length>0)w=(yield Promise.all([V,A()]))[0];else{w=yield V;let D;if(w.codecs.forEach(B=>{D===void 0&&(D=B.mimeType)}),D&&e.kind===G.Kind.Video){const B=Nc(D);B!==E&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Je(e)),{codec:B})),n.videoCodec=B,O=Xg(e.source===G.Source.ScreenShare,P.width,P.height,n))}yield A()}const M=new pf(e.kind,w,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(M.on(pe.CpuConstrained,D=>this.onTrackCpuConstrained(D,M)),M.options=n,e.sid=w.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:O,trackInfo:w})),ya(e)?e.startMonitor(this.engine.client):Or(e)&&e.startMonitor(),this.addTrackPublication(M),this.emit(ne.LocalTrackPublished,M),Or(e)&&w.audioFeatures.includes(Zt.TF_PRECONNECT_BUFFER)){const D=e.getPreConnectBuffer(),B=e.getPreConnectBufferMimeType();this.on(ne.LocalTrackSubscribed,Y=>{if(Y.trackSid===w.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),Je(e))),e.stopPreConnectBuffer()}}),D&&new Promise((re,de)=>L(this,void 0,void 0,function*(){var be,xe,H,ae,ee,Se;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),Je(e)));const le=setTimeout(()=>{de(new Error("agent not active within 10 seconds"))},1e4),ge=yield this.waitUntilActiveAgentPresent();clearTimeout(le),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),Je(e)));const De=yield this.streamBytes({name:"preconnect-buffer",mimeType:B,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[ge.identity],attributes:{trackId:M.trackSid,sampleRate:String((ee=N.sampleRate)!==null&&ee!==void 0?ee:"48000"),channels:String((Se=N.channelCount)!==null&&Se!==void 0?Se:"1")}});try{for(var j=!0,te=Pr(D),he;he=yield te.next(),be=he.done,!be;j=!0){ae=he.value,j=!1;const ye=ae;yield De.write(ye)}}catch(ye){xe={error:ye}}finally{try{!j&&!be&&(H=te.return)&&(yield H.call(te))}finally{if(xe)throw xe.error}}yield De.close(),re()}catch(le){de(le)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),Je(e)))}).catch(re=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),Je(e)),{error:re}))})}return M})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,i){return L(this,void 0,void 0,function*(){var a;if(this.encryptionType!==Fn.NONE)return;let o;if(this.trackPublications.forEach(T=>{T.track&&T.track===e&&(o=T)}),!o)throw new Lr("track is not published");if(!ya(e))throw new Lr("track is not a video track");const c=Object.assign(Object.assign({},(a=this.roomOptions)===null||a===void 0?void 0:a.publishDefaults),i),u=YL(e,n,c);if(!u){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Je(e)));return}const d=e.addSimulcastTrack(n,u);if(!d)return;const h=new Ag({cid:d.mediaStreamTrack.id,type:G.kindToProto(e.kind),muted:e.isMuted,source:G.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:c.videoCodec,cid:d.mediaStreamTrack.id}]});if(h.layers=FE(h.width,h.height,u),!this.engine||this.engine.isClosed)throw new $t("cannot publish track when not connected");const m=()=>L(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,d,c,u),yield this.engine.negotiate()}),y=(yield Promise.all([this.engine.addTrack(h),m()]))[0];this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:u,trackInfo:y}))})}unpublishTrack(e,n){return L(this,void 0,void 0,function*(){var i,a;if(Ss(e)){const h=this.pendingPublishPromises.get(e);h&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Je(e))),yield h)}const o=this.getPublicationForTrack(e),c=o?Je(o):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),c)),!o||!o.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),c));return}e=o.track,e.off(pe.Muted,this.onTrackMuted),e.off(pe.Unmuted,this.onTrackUnmuted),e.off(pe.Ended,this.handleTrackEnded),e.off(pe.UpstreamPaused,this.onTrackUpstreamPaused),e.off(pe.UpstreamResumed,this.onTrackUpstreamResumed),e.off(pe.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),n===void 0&&(n=(a=(i=this.roomOptions)===null||i===void 0?void 0:i.stopLocalTrackOnUnpublish)!==null&&a!==void 0?a:!0),n?e.stop():e.stopMonitor();let u=!1;const d=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<At.FAILED&&d)try{for(const h of this.engine.pcManager.publisher.getTransceivers())h.sender===d&&(h.direction="inactive",u=!0);if(this.engine.removeTrack(d)&&(u=!0),ya(e)){for(const[,h]of e.simulcastCodecs)h.sender&&(this.engine.removeTrack(h.sender)&&(u=!0),h.sender=void 0);e.simulcastCodecs.clear()}}catch(h){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),c),{error:h}))}switch(this.trackPublications.delete(o.trackSid),o.kind){case G.Kind.Audio:this.audioTrackPublications.delete(o.trackSid);break;case G.Kind.Video:this.videoTrackPublications.delete(o.trackSid);break}return this.emit(ne.LocalTrackUnpublished,o),o.setTrack(void 0),u&&(yield this.engine.negotiate()),o})}unpublishTracks(e){return L(this,void 0,void 0,function*(){return(yield Promise.all(e.map(i=>this.unpublishTrack(i)))).filter(i=>!!i)})}republishAllTracks(e){return L(this,arguments,void 0,function(n){var i=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){i.republishPromise&&(yield i.republishPromise),i.republishPromise=new Promise((o,c)=>L(i,void 0,void 0,function*(){try{const u=[];this.trackPublications.forEach(d=>{d.track&&(n&&(d.options=Object.assign(Object.assign({},d.options),n)),u.push(d))}),yield Promise.all(u.map(d=>L(this,void 0,void 0,function*(){const h=d.track;yield this.unpublishTrack(h,!1),a&&!h.isMuted&&h.source!==G.Source.ScreenShare&&h.source!==G.Source.ScreenShareAudio&&(Or(h)||ya(h))&&!h.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:d.trackSid})),yield h.restartTrack()),yield this.publishOrRepublishTrack(h,d.options,!0)}))),o()}catch(u){c(u)}finally{this.republishPromise=void 0}})),yield i.republishPromise}()})}publishData(e){return L(this,arguments,void 0,function(n){var i=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const o=a.reliable?Ge.RELIABLE:Ge.LOSSY,c=a.destinationIdentities,u=a.topic,d=new kn({kind:o,value:{case:"user",value:new m_({participantIdentity:i.identity,payload:n,destinationIdentities:c,topic:u})}});yield i.engine.sendDataPacket(d,o)}()})}publishDtmf(e,n){return L(this,void 0,void 0,function*(){const i=new kn({kind:Ge.RELIABLE,value:{case:"sipDtmf",value:new p_({code:e,digit:n})}});yield this.engine.sendDataPacket(i,Ge.RELIABLE)})}sendChatMessage(e,n){return L(this,void 0,void 0,function*(){const i={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:n?.attachments},a=new kn({value:{case:"chatMessage",value:new Eg(Object.assign(Object.assign({},i),{timestamp:Ct.parse(i.timestamp)}))}});return yield this.engine.sendDataPacket(a,Ge.RELIABLE),this.emit(ne.ChatMessage,i),i})}editChatMessage(e,n){return L(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},n),{message:e,editTimestamp:Date.now()}),a=new kn({value:{case:"chatMessage",value:new Eg(Object.assign(Object.assign({},i),{timestamp:Ct.parse(i.timestamp),editTimestamp:Ct.parse(i.editTimestamp)}))}});return yield this.engine.sendDataPacket(a,Ge.RELIABLE),this.emit(ne.ChatMessage,i),i})}sendText(e,n){return L(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,n)})}streamText(e){return L(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,n){return L(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,n)})}streamBytes(e){return L(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){return L(this,arguments,void 0,function(n){var i=this;let{destinationIdentity:a,method:o,payload:c,responseTimeout:u=1e4}=n;return function*(){return new Promise((h,m)=>L(i,void 0,void 0,function*(){var v,y,T,k;if(Yv(c)>xw){m(Nt.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((y=(v=this.engine.latestJoinResponse)===null||v===void 0?void 0:v.serverInfo)===null||y===void 0)&&y.version&&Oi((k=(T=this.engine.latestJoinResponse)===null||T===void 0?void 0:T.serverInfo)===null||k===void 0?void 0:k.version,"1.8.0")<0){m(Nt.builtIn("UNSUPPORTED_SERVER"));return}const E=crypto.randomUUID();yield this.publishRpcRequest(a,E,o,c,u-2e3);const x=setTimeout(()=>{this.pendingAcks.delete(E),m(Nt.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(E),clearTimeout(_)},2e3);this.pendingAcks.set(E,{resolve:()=>{clearTimeout(x)},participantIdentity:a});const _=setTimeout(()=>{this.pendingResponses.delete(E),m(Nt.builtIn("RESPONSE_TIMEOUT"))},u);this.pendingResponses.set(E,{resolve:(N,P)=>{clearTimeout(_),this.pendingAcks.has(E)&&(console.warn("RPC response received before ack",E),this.pendingAcks.delete(E),clearTimeout(x)),P?m(P):h(N??"")},participantIdentity:a})}))}()})}registerRpcMethod(e,n){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const n=this.pendingAcks.get(e);n?(n.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,n,i){const a=this.pendingResponses.get(e);a?(a.resolve(n,i),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,n,i,a,o){return L(this,void 0,void 0,function*(){const c=new kn({destinationIdentities:[e],kind:Ge.RELIABLE,value:{case:"rpcRequest",value:new g_({id:n,method:i,payload:a,responseTimeoutMs:o,version:1})}});yield this.engine.sendDataPacket(c,Ge.RELIABLE)})}handleParticipantDisconnected(e){for(const[n,{participantIdentity:i}]of this.pendingAcks)i===e&&this.pendingAcks.delete(n);for(const[n,{participantIdentity:i,resolve:a}]of this.pendingResponses)i===e&&(a(null,Nt.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(n))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(n=>n.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(n=>{var i,a;const o=this.trackPublications.get(n.sid);if(o){const c=o.isMuted||((a=(i=o.track)===null||i===void 0?void 0:i.isUpstreamPaused)!==null&&a!==void 0?a:!1);c!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Je(o)),{mutedOnServer:c})),this.engine.client.sendMuteTrack(n.sid,c))}}),!0):!1}setActiveAgent(e){var n,i,a,o;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(i=(n=this.activeAgentFuture)===null||n===void 0?void 0:n.resolve)===null||i===void 0||i.call(n,e):(o=(a=this.activeAgentFuture)===null||a===void 0?void 0:a.reject)===null||o===void 0||o.call(a,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Zi),this.activeAgentFuture.promise)}getPublicationForTrack(e){let n;return this.trackPublications.forEach(i=>{const a=i.track;a&&(e instanceof MediaStreamTrack?(Or(a)||ya(a))&&a.mediaStreamTrack===e&&(n=i):e===a&&(n=i))}),n}waitForPendingPublicationOfSource(e){return L(this,void 0,void 0,function*(){const i=Date.now();for(;Date.now()<i+1e4;){const a=Array.from(this.pendingPublishPromises.entries()).find(o=>{let[c]=o;return c.source===e});if(a)return a[1];yield Rn(20)}})}}class gf extends Nr{constructor(e,n,i,a){super(e,n.sid,n.name,a),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=o=>{this.setTrack(void 0),this.emit(pe.Ended,o)},this.handleVisibilityChange=o=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(o),this.logContext),this.visible=o,this.emitTrackUpdate()},this.handleVideoDimensionsChange=o=>{this.log.debug("adaptivestream video dimensions ".concat(o.width,"x").concat(o.height),this.logContext),this.videoDimensionsAdaptiveStream=o,this.emitTrackUpdate()},this.subscribed=i,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,i=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const a=new jf({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new S_({participantSid:"",trackSids:[this.trackSid]})]});this.emit(pe.UpdateSubscription,a),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(i)}get subscriptionStatus(){return this.subscribed===!1?Nr.SubscriptionStatus.Unsubscribed:super.isSubscribed?Nr.SubscriptionStatus.Subscribed:Nr.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Nr.PermissionStatus.Allowed:Nr.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,i;this.isManualOperationAllowed()&&(((n=this.requestedVideoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((i=this.requestedVideoDimensions)===null||i===void 0?void 0:i.height)===e.height||(Op(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&Op(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:qn.HIGH}setTrack(e){const n=this.subscriptionStatus,i=this.permissionStatus,a=this.track;a!==e&&(a&&(a.off(pe.VideoDimensionsChanged,this.handleVideoDimensionsChange),a.off(pe.VisibilityChanged,this.handleVisibilityChange),a.off(pe.Ended,this.handleEnded),a.detach(),a.stopMonitor(),this.emit(pe.Unsubscribed,a)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(pe.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(pe.VisibilityChanged,this.handleVisibilityChange),e.on(pe.Ended,this.handleEnded),this.emit(pe.Subscribed,e)),this.emitPermissionUpdateIfChanged(i),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,i=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(i),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(pe.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?pe.Muted:pe.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(pe.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(pe.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return Op(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new R_({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===G.Kind.Video){let n=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(n)AE(this.videoDimensionsAdaptiveStream,n)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const i=pL(this.trackInfo,this.requestedMaxQuality);i&&AE(this.videoDimensionsAdaptiveStream,i)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream;n?(e.width=Math.ceil(n.width),e.height=Math.ceil(n.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:qn.HIGH})),e.quality=qn.HIGH)}this.emit(pe.UpdateSettings,e)}}class vf extends Lw{static fromParticipantInfo(e,n,i){return new vf(e,n.sid,n.identity,n.name,n.metadata,n.attributes,i,n.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,n,i,a,o,c,u){let d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:Bc.STANDARD;super(n,i||"",a,o,c,u,d),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(pe.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),Je(e)),{settings:n})),this.signalClient.sendUpdateTrackSettings(n)}),e.on(pe.UpdateSubscription,n=>{n.participantTracks.forEach(i=>{i.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(pe.SubscriptionPermissionChanged,n=>{this.emit(ne.TrackSubscriptionPermissionChanged,e,n)}),e.on(pe.SubscriptionStatusChanged,n=>{this.emit(ne.TrackSubscriptionStatusChanged,e,n)}),e.on(pe.Subscribed,n=>{this.emit(ne.TrackSubscribed,n,e)}),e.on(pe.Unsubscribed,n=>{this.emit(ne.TrackUnsubscribed,n,e)}),e.on(pe.SubscriptionFailed,n=>{this.emit(ne.TrackSubscriptionFailed,e.trackSid,n)})}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:G.Source.Microphone;this.volumeMap.set(n,e);const i=this.getTrackPublication(n);i&&i.track&&i.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G.Source.Microphone;const n=this.getTrackPublication(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,i,a,o,c){let u=this.getTrackPublicationBySid(n);if(u||n.startsWith("TR")||this.trackPublications.forEach(m=>{!u&&e.kind===m.kind.toString()&&(u=m)}),!u){if(c===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(ne.TrackSubscriptionFailed,n);return}c===void 0&&(c=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,i,a,o,c-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Je(u))),this.emit(ne.TrackSubscriptionFailed,n);return}const d=e.kind==="video";let h;return d?h=new u5(e,n,a,o):h=new Pw(e,n,a,this.audioContext,this.audioOutput),h.source=u.source,h.isMuted=u.isMuted,h.setMediaStream(i),h.start(),u.setTrack(h),this.volumeMap.has(u.source)&&Gg(h)&&er(h)&&h.setVolume(this.volumeMap.get(u.source)),u}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,i=new Map;return e.tracks.forEach(a=>{var o,c;let u=this.getTrackPublicationBySid(a.sid);if(u)u.updateInfo(a);else{const d=G.kindFromProto(a.type);if(!d)return;u=new gf(d,a,(o=this.signalClient.connectOptions)===null||o===void 0?void 0:o.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(c=this.loggerOptions)===null||c===void 0?void 0:c.loggerName}),u.updateInfo(a),i.set(a.sid,u);const h=Array.from(this.trackPublications.values()).find(m=>m.source===u?.source);h&&u.source!==G.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(u.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Je(h),newTrack:Je(u)})),this.addTrackPublication(u)}n.set(a.sid,u)}),this.trackPublications.forEach(a=>{n.has(a.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Je(a))),this.unpublishTrack(a.trackSid,!0))}),i.forEach(a=>{this.emit(ne.TrackPublished,a)}),!0}unpublishTrack(e,n){const i=this.trackPublications.get(e);if(!i)return;const{track:a}=i;switch(a&&(a.stop(),i.setTrack(void 0)),this.trackPublications.delete(e),i.kind){case G.Kind.Audio:this.audioTrackPublications.delete(e);break;case G.Kind.Video:this.videoTrackPublications.delete(e);break}n&&this.emit(ne.TrackUnpublished,i)}setAudioOutput(e){return L(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTrackPublications.forEach(i=>{var a;er(i.track)&&Gg(i.track)&&n.push(i.track.setSinkId((a=e.deviceId)!==null&&a!==void 0?a:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:i})),super.emit(e,...i)}}var et;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting"})(et||(et={}));const v5=4*1e3;class Ni extends or.EventEmitter{constructor(e){var n,i,a,o;if(super(),n=this,this.state=et.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Qe,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(c,u,d)=>L(this,void 0,void 0,function*(){var h;if(!QP())throw rr()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const m=yield this.disconnectLock.lock();if(this.state===et.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),m(),Promise.resolve();if(this.connectFuture)return m(),this.connectFuture.promise;this.setAndEmitConnectionState(et.Connecting),((h=this.regionUrlProvider)===null||h===void 0?void 0:h.getServerUrl().toString())!==c&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),qg(new URL(c))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Zg(c,u):this.regionUrlProvider.updateToken(u),this.regionUrlProvider.fetchRegionSettings().then(T=>{var k;(k=this.regionUrlProvider)===null||k===void 0||k.setServerReportedRegions(T)}).catch(T=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:T}))}));const v=(T,k,E)=>L(this,void 0,void 0,function*(){var x,_;this.abortController&&this.abortController.abort();const N=new AbortController;this.abortController=N,m?.();try{yield this.attemptConnection(E??c,u,d,N),this.abortController=void 0,T()}catch(P){if(this.regionUrlProvider&&P instanceof pt&&P.reason!==nt.Cancelled&&P.reason!==nt.NotAllowed){let O=null;try{O=yield this.regionUrlProvider.getNextBestRegionUrl((x=this.abortController)===null||x===void 0?void 0:x.signal)}catch(A){if(A instanceof pt&&(A.status===401||A.reason===nt.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),k(A);return}}O&&!(!((_=this.abortController)===null||_===void 0)&&_.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(P.message,". Retrying with another region: ").concat(O),this.logContext),this.recreateEngine(),yield v(T,k,O)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,RE(P)),k(P))}else{let O=Ri.UNKNOWN_REASON;P instanceof pt&&(O=RE(P)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,O),k(P)}}}),y=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Zi((T,k)=>{v(T,k,y)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(c,u,d,h,m,v)=>L(this,void 0,void 0,function*(){var y,T,k;const E=yield d.join(c,u,{autoSubscribe:h.autoSubscribe,adaptiveStream:typeof m.adaptiveStream=="object"?!0:m.adaptiveStream,maxRetries:h.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:h.websocketTimeout},v.signal);let x=E.serverInfo;if(x||(x={version:E.serverVersion,region:E.serverRegion}),this.serverInfo=x,this.log.debug("connected to Livekit Server ".concat(Object.entries(x).map(_=>{let[N,P]=_;return"".concat(N,": ").concat(P)}).join(", ")),{room:(y=E.room)===null||y===void 0?void 0:y.name,roomSid:(T=E.room)===null||T===void 0?void 0:T.sid,identity:(k=E.participant)===null||k===void 0?void 0:k.identity}),!x.version)throw new PP("unknown server version");return x.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),m.dynacast=!1),E}),this.applyJoinResponse=c=>{const u=c.participant;if(this.localParticipant.sid=u.sid,this.localParticipant.identity=u.identity,this.localParticipant.setEnabledPublishCodecs(c.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(c.sifTrailer)}catch(d){this.log.error(d instanceof Error?d.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:d}))}this.handleParticipantUpdates([u,...c.otherParticipants]),c.room&&this.handleRoomUpdate(c.room)},this.attemptConnection=(c,u,d,h)=>L(this,void 0,void 0,function*(){var m,v;this.state===et.Reconnecting||this.isResuming||!((m=this.engine)===null||m===void 0)&&m.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((v=this.regionUrlProvider)===null||v===void 0)&&v.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Gv),d),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const y=yield this.connectSignal(c,u,this.engine,this.connOptions,this.options,h);this.applyJoinResponse(y),this.setupLocalParticipantEvents(),this.emit(J.SignalConnected)}catch(y){yield this.engine.close(),this.recreateEngine();const T=new pt("could not establish signal connection",nt.ServerUnreachable);throw y instanceof Error&&(T.message="".concat(T.message,": ").concat(y.message)),y instanceof pt&&(T.reason=y.reason,T.status=y.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:y})),T}if(h.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new pt("Connection attempt aborted",nt.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,h)}catch(y){throw yield this.engine.close(),this.recreateEngine(),y}wn()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),wn()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(et.Connected),this.emit(J.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return L(n,[...u],void 0,function(){var h=this;let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var v,y,T,k;const E=yield h.disconnectLock.lock();try{if(h.state===et.Disconnected){h.log.debug("already disconnected",h.logContext);return}h.log.info("disconnect from room",Object.assign({},h.logContext)),(h.state===et.Connecting||h.state===et.Reconnecting||h.isResuming)&&(h.log.warn("abort connection attempt",h.logContext),(v=h.abortController)===null||v===void 0||v.abort(),(T=(y=h.connectFuture)===null||y===void 0?void 0:y.reject)===null||T===void 0||T.call(y,new pt("Client initiated disconnect",nt.Cancelled)),h.connectFuture=void 0),!((k=h.engine)===null||k===void 0)&&k.client.isDisconnected||(yield h.engine.client.sendLeave()),h.engine&&(yield h.engine.close()),h.handleDisconnect(m,Ri.CLIENT_INITIATED),h.engine=void 0}finally{E()}}()})},this.onPageLeave=()=>L(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>L(this,void 0,void 0,function*(){const c=[],u=$n();if(u&&u.os==="iOS"){const d="livekit-dummy-audio-el";let h=document.getElementById(d);if(!h){h=document.createElement("audio"),h.id=d,h.autoplay=!0,h.hidden=!0;const m=Ap();m.enabled=!0;const v=new MediaStream([m]);h.srcObject=v,document.addEventListener("visibilitychange",()=>{h&&(h.srcObject=document.hidden?null:v,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(h),this.once(J.Disconnected,()=>{h?.remove(),h=null})}c.push(h)}this.remoteParticipants.forEach(d=>{d.audioTrackPublications.forEach(h=>{h.track&&h.track.attachedElements.forEach(m=>{c.push(m)})})});try{yield Promise.all([this.acquireAudioContext(),...c.map(d=>(d.muted=!1,d.play()))]),this.handleAudioPlaybackStarted()}catch(d){throw this.handleAudioPlaybackFailed(d),d}}),this.startVideo=()=>L(this,void 0,void 0,function*(){const c=[];for(const u of this.remoteParticipants.values())u.videoTrackPublications.forEach(d=>{var h;(h=d.track)===null||h===void 0||h.attachedElements.forEach(m=>{c.includes(m)||c.push(m)})});yield Promise.all(c.map(u=>u.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(u=>{u.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const c of this.remoteParticipants.values())this.handleParticipantDisconnected(c.identity,c);this.setAndEmitConnectionState(et.Reconnecting)&&this.emit(J.Reconnecting)},this.handleSignalRestarted=c=>L(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(c.serverRegion),Object.assign(Object.assign({},this.logContext),{region:c.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(c);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(u){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:u}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:c.serverRegion}))}catch{return}this.setAndEmitConnectionState(et.Connected),this.emit(J.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=c=>{c.forEach(u=>{var d;if(u.identity===this.localParticipant.identity){this.localParticipant.updateInfo(u);return}u.identity===""&&(u.identity=(d=this.sidToIdentity.get(u.sid))!==null&&d!==void 0?d:"");let h=this.remoteParticipants.get(u.identity);u.state===jo.DISCONNECTED?this.handleParticipantDisconnected(u.identity,h):h=this.getOrCreateParticipant(u.identity,u)})},this.handleActiveSpeakersUpdate=c=>{const u=[],d={};c.forEach(h=>{if(d[h.sid]=!0,h.sid===this.localParticipant.sid)this.localParticipant.audioLevel=h.level,this.localParticipant.setIsSpeaking(!0),u.push(this.localParticipant);else{const m=this.getRemoteParticipantBySid(h.sid);m&&(m.audioLevel=h.level,m.setIsSpeaking(!0),u.push(m))}}),d[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(h=>{d[h.sid]||(h.audioLevel=0,h.setIsSpeaking(!1))}),this.activeSpeakers=u,this.emitWhenConnected(J.ActiveSpeakersChanged,u)},this.handleSpeakersChanged=c=>{const u=new Map;this.activeSpeakers.forEach(h=>{const m=this.remoteParticipants.get(h.identity);m&&m.sid!==h.sid||u.set(h.sid,h)}),c.forEach(h=>{let m=this.getRemoteParticipantBySid(h.sid);h.sid===this.localParticipant.sid&&(m=this.localParticipant),m&&(m.audioLevel=h.level,m.setIsSpeaking(h.active),h.active?u.set(h.sid,m):u.delete(h.sid))});const d=Array.from(u.values());d.sort((h,m)=>m.audioLevel-h.audioLevel),this.activeSpeakers=d,this.emitWhenConnected(J.ActiveSpeakersChanged,d)},this.handleStreamStateUpdate=c=>{c.streamStates.forEach(u=>{const d=this.getRemoteParticipantBySid(u.participantSid);if(!d)return;const h=d.getTrackPublicationBySid(u.trackSid);if(!h||!h.track)return;const m=G.streamStateFromProto(u.state);h.track.setStreamState(m),m!==h.track.streamState&&(d.emit(ne.TrackStreamStateChanged,h,h.track.streamState),this.emitWhenConnected(J.TrackStreamStateChanged,h,h.track.streamState,d))})},this.handleSubscriptionPermissionUpdate=c=>{const u=this.getRemoteParticipantBySid(c.participantSid);if(!u)return;const d=u.getTrackPublicationBySid(c.trackSid);d&&d.setAllowed(c.allowed)},this.handleSubscriptionError=c=>{const u=Array.from(this.remoteParticipants.values()).find(h=>h.trackPublications.has(c.trackSid));if(!u)return;const d=u.getTrackPublicationBySid(c.trackSid);d&&d.setSubscriptionError(c.err)},this.handleDataPacket=c=>{const u=this.remoteParticipants.get(c.participantIdentity);if(c.value.case==="user")this.handleUserPacket(u,c.value.value,c.kind);else if(c.value.case==="transcription")this.handleTranscription(u,c.value.value);else if(c.value.case==="sipDtmf")this.handleSipDtmf(u,c.value.value);else if(c.value.case==="chatMessage")this.handleChatMessage(u,c.value.value);else if(c.value.case==="metrics")this.handleMetrics(c.value.value,u);else if(c.value.case==="streamHeader"||c.value.case==="streamChunk"||c.value.case==="streamTrailer")this.handleDataStream(c);else if(c.value.case==="rpcRequest"){const d=c.value.value;this.handleIncomingRpcRequest(c.participantIdentity,d.id,d.method,d.payload,d.responseTimeoutMs,d.version)}},this.handleUserPacket=(c,u,d)=>{this.emit(J.DataReceived,u.payload,c,d,u.topic),c?.emit(ne.DataReceived,u.payload,d)},this.handleSipDtmf=(c,u)=>{this.emit(J.SipDTMFReceived,u,c),c?.emit(ne.SipDTMFReceived,u)},this.handleTranscription=(c,u)=>{const d=u.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(u.transcribedParticipantIdentity),h=d?.trackPublications.get(u.trackId),m=rL(u,this.transcriptionReceivedTimes);h?.emit(pe.TranscriptionReceived,m),d?.emit(ne.TranscriptionReceived,m,h),this.emit(J.TranscriptionReceived,m,d,h)},this.handleChatMessage=(c,u)=>{const d=aL(u);this.emit(J.ChatMessage,d,c)},this.handleMetrics=(c,u)=>{this.emit(J.MetricsReceived,c,u)},this.handleDataStream=c=>{this.incomingDataStreamManager.handleDataStreamPacket(c)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(J.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=c=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:c})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(J.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(J.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(J.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>L(this,void 0,void 0,function*(){var c;((c=$n())===null||c===void 0?void 0:c.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(J.MediaDevicesChanged)}),this.handleRoomUpdate=c=>{const u=this.roomInfo;this.roomInfo=c,u&&u.metadata!==c.metadata&&this.emitWhenConnected(J.RoomMetadataChanged,c.metadata),u?.activeRecording!==c.activeRecording&&this.emitWhenConnected(J.RecordingStatusChanged,c.activeRecording)},this.handleConnectionQualityUpdate=c=>{c.updates.forEach(u=>{if(u.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(u.quality);return}const d=this.getRemoteParticipantBySid(u.participantSid);d&&d.setConnectionQuality(u.quality)})},this.onLocalParticipantMetadataChanged=c=>{this.emit(J.ParticipantMetadataChanged,c,this.localParticipant)},this.onLocalParticipantNameChanged=c=>{this.emit(J.ParticipantNameChanged,c,this.localParticipant)},this.onLocalAttributesChanged=c=>{this.emit(J.ParticipantAttributesChanged,c,this.localParticipant)},this.onLocalTrackMuted=c=>{this.emit(J.TrackMuted,c,this.localParticipant)},this.onLocalTrackUnmuted=c=>{this.emit(J.TrackUnmuted,c,this.localParticipant)},this.onTrackProcessorUpdate=c=>{var u;(u=c?.onPublish)===null||u===void 0||u.call(c,this)},this.onLocalTrackPublished=c=>L(this,void 0,void 0,function*(){var u,d,h,m,v,y;(u=c.track)===null||u===void 0||u.on(pe.TrackProcessorUpdate,this.onTrackProcessorUpdate),(d=c.track)===null||d===void 0||d.on(pe.Restarted,this.onLocalTrackRestarted),(v=(m=(h=c.track)===null||h===void 0?void 0:h.getProcessor())===null||m===void 0?void 0:m.onPublish)===null||v===void 0||v.call(m,this),this.emit(J.LocalTrackPublished,c,this.localParticipant),Or(c.track)&&(yield c.track.checkForSilence())&&this.emit(J.LocalAudioSilenceDetected,c);const T=yield(y=c.track)===null||y===void 0?void 0:y.getDeviceId(!1),k=Kg(c.source);k&&T&&T!==this.localParticipant.activeDeviceMap.get(k)&&(this.localParticipant.activeDeviceMap.set(k,T),this.emit(J.ActiveDeviceChanged,k,T))}),this.onLocalTrackUnpublished=c=>{var u,d;(u=c.track)===null||u===void 0||u.off(pe.TrackProcessorUpdate,this.onTrackProcessorUpdate),(d=c.track)===null||d===void 0||d.off(pe.Restarted,this.onLocalTrackRestarted),this.emit(J.LocalTrackUnpublished,c,this.localParticipant)},this.onLocalTrackRestarted=c=>L(this,void 0,void 0,function*(){const u=yield c.getDeviceId(!1),d=Kg(c.source);d&&u&&u!==this.localParticipant.activeDeviceMap.get(d)&&(this.log.debug("local track restarted, setting ".concat(d," ").concat(u," active"),this.logContext),this.localParticipant.activeDeviceMap.set(d,u),this.emit(J.ActiveDeviceChanged,d,u))}),this.onLocalConnectionQualityChanged=c=>{this.emit(J.ConnectionQualityChanged,c,this.localParticipant)},this.onMediaDevicesError=(c,u)=>{this.emit(J.MediaDevicesError,c,u)},this.onLocalParticipantPermissionsChanged=c=>{this.emit(J.ParticipantPermissionsChanged,c,this.localParticipant)},this.onLocalChatMessageSent=c=>{this.emit(J.ChatMessage,c,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},DL),e),this.log=Ur((i=this.options.loggerName)!==null&&i!==void 0?i:Ai.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},_w),e?.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},ww),e?.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},NL),e?.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new s5,this.outgoingDataStreamManager=new c5(this.engine,this.log),this.disconnectLock=new xn,this.localParticipant=new g5("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Oa(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Oa(this.options.audioCaptureDefaults.deviceId)),!((a=this.options.audioOutput)===null||a===void 0)&&a.deviceId&&this.switchActiveDevice("audiooutput",Oa(this.options.audioOutput.deviceId)).catch(c=>this.log.warn("Could not set audio output: ".concat(c.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),wn()){const c=new AbortController;(o=navigator.mediaDevices)===null||o===void 0||o.addEventListener("devicechange",this.handleDeviceChange,{signal:c.signal}),Ni.cleanupRegistry&&Ni.cleanupRegistry.register(this,()=>{c.abort()})}}registerTextStreamHandler(e,n){return this.incomingDataStreamManager.registerTextStreamHandler(e,n)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,n){return this.incomingDataStreamManager.registerByteStreamHandler(e,n)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,n){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return L(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new gL(this.options.e2ee),this.e2eeManager.on(Ra.ParticipantEncryptionStatusChanged,(n,i)=>{oL(i)&&(this.isE2EEEnabled=n),this.emit(J.ParticipantEncryptionStatusChanged,n,i)}),this.e2eeManager.on(Ra.EncryptionError,n=>this.emit(J.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}getSid(){return L(this,void 0,void 0,function*(){return this.state===et.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,n)=>{const i=a=>{a.sid!==""&&(this.engine.off(ve.RoomUpdate,i),e(a.sid))};this.engine.on(ve.RoomUpdate,i),this.once(J.Disconnected,()=>{this.engine.off(ve.RoomUpdate,i),n("Room disconnected before room server id was available")})})})}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new e5(this.options),this.engine.on(ve.ParticipantUpdate,this.handleParticipantUpdates).on(ve.RoomUpdate,this.handleRoomUpdate).on(ve.SpeakersChanged,this.handleSpeakersChanged).on(ve.StreamStateChanged,this.handleStreamStateUpdate).on(ve.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(ve.SubscriptionError,this.handleSubscriptionError).on(ve.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(ve.MediaTrackAdded,(e,n,i)=>{this.onTrackAdded(e,n,i)}).on(ve.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(ve.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(ve.DataPacketReceived,this.handleDataPacket).on(ve.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(et.SignalReconnecting)&&this.emit(J.SignalReconnecting)}).on(ve.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(et.Connected)&&this.emit(J.Reconnected)}).on(ve.SignalResumed,()=>{this.bufferedEvents=[],(this.state===et.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(ve.Restarting,this.handleRestarting).on(ve.SignalRestarted,this.handleSignalRestarted).on(ve.Offline,()=>{this.setAndEmitConnectionState(et.Reconnecting)&&this.emit(J.Reconnecting)}).on(ve.DCBufferStatusChanged,(e,n)=>{this.emit(J.DCBufferStatusChanged,e,n)}).on(ve.LocalTrackSubscribed,e=>{const n=this.localParticipant.getTrackPublications().find(i=>{let{trackSid:a}=i;return a===e});if(!n){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(ne.LocalTrackSubscribed,n),this.emitWhenConnected(J.LocalTrackSubscribed,n,this.localParticipant)}).on(ve.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((n,i)=>{this.handleParticipantDisconnected(i,n)}),this.emit(J.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Jt.getInstance().getDevices(e,n)}prepareConnection(e,n){return L(this,void 0,void 0,function*(){if(this.state===et.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(qg(new URL(e))&&n){this.regionUrlProvider=new Zg(e,n);const i=yield this.regionUrlProvider.getNextBestRegionUrl();i&&this.state===et.Disconnected&&(this.regionUrl=i,yield fetch($g(i),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(i),this.logContext))}else yield fetch($g(e),{method:"HEAD"})}catch(i){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:i}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return L(this,void 0,void 0,function*(){let i=()=>{},a;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":a=new Qi({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":a=new Qi({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":a=new Qi({scenario:{case:"serverLeave",value:!0}});break;case"migration":a=new Qi({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>L(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),a=new Qi({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>L(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),a=new Qi({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":a=new Qi({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),i=()=>L(this,void 0,void 0,function*(){const o=this.engine.client.onLeave;o&&o(new Uf({reason:Ri.CLIENT_INITIATED,action:Uo.RECONNECT}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");a=new Qi({scenario:{case:"subscriberBandwidth",value:ps(n)}});break;case"leave-full-reconnect":a=new Qi({scenario:{case:"leaveRequestFullReconnect",value:!0}})}a&&(yield this.engine.client.sendSimulateScenario(a),yield i())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){return L(this,arguments,void 0,function(i,a){var o=this;let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function*(){var u,d,h,m,v,y,T;let k=!0,E=!1;const x=c?{exact:a}:a;if(i==="audioinput"){E=o.localParticipant.audioTrackPublications.size===0;const _=(u=o.getActiveDevice(i))!==null&&u!==void 0?u:o.options.audioCaptureDefaults.deviceId;o.options.audioCaptureDefaults.deviceId=x;const N=Array.from(o.localParticipant.audioTrackPublications.values()).filter(O=>O.source===G.Source.Microphone);try{k=(yield Promise.all(N.map(O=>{var A;return(A=O.audioTrack)===null||A===void 0?void 0:A.setDeviceId(x)}))).every(O=>O===!0)}catch(O){throw o.options.audioCaptureDefaults.deviceId=_,O}const P=N.some(O=>{var A,w;return(w=(A=O.track)===null||A===void 0?void 0:A.isMuted)!==null&&w!==void 0?w:!1});k&&P&&(E=!0)}else if(i==="videoinput"){E=o.localParticipant.videoTrackPublications.size===0;const _=(d=o.getActiveDevice(i))!==null&&d!==void 0?d:o.options.videoCaptureDefaults.deviceId;o.options.videoCaptureDefaults.deviceId=x;const N=Array.from(o.localParticipant.videoTrackPublications.values()).filter(O=>O.source===G.Source.Camera);try{k=(yield Promise.all(N.map(O=>{var A;return(A=O.videoTrack)===null||A===void 0?void 0:A.setDeviceId(x)}))).every(O=>O===!0)}catch(O){throw o.options.videoCaptureDefaults.deviceId=_,O}const P=N.some(O=>{var A,w;return(w=(A=O.track)===null||A===void 0?void 0:A.isMuted)!==null&&w!==void 0?w:!1});k&&P&&(E=!0)}else if(i==="audiooutput"){if(E=!0,!Fg()&&!o.options.webAudioMix||o.options.webAudioMix&&o.audioContext&&!("setSinkId"in o.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");o.options.webAudioMix&&(a=(h=yield Jt.getInstance().normalizeDeviceId("audiooutput",a))!==null&&h!==void 0?h:""),(m=(T=o.options).audioOutput)!==null&&m!==void 0||(T.audioOutput={});const _=(v=o.getActiveDevice(i))!==null&&v!==void 0?v:o.options.audioOutput.deviceId;o.options.audioOutput.deviceId=a;try{o.options.webAudioMix&&((y=o.audioContext)===null||y===void 0||y.setSinkId(a)),yield Promise.all(Array.from(o.remoteParticipants.values()).map(N=>N.setAudioOutput({deviceId:a})))}catch(N){throw o.options.audioOutput.deviceId=_,N}}return E&&(o.localParticipant.activeDeviceMap.set(i,a),o.emit(J.ActiveDeviceChanged,i,a)),k}()})}setupLocalParticipantEvents(){this.localParticipant.on(ne.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ne.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ne.AttributesChanged,this.onLocalAttributesChanged).on(ne.TrackMuted,this.onLocalTrackMuted).on(ne.TrackUnmuted,this.onLocalTrackUnmuted).on(ne.LocalTrackPublished,this.onLocalTrackPublished).on(ne.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ne.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ne.MediaDevicesError,this.onMediaDevicesError).on(ne.AudioStreamAcquired,this.startAudio).on(ne.ChatMessage,this.onLocalChatMessageSent).on(ne.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,i){if(this.state===et.Connecting||this.state===et.Reconnecting){const v=()=>{this.onTrackAdded(e,n,i),y()},y=()=>{this.off(J.Reconnected,v),this.off(J.Connected,v),this.off(J.Disconnected,y)};this.once(J.Reconnected,v),this.once(J.Connected,v),this.once(J.Disconnected,y);return}if(this.state===et.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const a=GP(n.id),o=a[0];let c=a[1],u=e.id;if(c&&c.startsWith("TR")&&(u=c),o===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const d=Array.from(this.remoteParticipants.values()).find(v=>v.sid===o);if(!d){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(o),this.logContext);return}let h;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?h=this.options.adaptiveStream:h={});const m=d.addSubscribedMediaTrack(e,u,n,i,h);m?.isEncrypted&&!this.e2eeManager&&this.emit(J.EncryptionError,new Error("Encrypted ".concat(m.source," track received from participant ").concat(d.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var i;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearHandlersAndControllers(),this.state!==et.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(a=>{a.trackPublications.forEach(o=>{a.unpublishTrack(o.trackSid)})}),this.localParticipant.trackPublications.forEach(a=>{var o,c,u;a.track&&this.localParticipant.unpublishTrack(a.track,e),e?((o=a.track)===null||o===void 0||o.detach(),(c=a.track)===null||c===void 0||c.stop()):(u=a.track)===null||u===void 0||u.stopMonitor()}),this.localParticipant.off(ne.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ne.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ne.AttributesChanged,this.onLocalAttributesChanged).off(ne.TrackMuted,this.onLocalTrackMuted).off(ne.TrackUnmuted,this.onLocalTrackUnmuted).off(ne.LocalTrackPublished,this.onLocalTrackPublished).off(ne.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ne.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ne.MediaDevicesError,this.onMediaDevicesError).off(ne.AudioStreamAcquired,this.startAudio).off(ne.ChatMessage,this.onLocalChatMessageSent).off(ne.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),wn()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(i=navigator.mediaDevices)===null||i===void 0||i.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(et.Disconnected),this.emit(J.Disconnected,n)}}}handleParticipantDisconnected(e,n){var i;this.remoteParticipants.delete(e),n&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),n.trackPublications.forEach(a=>{n.unpublishTrack(a.trackSid,!0)}),this.emit(J.ParticipantDisconnected,n),n.setDisconnected(),(i=this.localParticipant)===null||i===void 0||i.handleParticipantDisconnected(n.identity))}handleIncomingRpcRequest(e,n,i,a,o,c){return L(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,n),c!==1){yield this.engine.publishRpcResponse(e,n,null,Nt.builtIn("UNSUPPORTED_VERSION"));return}const u=this.rpcHandlers.get(i);if(!u){yield this.engine.publishRpcResponse(e,n,null,Nt.builtIn("UNSUPPORTED_METHOD"));return}let d=null,h=null;try{const m=yield u({requestId:n,callerIdentity:e,payload:a,responseTimeout:o});Yv(m)>xw?(d=Nt.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(i))):h=m}catch(m){m instanceof Nt?d=m:(console.warn("Uncaught error returned by RPC handler for ".concat(i,". Returning APPLICATION_ERROR instead."),m),d=Nt.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,n,h,d)})}selectDefaultDevices(){return L(this,void 0,void 0,function*(){var e,n,i;const a=Jt.getInstance().previousDevices,o=yield Jt.getInstance().getDevices(void 0,!1),c=$n();if(c?.name==="Chrome"&&c.os!=="iOS")for(let d of o){const h=a.find(m=>m.deviceId===d.deviceId);h&&h.label!==""&&h.kind===d.kind&&h.label!==d.label&&this.getActiveDevice(d.kind)==="default"&&this.emit(J.ActiveDeviceChanged,d.kind,d.deviceId)}const u=["audiooutput","audioinput","videoinput"];for(let d of u){const h=cL(d),m=this.localParticipant.getTrackPublication(h);if(m&&(!((e=m.track)===null||e===void 0)&&e.isUserProvided))continue;const v=o.filter(T=>T.kind===d),y=this.getActiveDevice(d);if(y===((n=a.filter(T=>T.kind===d)[0])===null||n===void 0?void 0:n.deviceId)&&v.length>0&&((i=v[0])===null||i===void 0?void 0:i.deviceId)!==y){yield this.switchActiveDevice(d,v[0].deviceId);continue}d==="audioinput"&&!Hc()||d==="videoinput"||v.length>0&&!v.find(T=>T.deviceId===this.getActiveDevice(d))&&(d!=="audiooutput"||!Hc())&&(yield this.switchActiveDevice(d,v[0].deviceId))}})}acquireAudioContext(){return L(this,void 0,void 0,function*(){var e,n;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=Ew())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(a=>a.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),Rn(200)])}catch(a){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:a}))}const i=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";i!==this.canPlaybackAudio&&(this.audioEnabled=i,this.emit(J.AudioPlaybackStatusChanged,i))})}createParticipant(e,n){var i;let a;return n?a=vf.fromParticipantInfo(this.engine.client,n,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):a=new vf(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&a.setAudioContext(this.audioContext),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&a.setAudioOutput(this.options.audioOutput).catch(o=>this.log.warn("Could not set audio output: ".concat(o.message),this.logContext)),a}getOrCreateParticipant(e,n){if(this.remoteParticipants.has(e)){const a=this.remoteParticipants.get(e);return n&&a.updateInfo(n)&&this.sidToIdentity.set(n.sid,n.identity),a}const i=this.createParticipant(e,n);return this.remoteParticipants.set(e,i),this.sidToIdentity.set(n.sid,n.identity),this.emitWhenConnected(J.ParticipantConnected,i),i.on(ne.TrackPublished,a=>{this.emitWhenConnected(J.TrackPublished,a,i)}).on(ne.TrackSubscribed,(a,o)=>{a.kind===G.Kind.Audio?(a.on(pe.AudioPlaybackStarted,this.handleAudioPlaybackStarted),a.on(pe.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):a.kind===G.Kind.Video&&(a.on(pe.VideoPlaybackFailed,this.handleVideoPlaybackFailed),a.on(pe.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(J.TrackSubscribed,a,o,i)}).on(ne.TrackUnpublished,a=>{this.emit(J.TrackUnpublished,a,i)}).on(ne.TrackUnsubscribed,(a,o)=>{this.emit(J.TrackUnsubscribed,a,o,i)}).on(ne.TrackMuted,a=>{this.emitWhenConnected(J.TrackMuted,a,i)}).on(ne.TrackUnmuted,a=>{this.emitWhenConnected(J.TrackUnmuted,a,i)}).on(ne.ParticipantMetadataChanged,a=>{this.emitWhenConnected(J.ParticipantMetadataChanged,a,i)}).on(ne.ParticipantNameChanged,a=>{this.emitWhenConnected(J.ParticipantNameChanged,a,i)}).on(ne.AttributesChanged,a=>{this.emitWhenConnected(J.ParticipantAttributesChanged,a,i)}).on(ne.ConnectionQualityChanged,a=>{this.emitWhenConnected(J.ConnectionQualityChanged,a,i)}).on(ne.ParticipantPermissionsChanged,a=>{this.emitWhenConnected(J.ParticipantPermissionsChanged,a,i)}).on(ne.TrackSubscriptionStatusChanged,(a,o)=>{this.emitWhenConnected(J.TrackSubscriptionStatusChanged,a,o,i)}).on(ne.TrackSubscriptionFailed,(a,o)=>{this.emit(J.TrackSubscriptionFailed,a,i,o)}).on(ne.TrackSubscriptionPermissionChanged,(a,o)=>{this.emitWhenConnected(J.TrackSubscriptionPermissionChanged,a,o,i)}).on(ne.Active,()=>{this.emitWhenConnected(J.ParticipantActive,i),i.kind===Bc.AGENT&&this.localParticipant.setActiveAgent(i)}),n&&i.updateInfo(n),i}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((i,a)=>(i.push(...a.getTrackPublications()),i),[]),n=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const n of e.videoTrackPublications.values())n.isSubscribed&&sL(n)&&n.emitTrackUpdate()}getRemoteParticipantBySid(e){const n=this.sidToIdentity.get(e);if(n)return this.remoteParticipants.get(n)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=ln.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Ri.STATE_MISMATCH))):e=0},v5)}clearConnectionReconcile(){this.connectionReconcileInterval&&ln.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(J.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,i]=e;this.emit(n,...i)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];if(this.state===et.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,i]);else if(this.state===et.Connected)return this.emit(e,...i);return!1}simulateParticipants(e){return L(this,void 0,void 0,function*(){var n,i;const a=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),o=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new If({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ct.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Cs({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(J.SignalConnected),this.emit(J.Connected),this.setAndEmitConnectionState(et.Connected),a.video){const c=new pf(G.Kind.Video,new Mo({source:Bt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:ki.AUDIO,name:"video-dummy"}),new mf(a.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:xE(160*((n=o.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(c),this.localParticipant.emit(ne.LocalTrackPublished,c)}if(a.audio){const c=new pf(G.Kind.Audio,new Mo({source:Bt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:ki.AUDIO}),new hf(a.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Ap(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(c),this.localParticipant.emit(ne.LocalTrackPublished,c)}for(let c=0;c<o.count-1;c+=1){let u=new Cs({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(c),state:jo.ACTIVE,tracks:[],joinedAt:Ct.parse(Date.now())});const d=this.getOrCreateParticipant(u.identity,u);if(o.video){const h=xE(160*((i=o.aspectRatios[c%o.aspectRatios.length])!==null&&i!==void 0?i:1),160,!1,!0),m=new Mo({source:Bt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:ki.AUDIO});d.addSubscribedMediaTrack(h,m.sid,new MediaStream([h]),new RTCRtpReceiver),u.tracks=[...u.tracks,m]}if(o.audio){const h=Ap(),m=new Mo({source:Bt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:ki.AUDIO});d.addSubscribedMediaTrack(h,m.sid,new MediaStream([h]),new RTCRtpReceiver),u.tracks=[...u.tracks,m]}d.updateInfo(u)}})}emit(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];if(e!==J.ActiveSpeakersChanged&&e!==J.TranscriptionReceived){const o=Iw(i).filter(c=>c!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:o}))}return super.emit(e,...i)}}Ni.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(t=>{t()});function Iw(t){return t.map(e=>{if(e)return Array.isArray(e)?Iw(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var Ci;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(Ci||(Ci={}));class za extends or.EventEmitter{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Ci.IDLE,this.logs=[],this.options={},this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Ni(i.roomOptions),this.connectOptions=i.connectOptions,this.options=i}run(e){return L(this,void 0,void 0,function*(){if(this.status!==Ci.IDLE)throw Error("check is running already");this.setStatus(Ci.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==Ci.SKIPPED&&this.setStatus(this.isSuccess()?Ci.SUCCESS:Ci.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return L(this,void 0,void 0,function*(){return this.room.state===et.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return L(this,void 0,void 0,function*(){this.room&&this.room.state!==et.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Ci.SKIPPED)}switchProtocol(e){return L(this,void 0,void 0,function*(){let n=!1,i=!1;if(this.room.on(J.Reconnecting,()=>{n=!0}),this.room.once(J.Reconnected,()=>{i=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(o=>setTimeout(o,1e3)),!n)return;const a=Date.now()+1e4;for(;Date.now()<a;){if(i)return;yield Rn(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class b5 extends za{get description(){return"Cloud regions"}perform(){return L(this,void 0,void 0,function*(){const e=new Zg(this.url,this.token);if(!e.isCloud()){this.skip();return}const n=[],i=new Set;for(let o=0;o<3;o++){const c=yield e.getNextBestRegionUrl();if(!c)break;if(i.has(c))continue;i.add(c);const u=yield this.checkCloudRegion(c);this.appendMessage("".concat(u.region," RTT: ").concat(u.rtt,"ms, duration: ").concat(u.duration,"ms")),n.push(u)}n.sort((o,c)=>(o.duration-c.duration)*.5+(o.rtt-c.rtt)*.5);const a=n[0];this.bestStats=a,this.appendMessage("best Cloud region: ".concat(a.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return L(this,void 0,void 0,function*(){var n,i;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const a=(n=this.room.serverInfo)===null||n===void 0?void 0:n.region;if(!a)throw new Error("Region not found");const o=yield this.room.localParticipant.streamText({topic:"test"}),c=1e3,d=1e6/c,h="A".repeat(c),m=Date.now();for(let k=0;k<d;k++)yield o.write(h);yield o.close();const v=Date.now(),y=yield(i=this.room.engine.pcManager)===null||i===void 0?void 0:i.publisher.getStats(),T={region:a,rtt:1e4,duration:v-m};return y?.forEach(k=>{k.type==="candidate-pair"&&k.nominated&&(T.rtt=k.currentRoundTripTime*1e3)}),yield this.disconnect(),T})}}const Up=1e4;class y5 extends za{get description(){return"Connection via UDP vs TCP"}perform(){return L(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),n=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-n.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-n.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=n):this.appendMessage("best connection quality via udp");const i=this.bestStats;this.appendMessage("upstream bitrate: ".concat((i.bitrateTotal/i.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((i.rttTotal/i.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((i.jitterTotal/i.count*1e3).toFixed(2)," ms")),i.packetsLost>0&&this.appendWarning("packets lost: ".concat((i.packetsLost/i.packetsSent*100).toFixed(2),"%")),i.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((i.qualityLimitationDurations.bandwidth/(Up/1e3)*100).toFixed(2),"%")),i.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((i.qualityLimitationDurations.cpu/(Up/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return L(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const n=document.createElement("canvas");n.width=1280,n.height=720;const i=n.getContext("2d");if(!i)throw new Error("Could not get canvas context");let a=0;const o=()=>{a=(a+1)%360,i.fillStyle="hsl(".concat(a,", 100%, 50%)"),i.fillRect(0,0,n.width,n.height),requestAnimationFrame(o)};o();const u=n.captureStream(30).getVideoTracks()[0],h=(yield this.room.localParticipant.publishTrack(u,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,m={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},v=setInterval(()=>L(this,void 0,void 0,function*(){const y=yield h.getRTCStatsReport();y?.forEach(T=>{T.type==="outbound-rtp"?(m.packetsSent=T.packetsSent,m.qualityLimitationDurations=T.qualityLimitationDurations,m.bitrateTotal+=T.targetBitrate,m.count++):T.type==="remote-inbound-rtp"&&(m.packetsLost=T.packetsLost,m.rttTotal+=T.roundTripTime,m.jitterTotal+=T.jitter)})}),1e3);return yield new Promise(y=>setTimeout(y,Up)),clearInterval(v),u.stop(),n.remove(),yield this.disconnect(),m})}}class S5 extends za{get description(){return"Can publish audio"}perform(){return L(this,void 0,void 0,function*(){var e;const n=yield this.connect(),i=yield h5();if(yield Tw(i,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),n.localParticipant.publishTrack(i),yield new Promise(u=>setTimeout(u,3e3));const o=yield(e=i.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let c=0;if(o.forEach(u=>{u.type==="outbound-rtp"&&(u.kind==="audio"||!u.kind&&u.mediaType==="audio")&&(c=u.packetsSent)}),c===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(c," audio packets"))})}}class T5 extends za{get description(){return"Can publish video"}perform(){return L(this,void 0,void 0,function*(){var e;const n=yield this.connect(),i=yield f5();yield this.checkForVideo(i.mediaStreamTrack),n.localParticipant.publishTrack(i),yield new Promise(c=>setTimeout(c,5e3));const a=yield(e=i.sender)===null||e===void 0?void 0:e.getStats();if(!a)throw new Error("Could not get RTCStats");let o=0;if(a.forEach(c=>{c.type==="outbound-rtp"&&(c.kind==="video"||!c.kind&&c.mediaType==="video")&&(o+=c.packetsSent)}),o===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(o," video packets"))})}checkForVideo(e){return L(this,void 0,void 0,function*(){const n=new MediaStream;n.addTrack(e.clone());const i=document.createElement("video");i.srcObject=n,i.muted=!0,yield new Promise(a=>{i.onplay=()=>{setTimeout(()=>{var o,c,u,d;const h=document.createElement("canvas"),m=e.getSettings(),v=(c=(o=m.width)!==null&&o!==void 0?o:i.videoWidth)!==null&&c!==void 0?c:1280,y=(d=(u=m.height)!==null&&u!==void 0?u:i.videoHeight)!==null&&d!==void 0?d:720;h.width=v,h.height=y;const T=h.getContext("2d");T.drawImage(i,0,0);const E=T.getImageData(0,0,h.width,h.height).data;let x=!0;for(let _=0;_<E.length;_+=4)if(E[_]!==0||E[_+1]!==0||E[_+2]!==0){x=!1;break}x?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),a()},1e3)},i.play()}),n.getTracks().forEach(a=>a.stop()),i.remove()})}}class E5 extends za{get description(){return"Resuming connection after interruption"}perform(){return L(this,void 0,void 0,function*(){var e;const n=yield this.connect();let i=!1,a=!1,o;const c=new Promise(h=>{setTimeout(h,5e3),o=h}),u=()=>{i=!0};n.on(J.SignalReconnecting,u).on(J.Reconnecting,u).on(J.Reconnected,()=>{a=!0,o(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const d=n.engine.client.onClose;if(d&&d(""),yield c,i){if(!a||n.state!==et.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class C5 extends za{get description(){return"Can connect via TURN"}perform(){return L(this,void 0,void 0,function*(){var e,n;const i=new Fv,a=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let o=!1,c=!1,u=!1;for(let d of a.iceServers)for(let h of d.urls)h.startsWith("turn:")?(c=!0,u=!0):h.startsWith("turns:")&&(c=!0,u=!0,o=!0),h.startsWith("stun:")&&(u=!0);u?c&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield i.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||c?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(d=>setTimeout(d,0)))})}}class k5 extends za{get description(){return"Establishing WebRTC connection"}perform(){return L(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(J.SignalConnected,()=>{const i=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(a,o)=>{if(a.candidate){const c=new RTCIceCandidate(a);let u="".concat(c.protocol," ").concat(c.address,":").concat(c.port," ").concat(c.type);c.address&&(_5(c.address)?u+=" (private)":c.protocol==="tcp"&&c.tcpType==="passive"?(e=!0,u+=" (passive)"):c.protocol==="udp"&&(n=!0)),this.appendMessage(u)}i&&i(a,o)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=a=>{a instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(a.errorCode," ").concat(a.errorText," ").concat(a.url))})});try{yield this.connect(),Qe.info("now the room is connected")}catch(i){throw this.appendWarning("ports need to be open on firewall in order to connect."),i}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function _5(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class w5 extends za{get description(){return"Connecting to signal connection via WebSocket"}perform(){return L(this,void 0,void 0,function*(){var e,n,i;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let a=new Fv;const o=yield a.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(o.serverVersion,".")),((e=o.serverInfo)===null||e===void 0?void 0:e.edition)===E_.Cloud&&(!((n=o.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((i=o.serverInfo)===null||i===void 0?void 0:i.region)),yield a.close()})}}class Pz extends or.EventEmitter{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=n,this.options=i}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Ci.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Ci.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return L(this,void 0,void 0,function*(){const n=this.getNextCheckId(),i=new e(this.url,this.token,this.options),a=c=>{this.updateCheck(n,c)};i.on("update",a);const o=yield i.run();return i.off("update",a),o})}checkWebsocket(){return L(this,void 0,void 0,function*(){return this.createAndRunCheck(w5)})}checkWebRTC(){return L(this,void 0,void 0,function*(){return this.createAndRunCheck(k5)})}checkTURN(){return L(this,void 0,void 0,function*(){return this.createAndRunCheck(C5)})}checkReconnect(){return L(this,void 0,void 0,function*(){return this.createAndRunCheck(E5)})}checkPublishAudio(){return L(this,void 0,void 0,function*(){return this.createAndRunCheck(S5)})}checkPublishVideo(){return L(this,void 0,void 0,function*(){return this.createAndRunCheck(T5)})}checkConnectionProtocol(){return L(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(y5);if(e.data&&"protocol"in e.data){const n=e.data;this.options.protocol=n.protocol}return e})}checkCloudRegion(){return L(this,void 0,void 0,function*(){return this.createAndRunCheck(b5)})}}function x5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const i=Ss(t)?t.mediaStreamTrack:t,a=i.getSettings();let o={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in a){const c=a.facingMode;Qe.trace("rawFacingMode",{rawFacingMode:c}),c&&typeof c=="string"&&O5(c)&&(o={facingMode:c,confidence:"high"})}if(["low","medium"].includes(o.confidence)){Qe.trace("Try to get facing mode from device label: (".concat(i.label,")"));const c=A5(i.label);c!==void 0&&(o=c)}return o}const YE=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),R5=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function A5(t){var e;const n=t.trim().toLowerCase();if(n!=="")return YE.has(n)?YE.get(n):(e=Array.from(R5.entries()).find(i=>{let[a]=i;return n.includes(a)}))===null||e===void 0?void 0:e[1]}function O5(t){return t===void 0||["user","environment","left","right"].includes(t)}function N5(){const{role:t,code:e}=Kc(),[n,i]=b.useState("ready"),a=b.useRef(null),o=b.useRef(null);return b.useEffect(()=>{let c;return(async()=>{try{i("exchanging token...");const u=await fetch("/api/exchange-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:t,code:e})});if(!u.ok)throw new Error("token exchange failed");const{token:d,livekit_url:h}=await u.json();i("connecting...");const m=new Ni;await m.connect(h,d),m.on(J.TrackSubscribed,(y,T)=>{const k=T??y?.track;k?.kind===G.Kind.Video&&o.current&&k.attach(o.current)});const v=await rl({audio:!0,video:{width:1280,height:720}});for(const y of v)await m.localParticipant.publishTrack(y),y.kind===G.Kind.Video&&a.current&&y.attach(a.current);c=()=>{v.forEach(y=>y.stop()),m.disconnect()},i("connected")}catch(u){i("error: "+(u?.message??u))}})(),()=>c?.()},[t,e]),S.jsxs("div",{className:"p-6 space-y-4",children:[S.jsxs("p",{children:["Status: ",n]}),S.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[S.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full bg-black rounded-lg"}),S.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"w-full bg-black rounded-lg"})]})]})}const bf=Math.min,Ts=Math.max,yf=Math.round,_d=Math.floor,tr=t=>({x:t,y:t}),D5={left:"right",right:"left",bottom:"top",top:"bottom"},M5={start:"end",end:"start"};function KE(t,e,n){return Ts(t,bf(e,n))}function Vf(t,e){return typeof t=="function"?t(e):t}function xs(t){return t.split("-")[0]}function Hf(t){return t.split("-")[1]}function jw(t){return t==="x"?"y":"x"}function Uw(t){return t==="y"?"height":"width"}function Go(t){return["top","bottom"].includes(xs(t))?"y":"x"}function Bw(t){return jw(Go(t))}function P5(t,e,n){n===void 0&&(n=!1);const i=Hf(t),a=Bw(t),o=Uw(a);let c=a==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(c=Sf(c)),[c,Sf(c)]}function L5(t){const e=Sf(t);return[ev(t),e,ev(e)]}function ev(t){return t.replace(/start|end/g,e=>M5[e])}function I5(t,e,n){const i=["left","right"],a=["right","left"],o=["top","bottom"],c=["bottom","top"];switch(t){case"top":case"bottom":return n?e?a:i:e?i:a;case"left":case"right":return e?o:c;default:return[]}}function j5(t,e,n,i){const a=Hf(t);let o=I5(xs(t),n==="start",i);return a&&(o=o.map(c=>c+"-"+a),e&&(o=o.concat(o.map(ev)))),o}function Sf(t){return t.replace(/left|right|bottom|top/g,e=>D5[e])}function U5(t){return{top:0,right:0,bottom:0,left:0,...t}}function B5(t){return typeof t!="number"?U5(t):{top:t,right:t,bottom:t,left:t}}function Tf(t){const{x:e,y:n,width:i,height:a}=t;return{width:i,height:a,top:n,left:e,right:e+i,bottom:n+a,x:e,y:n}}function QE(t,e,n){let{reference:i,floating:a}=t;const o=Go(e),c=Bw(e),u=Uw(c),d=xs(e),h=o==="y",m=i.x+i.width/2-a.width/2,v=i.y+i.height/2-a.height/2,y=i[u]/2-a[u]/2;let T;switch(d){case"top":T={x:m,y:i.y-a.height};break;case"bottom":T={x:m,y:i.y+i.height};break;case"right":T={x:i.x+i.width,y:v};break;case"left":T={x:i.x-a.width,y:v};break;default:T={x:i.x,y:i.y}}switch(Hf(e)){case"start":T[c]-=y*(n&&h?-1:1);break;case"end":T[c]+=y*(n&&h?-1:1);break}return T}const z5=async(t,e,n)=>{const{placement:i="bottom",strategy:a="absolute",middleware:o=[],platform:c}=n,u=o.filter(Boolean),d=await(c.isRTL==null?void 0:c.isRTL(e));let h=await c.getElementRects({reference:t,floating:e,strategy:a}),{x:m,y:v}=QE(h,i,d),y=i,T={},k=0;for(let E=0;E<u.length;E++){const{name:x,fn:_}=u[E],{x:N,y:P,data:O,reset:A}=await _({x:m,y:v,initialPlacement:i,placement:y,strategy:a,middlewareData:T,rects:h,platform:c,elements:{reference:t,floating:e}});m=N??m,v=P??v,T={...T,[x]:{...T[x],...O}},A&&k<=50&&(k++,typeof A=="object"&&(A.placement&&(y=A.placement),A.rects&&(h=A.rects===!0?await c.getElementRects({reference:t,floating:e,strategy:a}):A.rects),{x:m,y:v}=QE(h,y,d)),E=-1)}return{x:m,y:v,placement:y,strategy:a,middlewareData:T}};async function zw(t,e){var n;e===void 0&&(e={});const{x:i,y:a,platform:o,rects:c,elements:u,strategy:d}=t,{boundary:h="clippingAncestors",rootBoundary:m="viewport",elementContext:v="floating",altBoundary:y=!1,padding:T=0}=Vf(e,t),k=B5(T),E=u[y?v==="floating"?"reference":"floating":v],x=Tf(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(E)))==null||n?E:E.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(u.floating)),boundary:h,rootBoundary:m,strategy:d})),_=v==="floating"?{x:i,y:a,width:c.floating.width,height:c.floating.height}:c.reference,N=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u.floating)),P=await(o.isElement==null?void 0:o.isElement(N))?await(o.getScale==null?void 0:o.getScale(N))||{x:1,y:1}:{x:1,y:1},O=Tf(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:_,offsetParent:N,strategy:d}):_);return{top:(x.top-O.top+k.top)/P.y,bottom:(O.bottom-x.bottom+k.bottom)/P.y,left:(x.left-O.left+k.left)/P.x,right:(O.right-x.right+k.right)/P.x}}const V5=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:a,middlewareData:o,rects:c,initialPlacement:u,platform:d,elements:h}=e,{mainAxis:m=!0,crossAxis:v=!0,fallbackPlacements:y,fallbackStrategy:T="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:E=!0,...x}=Vf(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const _=xs(a),N=Go(u),P=xs(u)===u,O=await(d.isRTL==null?void 0:d.isRTL(h.floating)),A=y||(P||!E?[Sf(u)]:L5(u)),w=k!=="none";!y&&w&&A.push(...j5(u,E,k,O));const V=[u,...A],M=await zw(e,x),D=[];let B=((i=o.flip)==null?void 0:i.overflows)||[];if(m&&D.push(M[_]),v){const be=P5(a,c,O);D.push(M[be[0]],M[be[1]])}if(B=[...B,{placement:a,overflows:D}],!D.every(be=>be<=0)){var Y,re;const be=(((Y=o.flip)==null?void 0:Y.index)||0)+1,xe=V[be];if(xe)return{data:{index:be,overflows:B},reset:{placement:xe}};let H=(re=B.filter(ae=>ae.overflows[0]<=0).sort((ae,ee)=>ae.overflows[1]-ee.overflows[1])[0])==null?void 0:re.placement;if(!H)switch(T){case"bestFit":{var de;const ae=(de=B.filter(ee=>{if(w){const Se=Go(ee.placement);return Se===N||Se==="y"}return!0}).map(ee=>[ee.placement,ee.overflows.filter(Se=>Se>0).reduce((Se,j)=>Se+j,0)]).sort((ee,Se)=>ee[1]-Se[1])[0])==null?void 0:de[0];ae&&(H=ae);break}case"initialPlacement":H=u;break}if(a!==H)return{reset:{placement:H}}}return{}}}};async function H5(t,e){const{placement:n,platform:i,elements:a}=t,o=await(i.isRTL==null?void 0:i.isRTL(a.floating)),c=xs(n),u=Hf(n),d=Go(n)==="y",h=["left","top"].includes(c)?-1:1,m=o&&d?-1:1,v=Vf(e,t);let{mainAxis:y,crossAxis:T,alignmentAxis:k}=typeof v=="number"?{mainAxis:v,crossAxis:0,alignmentAxis:null}:{mainAxis:v.mainAxis||0,crossAxis:v.crossAxis||0,alignmentAxis:v.alignmentAxis};return u&&typeof k=="number"&&(T=u==="end"?k*-1:k),d?{x:T*m,y:y*h}:{x:y*h,y:T*m}}const F5=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:a,y:o,placement:c,middlewareData:u}=e,d=await H5(e,t);return c===((n=u.offset)==null?void 0:n.placement)&&(i=u.arrow)!=null&&i.alignmentOffset?{}:{x:a+d.x,y:o+d.y,data:{...d,placement:c}}}}},q5=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:a}=e,{mainAxis:o=!0,crossAxis:c=!1,limiter:u={fn:x=>{let{x:_,y:N}=x;return{x:_,y:N}}},...d}=Vf(t,e),h={x:n,y:i},m=await zw(e,d),v=Go(xs(a)),y=jw(v);let T=h[y],k=h[v];if(o){const x=y==="y"?"top":"left",_=y==="y"?"bottom":"right",N=T+m[x],P=T-m[_];T=KE(N,T,P)}if(c){const x=v==="y"?"top":"left",_=v==="y"?"bottom":"right",N=k+m[x],P=k-m[_];k=KE(N,k,P)}const E=u.fn({...e,[y]:T,[v]:k});return{...E,data:{x:E.x-n,y:E.y-i,enabled:{[y]:o,[v]:c}}}}}};function Ff(){return typeof window<"u"}function al(t){return Vw(t)?(t.nodeName||"").toLowerCase():"#document"}function Gn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function lr(t){var e;return(e=(Vw(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Vw(t){return Ff()?t instanceof Node||t instanceof Gn(t).Node:!1}function Di(t){return Ff()?t instanceof Element||t instanceof Gn(t).Element:!1}function ar(t){return Ff()?t instanceof HTMLElement||t instanceof Gn(t).HTMLElement:!1}function WE(t){return!Ff()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Gn(t).ShadowRoot}function Wc(t){const{overflow:e,overflowX:n,overflowY:i,display:a}=Mi(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(a)}function $5(t){return["table","td","th"].includes(al(t))}function qf(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Wv(t){const e=Xv(),n=Di(t)?Mi(t):t;return["transform","translate","scale","rotate","perspective"].some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function G5(t){let e=Pa(t);for(;ar(e)&&!Yo(e);){if(Wv(e))return e;if(qf(e))return null;e=Pa(e)}return null}function Xv(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Yo(t){return["html","body","#document"].includes(al(t))}function Mi(t){return Gn(t).getComputedStyle(t)}function $f(t){return Di(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Pa(t){if(al(t)==="html")return t;const e=t.assignedSlot||t.parentNode||WE(t)&&t.host||lr(t);return WE(e)?e.host:e}function Hw(t){const e=Pa(t);return Yo(e)?t.ownerDocument?t.ownerDocument.body:t.body:ar(e)&&Wc(e)?e:Hw(e)}function Fc(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const a=Hw(t),o=a===((i=t.ownerDocument)==null?void 0:i.body),c=Gn(a);if(o){const u=tv(c);return e.concat(c,c.visualViewport||[],Wc(a)?a:[],u&&n?Fc(u):[])}return e.concat(a,Fc(a,[],n))}function tv(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Fw(t){const e=Mi(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const a=ar(t),o=a?t.offsetWidth:n,c=a?t.offsetHeight:i,u=yf(n)!==o||yf(i)!==c;return u&&(n=o,i=c),{width:n,height:i,$:u}}function Zv(t){return Di(t)?t:t.contextElement}function Ho(t){const e=Zv(t);if(!ar(e))return tr(1);const n=e.getBoundingClientRect(),{width:i,height:a,$:o}=Fw(e);let c=(o?yf(n.width):n.width)/i,u=(o?yf(n.height):n.height)/a;return(!c||!Number.isFinite(c))&&(c=1),(!u||!Number.isFinite(u))&&(u=1),{x:c,y:u}}const Y5=tr(0);function qw(t){const e=Gn(t);return!Xv()||!e.visualViewport?Y5:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function K5(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Gn(t)?!1:e}function Rs(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const a=t.getBoundingClientRect(),o=Zv(t);let c=tr(1);e&&(i?Di(i)&&(c=Ho(i)):c=Ho(t));const u=K5(o,n,i)?qw(o):tr(0);let d=(a.left+u.x)/c.x,h=(a.top+u.y)/c.y,m=a.width/c.x,v=a.height/c.y;if(o){const y=Gn(o),T=i&&Di(i)?Gn(i):i;let k=y,E=tv(k);for(;E&&i&&T!==k;){const x=Ho(E),_=E.getBoundingClientRect(),N=Mi(E),P=_.left+(E.clientLeft+parseFloat(N.paddingLeft))*x.x,O=_.top+(E.clientTop+parseFloat(N.paddingTop))*x.y;d*=x.x,h*=x.y,m*=x.x,v*=x.y,d+=P,h+=O,k=Gn(E),E=tv(k)}}return Tf({width:m,height:v,x:d,y:h})}function Jv(t,e){const n=$f(t).scrollLeft;return e?e.left+n:Rs(lr(t)).left+n}function $w(t,e,n){n===void 0&&(n=!1);const i=t.getBoundingClientRect(),a=i.left+e.scrollLeft-(n?0:Jv(t,i)),o=i.top+e.scrollTop;return{x:a,y:o}}function Q5(t){let{elements:e,rect:n,offsetParent:i,strategy:a}=t;const o=a==="fixed",c=lr(i),u=e?qf(e.floating):!1;if(i===c||u&&o)return n;let d={scrollLeft:0,scrollTop:0},h=tr(1);const m=tr(0),v=ar(i);if((v||!v&&!o)&&((al(i)!=="body"||Wc(c))&&(d=$f(i)),ar(i))){const T=Rs(i);h=Ho(i),m.x=T.x+i.clientLeft,m.y=T.y+i.clientTop}const y=c&&!v&&!o?$w(c,d,!0):tr(0);return{width:n.width*h.x,height:n.height*h.y,x:n.x*h.x-d.scrollLeft*h.x+m.x+y.x,y:n.y*h.y-d.scrollTop*h.y+m.y+y.y}}function W5(t){return Array.from(t.getClientRects())}function X5(t){const e=lr(t),n=$f(t),i=t.ownerDocument.body,a=Ts(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),o=Ts(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let c=-n.scrollLeft+Jv(t);const u=-n.scrollTop;return Mi(i).direction==="rtl"&&(c+=Ts(e.clientWidth,i.clientWidth)-a),{width:a,height:o,x:c,y:u}}function Z5(t,e){const n=Gn(t),i=lr(t),a=n.visualViewport;let o=i.clientWidth,c=i.clientHeight,u=0,d=0;if(a){o=a.width,c=a.height;const h=Xv();(!h||h&&e==="fixed")&&(u=a.offsetLeft,d=a.offsetTop)}return{width:o,height:c,x:u,y:d}}function J5(t,e){const n=Rs(t,!0,e==="fixed"),i=n.top+t.clientTop,a=n.left+t.clientLeft,o=ar(t)?Ho(t):tr(1),c=t.clientWidth*o.x,u=t.clientHeight*o.y,d=a*o.x,h=i*o.y;return{width:c,height:u,x:d,y:h}}function XE(t,e,n){let i;if(e==="viewport")i=Z5(t,n);else if(e==="document")i=X5(lr(t));else if(Di(e))i=J5(e,n);else{const a=qw(t);i={x:e.x-a.x,y:e.y-a.y,width:e.width,height:e.height}}return Tf(i)}function Gw(t,e){const n=Pa(t);return n===e||!Di(n)||Yo(n)?!1:Mi(n).position==="fixed"||Gw(n,e)}function e2(t,e){const n=e.get(t);if(n)return n;let i=Fc(t,[],!1).filter(u=>Di(u)&&al(u)!=="body"),a=null;const o=Mi(t).position==="fixed";let c=o?Pa(t):t;for(;Di(c)&&!Yo(c);){const u=Mi(c),d=Wv(c);!d&&u.position==="fixed"&&(a=null),(o?!d&&!a:!d&&u.position==="static"&&a&&["absolute","fixed"].includes(a.position)||Wc(c)&&!d&&Gw(t,c))?i=i.filter(h=>h!==c):a=u,c=Pa(c)}return e.set(t,i),i}function t2(t){let{element:e,boundary:n,rootBoundary:i,strategy:a}=t;const o=[...n==="clippingAncestors"?qf(e)?[]:e2(e,this._c):[].concat(n),i],c=o[0],u=o.reduce((d,h)=>{const m=XE(e,h,a);return d.top=Ts(m.top,d.top),d.right=bf(m.right,d.right),d.bottom=bf(m.bottom,d.bottom),d.left=Ts(m.left,d.left),d},XE(e,c,a));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function n2(t){const{width:e,height:n}=Fw(t);return{width:e,height:n}}function i2(t,e,n){const i=ar(e),a=lr(e),o=n==="fixed",c=Rs(t,!0,o,e);let u={scrollLeft:0,scrollTop:0};const d=tr(0);if(i||!i&&!o)if((al(e)!=="body"||Wc(a))&&(u=$f(e)),i){const y=Rs(e,!0,o,e);d.x=y.x+e.clientLeft,d.y=y.y+e.clientTop}else a&&(d.x=Jv(a));const h=a&&!i&&!o?$w(a,u):tr(0),m=c.left+u.scrollLeft-d.x-h.x,v=c.top+u.scrollTop-d.y-h.y;return{x:m,y:v,width:c.width,height:c.height}}function Bp(t){return Mi(t).position==="static"}function ZE(t,e){if(!ar(t)||Mi(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return lr(t)===n&&(n=n.ownerDocument.body),n}function Yw(t,e){const n=Gn(t);if(qf(t))return n;if(!ar(t)){let a=Pa(t);for(;a&&!Yo(a);){if(Di(a)&&!Bp(a))return a;a=Pa(a)}return n}let i=ZE(t,e);for(;i&&$5(i)&&Bp(i);)i=ZE(i,e);return i&&Yo(i)&&Bp(i)&&!Wv(i)?n:i||G5(t)||n}const r2=async function(t){const e=this.getOffsetParent||Yw,n=this.getDimensions,i=await n(t.floating);return{reference:i2(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function a2(t){return Mi(t).direction==="rtl"}const s2={convertOffsetParentRelativeRectToViewportRelativeRect:Q5,getDocumentElement:lr,getClippingRect:t2,getOffsetParent:Yw,getElementRects:r2,getClientRects:W5,getDimensions:n2,getScale:Ho,isElement:Di,isRTL:a2};function Kw(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function o2(t,e){let n=null,i;const a=lr(t);function o(){var u;clearTimeout(i),(u=n)==null||u.disconnect(),n=null}function c(u,d){u===void 0&&(u=!1),d===void 0&&(d=1),o();const h=t.getBoundingClientRect(),{left:m,top:v,width:y,height:T}=h;if(u||e(),!y||!T)return;const k=_d(v),E=_d(a.clientWidth-(m+y)),x=_d(a.clientHeight-(v+T)),_=_d(m),N={rootMargin:-k+"px "+-E+"px "+-x+"px "+-_+"px",threshold:Ts(0,bf(1,d))||1};let P=!0;function O(A){const w=A[0].intersectionRatio;if(w!==d){if(!P)return c();w?c(!1,w):i=setTimeout(()=>{c(!1,1e-7)},1e3)}w===1&&!Kw(h,t.getBoundingClientRect())&&c(),P=!1}try{n=new IntersectionObserver(O,{...N,root:a.ownerDocument})}catch{n=new IntersectionObserver(O,N)}n.observe(t)}return c(!0),o}function l2(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:d=!1}=i,h=Zv(t),m=a||o?[...h?Fc(h):[],...Fc(e)]:[];m.forEach(_=>{a&&_.addEventListener("scroll",n,{passive:!0}),o&&_.addEventListener("resize",n)});const v=h&&u?o2(h,n):null;let y=-1,T=null;c&&(T=new ResizeObserver(_=>{let[N]=_;N&&N.target===h&&T&&(T.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var P;(P=T)==null||P.observe(e)})),n()}),h&&!d&&T.observe(h),T.observe(e));let k,E=d?Rs(t):null;d&&x();function x(){const _=Rs(t);E&&!Kw(E,_)&&n(),E=_,k=requestAnimationFrame(x)}return n(),()=>{var _;m.forEach(N=>{a&&N.removeEventListener("scroll",n),o&&N.removeEventListener("resize",n)}),v?.(),(_=T)==null||_.disconnect(),T=null,d&&cancelAnimationFrame(k)}}const c2=F5,u2=q5,d2=V5,f2=(t,e,n)=>{const i=new Map,a={platform:s2,...n},o={...a.platform,_c:i};return z5(t,e,{...a,platform:o})};var wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var nv={exports:{}},h2=nv.exports,JE;function m2(){return JE||(JE=1,function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(h2,function(){var e=function(){},n="undefined",i=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),a=["trace","debug","info","warn","error"],o={},c=null;function u(E,x){var _=E[x];if(typeof _.bind=="function")return _.bind(E);try{return Function.prototype.bind.call(_,E)}catch{return function(){return Function.prototype.apply.apply(_,[E,arguments])}}}function d(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function h(E){return E==="debug"&&(E="log"),typeof console===n?!1:E==="trace"&&i?d:console[E]!==void 0?u(console,E):console.log!==void 0?u(console,"log"):e}function m(){for(var E=this.getLevel(),x=0;x<a.length;x++){var _=a[x];this[_]=x<E?e:this.methodFactory(_,E,this.name)}if(this.log=this.debug,typeof console===n&&E<this.levels.SILENT)return"No console available for logging"}function v(E){return function(){typeof console!==n&&(m.call(this),this[E].apply(this,arguments))}}function y(E,x,_){return h(E)||v.apply(this,arguments)}function T(E,x){var _=this,N,P,O,A="loglevel";typeof E=="string"?A+=":"+E:typeof E=="symbol"&&(A=void 0);function w(Y){var re=(a[Y]||"silent").toUpperCase();if(!(typeof window===n||!A)){try{window.localStorage[A]=re;return}catch{}try{window.document.cookie=encodeURIComponent(A)+"="+re+";"}catch{}}}function V(){var Y;if(!(typeof window===n||!A)){try{Y=window.localStorage[A]}catch{}if(typeof Y===n)try{var re=window.document.cookie,de=encodeURIComponent(A),be=re.indexOf(de+"=");be!==-1&&(Y=/^([^;]+)/.exec(re.slice(be+de.length+1))[1])}catch{}return _.levels[Y]===void 0&&(Y=void 0),Y}}function M(){if(!(typeof window===n||!A)){try{window.localStorage.removeItem(A)}catch{}try{window.document.cookie=encodeURIComponent(A)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function D(Y){var re=Y;if(typeof re=="string"&&_.levels[re.toUpperCase()]!==void 0&&(re=_.levels[re.toUpperCase()]),typeof re=="number"&&re>=0&&re<=_.levels.SILENT)return re;throw new TypeError("log.setLevel() called with invalid level: "+Y)}_.name=E,_.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},_.methodFactory=x||y,_.getLevel=function(){return O??P??N},_.setLevel=function(Y,re){return O=D(Y),re!==!1&&w(O),m.call(_)},_.setDefaultLevel=function(Y){P=D(Y),V()||_.setLevel(Y,!1)},_.resetLevel=function(){O=null,M(),m.call(_)},_.enableAll=function(Y){_.setLevel(_.levels.TRACE,Y)},_.disableAll=function(Y){_.setLevel(_.levels.SILENT,Y)},_.rebuild=function(){if(c!==_&&(N=D(c.getLevel())),m.call(_),c===_)for(var Y in o)o[Y].rebuild()},N=D(c?c.getLevel():"WARN");var B=V();B!=null&&(O=D(B)),m.call(_)}c=new T,c.getLogger=function(E){if(typeof E!="symbol"&&typeof E!="string"||E==="")throw new TypeError("You must supply a name when creating a logger.");var x=o[E];return x||(x=o[E]=new T(E,c.methodFactory)),x};var k=typeof window!==n?window.log:void 0;return c.noConflict=function(){return typeof window!==n&&window.log===c&&(window.log=k),c},c.getLoggers=function(){return o},c.default=c,c})}(nv)),nv.exports}var p2=m2();const g2=Qw(p2);var iv=function(t,e){return iv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},iv(t,e)};function Vr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");iv(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function v2(t,e,n,i){function a(o){return o instanceof n?o:new n(function(c){c(o)})}return new(n||(n=Promise))(function(o,c){function u(m){try{h(i.next(m))}catch(v){c(v)}}function d(m){try{h(i.throw(m))}catch(v){c(v)}}function h(m){m.done?o(m.value):a(m.value).then(u,d)}h((i=i.apply(t,[])).next())})}function Ww(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,a,o,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=u(0),c.throw=u(1),c.return=u(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(h){return function(m){return d([h,m])}}function d(h){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,h[0]&&(n=0)),n;)try{if(i=1,a&&(o=h[0]&2?a.return:h[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,h[1])).done)return o;switch(a=0,o&&(h=[h[0]&2,o.value]),h[0]){case 0:case 1:o=h;break;case 4:return n.label++,{value:h[1],done:!1};case 5:n.label++,a=h[1],h=[0];continue;case 7:h=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(h[0]===6||h[0]===2)){n=0;continue}if(h[0]===3&&(!o||h[1]>o[0]&&h[1]<o[3])){n.label=h[1];break}if(h[0]===6&&n.label<o[1]){n.label=o[1],o=h;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(h);break}o[2]&&n.ops.pop(),n.trys.pop();continue}h=e.call(t,n)}catch(m){h=[6,m],a=0}finally{i=o=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Ko(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qo(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),a,o=[],c;try{for(;(e===void 0||e-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(u){c={error:u}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(c)throw c.error}}return o}function qc(t,e,n){if(arguments.length===2)for(var i=0,a=e.length,o;i<a;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))}function Fo(t){return this instanceof Fo?(this.v=t,this):new Fo(t)}function b2(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),a,o=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(T){return function(k){return Promise.resolve(k).then(T,v)}}function u(T,k){i[T]&&(a[T]=function(E){return new Promise(function(x,_){o.push([T,E,x,_])>1||d(T,E)})},k&&(a[T]=k(a[T])))}function d(T,k){try{h(i[T](k))}catch(E){y(o[0][3],E)}}function h(T){T.value instanceof Fo?Promise.resolve(T.value.v).then(m,v):y(o[0][2],T)}function m(T){d("next",T)}function v(T){d("throw",T)}function y(T,k){T(k),o.shift(),o.length&&d(o[0][0],o[0][1])}}function y2(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Ko=="function"?Ko(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(o){n[o]=t[o]&&function(c){return new Promise(function(u,d){c=t[o](c),a(u,d,c.done,c.value)})}}function a(o,c,u,d){Promise.resolve(d).then(function(h){o({value:h,done:u})},c)}}function bt(t){return typeof t=="function"}function eb(t){var e=function(i){Error.call(i),i.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var zp=eb(function(t){return function(e){t(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function Ef(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Xc=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,i,a,o;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var u=Ko(c),d=u.next();!d.done;d=u.next()){var h=d.value;h.remove(this)}}catch(E){e={error:E}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}else c.remove(this);var m=this.initialTeardown;if(bt(m))try{m()}catch(E){o=E instanceof zp?E.errors:[E]}var v=this._finalizers;if(v){this._finalizers=null;try{for(var y=Ko(v),T=y.next();!T.done;T=y.next()){var k=T.value;try{eC(k)}catch(E){o=o??[],E instanceof zp?o=qc(qc([],Qo(o)),Qo(E.errors)):o.push(E)}}}catch(E){i={error:E}}finally{try{T&&!T.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}}if(o)throw new zp(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)eC(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&Ef(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&Ef(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),Xw=Xc.EMPTY;function Zw(t){return t instanceof Xc||t&&"closed"in t&&bt(t.remove)&&bt(t.add)&&bt(t.unsubscribe)}function eC(t){bt(t)?t():t.unsubscribe()}var S2={Promise:void 0},T2={setTimeout:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout.apply(void 0,qc([t,e],Qo(n)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function Jw(t){T2.setTimeout(function(){throw t})}function Cf(){}function tf(t){t()}var tb=function(t){Vr(e,t);function e(n){var i=t.call(this)||this;return i.isStopped=!1,n?(i.destination=n,Zw(n)&&n.add(i)):i.destination=k2,i}return e.create=function(n,i,a){return new rv(n,i,a)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Xc),E2=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(i){xd(i)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(i){xd(i)}else xd(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){xd(n)}},t}(),rv=function(t){Vr(e,t);function e(n,i,a){var o=t.call(this)||this,c;return bt(n)||!n?c={next:n??void 0,error:i??void 0,complete:a??void 0}:c=n,o.destination=new E2(c),o}return e}(tb);function xd(t){Jw(t)}function C2(t){throw t}var k2={closed:!0,next:Cf,error:C2,complete:Cf},nb=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ib(t){return t}function _2(t){return t.length===0?ib:t.length===1?t[0]:function(e){return t.reduce(function(n,i){return i(n)},e)}}var Kt=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,i){var a=this,o=x2(e)?e:new rv(e,n,i);return tf(function(){var c=a,u=c.operator,d=c.source;o.add(u?u.call(o,d):d?a._subscribe(o):a._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var i=this;return n=tC(n),new n(function(a,o){var c=new rv({next:function(u){try{e(u)}catch(d){o(d),c.unsubscribe()}},error:o,complete:a});i.subscribe(c)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[nb]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return _2(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=tC(e),new e(function(i,a){var o;n.subscribe(function(c){return o=c},function(c){return a(c)},function(){return i(o)})})},t.create=function(e){return new t(e)},t}();function tC(t){var e;return(e=t??S2.Promise)!==null&&e!==void 0?e:Promise}function w2(t){return t&&bt(t.next)&&bt(t.error)&&bt(t.complete)}function x2(t){return t&&t instanceof tb||w2(t)&&Zw(t)}function R2(t){return bt(t?.lift)}function Ui(t){return function(e){if(R2(e))return e.lift(function(n){try{return t(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Pi(t,e,n,i,a){return new A2(t,e,n,i,a)}var A2=function(t){Vr(e,t);function e(n,i,a,o,c,u){var d=t.call(this,n)||this;return d.onFinalize=c,d.shouldUnsubscribe=u,d._next=i?function(h){try{i(h)}catch(m){n.error(m)}}:t.prototype._next,d._error=o?function(h){try{o(h)}catch(m){n.error(m)}finally{this.unsubscribe()}}:t.prototype._error,d._complete=a?function(){try{a()}catch(h){n.error(h)}finally{this.unsubscribe()}}:t.prototype._complete,d}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;t.prototype.unsubscribe.call(this),!i&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(tb),O2=eb(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),As=function(t){Vr(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var i=new nC(this,this);return i.operator=n,i},e.prototype._throwIfClosed=function(){if(this.closed)throw new O2},e.prototype.next=function(n){var i=this;tf(function(){var a,o;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var c=Ko(i.currentObservers),u=c.next();!u.done;u=c.next()){var d=u.value;d.next(n)}}catch(h){a={error:h}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(a)throw a.error}}}})},e.prototype.error=function(n){var i=this;tf(function(){if(i._throwIfClosed(),!i.isStopped){i.hasError=i.isStopped=!0,i.thrownError=n;for(var a=i.observers;a.length;)a.shift().error(n)}})},e.prototype.complete=function(){var n=this;tf(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var i=n.observers;i.length;)i.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var i=this,a=this,o=a.hasError,c=a.isStopped,u=a.observers;return o||c?Xw:(this.currentObservers=null,u.push(n),new Xc(function(){i.currentObservers=null,Ef(u,n)}))},e.prototype._checkFinalizedStatuses=function(n){var i=this,a=i.hasError,o=i.thrownError,c=i.isStopped;a?n.error(o):c&&n.complete()},e.prototype.asObservable=function(){var n=new Kt;return n.source=this,n},e.create=function(n,i){return new nC(n,i)},e}(Kt),nC=function(t){Vr(e,t);function e(n,i){var a=t.call(this)||this;return a.destination=n,a.source=i,a}return e.prototype.next=function(n){var i,a;(a=(i=this.destination)===null||i===void 0?void 0:i.next)===null||a===void 0||a.call(i,n)},e.prototype.error=function(n){var i,a;(a=(i=this.destination)===null||i===void 0?void 0:i.error)===null||a===void 0||a.call(i,n)},e.prototype.complete=function(){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||i===void 0||i.call(n)},e.prototype._subscribe=function(n){var i,a;return(a=(i=this.source)===null||i===void 0?void 0:i.subscribe(n))!==null&&a!==void 0?a:Xw},e}(As),e1=function(t){Vr(e,t);function e(n){var i=t.call(this)||this;return i._value=n,i}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var i=t.prototype._subscribe.call(this,n);return!i.closed&&n.next(this._value),i},e.prototype.getValue=function(){var n=this,i=n.hasError,a=n.thrownError,o=n._value;if(i)throw a;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(As),N2={now:function(){return Date.now()}},D2=function(t){Vr(e,t);function e(n,i){return t.call(this)||this}return e.prototype.schedule=function(n,i){return this},e}(Xc),iC={setInterval:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setInterval.apply(void 0,qc([t,e],Qo(n)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},M2=function(t){Vr(e,t);function e(n,i){var a=t.call(this,n,i)||this;return a.scheduler=n,a.work=i,a.pending=!1,a}return e.prototype.schedule=function(n,i){var a;if(i===void 0&&(i=0),this.closed)return this;this.state=n;var o=this.id,c=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(c,o,i)),this.pending=!0,this.delay=i,this.id=(a=this.id)!==null&&a!==void 0?a:this.requestAsyncId(c,this.id,i),this},e.prototype.requestAsyncId=function(n,i,a){return a===void 0&&(a=0),iC.setInterval(n.flush.bind(n,this),a)},e.prototype.recycleAsyncId=function(n,i,a){if(a===void 0&&(a=0),a!=null&&this.delay===a&&this.pending===!1)return i;i!=null&&iC.clearInterval(i)},e.prototype.execute=function(n,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var a=this._execute(n,i);if(a)return a;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,i){var a=!1,o;try{this.work(n)}catch(c){a=!0,o=c||new Error("Scheduled action threw falsy error")}if(a)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,i=n.id,a=n.scheduler,o=a.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ef(o,this),i!=null&&(this.id=this.recycleAsyncId(a,i,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(D2),rC=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,i){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(i,n)},t.now=N2.now,t}(),P2=function(t){Vr(e,t);function e(n,i){i===void 0&&(i=rC.now);var a=t.call(this,n,i)||this;return a.actions=[],a._active=!1,a}return e.prototype.flush=function(n){var i=this.actions;if(this._active){i.push(n);return}var a;this._active=!0;do if(a=n.execute(n.state,n.delay))break;while(n=i.shift());if(this._active=!1,a){for(;n=i.shift();)n.unsubscribe();throw a}},e}(rC),L2=new P2(M2);function I2(t){return t&&bt(t.schedule)}function j2(t){return t[t.length-1]}function rb(t){return I2(j2(t))?t.pop():void 0}var ab=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function t1(t){return bt(t?.then)}function n1(t){return bt(t[nb])}function i1(t){return Symbol.asyncIterator&&bt(t?.[Symbol.asyncIterator])}function r1(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function U2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var a1=U2();function s1(t){return bt(t?.[a1])}function o1(t){return b2(this,arguments,function(){var e,n,i,a;return Ww(this,function(o){switch(o.label){case 0:e=t.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,Fo(e.read())];case 3:return n=o.sent(),i=n.value,a=n.done,a?[4,Fo(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,Fo(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function l1(t){return bt(t?.getReader)}function Hr(t){if(t instanceof Kt)return t;if(t!=null){if(n1(t))return B2(t);if(ab(t))return z2(t);if(t1(t))return V2(t);if(i1(t))return c1(t);if(s1(t))return H2(t);if(l1(t))return F2(t)}throw r1(t)}function B2(t){return new Kt(function(e){var n=t[nb]();if(bt(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function z2(t){return new Kt(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function V2(t){return new Kt(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,Jw)})}function H2(t){return new Kt(function(e){var n,i;try{for(var a=Ko(t),o=a.next();!o.done;o=a.next()){var c=o.value;if(e.next(c),e.closed)return}}catch(u){n={error:u}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}e.complete()})}function c1(t){return new Kt(function(e){q2(t,e).catch(function(n){return e.error(n)})})}function F2(t){return c1(o1(t))}function q2(t,e){var n,i,a,o;return v2(this,void 0,void 0,function(){var c,u;return Ww(this,function(d){switch(d.label){case 0:d.trys.push([0,5,6,11]),n=y2(t),d.label=1;case 1:return[4,n.next()];case 2:if(i=d.sent(),!!i.done)return[3,4];if(c=i.value,e.next(c),e.closed)return[2];d.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=d.sent(),a={error:u},[3,11];case 6:return d.trys.push([6,,9,10]),i&&!i.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:d.sent(),d.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Na(t,e,n,i,a){i===void 0&&(i=0),a===void 0&&(a=!1);var o=e.schedule(function(){n(),a?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(o),!a)return o}function u1(t,e){return e===void 0&&(e=0),Ui(function(n,i){n.subscribe(Pi(i,function(a){return Na(i,t,function(){return i.next(a)},e)},function(){return Na(i,t,function(){return i.complete()},e)},function(a){return Na(i,t,function(){return i.error(a)},e)}))})}function d1(t,e){return e===void 0&&(e=0),Ui(function(n,i){i.add(t.schedule(function(){return n.subscribe(i)},e))})}function $2(t,e){return Hr(t).pipe(d1(e),u1(e))}function G2(t,e){return Hr(t).pipe(d1(e),u1(e))}function Y2(t,e){return new Kt(function(n){var i=0;return e.schedule(function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())})})}function K2(t,e){return new Kt(function(n){var i;return Na(n,e,function(){i=t[a1](),Na(n,e,function(){var a,o,c;try{a=i.next(),o=a.value,c=a.done}catch(u){n.error(u);return}c?n.complete():n.next(o)},0,!0)}),function(){return bt(i?.return)&&i.return()}})}function f1(t,e){if(!t)throw new Error("Iterable cannot be null");return new Kt(function(n){Na(n,e,function(){var i=t[Symbol.asyncIterator]();Na(n,e,function(){i.next().then(function(a){a.done?n.complete():n.next(a.value)})},0,!0)})})}function Q2(t,e){return f1(o1(t),e)}function W2(t,e){if(t!=null){if(n1(t))return $2(t,e);if(ab(t))return Y2(t,e);if(t1(t))return G2(t,e);if(i1(t))return f1(t,e);if(s1(t))return K2(t,e);if(l1(t))return Q2(t,e)}throw r1(t)}function sb(t,e){return e?W2(t,e):Hr(t)}function aC(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=rb(t);return sb(t,n)}function X2(t){return t instanceof Date&&!isNaN(t)}var Z2=eb(function(t){return function(e){e===void 0&&(e=null),t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e}});function J2(t,e){var n=X2(t)?{first:t}:typeof t=="number"?{each:t}:t,i=n.first,a=n.each,o=n.with,c=o===void 0?eI:o,u=n.scheduler,d=u===void 0?L2:u,h=n.meta,m=h===void 0?null:h;if(i==null&&a==null)throw new TypeError("No timeout provided.");return Ui(function(v,y){var T,k,E=null,x=0,_=function(N){k=Na(y,d,function(){try{T.unsubscribe(),Hr(c({meta:m,lastValue:E,seen:x})).subscribe(y)}catch(P){y.error(P)}},N)};T=v.subscribe(Pi(y,function(N){k?.unsubscribe(),x++,y.next(E=N),a>0&&_(a)},void 0,void 0,function(){k!=null&&k.closed||k==null||k.unsubscribe(),E=null})),!x&&_(i!=null?typeof i=="number"?i:+i-d.now():a)})}function eI(t){throw new Z2(t)}function zt(t,e){return Ui(function(n,i){var a=0;n.subscribe(Pi(i,function(o){i.next(t.call(e,o,a++))}))})}var tI=Array.isArray;function nI(t,e){return tI(e)?t.apply(void 0,qc([],Qo(e))):t(e)}function iI(t){return zt(function(e){return nI(t,e)})}function rI(t,e,n,i,a,o,c,u){var d=[],h=0,m=0,v=!1,y=function(){v&&!d.length&&!h&&e.complete()},T=function(E){return h<i?k(E):d.push(E)},k=function(E){h++;var x=!1;Hr(n(E,m++)).subscribe(Pi(e,function(_){e.next(_)},function(){x=!0},void 0,function(){if(x)try{h--;for(var _=function(){var N=d.shift();c||k(N)};d.length&&h<i;)_();y()}catch(N){e.error(N)}}))};return t.subscribe(Pi(e,T,function(){v=!0,y()})),function(){}}function ob(t,e,n){return n===void 0&&(n=1/0),bt(e)?ob(function(i,a){return zt(function(o,c){return e(i,o,a,c)})(Hr(t(i,a)))},n):(typeof e=="number"&&(n=e),Ui(function(i,a){return rI(i,a,t,n)}))}function aI(t){return ob(ib,t)}function sI(){return aI(1)}function kf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return sI()(sb(t,rb(t)))}var oI=["addListener","removeListener"],lI=["addEventListener","removeEventListener"],cI=["on","off"];function av(t,e,n,i){if(bt(n)&&(i=n,n=void 0),i)return av(t,e,n).pipe(iI(i));var a=Qo(fI(t)?lI.map(function(u){return function(d){return t[u](e,d,n)}}):uI(t)?oI.map(sC(t,e)):dI(t)?cI.map(sC(t,e)):[],2),o=a[0],c=a[1];if(!o&&ab(t))return ob(function(u){return av(u,e,n)})(Hr(t));if(!o)throw new TypeError("Invalid event target");return new Kt(function(u){var d=function(){for(var h=[],m=0;m<arguments.length;m++)h[m]=arguments[m];return u.next(1<h.length?h:h[0])};return o(d),function(){return c(d)}})}function sC(t,e){return function(n){return function(i){return t[n](e,i)}}}function uI(t){return bt(t.addListener)&&bt(t.removeListener)}function dI(t){return bt(t.on)&&bt(t.off)}function fI(t){return bt(t.addEventListener)&&bt(t.removeEventListener)}function Gf(t,e){return Ui(function(n,i){var a=0;n.subscribe(Pi(i,function(o){return t.call(e,o,a++)&&i.next(o)}))})}function hI(t,e,n,i,a){return function(o,c){var u=n,d=e,h=0;o.subscribe(Pi(c,function(m){var v=h++;d=u?t(d,m,v):(u=!0,m),c.next(d)},a))}}function mI(t,e){return e===void 0&&(e=ib),t=t??pI,Ui(function(n,i){var a,o=!0;n.subscribe(Pi(i,function(c){var u=e(c);(o||!t(a,u))&&(o=!1,a=u,i.next(c))}))})}function pI(t,e){return t===e}function oC(t,e){return Ui(hI(t,e,arguments.length>=2,!0))}function gI(t){return Ui(function(e,n){var i=!1,a=Pi(n,function(){a?.unsubscribe(),i=!0},Cf);Hr(t).subscribe(a),e.subscribe(Pi(n,function(o){return i&&n.next(o)}))})}function Bi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=rb(t);return Ui(function(i,a){(n?kf(t,i,n):kf(t,i)).subscribe(a)})}function lC(t){return Ui(function(e,n){Hr(t).subscribe(Pi(n,function(){return n.complete()},Cf)),!n.closed&&e.subscribe(n)})}var vI=Object.defineProperty,bI=Object.defineProperties,yI=Object.getOwnPropertyDescriptors,cC=Object.getOwnPropertySymbols,SI=Object.prototype.hasOwnProperty,TI=Object.prototype.propertyIsEnumerable,uC=(t,e,n)=>e in t?vI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xa=(t,e)=>{for(var n in e||(e={}))SI.call(e,n)&&uC(t,n,e[n]);if(cC)for(var n of cC(e))TI.call(e,n)&&uC(t,n,e[n]);return t},Sc=(t,e)=>bI(t,yI(e)),Li=(t,e,n)=>new Promise((i,a)=>{var o=d=>{try{u(n.next(d))}catch(h){a(h)}},c=d=>{try{u(n.throw(d))}catch(h){a(h)}},u=d=>d.done?i(d.value):Promise.resolve(d.value).then(o,c);u((n=n.apply(t,e)).next())}),h1="lk";function Yt(t){return typeof t>"u"?!1:EI(t)||CI(t)}function EI(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function CI(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function $c(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function en(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if($c(t))return`${t.participant.identity}_${t.source}_placeholder`;if(Yt(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function kI(t,e){return t===void 0||e===void 0?!1:Yt(t)&&Yt(e)?t.publication.trackSid===e.publication.trackSid:en(t)===en(e)}function m1(t,e){return typeof e>"u"?!1:Yt(t)?e.some(n=>n.participant.identity===t.participant.identity&&Yt(n)&&n.publication.trackSid===t.publication.trackSid):$c(t)?e.some(n=>n.participant.identity===t.participant.identity&&$c(n)&&n.source===t.source):!1}function _I(t,e){return $c(t)&&Yt(e)&&e.participant.identity===t.participant.identity&&e.source===t.source}function wI(){const t=document.createElement("p");t.style.width="100%",t.style.height="200px";const e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);const n=t.offsetWidth;e.style.overflow="scroll";let i=t.offsetWidth;return n===i&&(i=e.clientWidth),document.body.removeChild(e),n-i}function xI(){return typeof document<"u"}function RI(t,e,n){return l2(t,e,()=>Li(this,null,function*(){const{x:i,y:a}=yield f2(t,e,{placement:"top",middleware:[c2(6),d2(),u2({padding:5})]});n?.(i,a)}))}function AI(t,e){return!t.contains(e.target)}var OI=[J.ConnectionStateChanged,J.RoomMetadataChanged,J.ActiveSpeakersChanged,J.ConnectionQualityChanged,J.ParticipantConnected,J.ParticipantDisconnected,J.ParticipantPermissionsChanged,J.ParticipantMetadataChanged,J.ParticipantNameChanged,J.ParticipantAttributesChanged,J.TrackMuted,J.TrackUnmuted,J.TrackPublished,J.TrackUnpublished,J.TrackStreamStateChanged,J.TrackSubscriptionFailed,J.TrackSubscriptionPermissionChanged,J.TrackSubscriptionStatusChanged],NI=[...OI,J.LocalTrackPublished,J.LocalTrackUnpublished];ne.TrackPublished,ne.TrackUnpublished,ne.TrackMuted,ne.TrackUnmuted,ne.TrackStreamStateChanged,ne.TrackSubscribed,ne.TrackUnsubscribed,ne.TrackSubscriptionPermissionChanged,ne.TrackSubscriptionFailed,ne.LocalTrackPublished,ne.LocalTrackUnpublished;var DI=[ne.ConnectionQualityChanged,ne.IsSpeakingChanged,ne.ParticipantMetadataChanged,ne.ParticipantPermissionsChanged,ne.TrackMuted,ne.TrackUnmuted,ne.TrackPublished,ne.TrackUnpublished,ne.TrackStreamStateChanged,ne.TrackSubscriptionFailed,ne.TrackSubscriptionPermissionChanged,ne.TrackSubscriptionStatusChanged];[...DI,ne.LocalTrackPublished,ne.LocalTrackUnpublished];var Ye=g2.getLogger("lk-components-js");Ye.setDefaultLevel("WARN");var MI=[{columns:1,rows:1},{columns:1,rows:2,orientation:"portrait"},{columns:2,rows:1,orientation:"landscape"},{columns:2,rows:2,minWidth:560},{columns:3,rows:3,minWidth:700},{columns:4,rows:4,minWidth:960},{columns:5,rows:5,minWidth:1100}];function p1(t,e,n,i){if(t.length<1)throw new Error("At least one grid layout definition must be provided.");const a=PI(t);if(n<=0||i<=0)return a[0];let o=0;const c=n/i>1?"landscape":"portrait";let u=a.find((d,h,m)=>{o=h;const v=m.findIndex((y,T)=>{const k=!y.orientation||y.orientation===c,E=T>h,x=y.maxTiles===d.maxTiles;return E&&x&&k})!==-1;return d.maxTiles>=e&&!v});if(u===void 0)if(u=a[a.length-1],u)Ye.warn(`No layout found for: participantCount: ${e}, width/height: ${n}/${i} fallback to biggest available layout (${u}).`);else throw new Error("No layout or fallback layout found.");if((n<u.minWidth||i<u.minHeight)&&o>0){const d=a[o-1];u=p1(a.slice(0,o),d.maxTiles,n,i)}return u}function PI(t){return[...t].map(e=>{var n,i;return{name:`${e.columns}x${e.rows}`,columns:e.columns,rows:e.rows,maxTiles:e.columns*e.rows,minWidth:(n=e.minWidth)!=null?n:0,minHeight:(i=e.minHeight)!=null?i:0,orientation:e.orientation}}).sort((e,n)=>e.maxTiles!==n.maxTiles?e.maxTiles-n.maxTiles:e.minWidth!==0||n.minWidth!==0?e.minWidth-n.minWidth:e.minHeight!==0||n.minHeight!==0?e.minHeight-n.minHeight:0)}function LI(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var g1=[],v1={showChat:!1,unreadMessages:0,showSettings:!1};function b1(t){return typeof t=="object"}function y1(t){return Array.isArray(t)&&t.filter(b1).length>0}function II(t,e){return e.audioLevel-t.audioLevel}function jI(t,e){return t.isSpeaking===e.isSpeaking?0:t.isSpeaking?-1:1}function UI(t,e){var n,i,a,o;return t.lastSpokeAt!==void 0||e.lastSpokeAt!==void 0?((i=(n=e.lastSpokeAt)==null?void 0:n.getTime())!=null?i:0)-((o=(a=t.lastSpokeAt)==null?void 0:a.getTime())!=null?o:0):0}function sv(t,e){var n,i,a,o;return((i=(n=t.joinedAt)==null?void 0:n.getTime())!=null?i:0)-((o=(a=e.joinedAt)==null?void 0:a.getTime())!=null?o:0)}function BI(t,e){return Yt(t)?Yt(e)?0:-1:Yt(e)?1:0}function zI(t,e){const n=t.participant.isCameraEnabled,i=e.participant.isCameraEnabled;return n!==i?n?-1:1:0}function VI(t){const e=[],n=[],i=[],a=[];t.forEach(u=>{u.participant.isLocal&&u.source===G.Source.Camera?e.push(u):u.source===G.Source.ScreenShare?n.push(u):u.source===G.Source.Camera?i.push(u):a.push(u)});const o=HI(n),c=FI(i);return[...e,...o,...c,...a]}function HI(t){const e=[],n=[];return t.forEach(i=>{i.participant.isLocal?e.push(i):n.push(i)}),e.sort((i,a)=>sv(i.participant,a.participant)),n.sort((i,a)=>sv(i.participant,a.participant)),[...n,...e]}function FI(t){const e=[],n=[];return t.forEach(i=>{i.participant.isLocal?e.push(i):n.push(i)}),n.sort((i,a)=>i.participant.isSpeaking&&a.participant.isSpeaking?II(i.participant,a.participant):i.participant.isSpeaking!==a.participant.isSpeaking?jI(i.participant,a.participant):i.participant.lastSpokeAt!==a.participant.lastSpokeAt?UI(i.participant,a.participant):Yt(i)!==Yt(a)?BI(i,a):i.participant.isCameraEnabled!==a.participant.isCameraEnabled?zI(i,a):sv(i.participant,a.participant)),[...e,...n]}function qI(t,e){return t.reduce((n,i,a)=>a%e===0?[...n,[i]]:[...n.slice(0,-1),[...n.slice(-1)[0],i]],[])}function dC(t,e){const n=Math.max(t.length,e.length);return new Array(n).fill([]).map((i,a)=>[t[a],e[a]])}function _f(t,e,n){return t.filter(i=>!e.map(a=>n(a)).includes(n(i)))}function ov(t){return t.map(e=>typeof e=="string"||typeof e=="number"?`${e}`:en(e))}function $I(t,e){return{dropped:_f(t,e,en),added:_f(e,t,en)}}function GI(t){return t.added.length!==0||t.dropped.length!==0}function lv(t,e){const n=e.findIndex(i=>en(i)===en(t));if(n===-1)throw new Error(`Element not part of the array: ${en(t)} not in ${ov(e)}`);return n}function YI(t,e,n){const i=lv(t,n),a=lv(e,n);return n.splice(i,1,e),n.splice(a,1,t),n}function KI(t,e){const n=lv(t,e);return e.splice(n,1),e}function QI(t,e){return[...e,t]}function Vp(t,e){return qI(t,e)}function WI(t,e,n){let i=XI(t,e);if(i.length<e.length){const c=_f(e,i,en);i=[...i,...c]}const a=Vp(i,n),o=Vp(e,n);if(dC(a,o).forEach(([c,u],d)=>{if(c&&u){const h=Vp(i,n)[d],m=$I(h,u);GI(m)&&(Ye.debug(`Detected visual changes on page: ${d}, current: ${ov(c)}, next: ${ov(u)}`,{changes:m}),m.added.length===m.dropped.length&&dC(m.added,m.dropped).forEach(([v,y])=>{if(v&&y)i=YI(v,y,i);else throw new Error(`For a swap action we need a addition and a removal one is missing: ${v}, ${y}`)}),m.added.length===0&&m.dropped.length>0&&m.dropped.forEach(v=>{i=KI(v,i)}),m.added.length>0&&m.dropped.length===0&&m.added.forEach(v=>{i=QI(v,i)}))}}),i.length>e.length){const c=_f(i,e,en);i=i.filter(u=>!c.map(en).includes(en(u)))}return i}function XI(t,e){return t.map(n=>e.find(a=>en(n)===en(a)||typeof n!="number"&&$c(n)&&Yt(a)&&_I(n,a))??n)}function An(t){return`${h1}-${t}`}function ZI(t){const e=cv(t),n=S1(t.participant).pipe(zt(()=>cv(t)),Bi(e));return{className:An(t.source===G.Source.Camera||t.source===G.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function cv(t){if(Yt(t))return t.publication;{const{source:e,name:n,participant:i}=t;if(e&&n)return i.getTrackPublications().find(a=>a.source===e&&a.trackName===n);if(n)return i.getTrackPublicationByName(n);if(e)return i.getTrackPublication(e);throw new Error("At least one of source and name needs to be defined")}}function lb(t,...e){return new Kt(n=>{const i=()=>{n.next(t)};return e.forEach(a=>{t.on(a,i)}),()=>{e.forEach(a=>{t.off(a,i)})}}).pipe(Bi(t))}function Yf(t,e){return new Kt(n=>{const i=(...a)=>{n.next(a)};return t.on(e,i),()=>{t.off(e,i)}})}function JI(t){return Yf(t,J.ConnectionStateChanged).pipe(zt(([e])=>e),Bi(t.state))}function ej(t,e,n=!0){const i=new Kt(o=>{Ni.getLocalDevices(t,n).then(c=>{o.next(c),o.complete()}).catch(c=>{e?.(c),o.next([]),o.complete()})}),a=new Kt(o=>{var c;const u=()=>Li(this,null,function*(){try{const d=yield Ni.getLocalDevices(t,n);o.next(d)}catch(d){e?.(d)}});if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(c=navigator?.mediaDevices)==null||c.addEventListener("devicechange",u)}return()=>{var d;(d=navigator?.mediaDevices)==null||d.removeEventListener("devicechange",u)}});return kf(i,a)}function tj(t){return Yf(t,J.DataReceived)}function nj(t){return lb(t,J.AudioPlaybackStatusChanged).pipe(zt(e=>({canPlayAudio:e.canPlaybackAudio})))}function ij(t){return lb(t,J.VideoPlaybackStatusChanged).pipe(zt(e=>({canPlayVideo:e.canPlaybackVideo})))}function rj(t,e){return Yf(t,J.ActiveDeviceChanged).pipe(Gf(([n])=>n===e),zt(([n,i])=>(Ye.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:i}),i)))}function aj(t,e){return Yf(t,J.ParticipantEncryptionStatusChanged).pipe(Gf(([,n])=>e?.identity===n?.identity||!n&&e?.identity===t.localParticipant.identity),zt(([n])=>n),Bi(e!=null&&e.isLocal?e.isE2EEEnabled:!!(e!=null&&e.isEncrypted)))}function cb(t,...e){return new Kt(n=>{const i=()=>{n.next(t)};return e.forEach(a=>{t.on(a,i)}),()=>{e.forEach(a=>{t.off(a,i)})}}).pipe(Bi(t))}function S1(t){return cb(t,ne.TrackMuted,ne.TrackUnmuted,ne.ParticipantPermissionsChanged,ne.TrackPublished,ne.TrackUnpublished,ne.LocalTrackPublished,ne.LocalTrackUnpublished,ne.MediaDevicesError,ne.TrackSubscriptionStatusChanged).pipe(zt(e=>{const{isMicrophoneEnabled:n,isCameraEnabled:i,isScreenShareEnabled:a}=e,o=e.getTrackPublication(G.Source.Microphone),c=e.getTrackPublication(G.Source.Camera);return{isCameraEnabled:i,isMicrophoneEnabled:n,isScreenShareEnabled:a,cameraTrack:c,microphoneTrack:o,participant:e}}))}function sj(t){return t?cb(t,ne.ParticipantMetadataChanged,ne.ParticipantNameChanged).pipe(zt(({name:e,identity:n,metadata:i})=>({name:e,identity:n,metadata:i})),Bi({name:t.name,identity:t.identity,metadata:t.metadata})):void 0}function oj(t){return ub(t,ne.ConnectionQualityChanged).pipe(zt(([e])=>e),Bi(t.connectionQuality))}function ub(t,e){return new Kt(n=>{const i=(...a)=>{n.next(a)};return t.on(e,i),()=>{t.off(e,i)}})}function T1(t){var e,n,i,a;return cb(t.participant,ne.TrackMuted,ne.TrackUnmuted,ne.TrackSubscribed,ne.TrackUnsubscribed,ne.LocalTrackPublished,ne.LocalTrackUnpublished).pipe(zt(o=>{var c,u;const d=(c=t.publication)!=null?c:o.getTrackPublication(t.source);return(u=d?.isMuted)!=null?u:!0}),Bi((a=(i=(e=t.publication)==null?void 0:e.isMuted)!=null?i:(n=t.participant.getTrackPublication(t.source))==null?void 0:n.isMuted)!=null?a:!0))}function lj(t){return ub(t,ne.IsSpeakingChanged).pipe(zt(([e])=>e))}function cj(t){return ub(t,ne.ParticipantPermissionsChanged).pipe(zt(()=>t.permissions),Bi(t.permissions))}function uj(t,e,n,i,a){const{localParticipant:o}=e,c=(m,v)=>{let y=!1;switch(m){case G.Source.Camera:y=v.isCameraEnabled;break;case G.Source.Microphone:y=v.isMicrophoneEnabled;break;case G.Source.ScreenShare:y=v.isScreenShareEnabled;break}return y},u=S1(o).pipe(zt(m=>c(t,m.participant)),Bi(c(t,o))),d=new As,h=(m,v)=>Li(this,null,function*(){try{switch(v??(v=n),d.next(!0),t){case G.Source.Camera:return yield o.setCameraEnabled(m??!o.isCameraEnabled,v,i),o.isCameraEnabled;case G.Source.Microphone:return yield o.setMicrophoneEnabled(m??!o.isMicrophoneEnabled,v,i),o.isMicrophoneEnabled;case G.Source.ScreenShare:return yield o.setScreenShareEnabled(m??!o.isScreenShareEnabled,v,i),o.isScreenShareEnabled;default:throw new TypeError("Tried to toggle unsupported source")}}catch(y){if(a&&y instanceof Error){a?.(y);return}else throw y}finally{d.next(!1)}});return{className:An("button"),toggle:h,enabledObserver:u,pendingObserver:d.asObservable()}}function dj(){let t=!1;const e=new As,n=new As,i=a=>Li(this,null,function*(){n.next(!0),t=a??!t,e.next(t),n.next(!1)});return{className:An("button"),toggle:i,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function fj(t,e,n){const i=new e1(void 0),a=rj(e,t),o=(c,...u)=>Li(this,[c,...u],function*(d,h={}){var m,v,y;if(e){Ye.debug(`Switching active device of kind "${t}" with id ${d}.`),yield e.switchActiveDevice(t,d,h.exact);const T=(m=e.getActiveDevice(t))!=null?m:d;T!==d&&d!=="default"&&Ye.info(`We tried to select the device with id (${d}), but the browser decided to select the device with id (${T}) instead.`);let k;t==="audioinput"?k=(v=e.localParticipant.getTrackPublication(G.Source.Microphone))==null?void 0:v.track:t==="videoinput"&&(k=(y=e.localParticipant.getTrackPublication(G.Source.Camera))==null?void 0:y.track);const E=d==="default"&&!k||d==="default"&&k?.mediaStreamTrack.label.startsWith("Default");i.next(E?d:T)}});return{className:An("media-device-select"),activeDeviceObservable:a,setActiveMediaDevice:o}}function hj(t){const e=n=>{t.disconnect(n)};return{className:An("disconnect-button"),disconnect:e}}function mj(t){const e=An("connection-quality"),n=oj(t);return{className:e,connectionQualityObserver:n}}function pj(t){let e="track-muted-indicator-camera";switch(t.source){case G.Source.Camera:e="track-muted-indicator-camera";break;case G.Source.Microphone:e="track-muted-indicator-microphone";break}const n=An(e),i=T1(t);return{className:n,mediaMutedObserver:i}}function gj(t){return{className:"lk-participant-name",infoObserver:sj(t)}}function vj(){return{className:An("participant-tile")}}var bj={CHAT:"lk.chat"},yj={CHAT:"lk-chat-topic"};function E1(t,e){return Li(this,arguments,function*(n,i,a={}){const{reliable:o,destinationIdentities:c,topic:u}=a;yield n.publishData(i,{destinationIdentities:c,topic:u,reliable:o})})}function Sj(t,e,n){const i=Array.isArray(e)?e:[e],a=tj(t).pipe(Gf(([,,,u])=>e===void 0||u!==void 0&&i.includes(u)),zt(([u,d,,h])=>({payload:u,topic:h,from:d})));let o;const c=new Kt(u=>{o=u});return{messageObservable:a,isSendingObservable:c,send:(u,...d)=>Li(this,[u,...d],function*(h,m={}){o.next(!0);try{yield E1(t.localParticipant,h,xa({topic:i[0]},m))}finally{o.next(!1)}})}}var Rd=new WeakMap;function Tj(t){return t.ignoreLegacy==!0}var Ej=t=>JSON.parse(new TextDecoder().decode(t)),Cj=t=>new TextEncoder().encode(JSON.stringify(t));function kj(t,e){var n,i,a,o,c,u;const d=()=>{var A,w,V;return((A=t.serverInfo)==null?void 0:A.edition)===1||!!((w=t.serverInfo)!=null&&w.version)&&Oi((V=t.serverInfo)==null?void 0:V.version,"1.8.2")>0},h=new As,m=(n=e?.channelTopic)!=null?n:bj.CHAT,v=(i=e?.channelTopic)!=null?i:yj.CHAT;let y=!1;Rd.has(t)||(y=!0);const T=(a=Rd.get(t))!=null?a:new Map,k=(o=T.get(m))!=null?o:new As;T.set(m,k),Rd.set(t,T);const E=(c=e?.messageDecoder)!=null?c:Ej;if(y){t.registerTextStreamHandler(m,(w,V)=>Li(this,null,function*(){const{id:M,timestamp:D}=w.info;sb(w).pipe(oC((B,Y)=>B+Y),zt(B=>({id:M,timestamp:D,message:B,from:t.getParticipantByIdentity(V.identity)}))).subscribe({next:B=>k.next(B)})}));const{messageObservable:A}=Sj(t,[v]);A.pipe(zt(w=>{const V=E(w.payload);return Tj(V)?void 0:Sc(xa({},V),{from:w.from})}),Gf(w=>!!w),lC(h)).subscribe(k)}const x=k.pipe(oC((A,w)=>{if("id"in w&&A.find(V=>{var M,D;return((M=V.from)==null?void 0:M.identity)===((D=w.from)==null?void 0:D.identity)&&V.id===w.id})){const V=A.findIndex(M=>M.id===w.id);if(V>-1){const M=A[V];A[V]=Sc(xa({},w),{timestamp:M.timestamp,editTimestamp:w.timestamp})}return[...A]}return[...A,w]},[]),lC(h)),_=new e1(!1),N=(u=e?.messageEncoder)!=null?u:Cj,P=(A,w)=>Li(this,null,function*(){w||(w={}),w.topic!=null||(w.topic=m),_.next(!0);try{const V={id:(yield t.localParticipant.sendText(A,w)).id,timestamp:Date.now(),message:A},M=Sc(xa({},V),{attachedFiles:w.attachments}),D=Sc(xa({},M),{from:t.localParticipant,attributes:w.attributes});k.next(D);const B=N(Sc(xa({},V),{ignoreLegacy:d()}));try{yield E1(t.localParticipant,B,{reliable:!0,topic:v})}catch(Y){Ye.info("could not send message in legacy chat format",Y)}return D}finally{_.next(!1)}});function O(){h.next(),h.complete(),k.complete(),Rd.delete(t),t.unregisterTextStreamHandler(m)}return t.once(J.Disconnected,O),{messageObservable:x,isSendingObservable:_,send:P}}function _j(){const t=e=>Li(this,null,function*(){Ye.info("Start Audio for room: ",e),yield e.startAudio()});return{className:An("start-audio-button"),roomAudioPlaybackAllowedObservable:nj,handleStartAudioPlayback:t}}function wj(){const t=e=>Li(this,null,function*(){Ye.info("Start Video for room: ",e),yield e.startVideo()});return{className:An("start-audio-button"),roomVideoPlaybackAllowedObservable:ij,handleStartVideoPlayback:t}}function xj(){return{className:[An("button"),An("chat-toggle")].join(" ")}}function Rj(){return{className:[An("button"),An("focus-toggle-button")].join(" ")}}function Aj(){return{className:"lk-room-container"}}function fC(t,e,n=!0){const i=[t.localParticipant,...Array.from(t.remoteParticipants.values())],a=[];return i.forEach(o=>{e.forEach(c=>{const u=Array.from(o.trackPublications.values()).filter(d=>d.source===c&&(!n||d.track)).map(d=>({participant:o,publication:d,source:d.source}));a.push(...u)})}),{trackReferences:a,participants:i}}function Oj(t,e,n){var i,a;const o=(i=n.additionalRoomEvents)!=null?i:NI,c=(a=n.onlySubscribed)!=null?a:!0,u=Array.from(new Set([J.ParticipantConnected,J.ParticipantDisconnected,J.ConnectionStateChanged,J.LocalTrackPublished,J.LocalTrackUnpublished,J.TrackPublished,J.TrackUnpublished,J.TrackSubscriptionStatusChanged,...o]).values());return lb(t,...u).pipe(zt(d=>{const h=fC(d,e,c);return Ye.debug(`TrackReference[] was updated. (length ${h.trackReferences.length})`,h),h}),Bi(fC(t,e,c)))}function Nj(t,e=1e3){if(t===null)return aC(!1);const n=av(t,"mousemove",{passive:!0}).pipe(zt(()=>!0)),i=n.pipe(J2({each:e,with:()=>kf(aC(!1),i.pipe(gI(n)))}),mI());return i}function Dj(t,e){if(typeof localStorage>"u"){Ye.error("Local storage is not available.");return}try{if(e){const n=Object.fromEntries(Object.entries(e).filter(([,i])=>i!==""));localStorage.setItem(t,JSON.stringify(n))}}catch(n){Ye.error(`Error setting item to local storage: ${n}`)}}function Mj(t){if(typeof localStorage>"u"){Ye.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){Ye.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){Ye.error(`Error getting item from local storage: ${e}`);return}}function Pj(t){return{load:()=>Mj(t),save:e=>Dj(t,e)}}var Lj=`${h1}-user-choices`,Tc={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"default",audioDeviceId:"default",username:""},{load:Ij,save:jj}=Pj(Lj);function Uj(t,e=!1){e!==!0&&jj(t)}function Bj(t,e=!1){var n,i,a,o,c;const u={videoEnabled:(n=t?.videoEnabled)!=null?n:Tc.videoEnabled,audioEnabled:(i=t?.audioEnabled)!=null?i:Tc.audioEnabled,videoDeviceId:(a=t?.videoDeviceId)!=null?a:Tc.videoDeviceId,audioDeviceId:(o=t?.audioDeviceId)!=null?o:Tc.audioDeviceId,username:(c=t?.username)!=null?c:Tc.username};if(e)return u;{const d=Ij();return xa(xa({},u),d??{})}}function C1(t,e){if(e.msg==="show_chat")return{...t,showChat:!0,unreadMessages:0};if(e.msg==="hide_chat")return{...t,showChat:!1};if(e.msg==="toggle_chat"){const n={...t,showChat:!t.showChat};return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?{...t,unreadMessages:e.count}:e.msg==="toggle_settings"?{...t,showSettings:!t.showSettings}:{...t}}function k1(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:{...t}}const Kf=b.createContext(void 0);function _1(){const t=b.useContext(Kf);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function zj(t){const e=Zc();if(t??(t=e),!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function Vj(){const[t,e]=b.useReducer(k1,g1),[n,i]=b.useReducer(C1,v1);return{pin:{dispatch:e,state:t},widget:{dispatch:i,state:n}}}function Hj(t){const[e,n]=b.useReducer(k1,g1),[i,a]=b.useReducer(C1,v1);return t??{pin:{dispatch:n,state:e},widget:{dispatch:a,state:i}}}function Zc(){return b.useContext(Kf)}const db=b.createContext(void 0);function Qf(){return b.useContext(db)}function sl(t){const e=Qf(),n=t??e;if(!n)throw new Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return n}const w1=b.createContext(void 0);function x1(){return b.useContext(w1)}function Jc(t){const e=x1(),n=Qf(),i=t??e??n?.participant;if(!i)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return i}const fb=b.createContext(void 0);function Wf(){const t=b.useContext(fb);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function Xf(){return b.useContext(fb)}function eu(t){const e=Xf(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}const R1=b.createContext(void 0);function Fj(t){return b.useContext(R1)}var hC={};function A1(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=A1(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function O1(){for(var t,e,n=0,i="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=A1(t))&&(i&&(i+=" "),i+=e);return i}function qj(...t){return(...e)=>{for(const n of t)if(typeof n=="function")try{n(...e)}catch(i){console.error(i)}}}function cr(...t){const e={...t[0]};for(let n=1;n<t.length;n++){const i=t[n];for(const a in i){const o=e[a],c=i[a];typeof o=="function"&&typeof c=="function"&&a[0]==="o"&&a[1]==="n"&&a.charCodeAt(2)>=65&&a.charCodeAt(2)<=90?e[a]=qj(o,c):(a==="className"||a==="UNSAFE_className")&&typeof o=="string"&&typeof c=="string"?e[a]=O1(o,c):e[a]=c!==void 0?c:o}}return e}function $j(t){return t!==void 0}function Fr(...t){return cr(...t.filter($j))}function N1(t,e,n){return b.Children.map(t,i=>b.isValidElement(i)&&b.Children.only(t)?(i.props.className&&(e??(e={}),e.className=O1(i.props.className,e.className),e.style={...i.props.style,...e.style}),b.cloneElement(i,{...e,key:n})):i)}function Gj(t){var e,n;if(typeof window<"u"&&typeof process<"u"&&(((e=process==null?void 0:hC)==null?void 0:e.NODE_ENV)==="dev"||((n=process==null?void 0:hC)==null?void 0:n.NODE_ENV)==="development")){const i=document.querySelector(".lk-room-container");i&&!getComputedStyle(i).getPropertyValue("--lk-has-imported-styles")&&Ye.warn("It looks like you're not using the `@livekit/components-styles package`. To render the UI with the default styling, please import it in your layout or page.")}}function Yj(t,e){return t==="processor"&&e&&typeof e=="object"&&"name"in e?e.name:t==="e2ee"&&e?"e2ee-enabled":e}const Kj={connect:!0,audio:!1,video:!1};function Qj(t){const{token:e,serverUrl:n,options:i,room:a,connectOptions:o,connect:c,audio:u,video:d,screen:h,onConnected:m,onDisconnected:v,onError:y,onMediaDeviceFailure:T,onEncryptionError:k,simulateParticipants:E,...x}={...Kj,...t};i&&a&&Ye.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[_,N]=b.useState(),P=b.useRef(c);b.useEffect(()=>{N(a??new Ni(i))},[a,JSON.stringify(i,Yj)]);const O=b.useMemo(()=>{const{className:A}=Aj();return cr(x,{className:A})},[x]);return b.useEffect(()=>{if(!_)return;const A=()=>{const B=_.localParticipant;Ye.debug("trying to publish local tracks"),Promise.all([B.setMicrophoneEnabled(!!u,typeof u!="boolean"?u:void 0),B.setCameraEnabled(!!d,typeof d!="boolean"?d:void 0),B.setScreenShareEnabled(!!h,typeof h!="boolean"?h:void 0)]).catch(Y=>{Ye.warn(Y),y?.(Y)})},w=(B,Y)=>{const re=zc.getFailure(B);T?.(re,Y)},V=B=>{k?.(B)},M=B=>{v?.(B)},D=()=>{m?.()};return _.on(J.SignalConnected,A).on(J.MediaDevicesError,w).on(J.EncryptionError,V).on(J.Disconnected,M).on(J.Connected,D),()=>{_.off(J.SignalConnected,A).off(J.MediaDevicesError,w).off(J.EncryptionError,V).off(J.Disconnected,M).off(J.Connected,D)}},[_,u,d,h,y,k,T,m,v]),b.useEffect(()=>{if(_){if(E){_.simulateParticipants({participants:{count:E},publish:{audio:!0,useRealTracks:!0}});return}if(c){if(P.current=!0,Ye.debug("connecting"),!e){Ye.debug("no token yet");return}if(!n){Ye.warn("no livekit url provided"),y?.(Error("no livekit url provided"));return}_.connect(n,e,o).catch(A=>{Ye.warn(A),P.current===!0&&y?.(A)})}else Ye.debug("disconnecting because connect is false"),P.current=!1,_.disconnect()}},[c,e,JSON.stringify(o),_,y,n,E]),b.useEffect(()=>{if(_)return()=>{Ye.info("disconnecting on onmount"),_.disconnect()}},[_]),{room:_,htmlProps:O}}const D1=b.forwardRef(function(t,e){const{room:n,htmlProps:i}=Qj(t);return b.createElement("div",{ref:e,...i},n&&b.createElement(fb.Provider,{value:n},b.createElement(R1.Provider,{value:t.featureFlags},t.children)))}),Wj=t=>{const e=b.useRef(t);return b.useEffect(()=>{e.current=t}),e};function Xj(t,e){const n=Jj(),i=Wj(e);return b.useLayoutEffect(()=>{let a=!1;const o=t.current;if(!o)return;function c(u,d){a||i.current(u,d)}return n?.subscribe(o,c),()=>{a=!0,n?.unsubscribe(o,c)}},[t.current,n,i]),n?.observer}function Zj(){let t=!1,e=[];const n=new Map;if(typeof window>"u")return;const i=new ResizeObserver((a,o)=>{e=e.concat(a),t||window.requestAnimationFrame(()=>{const c=new Set;for(let u=0;u<e.length;u++){if(c.has(e[u].target))continue;c.add(e[u].target);const d=n.get(e[u].target);d?.forEach(h=>h(e[u],o))}e=[],t=!1}),t=!0});return{observer:i,subscribe(a,o){i.observe(a);const c=n.get(a)??[];c.push(o),n.set(a,c)},unsubscribe(a,o){const c=n.get(a)??[];if(c.length===1){i.unobserve(a),n.delete(a);return}const u=c.indexOf(o);u!==-1&&c.splice(u,1),n.set(a,c)}}}let mC;const Jj=()=>mC||(mC=Zj()),M1=t=>{const[e,n]=b.useState({width:0,height:0});b.useLayoutEffect(()=>{if(t.current){const{width:a,height:o}=t.current.getBoundingClientRect();n({width:a,height:o})}},[t.current]);const i=b.useCallback(a=>n(a.contentRect),[]);return Xj(t,i),e};function On(t,e,n=!0){const[i,a]=b.useState(e);return b.useEffect(()=>{if(n&&a(e),typeof window>"u"||!t)return;const o=t.subscribe(a);return()=>o.unsubscribe()},[t,n]),i}function e3(t){const e=o=>typeof window<"u"?window.matchMedia(o).matches:!1,[n,i]=b.useState(e(t));function a(){i(e(t))}return b.useEffect(()=>{const o=window.matchMedia(t);return a(),o.addListener?o.addListener(a):o.addEventListener("change",a),()=>{o.removeListener?o.removeListener(a):o.removeEventListener("change",a)}},[t]),n}function t3(t={}){const e=Jc(t.participant),{className:n,connectionQualityObserver:i}=b.useMemo(()=>mj(e),[e]),a=On(i,e.connectionQuality);return{className:n,quality:a}}function hb(t){const e=eu(t),n=b.useMemo(()=>JI(e),[e]);return On(n,e.state)}function n3(t){const e=Wf(),n=hb(e);return{buttonProps:b.useMemo(()=>{const{className:i,disconnect:a}=hj(e);return cr(t,{className:i,onClick:()=>a(t.stopTracks??!0),disabled:n===et.Disconnected})},[e,t,n])}}function i3(t){if(t.publication instanceof pf){const e=t.publication.track;if(e){const{facingMode:n}=x5(e);return n}}return"undefined"}function r3({trackRef:t,props:e}){const n=sl(t),i=Zc(),{className:a}=b.useMemo(()=>Rj(),[]),o=b.useMemo(()=>m1(n,i?.pin.state),[n,i?.pin.state]);return{mergedProps:b.useMemo(()=>cr(e,{className:a,onClick:c=>{var u,d,h,m,v;(u=e.onClick)==null||u.call(e,c),o?(h=i==null?void 0:(d=i.pin).dispatch)==null||h.call(d,{msg:"clear_pin"}):(v=i==null?void 0:(m=i.pin).dispatch)==null||v.call(m,{msg:"set_pin",trackReference:n})}}),[e,a,n,o,i?.pin]),inFocus:o}}function a3(t,e,n={}){const i=n.gridLayouts??MI,{width:a,height:o}=M1(t),c=p1(i,e,a,o);return b.useEffect(()=>{t.current&&c&&(t.current.style.setProperty("--lk-col-count",c?.columns.toString()),t.current.style.setProperty("--lk-row-count",c?.rows.toString()))},[t,c]),{layout:c,containerWidth:a,containerHeight:o}}function pC(t,e={}){var n,i;const a=typeof t=="string"?e.participant:t.participant,o=Jc(a),c=typeof t=="string"?{participant:o,source:t}:t,[u,d]=b.useState(!!((n=c.publication)!=null&&n.isMuted||(i=o.getTrackPublication(c.source))!=null&&i.isMuted));return b.useEffect(()=>{const h=T1(c).subscribe(d);return()=>h.unsubscribe()},[en(c)]),u}function s3(t){const e=Jc(t),n=b.useMemo(()=>lj(e),[e]);return On(n,e.isSpeaking)}function o3(){const t=Wf(),e=b.useMemo(()=>cj(t.localParticipant),[t]);return On(e,t.localParticipant.permissions)}function l3({kind:t,room:e,track:n,requestPermissions:i,onError:a}){const o=Xf(),c=b.useMemo(()=>e??o??new Ni,[e,o]),u=b.useMemo(()=>ej(t,a,i),[t,i,a]),d=On(u,[]),[h,m]=b.useState(c?.getActiveDevice(t)??"default"),{className:v,activeDeviceObservable:y,setActiveMediaDevice:T}=b.useMemo(()=>fj(t,c),[t,c,n]);return b.useEffect(()=>{const k=y.subscribe(E=>{E&&(Ye.info("setCurrentDeviceId",E),m(E))});return()=>{k?.unsubscribe()}},[y]),{devices:d,className:v,activeDeviceId:h,setActiveMediaDevice:T}}function P1(t,e,n={}){const i=b.useRef([]),a=b.useRef(-1),o=e!==a.current,c=typeof n.customSortFunction=="function"?n.customSortFunction(t):VI(t);let u=[...c];if(o===!1)try{u=WI(i.current,c,e)}catch(d){Ye.error("Error while running updatePages(): ",d)}return o?i.current=c:i.current=u,a.current=e,u}function c3(t,e){const[n,i]=b.useState(1),a=Math.max(Math.ceil(e.length/t),1);n>a&&i(a);const o=n*t,c=o-t,u=m=>{i(v=>m==="next"?v===a?v:v+1:v===1?v:v-1)},d=m=>{m>a?i(a):m<1?i(1):i(m)},h=P1(e,t).slice(c,o);return{totalPageCount:a,nextPage:()=>u("next"),prevPage:()=>u("previous"),setPage:d,firstItemIndex:c,lastItemIndex:o,tracks:h,currentPage:n}}function u3({trackRef:t,onParticipantClick:e,disableSpeakingIndicator:n,htmlProps:i}){const a=sl(t),o=b.useMemo(()=>{const{className:y}=vj();return cr(i,{className:y,onClick:T=>{var k;if((k=i.onClick)==null||k.call(i,T),typeof e=="function"){const E=a.publication??a.participant.getTrackPublication(a.source);e({participant:a.participant,track:E})}}})},[i,e,a.publication,a.source,a.participant]),c=a.participant.getTrackPublication(G.Source.Microphone),u=b.useMemo(()=>({participant:a.participant,source:G.Source.Microphone,publication:c}),[c,a.participant]),d=pC(a),h=pC(u),m=s3(a.participant),v=i3(a);return{elementProps:{"data-lk-audio-muted":h,"data-lk-video-muted":d,"data-lk-speaking":n===!0?!1:m,"data-lk-local-participant":a.participant.isLocal,"data-lk-source":a.source,"data-lk-facing-mode":v,...o}}}function d3(t){return t=zj(t),b.useMemo(()=>t?.pin.state!==void 0&&t.pin.state.length>=1?t.pin.state:[],[t.pin.state])}function f3({room:t,props:e}){const n=eu(t),{className:i,roomAudioPlaybackAllowedObservable:a,handleStartAudioPlayback:o}=b.useMemo(()=>_j(),[]),c=b.useMemo(()=>a(n),[n,a]),{canPlayAudio:u}=On(c,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:b.useMemo(()=>cr(e,{className:i,onClick:()=>{o(n)},style:{display:u?"none":"block"}}),[e,i,u,o,n]),canPlayAudio:u}}function h3({room:t,props:e}){const n=eu(t),{className:i,roomVideoPlaybackAllowedObservable:a,handleStartVideoPlayback:o}=b.useMemo(()=>wj(),[]),c=b.useMemo(()=>a(n),[n,a]),{canPlayVideo:u}=On(c,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:b.useMemo(()=>cr(e,{className:i,onClick:()=>{o(n)},style:{display:u?"none":"block"}}),[e,i,u,o,n]),canPlayVideo:u}}function m3(t,e={}){const n=b.useRef(null),i=b.useRef(null),a=e.minSwipeDistance??50,o=d=>{i.current=null,n.current=d.targetTouches[0].clientX},c=d=>{i.current=d.targetTouches[0].clientX},u=b.useCallback(()=>{if(!n.current||!i.current)return;const d=n.current-i.current,h=d>a,m=d<-a;h&&e.onLeftSwipe&&e.onLeftSwipe(),m&&e.onRightSwipe&&e.onRightSwipe()},[a,e]);b.useEffect(()=>{const d=t.current;return d&&(d.addEventListener("touchstart",o,{passive:!0}),d.addEventListener("touchmove",c,{passive:!0}),d.addEventListener("touchend",u,{passive:!0})),()=>{d&&(d.removeEventListener("touchstart",o),d.removeEventListener("touchmove",c),d.removeEventListener("touchend",u))}},[t,u])}function p3({props:t}){const{dispatch:e,state:n}=_1().widget,{className:i}=b.useMemo(()=>xj(),[]);return{mergedProps:b.useMemo(()=>cr(t,{className:i,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,i,e,n])}}function g3(t){var e,n;const i=sl(t),{className:a,mediaMutedObserver:o}=b.useMemo(()=>pj(i),[en(i)]);return{isMuted:On(o,!!((e=i.publication)!=null&&e.isMuted||(n=i.participant.getTrackPublication(i.source))!=null&&n.isMuted)),className:a}}function v3({source:t,onChange:e,initialState:n,captureOptions:i,publishOptions:a,onDeviceError:o,...c}){var u;const d=Xf(),h=(u=d?.localParticipant)==null?void 0:u.getTrackPublication(t),m=b.useRef(!1),{toggle:v,className:y,pendingObserver:T,enabledObserver:k}=b.useMemo(()=>d?uj(t,d,i,a,o):dj(),[d,t,JSON.stringify(i),a]),E=On(T,!1),x=On(k,n??!!(h!=null&&h.isEnabled));b.useEffect(()=>{e?.(x,m.current),m.current=!1},[x,e]),b.useEffect(()=>{n!==void 0&&(Ye.debug("forcing initial toggle state",t,n),v(n))},[]);const _=b.useMemo(()=>cr(c,{className:y}),[c,y]),N=b.useCallback(P=>{var O;m.current=!0,v().catch(()=>m.current=!1),(O=c.onClick)==null||O.call(c,P)},[c,v]);return{toggle:v,enabled:x,pending:E,track:h,buttonProps:{..._,"aria-pressed":x,"data-lk-source":t,"data-lk-enabled":x,disabled:E,onClick:N}}}function L1(t=[G.Source.Camera,G.Source.Microphone,G.Source.ScreenShare,G.Source.ScreenShareAudio,G.Source.Unknown],e={}){const n=eu(e.room),[i,a]=b.useState([]),[o,c]=b.useState([]),u=b.useMemo(()=>t.map(d=>b1(d)?d.source:d),[JSON.stringify(t)]);return b.useEffect(()=>{const d=Oj(n,u,{additionalRoomEvents:e.updateOnlyOn,onlySubscribed:e.onlySubscribed}).subscribe(({trackReferences:h,participants:m})=>{Ye.debug("setting track bundles",h,m),a(h),c(m)});return()=>d.unsubscribe()},[n,JSON.stringify(e.onlySubscribed),JSON.stringify(e.updateOnlyOn),JSON.stringify(t)]),b.useMemo(()=>{if(y1(t)){const d=y3(t,o),h=Array.from(i);return o.forEach(m=>{d.has(m.identity)&&(d.get(m.identity)??[]).forEach(v=>{if(i.find(({participant:T,publication:k})=>m.identity===T.identity&&k.source===v))return;Ye.debug(`Add ${v} placeholder for participant ${m.identity}.`);const y={participant:m,source:v};h.push(y)})}),h}else return i},[i,o,t])}function b3(t,e){const n=new Set(t);for(const i of e)n.delete(i);return n}function y3(t,e){const n=new Map;if(y1(t)){const i=t.filter(a=>a.withPlaceholder).map(a=>a.source);e.forEach(a=>{const o=a.getTrackPublications().map(u=>{var d;return(d=u.track)==null?void 0:d.source}).filter(u=>u!==void 0),c=Array.from(b3(new Set(i),new Set(o)));c.length>0&&n.set(a.identity,c)})}return n}function S3(t){const e=Wf(),n=hb(e),i=b.useMemo(()=>n===et.Disconnected,[n]),a=b.useMemo(()=>kj(e,t),[e,t,i]),o=On(a.isSendingObservable,!1),c=On(a.messageObservable,[]);return{send:a.send,chatMessages:c,isSending:o}}function T3(t={}){const[e,n]=b.useState(Bj(t.defaults,t.preventLoad??!1)),i=b.useCallback(d=>{n(h=>({...h,audioEnabled:d}))},[]),a=b.useCallback(d=>{n(h=>({...h,videoEnabled:d}))},[]),o=b.useCallback(d=>{n(h=>({...h,audioDeviceId:d}))},[]),c=b.useCallback(d=>{n(h=>({...h,videoDeviceId:d}))},[]),u=b.useCallback(d=>{n(h=>({...h,username:d}))},[]);return b.useEffect(()=>{Uj(e,t.preventSave??!1)},[e,t.preventSave]),{userChoices:e,saveAudioInputEnabled:i,saveVideoInputEnabled:a,saveAudioInputDeviceId:o,saveVideoInputDeviceId:c,saveUsername:u}}function E3(t,e={}){const n=Jc(t),i=eu(e.room),a=b.useMemo(()=>aj(i,n),[i,n]);return On(a,n.isLocal?n.isE2EEEnabled:!!(n!=null&&n.isEncrypted))}const I1=b.forwardRef(function(t,e){const{mergedProps:n}=p3({props:t});return b.createElement("button",{ref:e,...n},t.children)}),C3=b.forwardRef(function(t,e){const{buttonProps:n}=n3(t);return b.createElement("button",{ref:e,...n},t.children)}),k3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},b.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),b.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),_3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},b.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),w3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24",...t},b.createElement("path",{fill:"#FFF",d:"M4.99 3.99a1 1 0 0 0-.697 1.717L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 1 0 1.414-1.414L13.414 12l6.293-6.293a1 1 0 0 0-.727-1.717 1 1 0 0 0-.687.303L12 10.586 5.707 4.293a1 1 0 0 0-.717-.303z"})),x3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none",...t},b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),gC=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},b.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M5.293 2.293a1 1 0 0 1 1.414 0l4.823 4.823a1.25 1.25 0 0 1 0 1.768l-4.823 4.823a1 1 0 0 1-1.414-1.414L9.586 8 5.293 3.707a1 1 0 0 1 0-1.414z",clipRule:"evenodd"})),R3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},b.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},b.createElement("path",{d:"M10 1.75h4.25m0 0V6m0-4.25L9 7M6 14.25H1.75m0 0V10m0 4.25L7 9"}))),A3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},b.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M8.961.894C8.875-.298 7.125-.298 7.04.894c-.066.912-1.246 1.228-1.76.472-.67-.99-2.186-.115-1.664.96.399.824-.465 1.688-1.288 1.289-1.076-.522-1.95.994-.961 1.665.756.513.44 1.693-.472 1.759-1.192.086-1.192 1.836 0 1.922.912.066 1.228 1.246.472 1.76-.99.67-.115 2.186.96 1.664.824-.399 1.688.465 1.289 1.288-.522 1.076.994 1.95 1.665.961.513-.756 1.693-.44 1.759.472.086 1.192 1.836 1.192 1.922 0 .066-.912 1.246-1.228 1.76-.472.67.99 2.186.115 1.664-.96-.399-.824.465-1.688 1.288-1.289 1.076.522 1.95-.994.961-1.665-.756-.513-.44-1.693.472-1.759 1.192-.086 1.192-1.836 0-1.922-.912-.066-1.228-1.246-.472-1.76.99-.67.115-2.186-.96-1.664-.824.399-1.688-.465-1.289-1.288.522-1.076-.994-1.95-1.665-.961-.513.756-1.693.44-1.759-.472ZM8 13A5 5 0 1 0 8 3a5 5 0 0 0 0 10Z",clipRule:"evenodd"})),O3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),N3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},b.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M4 6.104V4a4 4 0 1 1 8 0v2.104c1.154.326 2 1.387 2 2.646v4.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-4.5c0-1.259.846-2.32 2-2.646ZM5.5 4a2.5 2.5 0 0 1 5 0v2h-5V4Z",clipRule:"evenodd"})),D3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},b.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),b.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),M3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},b.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),b.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),P3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),L3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),I3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor",...t},b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("g",{opacity:.25},b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),b.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),j3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor",...t},b.createElement("g",{opacity:.25},b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),b.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),j1=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...t},b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),U3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none",...t},b.createElement("g",{fill:"currentColor"},b.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),b.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),vC=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 12a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 8 12Z",clipRule:"evenodd",opacity:.7}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 1.072a.75.75 0 0 1 .274 1.024l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 12 1.072Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 11.464a.75.75 0 0 1 .274 1.025l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 6 11.464Z",clipRule:"evenodd",opacity:.6}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 4a.75.75 0 0 1-.274 1.025l-2.165 1.25a.75.75 0 1 1-.75-1.3l2.165-1.25A.75.75 0 0 1 14.928 4Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 10a.75.75 0 0 1-.275 1.024l-2.165 1.25a.75.75 0 0 1-.75-1.298l2.165-1.25A.75.75 0 0 1 4.536 10Z",clipRule:"evenodd",opacity:.5}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M16 8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 16 8Z",clipRule:"evenodd"}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 8Z",clipRule:"evenodd",opacity:.4}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 12a.75.75 0 0 1-1.024.274l-2.165-1.25a.75.75 0 0 1 .75-1.299l2.165 1.25A.75.75 0 0 1 14.928 12Z",clipRule:"evenodd",opacity:.9}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 6a.75.75 0 0 1-1.025.275l-2.165-1.25a.75.75 0 1 1 .75-1.3l2.165 1.25A.75.75 0 0 1 4.536 6Z",clipRule:"evenodd",opacity:.3}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 14.928a.75.75 0 0 1-1.024-.274l-1.25-2.165a.75.75 0 0 1 1.298-.75l1.25 2.165A.75.75 0 0 1 12 14.928Z",clipRule:"evenodd",opacity:.8}),b.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 4.536a.75.75 0 0 1-1.024-.275l-1.25-2.165a.75.75 0 1 1 1.299-.75l1.25 2.165A.75.75 0 0 1 6 4.536Z",clipRule:"evenodd",opacity:.2})),B3=t=>b.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...t},b.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},b.createElement("path",{d:"M13.25 7H9m0 0V2.75M9 7l5.25-5.25M2.75 9H7m0 0v4.25M7 9l-5.25 5.25"}))),z3=b.forwardRef(function({trackRef:t,...e},n){const i=Qf(),{mergedProps:a,inFocus:o}=r3({trackRef:t??i,props:e});return b.createElement(Kf.Consumer,null,c=>c!==void 0&&b.createElement("button",{ref:n,...a},e.children?e.children:o?b.createElement(B3,null):b.createElement(R3,null)))}),Hp=b.forwardRef(function({kind:t,initialSelection:e,onActiveDeviceChange:n,onDeviceListChange:i,onDeviceSelectError:a,exactMatch:o,track:c,requestPermissions:u,onError:d,...h},m){const v=Xf(),y=b.useRef("default"),T=b.useCallback(w=>{v&&v.emit(J.MediaDevicesError,w),d?.(w)},[v,d]),{devices:k,activeDeviceId:E,setActiveMediaDevice:x,className:_}=l3({kind:t,room:v,track:c,requestPermissions:u,onError:T});b.useEffect(()=>{e!==void 0&&x(e)},[x]),b.useEffect(()=>{typeof i=="function"&&i(k)},[i,k]),b.useEffect(()=>{E!==y.current&&n?.(E),y.current=E},[E]);const N=async w=>{try{await x(w,{exact:o??!0})}catch(V){if(V instanceof Error)a?.(V);else throw V}},P=b.useMemo(()=>Fr(h,{className:_},{className:"lk-list"}),[_,h]),O=!!k.find(w=>w.label.toLowerCase().startsWith("default"));function A(w,V,M){return w===V||!O&&M===0&&V==="default"}return b.createElement("ul",{ref:m,...P},k.map((w,V)=>b.createElement("li",{key:w.deviceId,id:w.deviceId,"data-lk-active":A(w.deviceId,E,V),"aria-selected":A(w.deviceId,E,V),role:"option"},b.createElement("button",{className:"lk-button",onClick:()=>N(w.deviceId)},w.label))))}),V3=b.forwardRef(function({label:t,...e},n){const i=Wf(),{mergedProps:a,canPlayAudio:o}=f3({room:i,props:e}),{mergedProps:c,canPlayVideo:u}=h3({room:i,props:a}),{style:d,...h}=c;return d.display=o&&u?"none":"block",b.createElement("button",{ref:n,style:d,...h},t??`Start ${o?"Video":"Audio"}`)});function U1(t,e){switch(t){case G.Source.Microphone:return e?b.createElement(M3,null):b.createElement(D3,null);case G.Source.Camera:return e?b.createElement(_3,null):b.createElement(k3,null);case G.Source.ScreenShare:return e?b.createElement(U3,null):b.createElement(j1,null);default:return}}function H3(t){switch(t){case xi.Excellent:return b.createElement(P3,null);case xi.Good:return b.createElement(L3,null);case xi.Poor:return b.createElement(I3,null);default:return b.createElement(j3,null)}}const Fp=b.forwardRef(function({showIcon:t,...e},n){const{buttonProps:i,enabled:a}=v3(e),[o,c]=b.useState(!1);return b.useEffect(()=>{c(!0)},[]),o&&b.createElement("button",{ref:n,...i},(t??!0)&&U1(e.source,a),e.children)}),F3=b.forwardRef(function(t,e){const{className:n,quality:i}=t3(t),a=b.useMemo(()=>({...Fr(t,{className:n}),"data-lk-quality":i}),[i,t,n]);return b.createElement("div",{ref:e,...a},t.children??H3(i))}),bC=b.forwardRef(function({participant:t,...e},n){const i=Jc(t),{className:a,infoObserver:o}=b.useMemo(()=>gj(i),[i]),{identity:c,name:u}=On(o,{name:i.name,identity:i.identity,metadata:i.metadata}),d=b.useMemo(()=>Fr(e,{className:a,"data-lk-participant-name":u}),[e,a,u]);return b.createElement("span",{ref:n,...d},u!==""?u:c,e.children)}),q3=b.forwardRef(function({trackRef:t,show:e="always",...n},i){const{className:a,isMuted:o}=g3(t),c=e==="always"||e==="muted"&&o||e==="unmuted"&&!o,u=b.useMemo(()=>Fr(n,{className:a}),[a,n]);return c?b.createElement("div",{ref:i,...u,"data-lk-muted":o},n.children??U1(t.source,!o)):null}),$3=t=>b.createElement("svg",{width:320,height:320,viewBox:"0 0 320 320",preserveAspectRatio:"xMidYMid meet",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},b.createElement("path",{d:"M160 180C204.182 180 240 144.183 240 100C240 55.8172 204.182 20 160 20C115.817 20 79.9997 55.8172 79.9997 100C79.9997 144.183 115.817 180 160 180Z",fill:"white",fillOpacity:.25}),b.createElement("path",{d:"M97.6542 194.614C103.267 191.818 109.841 192.481 115.519 195.141C129.025 201.466 144.1 205 159.999 205C175.899 205 190.973 201.466 204.48 195.141C210.158 192.481 216.732 191.818 222.345 194.614C262.703 214.719 291.985 253.736 298.591 300.062C300.15 310.997 291.045 320 280 320H39.9997C28.954 320 19.8495 310.997 21.4087 300.062C28.014 253.736 57.2966 214.72 97.6542 194.614Z",fill:"white",fillOpacity:.25}));function B1(t,e={}){const[n,i]=b.useState(cv(t)),[a,o]=b.useState(n?.isMuted),[c,u]=b.useState(n?.isSubscribed),[d,h]=b.useState(n?.track),[m,v]=b.useState("landscape"),y=b.useRef(),{className:T,trackObserver:k}=b.useMemo(()=>ZI(t),[t.participant.sid??t.participant.identity,t.source,Yt(t)&&t.publication.trackSid]);return b.useEffect(()=>{const E=k.subscribe(x=>{Ye.debug("update track",x),i(x),o(x?.isMuted),u(x?.isSubscribed),h(x?.track)});return()=>E?.unsubscribe()},[k]),b.useEffect(()=>{var E,x;return d&&(y.current&&d.detach(y.current),(E=e.element)!=null&&E.current&&!(t.participant.isLocal&&d?.kind==="audio")&&d.attach(e.element.current)),y.current=(x=e.element)==null?void 0:x.current,()=>{y.current&&d?.detach(y.current)}},[d,e.element]),b.useEffect(()=>{var E,x;if(typeof((E=n?.dimensions)==null?void 0:E.width)=="number"&&typeof((x=n?.dimensions)==null?void 0:x.height)=="number"){const _=n.dimensions.width>n.dimensions.height?"landscape":"portrait";v(_)}},[n]),{publication:n,isMuted:a,isSubscribed:c,track:d,elementProps:Fr(e.props,{className:T,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":n?.source,...n?.kind==="video"&&{"data-lk-orientation":m}})}}var qp,yC;function G3(){if(yC)return qp;yC=1;var t="Expected a function",e=NaN,n="[object Symbol]",i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt,d=typeof wd=="object"&&wd&&wd.Object===Object&&wd,h=typeof self=="object"&&self&&self.Object===Object&&self,m=d||h||Function("return this")(),v=Object.prototype,y=v.toString,T=Math.max,k=Math.min,E=function(){return m.Date.now()};function x(A,w,V){var M,D,B,Y,re,de,be=0,xe=!1,H=!1,ae=!0;if(typeof A!="function")throw new TypeError(t);w=O(w)||0,_(V)&&(xe=!!V.leading,H="maxWait"in V,B=H?T(O(V.maxWait)||0,w):B,ae="trailing"in V?!!V.trailing:ae);function ee(Ae){var Be=M,yt=D;return M=D=void 0,be=Ae,Y=A.apply(yt,Be),Y}function Se(Ae){return be=Ae,re=setTimeout(he,w),xe?ee(Ae):Y}function j(Ae){var Be=Ae-de,yt=Ae-be,st=w-Be;return H?k(st,B-yt):st}function te(Ae){var Be=Ae-de,yt=Ae-be;return de===void 0||Be>=w||Be<0||H&&yt>=B}function he(){var Ae=E();if(te(Ae))return le(Ae);re=setTimeout(he,j(Ae))}function le(Ae){return re=void 0,ae&&M?ee(Ae):(M=D=void 0,Y)}function ge(){re!==void 0&&clearTimeout(re),be=0,M=de=D=re=void 0}function De(){return re===void 0?Y:le(E())}function ye(){var Ae=E(),Be=te(Ae);if(M=arguments,D=this,de=Ae,Be){if(re===void 0)return Se(de);if(H)return re=setTimeout(he,w),ee(de)}return re===void 0&&(re=setTimeout(he,w)),Y}return ye.cancel=ge,ye.flush=De,ye}function _(A){var w=typeof A;return!!A&&(w=="object"||w=="function")}function N(A){return!!A&&typeof A=="object"}function P(A){return typeof A=="symbol"||N(A)&&y.call(A)==n}function O(A){if(typeof A=="number")return A;if(P(A))return e;if(_(A)){var w=typeof A.valueOf=="function"?A.valueOf():A;A=_(w)?w+"":w}if(typeof A!="string")return A===0?A:+A;A=A.replace(i,"");var V=o.test(A);return V||c.test(A)?u(A.slice(2),V?2:8):a.test(A)?e:+A}return qp=x,qp}var Y3=G3();const SC=Qw(Y3);function K3(t){const e=b.useRef(t);e.current=t,b.useEffect(()=>()=>{e.current()},[])}function Q3(t,e=500,n){const i=b.useRef();K3(()=>{i.current&&i.current.cancel()});const a=b.useMemo(()=>{const o=SC(t,e,n),c=(...u)=>o(...u);return c.cancel=()=>{o.cancel()},c.isPending=()=>!!i.current,c.flush=()=>o.flush(),c},[t,e,n]);return b.useEffect(()=>{i.current=SC(t,e,n)},[t,e,n]),a}function W3(t,e,n){const i=(h,m)=>h===m,a=t instanceof Function?t():t,[o,c]=b.useState(a),u=b.useRef(a),d=Q3(c,e,n);return i(u.current,a)||(d(a),u.current=a),[o,d]}function X3({threshold:t=0,root:e=null,rootMargin:n="0%",freezeOnceVisible:i=!1,initialIsIntersecting:a=!1,onChange:o}={}){var c;const[u,d]=b.useState(null),[h,m]=b.useState(()=>({isIntersecting:a,entry:void 0})),v=b.useRef();v.current=o;const y=((c=h.entry)==null?void 0:c.isIntersecting)&&i;b.useEffect(()=>{if(!u||!("IntersectionObserver"in window)||y)return;const E=new IntersectionObserver(x=>{const _=Array.isArray(E.thresholds)?E.thresholds:[E.thresholds];x.forEach(N=>{const P=N.isIntersecting&&_.some(O=>N.intersectionRatio>=O);m({isIntersecting:P,entry:N}),v.current&&v.current(P,N)})},{threshold:t,root:e,rootMargin:n});return E.observe(u),()=>{E.disconnect()}},[u,JSON.stringify(t),e,n,y,i]);const T=b.useRef(null);b.useEffect(()=>{var E;!u&&(E=h.entry)!=null&&E.target&&!i&&!y&&T.current!==h.entry.target&&(T.current=h.entry.target,m({isIntersecting:a,entry:void 0}))},[u,h.entry,i,y,a]);const k=[d,!!h.isIntersecting,h.entry];return k.ref=k[0],k.isIntersecting=k[1],k.entry=k[2],k}const Z3=b.forwardRef(function({onTrackClick:t,onClick:e,onSubscriptionStatusChanged:n,trackRef:i,manageSubscription:a,...o},c){const u=sl(i),d=b.useRef(null);b.useImperativeHandle(c,()=>d.current);const h=X3({root:d.current}),[m]=W3(h,3e3);b.useEffect(()=>{a&&u.publication instanceof gf&&m?.isIntersecting===!1&&h?.isIntersecting===!1&&u.publication.setSubscribed(!1)},[m,u,a]),b.useEffect(()=>{a&&u.publication instanceof gf&&h?.isIntersecting===!0&&u.publication.setSubscribed(!0)},[h,u,a]);const{elementProps:v,publication:y,isSubscribed:T}=B1(u,{element:d,props:o});b.useEffect(()=>{n?.(!!T)},[T,n]);const k=E=>{e?.(E),t?.({participant:u?.participant,track:y})};return b.createElement("video",{ref:d,...v,muted:!0,onClick:k})}),z1=b.forwardRef(function({trackRef:t,onSubscriptionStatusChanged:e,volume:n,...i},a){const o=sl(t),c=b.useRef(null);b.useImperativeHandle(a,()=>c.current);const{elementProps:u,isSubscribed:d,track:h,publication:m}=B1(o,{element:c,props:i});return b.useEffect(()=>{e?.(!!d)},[d,e]),b.useEffect(()=>{h===void 0||n===void 0||(h instanceof Pw?h.setVolume(n):Ye.warn("Volume can only be set on remote audio tracks."))},[n,h]),b.useEffect(()=>{m===void 0||i.muted===void 0||(m instanceof gf?m.setEnabled(!i.muted):Ye.warn("Can only call setEnabled on remote track publications."))},[i.muted,m,h]),b.createElement("audio",{ref:c,...u})});function J3(t){const e=!!x1();return t.participant&&!e?b.createElement(w1.Provider,{value:t.participant},t.children):b.createElement(b.Fragment,null,t.children)}function eU(t){const e=!!Qf();return t.trackRef&&!e?b.createElement(db.Provider,{value:t.trackRef},t.children):b.createElement(b.Fragment,null,t.children)}const uv=b.forwardRef(function({trackRef:t,children:e,onParticipantClick:n,disableSpeakingIndicator:i,...a},o){var c,u;const d=sl(t),{elementProps:h}=u3({htmlProps:a,disableSpeakingIndicator:i,onParticipantClick:n,trackRef:d}),m=E3(d.participant),v=Zc(),y=(c=Fj())==null?void 0:c.autoSubscription,T=b.useCallback(k=>{d.source&&!k&&v&&v.pin.dispatch&&m1(d,v.pin.state)&&v.pin.dispatch({msg:"clear_pin"})},[d,v]);return b.createElement("div",{ref:o,style:{position:"relative"},...h},b.createElement(eU,{trackRef:d},b.createElement(J3,{participant:d.participant},e??b.createElement(b.Fragment,null,Yt(d)&&(((u=d.publication)==null?void 0:u.kind)==="video"||d.source===G.Source.Camera||d.source===G.Source.ScreenShare)?b.createElement(Z3,{trackRef:d,onSubscriptionStatusChanged:T,manageSubscription:y}):Yt(d)&&b.createElement(z1,{trackRef:d,onSubscriptionStatusChanged:T}),b.createElement("div",{className:"lk-participant-placeholder"},b.createElement($3,null)),b.createElement("div",{className:"lk-participant-metadata"},b.createElement("div",{className:"lk-participant-metadata-item"},d.source===G.Source.Camera?b.createElement(b.Fragment,null,m&&b.createElement(N3,{style:{marginRight:"0.25rem"}}),b.createElement(q3,{trackRef:{participant:d.participant,source:G.Source.Microphone},show:"muted"}),b.createElement(bC,null)):b.createElement(b.Fragment,null,b.createElement(j1,{style:{marginRight:"0.25rem"}}),b.createElement(bC,null,"'s screen"))),b.createElement(F3,{className:"lk-participant-metadata-item"}))),b.createElement(z3,{trackRef:d}))))});function tU(t){const e=Fr(t,{className:"lk-focus-layout"});return b.createElement("div",{...e},t.children)}function nU({trackRef:t,...e}){return b.createElement(uv,{trackRef:t,...e})}function V1({tracks:t,...e}){return b.createElement(b.Fragment,null,t.map(n=>b.createElement(db.Provider,{value:n,key:en(n)},N1(e.children))))}function iU({totalPageCount:t,nextPage:e,prevPage:n,currentPage:i,pagesContainer:a}){const[o,c]=b.useState(!1);return b.useEffect(()=>{let u;return a&&(u=Nj(a.current,2e3).subscribe(c)),()=>{u&&u.unsubscribe()}},[a]),b.createElement("div",{className:"lk-pagination-control","data-lk-user-interaction":o},b.createElement("button",{className:"lk-button",onClick:n},b.createElement(gC,null)),b.createElement("span",{className:"lk-pagination-count"},`${i} of ${t}`),b.createElement("button",{className:"lk-button",onClick:e},b.createElement(gC,null)))}const rU=b.forwardRef(function({totalPageCount:t,currentPage:e},n){const i=new Array(t).fill("").map((a,o)=>o+1===e?b.createElement("span",{"data-lk-active":!0,key:o}):b.createElement("span",{key:o}));return b.createElement("div",{ref:n,className:"lk-pagination-indicator"},i)});function aU({tracks:t,...e}){const n=b.createRef(),i=b.useMemo(()=>Fr(e,{className:"lk-grid-layout"}),[e]),{layout:a}=a3(n,t.length),o=c3(a.maxTiles,t);return m3(n,{onLeftSwipe:o.nextPage,onRightSwipe:o.prevPage}),b.createElement("div",{ref:n,"data-lk-pagination":o.totalPageCount>1,...i},b.createElement(V1,{tracks:o.tracks},e.children),t.length>a.maxTiles&&b.createElement(b.Fragment,null,b.createElement(rU,{totalPageCount:o.totalPageCount,currentPage:o.currentPage}),b.createElement(iU,{pagesContainer:n,...o})))}const sU=130,oU=140,lU=1,H1=16/10,cU=(1-H1)*-1;function uU({tracks:t,orientation:e,...n}){const i=b.useRef(null),[a,o]=b.useState(0),{width:c,height:u}=M1(i),d=e||(u>=c?"vertical":"horizontal"),h=d==="vertical"?Math.max(c*cU,sU):Math.max(u*H1,oU),m=wI(),v=Math.max(d==="vertical"?(u-m)/h:(c-m)/h,lU);let y=Math.round(v);Math.abs(v-a)<.5?y=Math.round(a):a!==v&&o(v);const T=P1(t,y);return b.useLayoutEffect(()=>{i.current&&(i.current.dataset.lkOrientation=d,i.current.style.setProperty("--lk-max-visible-tiles",y.toString()))},[y,d]),b.createElement("aside",{key:d,className:"lk-carousel",ref:i,...n},b.createElement(V1,{tracks:T},n.children))}function dU({value:t,onPinChange:e,onWidgetChange:n,children:i}){const a=Hj(t);return b.useEffect(()=>{Ye.debug("PinState Updated",{state:a.pin.state}),e&&a.pin.state&&e(a.pin.state)},[a.pin.state,e]),b.useEffect(()=>{Ye.debug("Widget Updated",{widgetState:a.widget.state}),n&&a.widget.state&&n(a.widget.state)},[n,a.widget.state]),b.createElement(Kf.Provider,{value:a},i)}function fU({volume:t,muted:e}){const n=L1([G.Source.Microphone,G.Source.ScreenShareAudio,G.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0}).filter(i=>!i.participant.isLocal&&i.publication.kind===G.Kind.Audio);return b.createElement("div",{style:{display:"none"}},n.map(i=>b.createElement(z1,{key:en(i),trackRef:i,volume:t,muted:e})))}function hU(t){const e=b.useMemo(()=>Fr(t,{className:"lk-toast"}),[t]);return b.createElement("div",{...e},t.children)}function mU(t){const[e,n]=b.useState(void 0),i=hb(t.room);return b.useEffect(()=>{switch(i){case et.Reconnecting:n(b.createElement(b.Fragment,null,b.createElement(vC,{className:"lk-spinner"})," Reconnecting"));break;case et.Connecting:n(b.createElement(b.Fragment,null,b.createElement(vC,{className:"lk-spinner"})," Connecting"));break;case et.Disconnected:n(b.createElement(b.Fragment,null,"Disconnected"));break;default:n(void 0);break}},[i]),e?b.createElement(hU,{className:"lk-toast-connection-state"},e):b.createElement(b.Fragment,null)}const pU=b.forwardRef(function({entry:t,hideName:e=!1,hideTimestamp:n=!1,messageFormatter:i,...a},o){var c,u,d,h;const m=b.useMemo(()=>i?i(t.message):t.message,[t.message,i]),v=!!t.editTimestamp,y=new Date(t.timestamp),T=typeof navigator<"u"?navigator.language:"en-US",k=((c=t.from)==null?void 0:c.name)??((u=t.from)==null?void 0:u.identity);return b.createElement("li",{ref:o,className:"lk-chat-entry",title:y.toLocaleTimeString(T,{timeStyle:"full"}),"data-lk-message-origin":(d=t.from)!=null&&d.isLocal?"local":"remote",...a},(!n||!e||v)&&b.createElement("span",{className:"lk-meta-data"},!e&&b.createElement("strong",{className:"lk-participant-name"},k),(!n||v)&&b.createElement("span",{className:"lk-timestamp"},v&&"edited ",y.toLocaleTimeString(T,{timeStyle:"short"}))),b.createElement("span",{className:"lk-message-body"},m),b.createElement("span",{className:"lk-message-attachements"},(h=t.attachedFiles)==null?void 0:h.map(E=>E.type.startsWith("image/")&&b.createElement("img",{style:{maxWidth:"300px",maxHeight:"300px"},key:E.name,src:URL.createObjectURL(E),alt:E.name}))))});function gU({messageFormatter:t,messageDecoder:e,messageEncoder:n,channelTopic:i,...a}){const o=b.useRef(null),c=b.useRef(null),u=b.useMemo(()=>({messageDecoder:e,messageEncoder:n,channelTopic:i}),[e,n,i]),{chatMessages:d,send:h,isSending:m}=S3(u),v=Zc(),y=b.useRef(0);async function T(k){k.preventDefault(),c.current&&c.current.value.trim()!==""&&(await h(c.current.value),c.current.value="",c.current.focus())}return b.useEffect(()=>{var k;o&&((k=o.current)==null||k.scrollTo({top:o.current.scrollHeight}))},[o,d]),b.useEffect(()=>{var k,E,x,_,N;if(!v||d.length===0)return;if((k=v.widget.state)!=null&&k.showChat&&d.length>0&&y.current!==((E=d[d.length-1])==null?void 0:E.timestamp)){y.current=(x=d[d.length-1])==null?void 0:x.timestamp;return}const P=d.filter(A=>!y.current||A.timestamp>y.current).length,{widget:O}=v;P>0&&((_=O.state)==null?void 0:_.unreadMessages)!==P&&((N=O.dispatch)==null||N.call(O,{msg:"unread_msg",count:P}))},[d,v?.widget]),b.createElement("div",{...a,className:"lk-chat"},b.createElement("div",{className:"lk-chat-header"},"Messages",v&&b.createElement(I1,{className:"lk-close-button"},b.createElement(w3,null))),b.createElement("ul",{className:"lk-list lk-chat-messages",ref:o},a.children?d.map((k,E)=>N1(a.children,{entry:k,key:k.id??E,messageFormatter:t})):d.map((k,E,x)=>{const _=E>=1&&x[E-1].from===k.from,N=E>=1&&k.timestamp-x[E-1].timestamp<6e4;return b.createElement(pU,{key:k.id??E,hideName:_,hideTimestamp:_===!1?!1:N,entry:k,messageFormatter:t})})),b.createElement("form",{className:"lk-chat-form",onSubmit:T},b.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:m,ref:c,type:"text",placeholder:"Enter a message...",onInput:k=>k.stopPropagation(),onKeyDown:k=>k.stopPropagation(),onKeyUp:k=>k.stopPropagation()}),b.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:m},"Send")))}function TC({kind:t,initialSelection:e,onActiveDeviceChange:n,tracks:i,requestPermissions:a=!1,...o}){const[c,u]=b.useState(!1),[d,h]=b.useState([]),[m,v]=b.useState(!0),[y,T]=b.useState(a),k=(N,P)=>{Ye.debug("handle device change"),u(!1),n?.(N,P)},E=b.useRef(null),x=b.useRef(null);b.useLayoutEffect(()=>{c&&T(!0)},[c]),b.useLayoutEffect(()=>{let N;return E.current&&x.current&&(d||m)&&(N=RI(E.current,x.current,(P,O)=>{x.current&&Object.assign(x.current.style,{left:`${P}px`,top:`${O}px`})})),v(!1),()=>{N?.()}},[E,x,d,m]);const _=b.useCallback(N=>{x.current&&N.target!==E.current&&c&&AI(x.current,N)&&u(!1)},[c,x,E]);return b.useEffect(()=>(document.addEventListener("click",_),()=>{document.removeEventListener("click",_)}),[_]),b.createElement(b.Fragment,null,b.createElement("button",{className:"lk-button lk-button-menu","aria-pressed":c,...o,onClick:()=>u(!c),ref:E},o.children),!o.disabled&&b.createElement("div",{className:"lk-device-menu",ref:x,style:{visibility:c?"visible":"hidden"}},t?b.createElement(Hp,{initialSelection:e,onActiveDeviceChange:N=>k(t,N),onDeviceListChange:h,kind:t,track:i?.[t],requestPermissions:y}):b.createElement(b.Fragment,null,b.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),b.createElement(Hp,{kind:"audioinput",onActiveDeviceChange:N=>k("audioinput",N),onDeviceListChange:h,track:i?.audioinput,requestPermissions:y}),b.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),b.createElement(Hp,{kind:"videoinput",onActiveDeviceChange:N=>k("videoinput",N),onDeviceListChange:h,track:i?.videoinput,requestPermissions:y}))))}function vU(){b.useEffect(()=>{Gj()},[])}function bU({props:t}){const{dispatch:e,state:n}=_1().widget,i="lk-button lk-settings-toggle";return{mergedProps:b.useMemo(()=>cr(t,{className:i,onClick:()=>{e&&e({msg:"toggle_settings"})},"aria-pressed":n!=null&&n.showSettings?"true":"false"}),[t,i,e,n])}}const yU=b.forwardRef(function(t,e){const{mergedProps:n}=bU({props:t});return b.createElement("button",{ref:e,...n},t.children)}),SU=t=>{switch(t){case G.Source.Camera:return 1;case G.Source.Microphone:return 2;case G.Source.ScreenShare:return 3;default:return 0}};function TU({variation:t,controls:e,saveUserChoices:n=!0,onDeviceError:i,...a}){var o;const[c,u]=b.useState(!1),d=Zc();b.useEffect(()=>{var D,B;((D=d?.widget.state)==null?void 0:D.showChat)!==void 0&&u((B=d?.widget.state)==null?void 0:B.showChat)},[(o=d?.widget.state)==null?void 0:o.showChat]);const h=e3(`(max-width: ${c?1e3:760}px)`)?"minimal":"verbose";t??(t=h);const m={leave:!0,...e},v=o3();if(!v)m.camera=!1,m.chat=!1,m.microphone=!1,m.screenShare=!1;else{const D=B=>v.canPublish&&(v.canPublishSources.length===0||v.canPublishSources.includes(SU(B)));m.camera??(m.camera=D(G.Source.Camera)),m.microphone??(m.microphone=D(G.Source.Microphone)),m.screenShare??(m.screenShare=D(G.Source.ScreenShare)),m.chat??(m.chat=v.canPublishData&&e?.chat)}const y=b.useMemo(()=>t==="minimal"||t==="verbose",[t]),T=b.useMemo(()=>t==="textOnly"||t==="verbose",[t]),k=LI(),[E,x]=b.useState(!1),_=b.useCallback(D=>{x(D)},[x]),N=Fr({className:"lk-control-bar"},a),{saveAudioInputEnabled:P,saveVideoInputEnabled:O,saveAudioInputDeviceId:A,saveVideoInputDeviceId:w}=T3({preventSave:!n}),V=b.useCallback((D,B)=>B?P(D):null,[P]),M=b.useCallback((D,B)=>B?O(D):null,[O]);return b.createElement("div",{...N},m.microphone&&b.createElement("div",{className:"lk-button-group"},b.createElement(Fp,{source:G.Source.Microphone,showIcon:y,onChange:V,onDeviceError:D=>i?.({source:G.Source.Microphone,error:D})},T&&"Microphone"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(TC,{kind:"audioinput",onActiveDeviceChange:(D,B)=>A(B??"default")}))),m.camera&&b.createElement("div",{className:"lk-button-group"},b.createElement(Fp,{source:G.Source.Camera,showIcon:y,onChange:M,onDeviceError:D=>i?.({source:G.Source.Camera,error:D})},T&&"Camera"),b.createElement("div",{className:"lk-button-group-menu"},b.createElement(TC,{kind:"videoinput",onActiveDeviceChange:(D,B)=>w(B??"default")}))),m.screenShare&&k&&b.createElement(Fp,{source:G.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:y,onChange:_,onDeviceError:D=>i?.({source:G.Source.ScreenShare,error:D})},T&&(E?"Stop screen share":"Share screen")),m.chat&&b.createElement(I1,null,y&&b.createElement(x3,null),T&&"Chat"),m.settings&&b.createElement(yU,null,y&&b.createElement(A3,null),T&&"Settings"),m.leave&&b.createElement(C3,null,y&&b.createElement(O3,null),T&&"Leave"),b.createElement(V3,null))}function F1({chatMessageFormatter:t,chatMessageDecoder:e,chatMessageEncoder:n,SettingsComponent:i,...a}){var o,c;const[u,d]=b.useState({showChat:!1,unreadMessages:0,showSettings:!1}),h=b.useRef(null),m=L1([{source:G.Source.Camera,withPlaceholder:!0},{source:G.Source.ScreenShare,withPlaceholder:!1}],{updateOnlyOn:[J.ActiveSpeakersChanged],onlySubscribed:!1}),v=x=>{Ye.debug("updating widget state",x),d(x)},y=Vj(),T=m.filter(Yt).filter(x=>x.publication.source===G.Source.ScreenShare),k=(o=d3(y))==null?void 0:o[0],E=m.filter(x=>!kI(x,k));return b.useEffect(()=>{var x,_,N,P,O,A;if(T.some(w=>w.publication.isSubscribed)&&h.current===null?(Ye.debug("Auto set screen share focus:",{newScreenShareTrack:T[0]}),(_=(x=y.pin).dispatch)==null||_.call(x,{msg:"set_pin",trackReference:T[0]}),h.current=T[0]):h.current&&!T.some(w=>{var V,M;return w.publication.trackSid===((M=(V=h.current)==null?void 0:V.publication)==null?void 0:M.trackSid)})&&(Ye.debug("Auto clearing screen share focus."),(P=(N=y.pin).dispatch)==null||P.call(N,{msg:"clear_pin"}),h.current=null),k&&!Yt(k)){const w=m.find(V=>V.participant.identity===k.participant.identity&&V.source===k.source);w!==k&&Yt(w)&&((A=(O=y.pin).dispatch)==null||A.call(O,{msg:"set_pin",trackReference:w}))}},[T.map(x=>`${x.publication.trackSid}_${x.publication.isSubscribed}`).join(),(c=k?.publication)==null?void 0:c.trackSid,m]),vU(),b.createElement("div",{className:"lk-video-conference",...a},xI()&&b.createElement(dU,{value:y,onWidgetChange:v},b.createElement("div",{className:"lk-video-conference-inner"},k?b.createElement("div",{className:"lk-focus-layout-wrapper"},b.createElement(tU,null,b.createElement(uU,{tracks:E},b.createElement(uv,null)),k&&b.createElement(nU,{trackRef:k}))):b.createElement("div",{className:"lk-grid-layout-wrapper"},b.createElement(aU,{tracks:m},b.createElement(uv,null))),b.createElement(TU,{controls:{chat:!0,settings:!!i}})),b.createElement(gU,{style:{display:u.showChat?"grid":"none"},messageFormatter:t,messageEncoder:n,messageDecoder:e}),i&&b.createElement("div",{className:"lk-settings-menu-modal",style:{display:u.showSettings?"block":"none"}},b.createElement(i,null))),b.createElement(fU,null),b.createElement(mU,null))}const EC=di;function EU(){const[t,e]=b.useState({});if(b.useEffect(()=>{(async()=>{try{const o=new URLSearchParams(location.search);let c=o.get("room")||void 0;if(!c){const h=o.get("ticket"),m=o.get("aid");if(!h&&!m)throw new Error("room  ticket ");const v=h?`/wait/resolve?ticket=${encodeURIComponent(h)}`:`/wait/resolve?aid=${encodeURIComponent(m)}`;if(c=(await EC.get(v)).room,!c)throw new Error("ticket/aid ")}const u="guest-"+crypto.randomUUID().slice(0,8),d=await EC.post("dev/token",{room:c,identity:u,name:u});e({room:c,token:d.token})}catch(o){e({err:o.message||String(o)})}})()},[]),t.err)return S.jsxs("div",{children:[": ",t.err]});if(!t.token)return S.jsx("div",{children:""});const n=void 0,i=location.hostname==="localhost"?"ws://localhost:7880":void 0,a=t.url??n??i??"ws://localhost:7880";return S.jsx("div",{style:{height:"100vh"},children:S.jsx(D1,{serverUrl:a,token:t.token,connect:!0,audio:!0,video:!0,style:{height:"100%"},children:S.jsx(F1,{})})})}const on=[];for(let t=0;t<256;++t)on.push((t+256).toString(16).slice(1));function CU(t,e=0){return(on[t[e+0]]+on[t[e+1]]+on[t[e+2]]+on[t[e+3]]+"-"+on[t[e+4]]+on[t[e+5]]+"-"+on[t[e+6]]+on[t[e+7]]+"-"+on[t[e+8]]+on[t[e+9]]+"-"+on[t[e+10]]+on[t[e+11]]+on[t[e+12]]+on[t[e+13]]+on[t[e+14]]+on[t[e+15]]).toLowerCase()}let $p;const kU=new Uint8Array(16);function _U(){if(!$p){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");$p=crypto.getRandomValues.bind(crypto)}return $p(kU)}const wU=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),CC={randomUUID:wU};function xU(t,e,n){t=t||{};const i=t.random??t.rng?.()??_U();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,CU(i)}function RU(t,e,n){return CC.randomUUID&&!t?CC.randomUUID():xU(t)}const AU="/api".trim(),OU=AU||"http://localhost:8000/api",NU=new URL("api/calls/event",OU).toString();function DU(t,e){const n=JSON.stringify(e),i=new Blob([n],{type:"application/json"});return navigator.sendBeacon&&document.visibilityState==="hidden"?(navigator.sendBeacon(t,i),Promise.resolve()):fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:n,keepalive:!0,credentials:"omit"}).catch(()=>{})}function fs(t,e,n={}){if(!t)return;const i={room:t,type:e,ts:new Date().toISOString(),event_id:RU(),...n};return console.debug("[emit]",e,t,i),DU(NU,i)}function MU(){const[t,e]=b.useState({}),n=t.room??"";if(b.useEffect(()=>{const d=new URLSearchParams(location.search).get("room"),h=d||`room_${crypto.randomUUID().slice(0,8)}`;if(!d){const m=new URL(location.href);m.searchParams.set("room",h),history.replaceState({},"",m.toString())}e(m=>({...m,room:h}))},[]),b.useEffect(()=>{t.room&&(async()=>{try{const u="host-"+crypto.randomUUID().slice(0,8),d=await di.post("/dev/token",{room:t.room,identity:u,name:"host"});e(h=>({...h,token:d.token}))}catch(u){e(d=>({...d,err:u.message??String(u)}))}})()},[t.room]),b.useEffect(()=>{n&&fs(n,"start")},[n]),b.useEffect(()=>{if(!n)return;const u=setInterval(()=>fs(n,"heartbeat"),3e4);return()=>clearInterval(u)},[n]),b.useEffect(()=>{if(!n)return;const u=()=>fs(n,"end");return window.addEventListener("pagehide",u),window.addEventListener("beforeunload",u),()=>{window.removeEventListener("pagehide",u),window.removeEventListener("beforeunload",u)}},[n]),t.err)return S.jsxs("div",{children:[": ",t.err]});if(!t.token||!t.room)return S.jsx("div",{children:""});const i=void 0,a=location.hostname==="localhost"?"ws://localhost:7880":void 0,o=t.url??i??a??"ws://localhost:7880",c=(()=>{const u=new URL(location.origin+"/wait");return t.room&&u.searchParams.set("room",t.room),u.toString()})();return t.err?S.jsxs("div",{children:[": ",t.err]}):!t.token||!t.room?S.jsx("div",{children:""}):S.jsxs("div",{style:{height:"100vh"},children:[S.jsxs("div",{style:{position:"absolute",zIndex:10,top:8,left:8,background:"white",padding:8,borderRadius:8},children:[S.jsx("div",{style:{fontSize:12,marginBottom:4},children:"URL"}),S.jsxs("div",{style:{display:"flex",gap:8},children:[S.jsx("input",{value:c,readOnly:!0,style:{width:320}}),S.jsx("button",{onClick:()=>navigator.clipboard.writeText(c),children:""})]})]}),S.jsx(D1,{token:t.token,serverUrl:o,connect:!0,audio:!0,video:!0,onConnected:u=>{u?.name&&(fs(u.name,"start"),u.on(J.LocalTrackPublished,d=>{const h=d.track;if(h?.mediaStreamTrack){const m=new AudioContext,v=m.createMediaStreamSource(new MediaStream([h.mediaStreamTrack])),y=m.createAnalyser();v.connect(y);const T=new Uint8Array(y.fftSize);let k=0;const E=()=>{y.getByteTimeDomainData(T),k=T.reduce((_,N)=>_+Math.abs(N-128),0)/T.length<1.5?k+1:0,k===60&&fs(u.name,"silence",{message:"silence detected on local audio track"}),u.state==="connected"&&requestAnimationFrame(E)};E()}}))},onDisconnected:(u,d)=>{u?.name&&fs(u.name,"end")},onError:u=>{n&&fs(n,"error",{message:String(u)})},style:{height:"100%"},children:S.jsx(F1,{})})]})}async function PU(t,e){const n=await fetch("/api/dev/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({room:t,identity:e})}),i=await n.text();if(!n.ok)throw new Error(i);let a;try{a=JSON.parse(i)}catch{throw new Error(`Token API returned non-JSON: ${i.slice(0,120)}`)}return{token:a.token,url:a.url??a.livekit_url}}function LU(){const[t,e]=b.useState("ready"),n=b.useRef(null),i=b.useRef(null);return b.useEffect(()=>{let a;return(async()=>{try{e("requesting token");const o="demo",c="user_"+crypto.randomUUID(),{token:u,url:d}=await PU(o,c);e("connecting room");const h=await new Ni;await h.connect(d,u,{videoCaptureDefaults:{facingMode:"user"},publishDefaults:{simulcast:!1}}),h.on(J.TrackSubscribed,(y,T)=>{T?.kind===G.Kind.Video&&i.current&&T.attach(i.current)}),h.on(J.TrackUnsubscribed,(y,T)=>{T?.kind===G.Kind.Video&&i.current&&T.detach(i.current)});const m=h.participants??h.remoteParticipants??new Map;for(const[,y]of m){const T=y.tracks??new Map;for(const[,k]of T){const E=k.track;E?.kind===G.Kind.Video&&i.current&&E.attach(i.current)}}const v=await rl({audio:{echoCancellation:!0,noiseSuppression:!0},video:{width:1280,height:720}});for(const y of v)await h.localParticipant.publishTrack(y),y.kind===G.Kind.Video&&n.current&&y.attach(n.current);a=()=>{v.forEach(y=>y.stop()),h.disconnect()},e("connected")}catch(o){e("error: "+String(o?.message??o))}})(),()=>a?.()},[]),S.jsxs("div",{style:{padding:12},children:[S.jsxs("p",{children:["Status: ",t]}),S.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[S.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",background:"#000"}}),S.jsx("video",{ref:i,autoPlay:!0,playsInline:!0,style:{width:"100%",background:"#000"}})]})]})}const q1=b.createContext({user:null,loading:!0,login:async()=>{},logout:()=>{},refresh:async()=>{}});function IU({children:t}){const[e,n]=b.useState(null),[i,a]=b.useState(!0),o=async()=>{try{const d=await VT.me();n(d.user??null)}catch{n(null)}};b.useEffect(()=>{(async()=>(await o(),a(!1)))()},[]);const c=async(d,h)=>{const m=await VT.login(d,h);qo(m.token),n(m.user)},u=()=>{qo(null),n(null)};return S.jsx(q1.Provider,{value:{user:e,loading:i,login:c,logout:u,refresh:o},children:t})}const jU=()=>b.useContext(q1);function UU(){const t=Ms(),{login:e,refresh:n}=jU(),[i,a]=b.useState("admin@example.com"),[o,c]=b.useState("password"),[u,d]=b.useState(!1),[h,m]=b.useState(null);async function v(y){y.preventDefault(),m(null),d(!0);try{await e(i,o),await n(),t("/admin/site",{replace:!0})}catch(T){const k=T?.response?.status;m(k===401?"":T?.response?.data?.message||"")}finally{d(!1)}}return S.jsx("div",{className:"min-h-screen grid place-items-center bg-slate-50 px-4",children:S.jsxs("form",{onSubmit:v,className:"w-full max-w-sm rounded-2xl border bg-white p-6 shadow-sm",children:[S.jsx("h1",{className:"text-xl font-semibold",children:""}),S.jsx("input",{className:"mt-4 w-full rounded-xl border px-4 py-3",placeholder:"",value:i,onChange:y=>a(y.target.value),autoComplete:"email"}),S.jsx("input",{className:"mt-3 w-full rounded-xl border px-4 py-3",type:"password",placeholder:"",value:o,onChange:y=>c(y.target.value),autoComplete:"current-password"}),h&&S.jsx("p",{className:"mt-3 text-sm text-red-600",children:h}),S.jsx("button",{className:"mt-5 w-full rounded-xl bg-indigo-600 text-white py-3 hover:bg-indigo-500 disabled:opacity-60",disabled:u,children:u?"":""})]})})}function BU(){const[t,e]=b.useState(!0);return S.jsxs("div",{className:`sb-nav-fixed sb ${t?"":"sb-sidenav-toggled"}`,children:[S.jsxs("nav",{className:"sb-topnav navbar navbar-expand navbar-dark bg-dark",children:[S.jsx(Hn,{className:"navbar-brand ps-3",to:"/admin",children:"Start Bootstrap"}),S.jsx("button",{type:"button",className:"btn btn-link btn-sm me-4","aria-label":"Toggle sidebar",onClick:()=>e(n=>!n),children:S.jsx("i",{className:"fas fa-bars"})}),S.jsx("form",{className:"d-none d-md-inline-block ms-auto me-3 my-2 my-md-0",children:S.jsxs("div",{className:"input-group",children:[S.jsx("input",{className:"form-control",placeholder:"Search for..."}),S.jsx("button",{className:"btn btn-primary",type:"button",children:S.jsx("i",{className:"fas fa-search"})})]})}),S.jsx("ul",{className:"navbar-nav ms-auto me-3",children:S.jsxs("li",{className:"nav-item dropdown",children:[S.jsx("button",{className:"nav-link dropdown-toggle btn btn-link p-0 text-decoration-none",id:"userMenu","data-bs-toggle":"dropdown","aria-expanded":"false",type:"button",children:S.jsx("i",{className:"fas fa-user fa-fw"})}),S.jsxs("ul",{className:"dropdown-menu dropdown-menu-end","aria-labelledby":"userMenu",children:[S.jsx("li",{children:S.jsx("button",{className:"dropdown-item",type:"button",children:"Settings"})}),S.jsx("li",{children:S.jsx("button",{className:"dropdown-item",type:"button",children:"Activity Log"})}),S.jsx("li",{children:S.jsx("hr",{className:"dropdown-divider"})}),S.jsx("li",{children:S.jsx("button",{className:"dropdown-item",type:"button",onClick:()=>{localStorage.removeItem("admin_token"),location.href="/admin/login"},children:"Logout"})})]})]})})]}),S.jsxs("div",{id:"layoutSidenav",children:[S.jsx("div",{id:"layoutSidenav_nav",children:S.jsxs("nav",{className:"sb-sidenav accordion sb-sidenav-dark",children:[S.jsx("div",{className:"sb-sidenav-menu",children:S.jsxs("div",{className:"nav",children:[S.jsx("div",{className:"sb-sidenav-menu-heading",children:"Core"}),S.jsxs(wc,{className:"nav-link",to:"dashboard",children:[S.jsx("div",{className:"sb-nav-link-icon",children:S.jsx("i",{className:"fas fa-tachometer-alt"})}),"Dashboard"]}),S.jsx("div",{className:"sb-sidenav-menu-heading",children:"Addons"}),S.jsxs(wc,{className:"nav-link",to:"charts",children:[S.jsx("div",{className:"sb-nav-link-icon",children:S.jsx("i",{className:"fas fa-chart-area"})}),"Charts"]}),S.jsxs(wc,{className:"nav-link",to:"tables",children:[S.jsx("div",{className:"sb-nav-link-icon",children:S.jsx("i",{className:"fas fa-table"})}),"Tables"]}),S.jsxs(wc,{className:"nav-link",to:"site",children:[S.jsx("div",{className:"sb-nav-link-icon",children:S.jsx("i",{className:"fas fa-home"})}),"Site Builder"]})]})}),S.jsxs("div",{className:"sb-sidenav-footer",children:[S.jsx("div",{className:"small",children:"Logged in as:"}),"Admin"]})]})}),S.jsxs("div",{id:"layoutSidenav_content",children:[S.jsx("main",{className:"p-4",children:S.jsx(Rv,{})}),S.jsx("footer",{className:"py-4 bg-light mt-auto",children:S.jsxs("div",{className:"container-fluid px-4 d-flex align-items-center justify-content-between small",children:[S.jsx("div",{className:"text-muted",children:"Copyright  Your Website 2025"}),S.jsxs("div",{children:[S.jsx("a",{href:"#",children:"Privacy Policy"}),"  ",S.jsx("a",{href:"#",children:"Terms & Conditions"})]})]})})]})]})]})}const zU="admin.token";function VU(){const[t,e]=b.useState([]),[n,i]=b.useState(null),[a,o]=b.useState(null),[c,u]=b.useState(!1),d=b.useRef(null);b.useEffect(()=>{fetch("/api/appointments/nearby?lawyer_id=1").then(_=>_.ok?_.json():Promise.reject(_)).then(e).catch(_=>console.error("fetch appointments failed",_))},[]);function h(_){const N=new Date(_).getTime(),P=Date.now(),O=N-300*1e3,A=N+3600*1e3;return P>=O&&P<=A}b.useMemo(()=>{const _=new Date,N=new Date(_),P=(_.getDay()+6)%7;N.setDate(_.getDate()-P);const O=[...Array(5)].map((w,V)=>new Date(N.getFullYear(),N.getMonth(),N.getDate()+V)),A=[...Array(17)].map((w,V)=>V);return{days:O,slots:A}},[]);const m=Ms();b.useEffect(()=>{localStorage.getItem(zU)||m("/admin",{replace:!0})},[m]);const v=Yk(),[y,T]=b.useState({...v});async function k(_){u(!0),d.current?.abort();const N=new AbortController;d.current=N,u(!0),o(null),i(null);const P=t.find(O=>O.id===_);P&&i({id:P.id,client_name:P.client_name,starts_at:P.starts_at});try{const O=await fetch(`/api/appointments/${_}`,{signal:N.signal});if(!O.ok)throw new Error(`HTTP ${O.status}`);const A=await O.json();i(A)}catch(O){if(O?.name==="AbortError")return;console.error("openDetail failed:",O),o("")}finally{u(!1)}}function E(_){const N=_.hostJoinPath??`/host?aid=${_.id}`,P=_.clientJoinPath??`/wait?aid=${_.id}`;return{host:N,guest:P}}function x(_){if(!_.client_email)return;const{guest:N}=E(_),P=encodeURIComponent(""),O=encodeURIComponent(`
${location.origin}${N}

: ${new Date(_.starts_at).toLocaleString()}`);location.href=`mailto:${_.client_email}?subject=${P}&body=${O}`}return S.jsx("div",{children:S.jsxs("div",{className:"mt-8 grid md:grid-cols-2 gap-8",children:[S.jsx("div",{className:"min-w-0",children:S.jsxs("div",{className:"rounded-2xl border bg-white p-6 shadow-sm min-w-0 overflow-x-hidden",children:[S.jsx("h2",{className:"font-semibold mb-3",children:""}),S.jsxs("ul",{className:"list-none p-0 mb-4",children:[t.map(_=>S.jsxs("li",{className:"flex items-center gap-3 py-1",children:[S.jsx("div",{className:"time w-16 tabular-nums",children:new Date(_.starts_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),S.jsx("div",{className:"name flex-1",children:_.client_name}),h(_.starts_at)?S.jsx("a",{href:`/host?aid=${_.id}`,className:"btn btn-sm btn-primary no-underline",children:""}):S.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>k(_.id),children:""}),new Date(_.starts_at).getTime()<Date.now()&&!h(_.starts_at)&&S.jsx("span",{className:"text-gray-400 text-sm",children:""})]},_.id)),t.length===0&&S.jsx("li",{className:"text-sm text-gray-500",children:""})]})]})}),S.jsx("div",{className:"rounded-2xl border bg-white p-6 shadow-sm min-w-0 overflow-x-hidden",children:n?S.jsxs(S.Fragment,{children:[S.jsx("h2",{className:"fw-semibold mb-3",children:""}),c?S.jsx("div",{className:"text-muted",children:""}):S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"mb-3",children:[S.jsx("div",{className:"text-muted text-sm",children:""}),S.jsx("div",{className:"fw-semibold",children:new Date(n.starts_at).toLocaleString()})]}),S.jsxs("div",{className:"mb-3",children:[S.jsx("div",{className:"text-muted text-sm",children:""}),S.jsx("div",{children:n.client_name}),n.client_email&&S.jsx("div",{className:"text-muted small",children:n.client_email})]}),S.jsxs("div",{className:"mb-3",children:[S.jsx("div",{className:"text-muted text-sm",children:""}),(()=>{const{host:_,guest:N}=E(n);return S.jsxs("ul",{className:"list-unstyled",children:[S.jsxs("li",{children:[": ",S.jsx("a",{href:N,target:"_blank",rel:"noreferrer",children:location.origin+N})]}),S.jsxs("li",{children:[": ",S.jsx("a",{href:_,target:"_blank",rel:"noreferrer",children:location.origin+_})]})]})})()]}),S.jsxs("div",{className:"d-flex gap-2",children:[S.jsx("button",{className:"btn btn-primary",onClick:()=>x(n),disabled:!n.client_email,title:n.client_email?"":"",children:""}),S.jsx("a",{className:"btn btn-outline-secondary",href:E(n).host,target:"_blank",rel:"noreferrer",children:""}),S.jsx("button",{className:"btn btn-light",onClick:()=>i(null),children:""})]})]})]}):S.jsx(S.Fragment,{children:S.jsx("h2",{className:"fw-semibold mb-3",children:" / "})})})]})})}function HU(){return S.jsxs("div",{className:"container-fluid px-4",children:[S.jsx("h1",{className:"mt-4",children:"Charts"}),S.jsx("p",{children:" Chart.js "})]})}function FU(){return S.jsxs("div",{className:"container-fluid px-4",children:[S.jsx("h1",{className:"mt-4",children:"Tables"}),S.jsx("p",{children:" Simple-DataTables "})]})}var Gp={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var kC;function qU(){return kC||(kC=1,function(t){(function(){var e={}.hasOwnProperty;function n(){for(var o="",c=0;c<arguments.length;c++){var u=arguments[c];u&&(o=a(o,i(u)))}return o}function i(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var c="";for(var u in o)e.call(o,u)&&o[u]&&(c=a(c,u));return c}function a(o,c){return c?o?o+" "+c:o+c:o}t.exports?(n.default=n,t.exports=n):window.classNames=n})()}(Gp)),Gp.exports}var $U=qU();const GU=yk($U),YU=["xxl","xl","lg","md","sm","xs"],KU="xs",$1=b.createContext({prefixes:{},breakpoints:YU,minBreakpoint:KU}),{Consumer:Lz,Provider:Iz}=$1;function QU(t,e){const{prefixes:n}=b.useContext($1);return t||n[e]||e}const WU=["as","disabled"];function XU(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;n[i]=t[i]}return n}function ZU(t){return!t||t.trim()==="#"}function G1({tagName:t,disabled:e,href:n,target:i,rel:a,role:o,onClick:c,tabIndex:u=0,type:d}){t||(n!=null||i!=null||a!=null?t="a":t="button");const h={tagName:t};if(t==="button")return[{type:d||"button",disabled:e},h];const m=y=>{if((e||t==="a"&&ZU(n))&&y.preventDefault(),e){y.stopPropagation();return}c?.(y)},v=y=>{y.key===" "&&(y.preventDefault(),m(y))};return t==="a"&&(n||(n="#"),e&&(n=void 0)),[{role:o??"button",disabled:void 0,tabIndex:e?void 0:u,href:n,target:t==="a"?i:void 0,"aria-disabled":e||void 0,rel:t==="a"?a:void 0,onClick:m,onKeyDown:v},h]}const JU=b.forwardRef((t,e)=>{let{as:n,disabled:i}=t,a=XU(t,WU);const[o,{tagName:c}]=G1(Object.assign({tagName:n,disabled:i},a));return S.jsx(c,Object.assign({},a,o,{ref:e}))});JU.displayName="Button";const Gt=b.forwardRef(({as:t,bsPrefix:e,variant:n="primary",size:i,active:a=!1,disabled:o=!1,className:c,...u},d)=>{const h=QU(e,"btn"),[m,{tagName:v}]=G1({tagName:t,disabled:o,...u}),y=v;return S.jsx(y,{...m,...u,ref:d,disabled:o,className:GU(c,h,a&&"active",n&&`${h}-${n}`,i&&`${h}-${i}`,u.href&&o&&"disabled")})});Gt.displayName="Button";var mn="top",Yn="bottom",Kn="right",pn="left",Zf="auto",ol=[mn,Yn,Kn,pn],Os="start",Wo="end",Y1="clippingParents",mb="viewport",Oo="popper",K1="reference",dv=ol.reduce(function(t,e){return t.concat([e+"-"+Os,e+"-"+Wo])},[]),pb=[].concat(ol,[Zf]).reduce(function(t,e){return t.concat([e,e+"-"+Os,e+"-"+Wo])},[]),Q1="beforeRead",W1="read",X1="afterRead",Z1="beforeMain",J1="main",ex="afterMain",tx="beforeWrite",nx="write",ix="afterWrite",rx=[Q1,W1,X1,Z1,J1,ex,tx,nx,ix];function nr(t){return t.split("-")[0]}function Qn(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Ns(t){var e=Qn(t).Element;return t instanceof e||t instanceof Element}function ci(t){var e=Qn(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function gb(t){if(typeof ShadowRoot>"u")return!1;var e=Qn(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}var Es=Math.max,wf=Math.min,Xo=Math.round;function fv(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function ax(){return!/^((?!chrome|android).)*safari/i.test(fv())}function Zo(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var i=t.getBoundingClientRect(),a=1,o=1;e&&ci(t)&&(a=t.offsetWidth>0&&Xo(i.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Xo(i.height)/t.offsetHeight||1);var c=Ns(t)?Qn(t):window,u=c.visualViewport,d=!ax()&&n,h=(i.left+(d&&u?u.offsetLeft:0))/a,m=(i.top+(d&&u?u.offsetTop:0))/o,v=i.width/a,y=i.height/o;return{width:v,height:y,top:m,right:h+v,bottom:m+y,left:h,x:h,y:m}}function vb(t){var e=Zo(t),n=t.offsetWidth,i=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:i}}function sx(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&gb(n)){var i=e;do{if(i&&t.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function sr(t){return t?(t.nodeName||"").toLowerCase():null}function Br(t){return Qn(t).getComputedStyle(t)}function e4(t){return["table","td","th"].indexOf(sr(t))>=0}function Va(t){return((Ns(t)?t.ownerDocument:t.document)||window.document).documentElement}function Jf(t){return sr(t)==="html"?t:t.assignedSlot||t.parentNode||(gb(t)?t.host:null)||Va(t)}function _C(t){return!ci(t)||Br(t).position==="fixed"?null:t.offsetParent}function t4(t){var e=/firefox/i.test(fv()),n=/Trident/i.test(fv());if(n&&ci(t)){var i=Br(t);if(i.position==="fixed")return null}var a=Jf(t);for(gb(a)&&(a=a.host);ci(a)&&["html","body"].indexOf(sr(a))<0;){var o=Br(a);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return a;a=a.parentNode}return null}function tu(t){for(var e=Qn(t),n=_C(t);n&&e4(n)&&Br(n).position==="static";)n=_C(n);return n&&(sr(n)==="html"||sr(n)==="body"&&Br(n).position==="static")?e:n||t4(t)||e}function bb(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Mc(t,e,n){return Es(t,wf(e,n))}function n4(t,e,n){var i=Mc(t,e,n);return i>n?n:i}function ox(){return{top:0,right:0,bottom:0,left:0}}function lx(t){return Object.assign({},ox(),t)}function cx(t,e){return e.reduce(function(n,i){return n[i]=t,n},{})}var i4=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,lx(typeof e!="number"?e:cx(e,ol))};function r4(t){var e,n=t.state,i=t.name,a=t.options,o=n.elements.arrow,c=n.modifiersData.popperOffsets,u=nr(n.placement),d=bb(u),h=[pn,Kn].indexOf(u)>=0,m=h?"height":"width";if(!(!o||!c)){var v=i4(a.padding,n),y=vb(o),T=d==="y"?mn:pn,k=d==="y"?Yn:Kn,E=n.rects.reference[m]+n.rects.reference[d]-c[d]-n.rects.popper[m],x=c[d]-n.rects.reference[d],_=tu(o),N=_?d==="y"?_.clientHeight||0:_.clientWidth||0:0,P=E/2-x/2,O=v[T],A=N-y[m]-v[k],w=N/2-y[m]/2+P,V=Mc(O,w,A),M=d;n.modifiersData[i]=(e={},e[M]=V,e.centerOffset=V-w,e)}}function a4(t){var e=t.state,n=t.options,i=n.element,a=i===void 0?"[data-popper-arrow]":i;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||sx(e.elements.popper,a)&&(e.elements.arrow=a))}const ux={name:"arrow",enabled:!0,phase:"main",fn:r4,effect:a4,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Jo(t){return t.split("-")[1]}var s4={top:"auto",right:"auto",bottom:"auto",left:"auto"};function o4(t,e){var n=t.x,i=t.y,a=e.devicePixelRatio||1;return{x:Xo(n*a)/a||0,y:Xo(i*a)/a||0}}function wC(t){var e,n=t.popper,i=t.popperRect,a=t.placement,o=t.variation,c=t.offsets,u=t.position,d=t.gpuAcceleration,h=t.adaptive,m=t.roundOffsets,v=t.isFixed,y=c.x,T=y===void 0?0:y,k=c.y,E=k===void 0?0:k,x=typeof m=="function"?m({x:T,y:E}):{x:T,y:E};T=x.x,E=x.y;var _=c.hasOwnProperty("x"),N=c.hasOwnProperty("y"),P=pn,O=mn,A=window;if(h){var w=tu(n),V="clientHeight",M="clientWidth";if(w===Qn(n)&&(w=Va(n),Br(w).position!=="static"&&u==="absolute"&&(V="scrollHeight",M="scrollWidth")),w=w,a===mn||(a===pn||a===Kn)&&o===Wo){O=Yn;var D=v&&w===A&&A.visualViewport?A.visualViewport.height:w[V];E-=D-i.height,E*=d?1:-1}if(a===pn||(a===mn||a===Yn)&&o===Wo){P=Kn;var B=v&&w===A&&A.visualViewport?A.visualViewport.width:w[M];T-=B-i.width,T*=d?1:-1}}var Y=Object.assign({position:u},h&&s4),re=m===!0?o4({x:T,y:E},Qn(n)):{x:T,y:E};if(T=re.x,E=re.y,d){var de;return Object.assign({},Y,(de={},de[O]=N?"0":"",de[P]=_?"0":"",de.transform=(A.devicePixelRatio||1)<=1?"translate("+T+"px, "+E+"px)":"translate3d("+T+"px, "+E+"px, 0)",de))}return Object.assign({},Y,(e={},e[O]=N?E+"px":"",e[P]=_?T+"px":"",e.transform="",e))}function l4(t){var e=t.state,n=t.options,i=n.gpuAcceleration,a=i===void 0?!0:i,o=n.adaptive,c=o===void 0?!0:o,u=n.roundOffsets,d=u===void 0?!0:u,h={placement:nr(e.placement),variation:Jo(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,wC(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:d})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,wC(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const yb={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:l4,data:{}};var Ad={passive:!0};function c4(t){var e=t.state,n=t.instance,i=t.options,a=i.scroll,o=a===void 0?!0:a,c=i.resize,u=c===void 0?!0:c,d=Qn(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&h.forEach(function(m){m.addEventListener("scroll",n.update,Ad)}),u&&d.addEventListener("resize",n.update,Ad),function(){o&&h.forEach(function(m){m.removeEventListener("scroll",n.update,Ad)}),u&&d.removeEventListener("resize",n.update,Ad)}}const Sb={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:c4,data:{}};var u4={left:"right",right:"left",bottom:"top",top:"bottom"};function nf(t){return t.replace(/left|right|bottom|top/g,function(e){return u4[e]})}var d4={start:"end",end:"start"};function xC(t){return t.replace(/start|end/g,function(e){return d4[e]})}function Tb(t){var e=Qn(t),n=e.pageXOffset,i=e.pageYOffset;return{scrollLeft:n,scrollTop:i}}function Eb(t){return Zo(Va(t)).left+Tb(t).scrollLeft}function f4(t,e){var n=Qn(t),i=Va(t),a=n.visualViewport,o=i.clientWidth,c=i.clientHeight,u=0,d=0;if(a){o=a.width,c=a.height;var h=ax();(h||!h&&e==="fixed")&&(u=a.offsetLeft,d=a.offsetTop)}return{width:o,height:c,x:u+Eb(t),y:d}}function h4(t){var e,n=Va(t),i=Tb(t),a=(e=t.ownerDocument)==null?void 0:e.body,o=Es(n.scrollWidth,n.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),c=Es(n.scrollHeight,n.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),u=-i.scrollLeft+Eb(t),d=-i.scrollTop;return Br(a||n).direction==="rtl"&&(u+=Es(n.clientWidth,a?a.clientWidth:0)-o),{width:o,height:c,x:u,y:d}}function Cb(t){var e=Br(t),n=e.overflow,i=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+a+i)}function dx(t){return["html","body","#document"].indexOf(sr(t))>=0?t.ownerDocument.body:ci(t)&&Cb(t)?t:dx(Jf(t))}function Pc(t,e){var n;e===void 0&&(e=[]);var i=dx(t),a=i===((n=t.ownerDocument)==null?void 0:n.body),o=Qn(i),c=a?[o].concat(o.visualViewport||[],Cb(i)?i:[]):i,u=e.concat(c);return a?u:u.concat(Pc(Jf(c)))}function hv(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function m4(t,e){var n=Zo(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function RC(t,e,n){return e===mb?hv(f4(t,n)):Ns(e)?m4(e,n):hv(h4(Va(t)))}function p4(t){var e=Pc(Jf(t)),n=["absolute","fixed"].indexOf(Br(t).position)>=0,i=n&&ci(t)?tu(t):t;return Ns(i)?e.filter(function(a){return Ns(a)&&sx(a,i)&&sr(a)!=="body"}):[]}function g4(t,e,n,i){var a=e==="clippingParents"?p4(t):[].concat(e),o=[].concat(a,[n]),c=o[0],u=o.reduce(function(d,h){var m=RC(t,h,i);return d.top=Es(m.top,d.top),d.right=wf(m.right,d.right),d.bottom=wf(m.bottom,d.bottom),d.left=Es(m.left,d.left),d},RC(t,c,i));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function fx(t){var e=t.reference,n=t.element,i=t.placement,a=i?nr(i):null,o=i?Jo(i):null,c=e.x+e.width/2-n.width/2,u=e.y+e.height/2-n.height/2,d;switch(a){case mn:d={x:c,y:e.y-n.height};break;case Yn:d={x:c,y:e.y+e.height};break;case Kn:d={x:e.x+e.width,y:u};break;case pn:d={x:e.x-n.width,y:u};break;default:d={x:e.x,y:e.y}}var h=a?bb(a):null;if(h!=null){var m=h==="y"?"height":"width";switch(o){case Os:d[h]=d[h]-(e[m]/2-n[m]/2);break;case Wo:d[h]=d[h]+(e[m]/2-n[m]/2);break}}return d}function el(t,e){e===void 0&&(e={});var n=e,i=n.placement,a=i===void 0?t.placement:i,o=n.strategy,c=o===void 0?t.strategy:o,u=n.boundary,d=u===void 0?Y1:u,h=n.rootBoundary,m=h===void 0?mb:h,v=n.elementContext,y=v===void 0?Oo:v,T=n.altBoundary,k=T===void 0?!1:T,E=n.padding,x=E===void 0?0:E,_=lx(typeof x!="number"?x:cx(x,ol)),N=y===Oo?K1:Oo,P=t.rects.popper,O=t.elements[k?N:y],A=g4(Ns(O)?O:O.contextElement||Va(t.elements.popper),d,m,c),w=Zo(t.elements.reference),V=fx({reference:w,element:P,placement:a}),M=hv(Object.assign({},P,V)),D=y===Oo?M:w,B={top:A.top-D.top+_.top,bottom:D.bottom-A.bottom+_.bottom,left:A.left-D.left+_.left,right:D.right-A.right+_.right},Y=t.modifiersData.offset;if(y===Oo&&Y){var re=Y[a];Object.keys(B).forEach(function(de){var be=[Kn,Yn].indexOf(de)>=0?1:-1,xe=[mn,Yn].indexOf(de)>=0?"y":"x";B[de]+=re[xe]*be})}return B}function v4(t,e){e===void 0&&(e={});var n=e,i=n.placement,a=n.boundary,o=n.rootBoundary,c=n.padding,u=n.flipVariations,d=n.allowedAutoPlacements,h=d===void 0?pb:d,m=Jo(i),v=m?u?dv:dv.filter(function(k){return Jo(k)===m}):ol,y=v.filter(function(k){return h.indexOf(k)>=0});y.length===0&&(y=v);var T=y.reduce(function(k,E){return k[E]=el(t,{placement:E,boundary:a,rootBoundary:o,padding:c})[nr(E)],k},{});return Object.keys(T).sort(function(k,E){return T[k]-T[E]})}function b4(t){if(nr(t)===Zf)return[];var e=nf(t);return[xC(t),e,xC(e)]}function y4(t){var e=t.state,n=t.options,i=t.name;if(!e.modifiersData[i]._skip){for(var a=n.mainAxis,o=a===void 0?!0:a,c=n.altAxis,u=c===void 0?!0:c,d=n.fallbackPlacements,h=n.padding,m=n.boundary,v=n.rootBoundary,y=n.altBoundary,T=n.flipVariations,k=T===void 0?!0:T,E=n.allowedAutoPlacements,x=e.options.placement,_=nr(x),N=_===x,P=d||(N||!k?[nf(x)]:b4(x)),O=[x].concat(P).reduce(function(ge,De){return ge.concat(nr(De)===Zf?v4(e,{placement:De,boundary:m,rootBoundary:v,padding:h,flipVariations:k,allowedAutoPlacements:E}):De)},[]),A=e.rects.reference,w=e.rects.popper,V=new Map,M=!0,D=O[0],B=0;B<O.length;B++){var Y=O[B],re=nr(Y),de=Jo(Y)===Os,be=[mn,Yn].indexOf(re)>=0,xe=be?"width":"height",H=el(e,{placement:Y,boundary:m,rootBoundary:v,altBoundary:y,padding:h}),ae=be?de?Kn:pn:de?Yn:mn;A[xe]>w[xe]&&(ae=nf(ae));var ee=nf(ae),Se=[];if(o&&Se.push(H[re]<=0),u&&Se.push(H[ae]<=0,H[ee]<=0),Se.every(function(ge){return ge})){D=Y,M=!1;break}V.set(Y,Se)}if(M)for(var j=k?3:1,te=function(De){var ye=O.find(function(Ae){var Be=V.get(Ae);if(Be)return Be.slice(0,De).every(function(yt){return yt})});if(ye)return D=ye,"break"},he=j;he>0;he--){var le=te(he);if(le==="break")break}e.placement!==D&&(e.modifiersData[i]._skip=!0,e.placement=D,e.reset=!0)}}const hx={name:"flip",enabled:!0,phase:"main",fn:y4,requiresIfExists:["offset"],data:{_skip:!1}};function AC(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function OC(t){return[mn,Kn,Yn,pn].some(function(e){return t[e]>=0})}function S4(t){var e=t.state,n=t.name,i=e.rects.reference,a=e.rects.popper,o=e.modifiersData.preventOverflow,c=el(e,{elementContext:"reference"}),u=el(e,{altBoundary:!0}),d=AC(c,i),h=AC(u,a,o),m=OC(d),v=OC(h);e.modifiersData[n]={referenceClippingOffsets:d,popperEscapeOffsets:h,isReferenceHidden:m,hasPopperEscaped:v},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":m,"data-popper-escaped":v})}const mx={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:S4};function T4(t,e,n){var i=nr(t),a=[pn,mn].indexOf(i)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,c=o[0],u=o[1];return c=c||0,u=(u||0)*a,[pn,Kn].indexOf(i)>=0?{x:u,y:c}:{x:c,y:u}}function E4(t){var e=t.state,n=t.options,i=t.name,a=n.offset,o=a===void 0?[0,0]:a,c=pb.reduce(function(m,v){return m[v]=T4(v,e.rects,o),m},{}),u=c[e.placement],d=u.x,h=u.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=d,e.modifiersData.popperOffsets.y+=h),e.modifiersData[i]=c}const px={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:E4};function C4(t){var e=t.state,n=t.name;e.modifiersData[n]=fx({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const kb={name:"popperOffsets",enabled:!0,phase:"read",fn:C4,data:{}};function k4(t){return t==="x"?"y":"x"}function _4(t){var e=t.state,n=t.options,i=t.name,a=n.mainAxis,o=a===void 0?!0:a,c=n.altAxis,u=c===void 0?!1:c,d=n.boundary,h=n.rootBoundary,m=n.altBoundary,v=n.padding,y=n.tether,T=y===void 0?!0:y,k=n.tetherOffset,E=k===void 0?0:k,x=el(e,{boundary:d,rootBoundary:h,padding:v,altBoundary:m}),_=nr(e.placement),N=Jo(e.placement),P=!N,O=bb(_),A=k4(O),w=e.modifiersData.popperOffsets,V=e.rects.reference,M=e.rects.popper,D=typeof E=="function"?E(Object.assign({},e.rects,{placement:e.placement})):E,B=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),Y=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,re={x:0,y:0};if(w){if(o){var de,be=O==="y"?mn:pn,xe=O==="y"?Yn:Kn,H=O==="y"?"height":"width",ae=w[O],ee=ae+x[be],Se=ae-x[xe],j=T?-M[H]/2:0,te=N===Os?V[H]:M[H],he=N===Os?-M[H]:-V[H],le=e.elements.arrow,ge=T&&le?vb(le):{width:0,height:0},De=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:ox(),ye=De[be],Ae=De[xe],Be=Mc(0,V[H],ge[H]),yt=P?V[H]/2-j-Be-ye-B.mainAxis:te-Be-ye-B.mainAxis,st=P?-V[H]/2+j+Be+Ae+B.mainAxis:he+Be+Ae+B.mainAxis,Vt=e.elements.arrow&&tu(e.elements.arrow),Nn=Vt?O==="y"?Vt.clientTop||0:Vt.clientLeft||0:0,$r=(de=Y?.[O])!=null?de:0,Dn=ae+yt-$r-Nn,hl=ae+st-$r,js=Mc(T?wf(ee,Dn):ee,ae,T?Es(Se,hl):Se);w[O]=js,re[O]=js-ae}if(u){var cn,ml=O==="x"?mn:pn,Us=O==="x"?Yn:Kn,Wn=w[A],gi=A==="y"?"height":"width",Xn=Wn+x[ml],vi=Wn-x[Us],Gr=[mn,pn].indexOf(_)!==-1,Yr=(cn=Y?.[A])!=null?cn:0,tn=Gr?Xn:Wn-V[gi]-M[gi]-Yr+B.altAxis,gt=Gr?Wn+V[gi]+M[gi]-Yr-B.altAxis:vi,gn=T&&Gr?n4(tn,Wn,gt):Mc(T?tn:Xn,Wn,T?gt:vi);w[A]=gn,re[A]=gn-Wn}e.modifiersData[i]=re}}const gx={name:"preventOverflow",enabled:!0,phase:"main",fn:_4,requiresIfExists:["offset"]};function w4(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function x4(t){return t===Qn(t)||!ci(t)?Tb(t):w4(t)}function R4(t){var e=t.getBoundingClientRect(),n=Xo(e.width)/t.offsetWidth||1,i=Xo(e.height)/t.offsetHeight||1;return n!==1||i!==1}function A4(t,e,n){n===void 0&&(n=!1);var i=ci(e),a=ci(e)&&R4(e),o=Va(e),c=Zo(t,a,n),u={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(i||!i&&!n)&&((sr(e)!=="body"||Cb(o))&&(u=x4(e)),ci(e)?(d=Zo(e,!0),d.x+=e.clientLeft,d.y+=e.clientTop):o&&(d.x=Eb(o))),{x:c.left+u.scrollLeft-d.x,y:c.top+u.scrollTop-d.y,width:c.width,height:c.height}}function O4(t){var e=new Map,n=new Set,i=[];t.forEach(function(o){e.set(o.name,o)});function a(o){n.add(o.name);var c=[].concat(o.requires||[],o.requiresIfExists||[]);c.forEach(function(u){if(!n.has(u)){var d=e.get(u);d&&a(d)}}),i.push(o)}return t.forEach(function(o){n.has(o.name)||a(o)}),i}function N4(t){var e=O4(t);return rx.reduce(function(n,i){return n.concat(e.filter(function(a){return a.phase===i}))},[])}function D4(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function M4(t){var e=t.reduce(function(n,i){var a=n[i.name];return n[i.name]=a?Object.assign({},a,i,{options:Object.assign({},a.options,i.options),data:Object.assign({},a.data,i.data)}):i,n},{});return Object.keys(e).map(function(n){return e[n]})}var NC={placement:"bottom",modifiers:[],strategy:"absolute"};function DC(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function eh(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,i=n===void 0?[]:n,a=e.defaultOptions,o=a===void 0?NC:a;return function(u,d,h){h===void 0&&(h=o);var m={placement:"bottom",orderedModifiers:[],options:Object.assign({},NC,o),modifiersData:{},elements:{reference:u,popper:d},attributes:{},styles:{}},v=[],y=!1,T={state:m,setOptions:function(_){var N=typeof _=="function"?_(m.options):_;E(),m.options=Object.assign({},o,m.options,N),m.scrollParents={reference:Ns(u)?Pc(u):u.contextElement?Pc(u.contextElement):[],popper:Pc(d)};var P=N4(M4([].concat(i,m.options.modifiers)));return m.orderedModifiers=P.filter(function(O){return O.enabled}),k(),T.update()},forceUpdate:function(){if(!y){var _=m.elements,N=_.reference,P=_.popper;if(DC(N,P)){m.rects={reference:A4(N,tu(P),m.options.strategy==="fixed"),popper:vb(P)},m.reset=!1,m.placement=m.options.placement,m.orderedModifiers.forEach(function(B){return m.modifiersData[B.name]=Object.assign({},B.data)});for(var O=0;O<m.orderedModifiers.length;O++){if(m.reset===!0){m.reset=!1,O=-1;continue}var A=m.orderedModifiers[O],w=A.fn,V=A.options,M=V===void 0?{}:V,D=A.name;typeof w=="function"&&(m=w({state:m,options:M,name:D,instance:T})||m)}}}},update:D4(function(){return new Promise(function(x){T.forceUpdate(),x(m)})}),destroy:function(){E(),y=!0}};if(!DC(u,d))return T;T.setOptions(h).then(function(x){!y&&h.onFirstUpdate&&h.onFirstUpdate(x)});function k(){m.orderedModifiers.forEach(function(x){var _=x.name,N=x.options,P=N===void 0?{}:N,O=x.effect;if(typeof O=="function"){var A=O({state:m,name:_,instance:T,options:P}),w=function(){};v.push(A||w)}})}function E(){v.forEach(function(x){return x()}),v=[]}return T}}var P4=eh();const L4=di;function I4({data:t,onSave:e}){const[n,i]=b.useState({kicker:t?.kicker??"",title:t?.title??"",subtitle:t?.subtitle??"",btnText:t?.btnText??"",btnHref:t?.btnHref??"",imgId:t?.imgId??null,bgUrl:t?.bgUrl??"",avatarUrl:t?.avatarUrl??""}),[a,o]=b.useState(!1),[c,u]=b.useState(null);async function d(){o(!0);try{const m={...n};console.log("[HeroEditor] save click payload:",m),await e(n)}finally{o(!1)}}async function h(m,v="bgUrl"){if(m){o(!0),u(null);try{const y=new FormData;y.append("file",m);const T=await L4.jupload("/media",y);i(k=>{const E={...k,[v]:T.url};return e(E),E})}catch(y){u(y.message||"")}finally{o(!1)}}}return S.jsxs("div",{className:"row g-3",children:[["kicker","title","subtitle","btnText","btnHref"].map(m=>S.jsxs("div",{className:m==="subtitle"?"col-12":"col-md-6",children:[S.jsx("label",{className:"form-label",children:m}),S.jsx("input",{className:"form-control",value:n[m]||"",onChange:v=>i({...n,[m]:v.target.value})})]},m)),S.jsxs("div",{className:"col-12",children:[S.jsx("label",{className:"form-label",children:""}),S.jsx("input",{type:"file",className:"form-control",accept:"image/*",onChange:m=>h(m.target.files?.[0],"bgUrl"),disabled:a}),c&&S.jsx("div",{className:"text-danger small mt-2",children:c}),n.bgUrl&&S.jsx("img",{src:n.bgUrl,className:"img-fluid mt-2 rounded-3",alt:""})]}),S.jsxs("div",{className:"col-12",children:[S.jsx("label",{className:"form-label",children:""}),S.jsx("input",{type:"file",className:"form-control",accept:"image/*",onChange:m=>h(m.target.files?.[0],"avatarUrl"),disabled:a}),n.avatarUrl&&S.jsx("img",{src:n.avatarUrl,className:"img-thumbnail mt-2 rounded-circle",style:{width:120,height:120,objectFit:"cover"},alt:""})]}),S.jsx("div",{className:"col-12",children:S.jsx(Gt,{onClick:d,disabled:a,children:""})})]})}function j4({data:t,onSave:e}){const[n,i]=b.useState(t?.items||[]);return S.jsxs("div",{children:[n.map((a,o)=>S.jsxs("div",{className:"row g-2 align-items-end mb-2",children:[S.jsxs("div",{className:"col-md-4",children:[S.jsx("label",{className:"form-label",children:"title"}),S.jsx("input",{className:"form-control",value:a.title||"",onChange:c=>{const u=[...n];u[o]={...u[o],title:c.target.value},i(u)}})]}),S.jsxs("div",{className:"col-md-6",children:[S.jsx("label",{className:"form-label",children:"text"}),S.jsx("input",{className:"form-control",value:a.text||"",onChange:c=>{const u=[...n];u[o]={...u[o],text:c.target.value},i(u)}})]}),S.jsx("div",{className:"col-md-2",children:S.jsx(Gt,{size:"sm",variant:"outline-danger",onClick:()=>{const c=[...n];c.splice(o,1),i(c)},children:""})})]},o)),S.jsx(Gt,{size:"sm",className:"me-2",onClick:()=>i([...n,{title:"",text:""}]),children:"+ "}),S.jsx(Gt,{onClick:()=>e({items:n}),children:""})]})}function U4({data:t,onSave:e}){const[n,i]=b.useState({text:t?.text||"",btnText:t?.btnText||"",btnHref:t?.btnHref||""});return S.jsxs("div",{className:"row g-3",children:[["text","btnText","btnHref"].map(a=>S.jsxs("div",{className:"col-md-6",children:[S.jsx("label",{className:"form-label",children:a}),S.jsx("input",{className:"form-control",value:n[a]||"",onChange:o=>i({...n,[a]:o.target.value})})]},a)),S.jsx("div",{className:"col-12",children:S.jsx(Gt,{onClick:()=>e(n),children:""})})]})}const Yp=1,hs=di;function B4(){const[t,e]=b.useState(null),[n,i]=b.useState([]),[a,o]=b.useState(!0),[c,u]=b.useState(null),[d,h]=b.useState(!1),[m,v]=b.useState(null),[y,T]=b.useState(null),[k,E]=b.useState(null);async function x(){o(!0);try{const D=await hs.get(`/admin/sites/${Yp}`),B=D?.site??(D&&D.id?D:null),Y=D?.pages??D?.site?.pages??[];if(!B)throw new Error(" / ");e(B),i(Array.isArray(Y)?Y:[]),!c&&Y?.length&&u(Y[0])}catch(D){console.error("[Builder] load error:",D),alert(`: ${D?.message??String(D)}`)}finally{o(!1)}}b.useEffect(()=>{x()},[]);async function _(D="/",B="Home"){await hs.post(`/admin/sites/${Yp}/pages`,{path:D,title:B}),await x()}async function N(D,B){await hs.post(`/admin/pages/${D}/blocks`,{type:B,data:{}}),await x()}async function P(){t&&(await hs.jput(`/admin/sites/${Yp}`,{title:t.title,slug:t.slug,meta:t.meta}),alert(""))}async function O(D,B){await hs.jput(`/admin/blocks/${D.id}`,{data:B,sort:D.sort}),i(Y=>Y.map(re=>({...re,blocks:re.blocks.map(de=>de.id===D.id?{...de,data:B}:de)}))),await x()}async function A(D,B,Y){const re=D.blocks.findIndex(xe=>xe.id===B),de=[...D.blocks],be=re+Y;be<0||be>=de.length||([de[re],de[be]]=[de[be],de[re]],await hs.post(`/admin/pages/${D.id}/reorder`,{ids:de.map(xe=>xe.id)}),await x())}async function w(D){confirm("")&&(await hs.jdel(`/admin/blocks/${D}`),await x())}function V(D,B){const Y=B.startsWith("/")?B:`/${B}`,re=`/s/${D}${Y.replace(/\/?$/,"/")}`;window.open(re,"_blank")}const M=async D=>{if(!c)return alert("");await N(c.id,D)};return a?S.jsx("div",{className:"p-4",children:""}):t?S.jsxs("div",{className:"container py-4",children:[S.jsxs("div",{className:"d-flex gap-3 align-items-end",children:[S.jsxs("div",{className:"flex-grow-1",children:[S.jsx("div",{className:"form-label",children:""}),S.jsx("input",{className:"form-control",value:t.title,onChange:D=>e({...t,title:D.target.value})})]}),S.jsxs("div",{children:[S.jsx("div",{className:"form-label",children:""}),S.jsx("input",{className:"form-control",value:t.slug,onChange:D=>e({...t,slug:D.target.value})})]}),S.jsx(Gt,{className:"ms-auto",onClick:P,children:""})]}),S.jsxs("div",{className:"ms-auto d-flex gap-2 mt-2",children:[S.jsx(Gt,{size:"sm",onClick:()=>M("hero"),children:"+ Hero"}),S.jsx(Gt,{size:"sm",onClick:()=>M("features"),children:"+ Features"}),S.jsx(Gt,{size:"sm",onClick:()=>M("cta"),children:"+ CTA"}),S.jsx(Gt,{size:"sm",variant:"outline-primary",onClick:()=>c&&V(t.slug,c.path),children:""}),S.jsx(Gt,{size:"sm",variant:"outline-secondary",onClick:()=>_("/new","New Page"),children:"+ Page"})]}),n.map(D=>S.jsxs("div",{className:"mt-4",children:[S.jsxs("div",{className:"d-flex align-items-center mb-2",children:[S.jsxs("h5",{className:"mb-0",children:[D.title," ",S.jsx("small",{className:"text-muted",children:D.path})]}),S.jsxs("div",{className:"ms-auto d-flex gap-2",children:[S.jsx(Gt,{size:"sm",onClick:()=>N(D.id,"hero"),children:"+ Hero"}),S.jsx(Gt,{size:"sm",onClick:()=>N(D.id,"features"),children:"+ Features"}),S.jsx(Gt,{size:"sm",onClick:()=>N(D.id,"cta"),children:"+ CTA"}),S.jsx(Gt,{size:"sm",variant:"outline-secondary",onClick:()=>_("/new","New Page"),children:"+ Page"})]})]}),D.blocks.map(B=>S.jsxs("div",{className:"border rounded-4 p-3 mb-3",children:[S.jsxs("div",{className:"d-flex align-items-center mb-2",children:[S.jsx("div",{className:"badge text-bg-secondary me-2",children:B.type}),S.jsxs("div",{className:"ms-auto d-flex gap-2",children:[S.jsx(Gt,{size:"sm",variant:"light",onClick:()=>A(D,B.id,-1),children:""}),S.jsx(Gt,{size:"sm",variant:"light",onClick:()=>A(D,B.id,1),children:""}),S.jsx(Gt,{size:"sm",variant:"outline-danger",onClick:()=>w(B.id),children:""})]})]}),B.type==="hero"&&S.jsx(I4,{data:B.data,onSave:Y=>O(B,Y)}),B.type==="features"&&S.jsx(j4,{data:B.data,onSave:Y=>O(B,Y)}),B.type==="cta"&&S.jsx(U4,{data:B.data,onSave:Y=>O(B,Y)})]},B.id??`${B.type}-${B.sort??0}`))]},D.id))]}):S.jsx("div",{className:"p-4",children:""})}const _o=di;function MC(){const{tenant:t}=Kc(),e=new URLSearchParams(ji().search),[n,i]=b.useState(null),[a,o]=b.useState([]),[c,u]=b.useState(null),[d,h]=b.useState([]),[m,v]=b.useState(""),[y,T]=b.useState(""),[k,E]=b.useState(""),[x,_]=b.useState(""),[N,P]=b.useState(!1),[O,A]=b.useState(null);b.useEffect(()=>{(async()=>{const M=t||e.get("slug")||e.get("tenant")||e.get("tenant_id")||"";if(!M)return;let D=null;if(/^\d+$/.test(M)?D={id:Number(M)}:D=await _o.get(`public/tenants/resolve?slug=${encodeURIComponent(M)}`).catch(async()=>_o.get(`public/tenants/resolve?key=${encodeURIComponent(M)}`)).catch(()=>null),!D)throw new Error("tenant not found");i({id:D.id,display_name:D.display_name??""})})().catch(M=>console.error(M))},[]),b.useEffect(()=>{n&&(async()=>{const M=await _o.get(`public/tenants/${n.id}/pros`).catch(()=>[]);o(M);const D=e.get("lawyer_id");D&&/^\d+$/.test(D)?u(Number(D)):M[0]&&u(M[0].user_id??M[0].id??null)})()},[n?.id]),b.useEffect(()=>{if(!n||!c){h([]),v("");return}(async()=>{const M=await _o.get(`public/tenants/${n.id}/slots?lawyer_id=${c}`).catch(()=>null),B=(Array.isArray(M)?M:M?.days??[]).map(Y=>({date:Y.date,slots:Y.slots??Y.times??[]}));h(B)})()},[n?.id,c]);const w=b.useMemo(()=>!!n?.id&&!!c&&!!m&&!!y&&/\S+@\S+/.test(k),[n?.id,c,m,y,k]);async function V(){try{if(!n?.id||!c||!m)return;P(!0);const M=await _o.post("clients/upsert",{name:y,email:k}),D={lawyer_id:c,client_name:y,client_email:k,start_at:new Date(m).toISOString(),starts_at:new Date(m).toISOString(),visitor_id:String(M.user_id??"public"),purpose_title:"",purpose_detail:x},B=await _o.post(`tenants/${n.id}/appointments`,D);A({host:B.hostJoinPath,guest:B.clientJoinPath,starts_at:m})}catch(M){alert(M?.message??""),console.error(M)}finally{P(!1)}}return S.jsxs("div",{className:"container py-4",style:{maxWidth:900},children:[S.jsx("h2",{className:"mb-3",children:""}),S.jsxs("div",{className:"card mb-3",children:[S.jsx("div",{className:"card-header",children:""}),S.jsxs("div",{className:"card-body",children:[S.jsx("div",{className:"text-muted",children:"()"}),S.jsx("div",{className:"mt-2",children:n?n.display_name||`#${n.id}`:""})]})]}),S.jsxs("div",{className:"card mb-3",children:[S.jsx("div",{className:"card-header",children:"1. "}),S.jsxs("div",{className:"card-body",children:[!n&&S.jsx("div",{className:"text-muted",children:""}),n&&!c&&S.jsx("div",{className:"text-muted",children:""}),n&&c&&d.length===0&&S.jsx("div",{className:"text-muted",children:""}),d.map(M=>S.jsxs("div",{className:"mb-2",children:[S.jsx("div",{className:"fw-semibold mb-1",children:M.date}),S.jsx("div",{className:"d-flex flex-wrap gap-2",children:M.slots.map(D=>S.jsx("button",{type:"button",className:"btn btn-sm "+(m===D?"btn-primary":"btn-outline-secondary"),onClick:()=>v(D),children:new Date(D).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},D))})]},M.date))]})]}),S.jsxs("div",{className:"card mb-3",children:[S.jsx("div",{className:"card-header",children:"2. "}),S.jsxs("div",{className:"card-body",children:[S.jsxs("div",{className:"row g-2",children:[S.jsxs("div",{className:"col-md-6",children:[S.jsx("label",{className:"form-label",children:""}),S.jsx("input",{className:"form-control",value:y,onChange:M=>T(M.target.value)})]}),S.jsxs("div",{className:"col-md-6",children:[S.jsx("label",{className:"form-label",children:""}),S.jsx("input",{className:"form-control",value:k,onChange:M=>E(M.target.value)})]})]}),S.jsxs("div",{className:"mt-3",children:[S.jsx("label",{className:"form-label",children:""}),S.jsx("input",{className:"form-control",placeholder:" /  /  ",value:x,onChange:M=>_(M.target.value)})]})]})]}),S.jsx("div",{className:"d-flex gap-2",children:S.jsx("button",{className:"btn btn-primary",disabled:!w||N,onClick:V,children:N?"":""})}),O&&S.jsxs("div",{className:"alert alert-success mt-3",children:[S.jsxs("div",{className:"mb-1",children:["",new Date(O.starts_at).toLocaleString()]}),S.jsxs("div",{children:["",S.jsx("a",{href:O.guest,target:"_blank",rel:"noreferrer",children:O.guest})]}),S.jsxs("div",{children:["",S.jsx("a",{href:O.host,target:"_blank",rel:"noreferrer",children:O.host})]})]})]})}function Kp(t){if(!t)return"";const e=new Date(t),n=i=>String(i).padStart(2,"0");return`${e.getFullYear()}-${n(e.getMonth()+1)}-${n(e.getDate())}T${n(e.getHours())}:${n(e.getMinutes())}`}function z4(t){const e=new Date(t);e.setSeconds(0,0);const n=e.getMinutes(),i=n%30===0?0:30-n%30;return e.setMinutes(n+i),e}function PC(t){const n=z4(t??new Date),i=a=>String(a).padStart(2,"0");return`${n.getFullYear()}-${i(n.getMonth()+1)}-${i(n.getDate())}T${i(n.getHours())}:${i(n.getMinutes())}`}function LC(){let t=localStorage.getItem("visitor_id");return t||(t=1),t}function V4({tenant:t,lawyerId:e,defaultStartsAt:n}){const[i,a]=b.useState(""),[o,c]=b.useState(""),[u,d]=b.useState(""),[h,m]=b.useState(""),[v,y]=b.useState(""),[T,k]=b.useState(n?Kp(n):PC());b.useEffect(()=>{if(n){const M=new Date(n);k(PC(M))}},[n]);const[E,x]=b.useState(!1),_=b.useRef(null),[N,P]=b.useState(),[O,A]=b.useState(null);b.useEffect(()=>{const M=LC();fetch(`/api/tenants/${t}/my/appointments?visitor_id=${M}`).then(D=>D.ok?D.json():[]).then(D=>{if(D?.[0]){const B=D[0];A({when:Kp(B.starts_at),clientPath:`/wait?aid=${B.id}`,hostPath:`/host?aid=${B.id}`})}}).catch(()=>{})},[t]);const w=b.useMemo(()=>!i||!h||!T?!1:new Date(T).getTime()>=Date.now()+240*1e3,[i,h,T]);async function V(M){if(M.preventDefault(),!w||E)return;_.current?.abort();const D=new AbortController;_.current=D,x(!0),P(void 0);try{const B={lawyer_id:e,client_name:i,client_email:o,client_phone:u,start_at:new Date(T).toISOString(),visitor_id:LC(),purpose_title:h,purpose_detail:v},Y=await fetch(`/api/tenants/${t}/appointments`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(B),signal:D.signal}),de=(Y.headers.get("content-type")||"").includes("application/json")?await Y.json():await Y.text();if(!Y.ok){if(Y.status===409&&de?.suggested_start_at){k(Kp(de.suggested_start_at)),P("");return}throw new Error(typeof de=="string"?de:de?.message||"")}const be=de;A({when:T,clientPath:be.clientJoinPath||"",hostPath:be.hostJoinPath||""}),localStorage.setItem("last_aid",String(be.appointmentId))}catch(B){P(String(B?.message||B))}finally{x(!1)}}if(O){const M=`${location.origin}/${t}`,D=`${M}${O.clientPath}`,B=`${M}${O.hostPath}`;return S.jsxs("div",{style:{background:"#f7f7ff",padding:12,borderRadius:12,marginBottom:12},children:[S.jsxs("div",{children:["",S.jsx("b",{children:O.when.replace("T"," ")})]}),S.jsx(Hn,{to:`/${t}/reserve`,children:""}),S.jsxs("div",{style:{marginTop:8,lineHeight:1.7},children:["URL",S.jsx("a",{href:D,children:D}),S.jsx("br",{}),"URL",S.jsx("a",{href:B,children:B})]})]})}return S.jsxs("form",{onSubmit:V,style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr auto",gap:8,alignItems:"center"},children:[S.jsx("input",{value:i,onChange:M=>a(M.target.value),name:"name",placeholder:"",required:!0}),S.jsx("input",{value:o,onChange:M=>c(M.target.value),name:"email",placeholder:""}),S.jsx("input",{value:u,onChange:M=>d(M.target.value),name:"phone",placeholder:""}),S.jsxs("div",{style:{gridColumn:"1 / 3"},children:[S.jsx("label",{className:"block text-sm mb-1",children:""}),S.jsx("input",{value:h,onChange:M=>m(M.target.value),placeholder:"",required:!0})]}),S.jsxs("div",{style:{gridColumn:"1 / 4"},children:[S.jsx("label",{className:"block text-sm mb-1",children:""}),S.jsx("textarea",{value:v,onChange:M=>y(M.target.value),placeholder:"",rows:5})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm mb-1",children:""}),S.jsx("input",{name:"start_at",type:"datetime-local",value:T,readOnly:!0,className:"opacity-50 pointer-events-none"})]}),S.jsx("button",{type:"submit",disabled:!w||E,style:{padding:"10px 14px",borderRadius:12,border:"none",background:!w||E?"#c9c9d6":"#6c63ff",color:"#fff",cursor:!w||E?"not-allowed":"pointer",boxShadow:"0 3px 8px rgba(0,0,0,.08)"},onMouseDown:M=>M.currentTarget.style.transform="translateY(1px)",onMouseUp:M=>M.currentTarget.style.transform="translateY(0)",formNoValidate:!0,children:E?"":""}),N&&S.jsx("div",{style:{gridColumn:"1 / -1",color:"#c00"},children:N})]})}function H4(){const{tenant:t=""}=Kc(),[e,n]=b.useState([]),[i,a]=b.useState(new URLSearchParams(location.search).get("prefill")??void 0);return b.useEffect(()=>{const o=new Date().toISOString();fetch(`/api/tenants/${t}/availability?from=${encodeURIComponent(o)}&days=7&duration=30`).then(c=>c.ok?c.json():Promise.reject(c)).then(c=>n(c.days||[])).catch(console.error)},[t]),t?S.jsxs("div",{style:{padding:16},children:[S.jsx("h2",{children:""}),S.jsx(V4,{tenant:t,lawyerId:1,defaultStartsAt:i}),S.jsx("h3",{style:{marginTop:16},children:"301"}),S.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))",gap:12},children:e.map(o=>S.jsxs("div",{style:{border:"1px solid #eee",borderRadius:12,padding:12},children:[S.jsx("strong",{children:new Date(o.date).toLocaleDateString("ja-JP",{weekday:"short",month:"numeric",day:"numeric"})}),S.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginTop:8},children:o.slots.map(c=>S.jsx("button",{type:"button",onClick:()=>a(c),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #ddd"},children:new Date(c).toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"})},c))})]},o.date))})]}):null}function F4({data:t}){const e=t?.kicker??"",n=t?.headline??t?.title??"",i=t?.subtitle??"",a=t?.btnText??"",o=t?.btnHref??"#",c=t?.bgUrl??t?.imageUrl??t?.imgUrl,u=t?.avatarUrl;return console.log("bg =",c),console.log("av =",u),S.jsx("div",{className:"relative",children:S.jsxs("section",{className:"position-relative text-center text-white",style:c?{backgroundImage:`url(${c})`,backgroundSize:"cover",backgroundPosition:"center"}:{},children:[e&&S.jsx("div",{className:"text-sm text-slate-500",children:e}),n&&S.jsx("h1",{className:"text-4xl font-extrabold my-3",children:n}),i&&S.jsx("p",{className:"text-slate-600",children:i}),a&&S.jsx("div",{className:"mt-4",children:S.jsx("a",{href:o,className:"px-5 py-3 rounded-2xl bg-indigo-600 text-white hover:bg-indigo-700",children:a})}),u&&S.jsx("img",{src:u,className:"rounded-circle mb-3",style:{width:120,height:120,objectFit:"cover",border:"4px solid #fff"},alt:""})]})})}function q4({data:t}){const e=t.items??[];return S.jsx("section",{className:"py-2",children:S.jsx("div",{className:"row g-3",children:e.map((n,i)=>S.jsx("div",{className:"col-md-4",children:S.jsxs("div",{className:"border rounded-4 p-4 h-100",children:[S.jsx("div",{className:"fw-semibold",children:n.title??""}),n.text&&S.jsx("p",{className:"text-muted mt-2 mb-0",children:n.text})]})},i))})})}const $4=di;function G4({siteSlug:t="demo"}){const[e,n]=b.useState(""),[i,a]=b.useState(""),[o,c]=b.useState(""),[u,d]=b.useState(""),[h,m]=b.useState(!1),[v,y]=b.useState(!1);async function T(k){if(k.preventDefault(),!i||!u){alert("");return}m(!0);try{await $4.post("inquiries",{site_slug:t,name:e,email:i,topic:o,message:u}),y(!0),n(""),a(""),c(""),d("")}catch(E){console.error(E),alert("")}finally{m(!1)}}return S.jsxs("form",{onSubmit:T,className:"space-y-3",children:[v&&S.jsx("div",{className:"alert alert-success",children:""}),S.jsx("input",{className:"form-control",placeholder:"",value:e,onChange:k=>n(k.target.value)}),S.jsx("input",{className:"form-control",placeholder:" *",value:i,onChange:k=>a(k.target.value)}),S.jsx("input",{className:"form-control",placeholder:" / ",value:o,onChange:k=>c(k.target.value)}),S.jsx("textarea",{className:"form-control",rows:5,placeholder:" *",value:u,onChange:k=>d(k.target.value)}),S.jsx("button",{className:"btn btn-primary",disabled:h,children:h?"...":""})]})}function Y4({data:t}){return t?.imgUrl?S.jsxs("div",{className:"relative w-full h-40 md:h-60",children:[S.jsx("img",{src:t.imgUrl,alt:t.altText??"",className:"w-full h-full object-cover"}),S.jsx("div",{className:"absolute inset-0 bg-black/20"})," "]}):null}function K4({data:t}){if(!t?.imgUrl)return null;const e=t.radius==="xl"?"rounded-2xl":t.radius==="md"?"rounded-md":"",n=t.shadow?"shadow-md":"",i=t.width==="half"?"max-w-xl":t.width==="content"?"max-w-3xl":"w-full",a=t.align==="left"?"mx-0":t.align==="right"?"ml-auto":"mx-auto",o=S.jsx("img",{src:t.imgUrl,alt:t.alt||"",loading:"lazy",className:`${i} ${a} ${e} ${n} block object-cover`});return S.jsxs("figure",{className:"my-6",children:[t.linkUrl?S.jsx("a",{href:t.linkUrl,children:o}):o,t.caption&&S.jsx("figcaption",{className:"text-center text-sm text-slate-500 mt-2",children:t.caption})]})}function Q4({data:t}){const{imgUrl:e,caption:n,align:i="center",width:a=680,shadow:o=!0,rounded:c=!0}=t||{};if(!e)return null;const u=i==="left"?"md:mr-auto md:ml-0":i==="right"?"md:ml-auto md:mr-0":"mx-auto";return S.jsxs("figure",{className:`my-6 ${u}`,style:{maxWidth:a},children:[S.jsx("img",{src:e,alt:n??"",className:["w-full h-auto",o?"shadow-lg":"",c?"rounded-2xl":"","border border-slate-200"].join(" "),loading:"lazy"}),n&&S.jsx("figcaption",{className:"text-sm text-slate-500 mt-2",children:n})]})}function W4({data:t}){const e=t.columns??{sm:2,md:3,lg:4},n=t.radius==="xl"?"rounded-2xl":t.radius==="md"?"rounded-md":"",i=t.gap??12;return S.jsxs("div",{className:"grid",style:{gap:i,gridTemplateColumns:`repeat(${e.sm}, 1fr)`},children:[S.jsx("style",{children:`
        @media (min-width: 768px){ .gallery-md { grid-template-columns: repeat(${e.md}, 1fr); } }
        @media (min-width: 1024px){ .gallery-lg { grid-template-columns: repeat(${e.lg}, 1fr); } }
      `}),S.jsx("div",{className:"contents gallery-md gallery-lg",children:t.items?.map((a,o)=>S.jsx("img",{src:a.imgUrl,alt:a.alt||"",loading:"lazy",className:`${n} w-full h-full object-cover`},o))})]})}const X4={hero:t=>S.jsx(F4,{data:t.data}),features:t=>S.jsx(q4,{data:t.data}),cta:t=>S.jsx(G4,{data:t.data}),header:t=>S.jsx(Y4,{data:t.data}),image:t=>S.jsx(K4,{data:t.data}),mediacard:t=>S.jsx(Q4,{data:t.data}),gallery:t=>S.jsx(W4,{data:t.data})};function Z4(){zN();const{slug:t}=Kc(),e=ji(),n=b.useMemo(()=>{const m=e.pathname.replace(/^\/s\/[^/]+/,"")||"/";return m.startsWith("/")?m:`/${m}`},[e.pathname]),i=t?`/reserve?slug=${encodeURIComponent(t)}`:void 0,[a,o]=b.useState(null),[c,u]=b.useState(null);if(b.useEffect(()=>{let m=!1;return(async()=>{try{u(null),o(null);const v=await fetch(`http://localhost:8000/api/public/sites/${t}/page?path=${encodeURIComponent(n)}`);if(!v.ok)throw new Error(`HTTP ${v.status}`);const y=await v.json();m||(o(y),document.title=`${y.page.title} | ${y.site.title}`)}catch(v){m||u(v.message||"Error")}})(),()=>{m=!0}},[t,n]),c)return S.jsxs("div",{style:{padding:24},children:[": ",c]});if(!a)return S.jsx("div",{style:{padding:24},children:""});const h=a.page.blocks.find(m=>String(m.type).toLowerCase()==="hero")?.data?.imgUrl;return S.jsxs("div",{className:"relative isolate",children:[h&&S.jsxs("div",{className:"absolute inset-x-0 top-0 z-0 h-[260px] md:h-[360px]",children:[S.jsx("img",{src:h,alt:"",className:"w-full h-full object-cover"}),S.jsx("div",{className:"absolute inset-x-0 top-0 h-16 bg-gradient-to-b from-white/70 to-transparent"}),S.jsx("div",{className:"absolute inset-x-0 bottom-0 h-24 bg-gradient-to-b from-transparent to-white"})]}),S.jsxs("header",{className:"container py-4 d-flex gap-3 relative z-10",children:[S.jsx(Hn,{to:`/s/${a.site.slug}/`,className:"fw-bold text-decoration-none fs-5",children:a.site.title}),S.jsx("nav",{className:"ms-auto d-flex gap-3",children:(a.nav??[]).map(m=>S.jsx(Hn,{to:`/s/${a.site.slug}${m.path}`,className:"link-secondary",children:m.title},m.path))}),i&&S.jsx(Hn,{className:"btn btn-success btn-sm",to:i,children:""})]}),S.jsx("main",{className:"container py-4 d-grid gap-5 relative z-10",children:a.page.blocks.slice().sort((m,v)=>(m.sort??0)-(v.sort??0)).map(m=>{const v=String(m.type||"").toLowerCase(),y=X4[v],T=m.id??`${v}-${m.sort??0}`;return S.jsx("div",{children:y?S.jsx(y,{data:m.data}):S.jsxs("div",{className:"border rounded-4 p-4",children:[S.jsx("div",{className:"fw-semibold mb-2",children:m.type}),S.jsx("pre",{className:"mb-0",children:JSON.stringify(m.data,null,2)})]})},T)})}),S.jsxs("footer",{className:"container py-4 border-top text-muted small",children:[" ",new Date().getFullYear()," ",a.site.title]})]})}const IC=t=>["default","law","beauty","edu"].includes(t);function J4(t){const[e,n]=b.useState();return b.useEffect(()=>{try{const i=new URL(window.location.href),a=(i.searchParams.get("v")||"").toLowerCase(),o=i.pathname.replace(/^\/+|\/+$/g,"").split("/")[0]||"";IC(a)?n(a):IC(o)&&n(o)}catch{}},[]),t||e||"default"}const e6=[{title:"/",desc:""},{title:"/",desc:"Stripe"},{title:"",desc:""},{title:"HP",desc:"/SEO"},{title:"/",desc:""},{title:"",desc:"IP"}],t6=[{q:"",a:""},{q:"",a:""},{q:"HP",a:" or "}],n6=[{name:"",price:"19,800 / ",points:["HP +  +  + ","","/"]},{name:"",price:"217,800 / ",points:["2","",""]},{name:"",price:"",points:["/","SLA/",""]}],jC={default:{badge:"MULTI-INDUSTRY",headline:"",subhead:"",heroBullets:["URL ","HP1"],trust:[""],features:e6,faq:t6,demoLink:"/demo",PublicReserve:"/Offices",signupLink:"/signup"}};function i6({badge:t,vertical:e}){return S.jsx("header",{className:"sticky top-0 z-40 backdrop-blur bg-white/70 border-b border-slate-200",children:S.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("div",{className:"h-8 w-8 rounded-2xl bg-gradient-to-br from-fuchsia-500 to-indigo-500"}),S.jsx("span",{className:"font-semibold tracking-tight",children:"PLASMIC"}),e!=="default"&&S.jsx("span",{className:"ml-2 text-xs rounded-full px-2 py-0.5 bg-slate-100 border border-slate-200",children:t})]}),S.jsxs("nav",{className:"hidden md:flex items-center gap-6 text-sm",children:[S.jsx("a",{href:"#features",className:"hover:text-slate-600",children:""}),S.jsx("a",{href:"#pricing",className:"hover:text-slate-600",children:""}),S.jsx("a",{href:"#security",className:"hover:text-slate-600",children:""}),S.jsx("a",{href:"#faq",className:"hover:text-slate-600",children:"FAQ"})]}),S.jsxs("div",{className:"flex items-center gap-3",children:[S.jsx("a",{href:"/admin",className:"text-sm px-3 py-1.5 rounded-xl border border-slate-300 hover:bg-slate-50",children:""}),S.jsx("a",{href:"#cta",className:"text-sm px-3 py-1.5 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700",children:""})]})]})})}function r6({headline:t,subhead:e,bullets:n,trust:i,reserveHref:a}){return S.jsx("section",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pt-16 pb-12",children:S.jsxs("div",{className:"grid lg:grid-cols-2 gap-10 items-center",children:[S.jsxs("div",{children:[S.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold leading-tight tracking-tight",children:t}),S.jsx("p",{className:"mt-5 text-lg text-slate-600",children:e}),S.jsxs("div",{className:"mt-8 flex flex-wrap gap-3",children:[S.jsx("a",{id:"cta",href:a,className:"px-5 py-3 rounded-2xl bg-indigo-600 text-white hover:bg-indigo-700",children:""}),S.jsx("a",{href:"#pricing",className:"px-5 py-3 rounded-2xl border border-slate-300 hover:bg-slate-50",children:""})]}),S.jsx("div",{className:"mt-6 flex flex-wrap gap-2",children:i.map(o=>S.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-slate-100 border border-slate-200",children:o},o))})]}),S.jsxs("div",{className:"relative",children:[S.jsx("div",{className:"absolute -inset-4 rounded-3xl bg-gradient-to-tr from-indigo-200/60 to-fuchsia-200/60 blur-2xl"}),S.jsxs("div",{className:"relative rounded-3xl border border-slate-200 shadow-xl bg-white p-4",children:[S.jsx("div",{className:"aspect-video w-full rounded-2xl bg-slate-100 grid place-items-center text-slate-500",children:S.jsx("img",{src:"/reserve.bmp",alt:"",className:"w-full h-auto rounded-2xl object-cover"})}),S.jsx("ul",{className:"mt-4 grid grid-cols-2 gap-2 text-sm",children:n.map(o=>S.jsx("li",{className:"px-3 py-2 rounded-xl bg-slate-50 border border-slate-200",children:o},o))})]})]})]})})}function a6({signupHref:t}){return S.jsxs("section",{id:"pricing",className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-12",children:[S.jsx("h2",{className:"text-2xl font-bold",children:""}),S.jsx("p",{className:"text-slate-600 mt-2",children:"HP"}),S.jsx("div",{className:"mt-8 grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:n6.map(e=>S.jsxs("div",{className:"rounded-2xl border border-slate-200 p-6 bg-white shadow-sm flex flex-col",children:[S.jsx("div",{className:"text-sm font-semibold",children:e.name}),S.jsx("div",{className:"mt-4 text-3xl font-extrabold",children:e.price}),S.jsx("ul",{className:"mt-4 space-y-2 text-sm text-slate-600",children:e.points.map(n=>S.jsxs("li",{children:[" ",n]},n))}),S.jsx("a",{href:t,className:"mt-6 px-4 py-2 rounded-xl bg-indigo-600 text-white text-center hover:bg-indigo-700",children:""})]},e.name))}),S.jsx("p",{className:"text-xs text-slate-500 mt-4",children:" "})]})}async function Qp(t,e){const n=await fetch(t,{headers:{"Content-Type":"application/json"},...e});if(!n.ok)throw new Error(`${n.status} ${n.statusText}`);return n.json()}function UC(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function s6(...t){return e=>{let n=!1;const i=t.map(a=>{const o=UC(a,e);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<i.length;a++){const o=i[a];typeof o=="function"?o():UC(t[a],null)}}}}function o6(t){const e=c6(t),n=b.forwardRef((i,a)=>{const{children:o,...c}=i,u=b.Children.toArray(o),d=u.find(d6);if(d){const h=d.props.children,m=u.map(v=>v===d?b.Children.count(h)>1?b.Children.only(null):b.isValidElement(h)?h.props.children:null:v);return S.jsx(e,{...c,ref:a,children:b.isValidElement(h)?b.cloneElement(h,void 0,m):null})}return S.jsx(e,{...c,ref:a,children:o})});return n.displayName=`${t}.Slot`,n}var l6=o6("Slot");function c6(t){const e=b.forwardRef((n,i)=>{const{children:a,...o}=n;if(b.isValidElement(a)){const c=h6(a),u=f6(o,a.props);return a.type!==b.Fragment&&(u.ref=i?s6(i,c):c),b.cloneElement(a,u)}return b.Children.count(a)>1?b.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var u6=Symbol("radix.slottable");function d6(t){return b.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===u6}function f6(t,e){const n={...e};for(const i in e){const a=t[i],o=e[i];/^on[A-Z]/.test(i)?a&&o?n[i]=(...u)=>{const d=o(...u);return a(...u),d}:a&&(n[i]=a):i==="style"?n[i]={...a,...o}:i==="className"&&(n[i]=[a,o].filter(Boolean).join(" "))}return{...t,...n}}function h6(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function vx(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=vx(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function bx(){for(var t,e,n=0,i="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=vx(t))&&(i&&(i+=" "),i+=e);return i}const BC=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,zC=bx,m6=(t,e)=>n=>{var i;if(e?.variants==null)return zC(t,n?.class,n?.className);const{variants:a,defaultVariants:o}=e,c=Object.keys(a).map(h=>{const m=n?.[h],v=o?.[h];if(m===null)return null;const y=BC(m)||BC(v);return a[h][y]}),u=n&&Object.entries(n).reduce((h,m)=>{let[v,y]=m;return y===void 0||(h[v]=y),h},{}),d=e==null||(i=e.compoundVariants)===null||i===void 0?void 0:i.reduce((h,m)=>{let{class:v,className:y,...T}=m;return Object.entries(T).every(k=>{let[E,x]=k;return Array.isArray(x)?x.includes({...o,...u}[E]):{...o,...u}[E]===x})?[...h,v,y]:h},[]);return zC(t,c,d,n?.class,n?.className)},_b="-",p6=t=>{const e=v6(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=t;return{getClassGroupId:c=>{const u=c.split(_b);return u[0]===""&&u.length!==1&&u.shift(),yx(u,e)||g6(c)},getConflictingClassGroupIds:(c,u)=>{const d=n[c]||[];return u&&i[c]?[...d,...i[c]]:d}}},yx=(t,e)=>{if(t.length===0)return e.classGroupId;const n=t[0],i=e.nextPart.get(n),a=i?yx(t.slice(1),i):void 0;if(a)return a;if(e.validators.length===0)return;const o=t.join(_b);return e.validators.find(({validator:c})=>c(o))?.classGroupId},VC=/^\[(.+)\]$/,g6=t=>{if(VC.test(t)){const e=VC.exec(t)[1],n=e?.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},v6=t=>{const{theme:e,classGroups:n}=t,i={nextPart:new Map,validators:[]};for(const a in n)mv(n[a],i,a,e);return i},mv=(t,e,n,i)=>{t.forEach(a=>{if(typeof a=="string"){const o=a===""?e:HC(e,a);o.classGroupId=n;return}if(typeof a=="function"){if(b6(a)){mv(a(i),e,n,i);return}e.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([o,c])=>{mv(c,HC(e,o),n,i)})})},HC=(t,e)=>{let n=t;return e.split(_b).forEach(i=>{n.nextPart.has(i)||n.nextPart.set(i,{nextPart:new Map,validators:[]}),n=n.nextPart.get(i)}),n},b6=t=>t.isThemeGetter,y6=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,i=new Map;const a=(o,c)=>{n.set(o,c),e++,e>t&&(e=0,i=n,n=new Map)};return{get(o){let c=n.get(o);if(c!==void 0)return c;if((c=i.get(o))!==void 0)return a(o,c),c},set(o,c){n.has(o)?n.set(o,c):a(o,c)}}},pv="!",gv=":",S6=gv.length,T6=t=>{const{prefix:e,experimentalParseClassName:n}=t;let i=a=>{const o=[];let c=0,u=0,d=0,h;for(let k=0;k<a.length;k++){let E=a[k];if(c===0&&u===0){if(E===gv){o.push(a.slice(d,k)),d=k+S6;continue}if(E==="/"){h=k;continue}}E==="["?c++:E==="]"?c--:E==="("?u++:E===")"&&u--}const m=o.length===0?a:a.substring(d),v=E6(m),y=v!==m,T=h&&h>d?h-d:void 0;return{modifiers:o,hasImportantModifier:y,baseClassName:v,maybePostfixModifierPosition:T}};if(e){const a=e+gv,o=i;i=c=>c.startsWith(a)?o(c.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:c,maybePostfixModifierPosition:void 0}}if(n){const a=i;i=o=>n({className:o,parseClassName:a})}return i},E6=t=>t.endsWith(pv)?t.substring(0,t.length-1):t.startsWith(pv)?t.substring(1):t,C6=t=>{const e=Object.fromEntries(t.orderSensitiveModifiers.map(i=>[i,!0]));return i=>{if(i.length<=1)return i;const a=[];let o=[];return i.forEach(c=>{c[0]==="["||e[c]?(a.push(...o.sort(),c),o=[]):o.push(c)}),a.push(...o.sort()),a}},k6=t=>({cache:y6(t.cacheSize),parseClassName:T6(t),sortModifiers:C6(t),...p6(t)}),_6=/\s+/,w6=(t,e)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:a,sortModifiers:o}=e,c=[],u=t.trim().split(_6);let d="";for(let h=u.length-1;h>=0;h-=1){const m=u[h],{isExternal:v,modifiers:y,hasImportantModifier:T,baseClassName:k,maybePostfixModifierPosition:E}=n(m);if(v){d=m+(d.length>0?" "+d:d);continue}let x=!!E,_=i(x?k.substring(0,E):k);if(!_){if(!x){d=m+(d.length>0?" "+d:d);continue}if(_=i(k),!_){d=m+(d.length>0?" "+d:d);continue}x=!1}const N=o(y).join(":"),P=T?N+pv:N,O=P+_;if(c.includes(O))continue;c.push(O);const A=a(_,x);for(let w=0;w<A.length;++w){const V=A[w];c.push(P+V)}d=m+(d.length>0?" "+d:d)}return d};function x6(){let t=0,e,n,i="";for(;t<arguments.length;)(e=arguments[t++])&&(n=Sx(e))&&(i&&(i+=" "),i+=n);return i}const Sx=t=>{if(typeof t=="string")return t;let e,n="";for(let i=0;i<t.length;i++)t[i]&&(e=Sx(t[i]))&&(n&&(n+=" "),n+=e);return n};function R6(t,...e){let n,i,a,o=c;function c(d){const h=e.reduce((m,v)=>v(m),t());return n=k6(h),i=n.cache.get,a=n.cache.set,o=u,u(d)}function u(d){const h=i(d);if(h)return h;const m=w6(d,n);return a(d,m),m}return function(){return o(x6.apply(null,arguments))}}const qt=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},Tx=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Ex=/^\((?:(\w[\w-]*):)?(.+)\)$/i,A6=/^\d+\/\d+$/,O6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,N6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,D6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,M6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,P6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,wo=t=>A6.test(t),$e=t=>!!t&&!Number.isNaN(Number(t)),Sa=t=>!!t&&Number.isInteger(Number(t)),Wp=t=>t.endsWith("%")&&$e(t.slice(0,-1)),Ar=t=>O6.test(t),L6=()=>!0,I6=t=>N6.test(t)&&!D6.test(t),Cx=()=>!1,j6=t=>M6.test(t),U6=t=>P6.test(t),B6=t=>!Ee(t)&&!Ce(t),z6=t=>ll(t,wx,Cx),Ee=t=>Tx.test(t),ms=t=>ll(t,xx,I6),Xp=t=>ll(t,$6,$e),FC=t=>ll(t,kx,Cx),V6=t=>ll(t,_x,U6),Od=t=>ll(t,Rx,j6),Ce=t=>Ex.test(t),Ec=t=>cl(t,xx),H6=t=>cl(t,G6),qC=t=>cl(t,kx),F6=t=>cl(t,wx),q6=t=>cl(t,_x),Nd=t=>cl(t,Rx,!0),ll=(t,e,n)=>{const i=Tx.exec(t);return i?i[1]?e(i[1]):n(i[2]):!1},cl=(t,e,n=!1)=>{const i=Ex.exec(t);return i?i[1]?e(i[1]):n:!1},kx=t=>t==="position"||t==="percentage",_x=t=>t==="image"||t==="url",wx=t=>t==="length"||t==="size"||t==="bg-size",xx=t=>t==="length",$6=t=>t==="number",G6=t=>t==="family-name",Rx=t=>t==="shadow",Y6=()=>{const t=qt("color"),e=qt("font"),n=qt("text"),i=qt("font-weight"),a=qt("tracking"),o=qt("leading"),c=qt("breakpoint"),u=qt("container"),d=qt("spacing"),h=qt("radius"),m=qt("shadow"),v=qt("inset-shadow"),y=qt("text-shadow"),T=qt("drop-shadow"),k=qt("blur"),E=qt("perspective"),x=qt("aspect"),_=qt("ease"),N=qt("animate"),P=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],A=()=>[...O(),Ce,Ee],w=()=>["auto","hidden","clip","visible","scroll"],V=()=>["auto","contain","none"],M=()=>[Ce,Ee,d],D=()=>[wo,"full","auto",...M()],B=()=>[Sa,"none","subgrid",Ce,Ee],Y=()=>["auto",{span:["full",Sa,Ce,Ee]},Sa,Ce,Ee],re=()=>[Sa,"auto",Ce,Ee],de=()=>["auto","min","max","fr",Ce,Ee],be=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],xe=()=>["start","end","center","stretch","center-safe","end-safe"],H=()=>["auto",...M()],ae=()=>[wo,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...M()],ee=()=>[t,Ce,Ee],Se=()=>[...O(),qC,FC,{position:[Ce,Ee]}],j=()=>["no-repeat",{repeat:["","x","y","space","round"]}],te=()=>["auto","cover","contain",F6,z6,{size:[Ce,Ee]}],he=()=>[Wp,Ec,ms],le=()=>["","none","full",h,Ce,Ee],ge=()=>["",$e,Ec,ms],De=()=>["solid","dashed","dotted","double"],ye=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ae=()=>[$e,Wp,qC,FC],Be=()=>["","none",k,Ce,Ee],yt=()=>["none",$e,Ce,Ee],st=()=>["none",$e,Ce,Ee],Vt=()=>[$e,Ce,Ee],Nn=()=>[wo,"full",...M()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ar],breakpoint:[Ar],color:[L6],container:[Ar],"drop-shadow":[Ar],ease:["in","out","in-out"],font:[B6],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ar],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ar],shadow:[Ar],spacing:["px",$e],text:[Ar],"text-shadow":[Ar],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",wo,Ee,Ce,x]}],container:["container"],columns:[{columns:[$e,Ee,Ce,u]}],"break-after":[{"break-after":P()}],"break-before":[{"break-before":P()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:A()}],overflow:[{overflow:w()}],"overflow-x":[{"overflow-x":w()}],"overflow-y":[{"overflow-y":w()}],overscroll:[{overscroll:V()}],"overscroll-x":[{"overscroll-x":V()}],"overscroll-y":[{"overscroll-y":V()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:D()}],"inset-x":[{"inset-x":D()}],"inset-y":[{"inset-y":D()}],start:[{start:D()}],end:[{end:D()}],top:[{top:D()}],right:[{right:D()}],bottom:[{bottom:D()}],left:[{left:D()}],visibility:["visible","invisible","collapse"],z:[{z:[Sa,"auto",Ce,Ee]}],basis:[{basis:[wo,"full","auto",u,...M()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[$e,wo,"auto","initial","none",Ee]}],grow:[{grow:["",$e,Ce,Ee]}],shrink:[{shrink:["",$e,Ce,Ee]}],order:[{order:[Sa,"first","last","none",Ce,Ee]}],"grid-cols":[{"grid-cols":B()}],"col-start-end":[{col:Y()}],"col-start":[{"col-start":re()}],"col-end":[{"col-end":re()}],"grid-rows":[{"grid-rows":B()}],"row-start-end":[{row:Y()}],"row-start":[{"row-start":re()}],"row-end":[{"row-end":re()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":de()}],"auto-rows":[{"auto-rows":de()}],gap:[{gap:M()}],"gap-x":[{"gap-x":M()}],"gap-y":[{"gap-y":M()}],"justify-content":[{justify:[...be(),"normal"]}],"justify-items":[{"justify-items":[...xe(),"normal"]}],"justify-self":[{"justify-self":["auto",...xe()]}],"align-content":[{content:["normal",...be()]}],"align-items":[{items:[...xe(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...xe(),{baseline:["","last"]}]}],"place-content":[{"place-content":be()}],"place-items":[{"place-items":[...xe(),"baseline"]}],"place-self":[{"place-self":["auto",...xe()]}],p:[{p:M()}],px:[{px:M()}],py:[{py:M()}],ps:[{ps:M()}],pe:[{pe:M()}],pt:[{pt:M()}],pr:[{pr:M()}],pb:[{pb:M()}],pl:[{pl:M()}],m:[{m:H()}],mx:[{mx:H()}],my:[{my:H()}],ms:[{ms:H()}],me:[{me:H()}],mt:[{mt:H()}],mr:[{mr:H()}],mb:[{mb:H()}],ml:[{ml:H()}],"space-x":[{"space-x":M()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":M()}],"space-y-reverse":["space-y-reverse"],size:[{size:ae()}],w:[{w:[u,"screen",...ae()]}],"min-w":[{"min-w":[u,"screen","none",...ae()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[c]},...ae()]}],h:[{h:["screen","lh",...ae()]}],"min-h":[{"min-h":["screen","lh","none",...ae()]}],"max-h":[{"max-h":["screen","lh",...ae()]}],"font-size":[{text:["base",n,Ec,ms]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[i,Ce,Xp]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Wp,Ee]}],"font-family":[{font:[H6,Ee,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,Ce,Ee]}],"line-clamp":[{"line-clamp":[$e,"none",Ce,Xp]}],leading:[{leading:[o,...M()]}],"list-image":[{"list-image":["none",Ce,Ee]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ce,Ee]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:ee()}],"text-color":[{text:ee()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...De(),"wavy"]}],"text-decoration-thickness":[{decoration:[$e,"from-font","auto",Ce,ms]}],"text-decoration-color":[{decoration:ee()}],"underline-offset":[{"underline-offset":[$e,"auto",Ce,Ee]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ce,Ee]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ce,Ee]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Se()}],"bg-repeat":[{bg:j()}],"bg-size":[{bg:te()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Sa,Ce,Ee],radial:["",Ce,Ee],conic:[Sa,Ce,Ee]},q6,V6]}],"bg-color":[{bg:ee()}],"gradient-from-pos":[{from:he()}],"gradient-via-pos":[{via:he()}],"gradient-to-pos":[{to:he()}],"gradient-from":[{from:ee()}],"gradient-via":[{via:ee()}],"gradient-to":[{to:ee()}],rounded:[{rounded:le()}],"rounded-s":[{"rounded-s":le()}],"rounded-e":[{"rounded-e":le()}],"rounded-t":[{"rounded-t":le()}],"rounded-r":[{"rounded-r":le()}],"rounded-b":[{"rounded-b":le()}],"rounded-l":[{"rounded-l":le()}],"rounded-ss":[{"rounded-ss":le()}],"rounded-se":[{"rounded-se":le()}],"rounded-ee":[{"rounded-ee":le()}],"rounded-es":[{"rounded-es":le()}],"rounded-tl":[{"rounded-tl":le()}],"rounded-tr":[{"rounded-tr":le()}],"rounded-br":[{"rounded-br":le()}],"rounded-bl":[{"rounded-bl":le()}],"border-w":[{border:ge()}],"border-w-x":[{"border-x":ge()}],"border-w-y":[{"border-y":ge()}],"border-w-s":[{"border-s":ge()}],"border-w-e":[{"border-e":ge()}],"border-w-t":[{"border-t":ge()}],"border-w-r":[{"border-r":ge()}],"border-w-b":[{"border-b":ge()}],"border-w-l":[{"border-l":ge()}],"divide-x":[{"divide-x":ge()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ge()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...De(),"hidden","none"]}],"divide-style":[{divide:[...De(),"hidden","none"]}],"border-color":[{border:ee()}],"border-color-x":[{"border-x":ee()}],"border-color-y":[{"border-y":ee()}],"border-color-s":[{"border-s":ee()}],"border-color-e":[{"border-e":ee()}],"border-color-t":[{"border-t":ee()}],"border-color-r":[{"border-r":ee()}],"border-color-b":[{"border-b":ee()}],"border-color-l":[{"border-l":ee()}],"divide-color":[{divide:ee()}],"outline-style":[{outline:[...De(),"none","hidden"]}],"outline-offset":[{"outline-offset":[$e,Ce,Ee]}],"outline-w":[{outline:["",$e,Ec,ms]}],"outline-color":[{outline:ee()}],shadow:[{shadow:["","none",m,Nd,Od]}],"shadow-color":[{shadow:ee()}],"inset-shadow":[{"inset-shadow":["none",v,Nd,Od]}],"inset-shadow-color":[{"inset-shadow":ee()}],"ring-w":[{ring:ge()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:ee()}],"ring-offset-w":[{"ring-offset":[$e,ms]}],"ring-offset-color":[{"ring-offset":ee()}],"inset-ring-w":[{"inset-ring":ge()}],"inset-ring-color":[{"inset-ring":ee()}],"text-shadow":[{"text-shadow":["none",y,Nd,Od]}],"text-shadow-color":[{"text-shadow":ee()}],opacity:[{opacity:[$e,Ce,Ee]}],"mix-blend":[{"mix-blend":[...ye(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ye()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[$e]}],"mask-image-linear-from-pos":[{"mask-linear-from":Ae()}],"mask-image-linear-to-pos":[{"mask-linear-to":Ae()}],"mask-image-linear-from-color":[{"mask-linear-from":ee()}],"mask-image-linear-to-color":[{"mask-linear-to":ee()}],"mask-image-t-from-pos":[{"mask-t-from":Ae()}],"mask-image-t-to-pos":[{"mask-t-to":Ae()}],"mask-image-t-from-color":[{"mask-t-from":ee()}],"mask-image-t-to-color":[{"mask-t-to":ee()}],"mask-image-r-from-pos":[{"mask-r-from":Ae()}],"mask-image-r-to-pos":[{"mask-r-to":Ae()}],"mask-image-r-from-color":[{"mask-r-from":ee()}],"mask-image-r-to-color":[{"mask-r-to":ee()}],"mask-image-b-from-pos":[{"mask-b-from":Ae()}],"mask-image-b-to-pos":[{"mask-b-to":Ae()}],"mask-image-b-from-color":[{"mask-b-from":ee()}],"mask-image-b-to-color":[{"mask-b-to":ee()}],"mask-image-l-from-pos":[{"mask-l-from":Ae()}],"mask-image-l-to-pos":[{"mask-l-to":Ae()}],"mask-image-l-from-color":[{"mask-l-from":ee()}],"mask-image-l-to-color":[{"mask-l-to":ee()}],"mask-image-x-from-pos":[{"mask-x-from":Ae()}],"mask-image-x-to-pos":[{"mask-x-to":Ae()}],"mask-image-x-from-color":[{"mask-x-from":ee()}],"mask-image-x-to-color":[{"mask-x-to":ee()}],"mask-image-y-from-pos":[{"mask-y-from":Ae()}],"mask-image-y-to-pos":[{"mask-y-to":Ae()}],"mask-image-y-from-color":[{"mask-y-from":ee()}],"mask-image-y-to-color":[{"mask-y-to":ee()}],"mask-image-radial":[{"mask-radial":[Ce,Ee]}],"mask-image-radial-from-pos":[{"mask-radial-from":Ae()}],"mask-image-radial-to-pos":[{"mask-radial-to":Ae()}],"mask-image-radial-from-color":[{"mask-radial-from":ee()}],"mask-image-radial-to-color":[{"mask-radial-to":ee()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":O()}],"mask-image-conic-pos":[{"mask-conic":[$e]}],"mask-image-conic-from-pos":[{"mask-conic-from":Ae()}],"mask-image-conic-to-pos":[{"mask-conic-to":Ae()}],"mask-image-conic-from-color":[{"mask-conic-from":ee()}],"mask-image-conic-to-color":[{"mask-conic-to":ee()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Se()}],"mask-repeat":[{mask:j()}],"mask-size":[{mask:te()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ce,Ee]}],filter:[{filter:["","none",Ce,Ee]}],blur:[{blur:Be()}],brightness:[{brightness:[$e,Ce,Ee]}],contrast:[{contrast:[$e,Ce,Ee]}],"drop-shadow":[{"drop-shadow":["","none",T,Nd,Od]}],"drop-shadow-color":[{"drop-shadow":ee()}],grayscale:[{grayscale:["",$e,Ce,Ee]}],"hue-rotate":[{"hue-rotate":[$e,Ce,Ee]}],invert:[{invert:["",$e,Ce,Ee]}],saturate:[{saturate:[$e,Ce,Ee]}],sepia:[{sepia:["",$e,Ce,Ee]}],"backdrop-filter":[{"backdrop-filter":["","none",Ce,Ee]}],"backdrop-blur":[{"backdrop-blur":Be()}],"backdrop-brightness":[{"backdrop-brightness":[$e,Ce,Ee]}],"backdrop-contrast":[{"backdrop-contrast":[$e,Ce,Ee]}],"backdrop-grayscale":[{"backdrop-grayscale":["",$e,Ce,Ee]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[$e,Ce,Ee]}],"backdrop-invert":[{"backdrop-invert":["",$e,Ce,Ee]}],"backdrop-opacity":[{"backdrop-opacity":[$e,Ce,Ee]}],"backdrop-saturate":[{"backdrop-saturate":[$e,Ce,Ee]}],"backdrop-sepia":[{"backdrop-sepia":["",$e,Ce,Ee]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":M()}],"border-spacing-x":[{"border-spacing-x":M()}],"border-spacing-y":[{"border-spacing-y":M()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ce,Ee]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[$e,"initial",Ce,Ee]}],ease:[{ease:["linear","initial",_,Ce,Ee]}],delay:[{delay:[$e,Ce,Ee]}],animate:[{animate:["none",N,Ce,Ee]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[E,Ce,Ee]}],"perspective-origin":[{"perspective-origin":A()}],rotate:[{rotate:yt()}],"rotate-x":[{"rotate-x":yt()}],"rotate-y":[{"rotate-y":yt()}],"rotate-z":[{"rotate-z":yt()}],scale:[{scale:st()}],"scale-x":[{"scale-x":st()}],"scale-y":[{"scale-y":st()}],"scale-z":[{"scale-z":st()}],"scale-3d":["scale-3d"],skew:[{skew:Vt()}],"skew-x":[{"skew-x":Vt()}],"skew-y":[{"skew-y":Vt()}],transform:[{transform:[Ce,Ee,"","none","gpu","cpu"]}],"transform-origin":[{origin:A()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Nn()}],"translate-x":[{"translate-x":Nn()}],"translate-y":[{"translate-y":Nn()}],"translate-z":[{"translate-z":Nn()}],"translate-none":["translate-none"],accent:[{accent:ee()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:ee()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ce,Ee]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ce,Ee]}],fill:[{fill:["none",...ee()]}],"stroke-w":[{stroke:[$e,Ec,ms,Xp]}],stroke:[{stroke:["none",...ee()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},K6=R6(Y6);function Q6(...t){return K6(bx(t))}const W6=m6("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),vv=b.forwardRef(({className:t,variant:e,size:n,asChild:i=!1,...a},o)=>{const c=i?l6:"button";return S.jsx(c,{className:Q6(W6({variant:e,size:n,className:t})),ref:o,...a})});vv.displayName="Button";function X6(t){console.log(t);const[e,n]=b.useState({}),[i,a]=b.useState([]),[o,c]=b.useState([]),[u,d]=b.useState();return b.useEffect(()=>{(async()=>a(await Qp("/api/public/tenants")))()},[]),b.useEffect(()=>{u&&(async()=>{const h=new Date().toISOString(),m=new Date(Date.now()+7*864e5).toISOString();c(await Qp(`/api/public/tenants/${u}/slots?from=${h}&to=${m}`))})()},[u]),b.useEffect(()=>{(async()=>n(await Qp("/api/settings")))()},[]),S.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[S.jsxs("header",{className:"flex items-center justify-between py-4",children:[S.jsx("div",{className:"font-semibold text-lg",children:e["site.name"]??"Regal"}),S.jsxs("nav",{className:"space-x-4 text-sm",children:[S.jsx(Hn,{to:"/",children:""}),S.jsx(Hn,{to:":tenant/reserve",children:""}),S.jsx(Hn,{to:"s/:slug",children:"TenantHome"}),S.jsx(Hn,{to:"/offices",children:"Offices"}),S.jsx(Hn,{to:"/admin",className:"px-3 py-1 rounded bg-primary text-primary-foreground",children:""})]})]}),S.jsxs("section",{className:"py-16 text-center",children:[S.jsx("h1",{className:"text-4xl md:text-6xl font-bold",children:e["hero.title"]??""}),S.jsx("p",{className:"mt-4 text-muted-foreground",children:e["hero.subtitle"]??"URL"}),S.jsxs("div",{className:"mt-8 flex gap-4 justify-center",children:[S.jsx(Hn,{to:e["cta.primary.href"]??"/reserve",children:S.jsx(vv,{children:e["cta.primary.label"]??""})}),S.jsx("a",{href:e["cta.secondary.href"]??"#features",children:S.jsx(vv,{variant:"secondary",children:e["cta.secondary.label"]??""})})]})]})]})}function Z6(){return S.jsx("div",{children:"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})}function J6(t){return S.jsx("div",{children:S.jsx("h1",{children:"fdfdsafdsafdsafdsafdsafdsafdsa"})})}function e7(){return S.jsx("footer",{className:"border-t border-slate-200 py-10",children:S.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row items-center justify-between gap-4",children:[S.jsxs("div",{className:"text-sm text-slate-500",children:[" ",new Date().getFullYear()," PLASMIC"]}),S.jsx("div",{className:"text-xs text-slate-400",children:"/law, /beauty, /edu  ?v=law "})]})})}function t7(t){const e=J4(t.vertical),n=b.useMemo(()=>jC[e]??jC.default,[e]);return S.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white text-slate-900",children:[S.jsx(i6,{badge:n.badge,vertical:e}),S.jsx(r6,{headline:n.headline,subhead:n.subhead,bullets:n.heroBullets,trust:n.trust,reserveHref:n.PublicReserve}),S.jsx(X6,{features:n.features}),S.jsx(a6,{signupHref:n.signupLink}),S.jsx(Z6,{}),S.jsx(J6,{items:n.faq}),S.jsx(e7,{})]})}const n7=di;function i7(){const[t,e]=b.useState([]),[n,i]=b.useState(1),[a,o]=b.useState(""),[c,u]=b.useState(""),[d,h]=b.useState(""),[m,v]=b.useState(null);return b.useEffect(()=>{(async()=>{const y=new URLSearchParams({page:String(n),q:a,region:c,type:d}),T=await n7.get(`/public/tenants/list?${y}`);e(T.data),v(T.meta)})()},[n,a,c,d]),S.jsxs("div",{className:"mx-auto max-w-5xl p-6",children:[S.jsx("h1",{className:"text-2xl font-bold mb-4",children:""}),S.jsxs("div",{className:"flex gap-2 mb-6",children:[S.jsx("input",{type:"text",placeholder:"",value:a,onChange:y=>o(y.target.value),className:"border rounded p-2 flex-1"}),S.jsxs("select",{value:c,onChange:y=>u(y.target.value),className:"border rounded p-2",children:[S.jsx("option",{value:"",children:""}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]})]}),S.jsxs("select",{value:d,onChange:y=>h(y.target.value),className:"border rounded p-2",children:[S.jsx("option",{value:"",children:""}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsx("optgroup",{label:"",children:S.jsx("option",{value:"",children:""})}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]}),S.jsxs("optgroup",{label:"",children:[S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""}),S.jsx("option",{value:"",children:""})]})]})]}),S.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:t.map(y=>S.jsxs("div",{className:"border rounded-xl p-4",children:[S.jsx("div",{className:"font-semibold",children:y.display_name}),S.jsxs("div",{className:"text-sm text-slate-500 mb-3",children:[y.region,"",y.type," /s/",y.slug]}),S.jsxs("div",{className:"flex gap-2",children:[y.home_url?S.jsx("a",{className:"btn btn-light",href:y.home_url,target:"_blank",rel:"noreferrer",children:"HP"}):S.jsx("a",{className:"btn btn-light",href:`/s/${y.slug}`,children:""}),S.jsx("a",{className:"btn btn-primary",href:`/s/${y.slug}/reserve`,children:""})]})]},y.id))}),m&&S.jsx("div",{className:"flex justify-center gap-2 mt-6",children:Array.from({length:m.total_pages},(y,T)=>T+1).map(y=>S.jsx("button",{onClick:()=>i(y),className:`px-3 py-1 rounded ${y===n?"bg-indigo-600 text-white":"bg-slate-100"}`,children:y},y))})]})}const r7=di;function a7(){const t=Ms(),{slug:e}=Kc(),[n]=_D(),i=e||n.get("slug")||"",[a,o]=b.useState(null),[c,u]=b.useState(!0);return b.useEffect(()=>{(async()=>{try{if(!i)throw new Error("no-slug");const d=await r7.get(`/public/tenants/resolve?slug=${encodeURIComponent(i)}`);if(!d.ok)throw new Error("resolve-failed");const h=await d.json();o(h)}catch{t("/offices",{replace:!0,state:{msg:""}})}finally{u(!1)}})()},[i,t]),{tenant:a,loading:c}}function s7(){const{tenant:t,loading:e}=a7();return e?S.jsx("div",{className:"p-8 text-center",children:""}):t?S.jsxs("div",{className:"mx-auto max-w-5xl p-6",children:[S.jsx("h1",{className:"text-2xl font-bold mb-4",children:t.display_name}),S.jsx("p",{className:"text-slate-600 mb-6",children:""}),S.jsx("a",{className:"btn btn-primary",href:`/s/${t.slug}/reserve`,children:""})]}):null}const Zp="/api".trim(),o7=()=>S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16",children:S.jsx("g",{fill:"#E184DF",children:S.jsx("path",{d:"M127,50 L126,50 C123.238576,50 121,47.7614237 121,45 C121,42.2385763 123.238576,40 126,40 L135,40 L135,56 L133,56 L133,42 L129,42 L129,56 L127,56 L127,50 Z M127,48 L127,42 L126,42 C124.343146,42 123,43.3431458 123,45 C123,46.6568542 124.343146,48 126,48 L127,48 Z",transform:"translate(-121 -40)"})})});function l7(){const[t,e]=b.useState(""),[n,i]=b.useState(""),[a,o]=b.useState(""),[c,u]=b.useState("price_1S8tvULGwIgaytjJcfgsahwn"),[d,h]=b.useState(!1),[m,v]=b.useState(null),[y,T]=b.useState(null);b.useEffect(()=>{const E=new URLSearchParams(location.search);E.get("success")&&T(""),E.get("canceled")&&T("")},[]);async function k(E){E.preventDefault(),v(null),T(null),h(!0);try{const x=Zp&&Zp!=="/"?`${Zp}/signup-and-checkout`:"/signup-and-checkout",_=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({name:t,email:n,password:a,price_id:c})}),N=await _.json().catch(()=>({}));if(!_.ok)throw new Error(N?.message||`: ${_.status}`);if(!N?.url)throw new Error("Checkout URL ");window.location.href=N.url}catch(x){v(x?.message||"")}finally{h(!1)}}return S.jsx("div",{className:"min-h-screen grid place-items-center bg-slate-50 px-4",children:S.jsxs("form",{onSubmit:k,className:"w-full max-w-sm rounded-2xl border bg-white p-6 shadow-sm",children:[S.jsx("section",{className:"mb-4",children:S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx("div",{className:"mt-1",children:S.jsx(o7,{})}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-base font-semibold",children:""}),S.jsx("p",{className:"text-sm text-slate-600",children:"1119,800"})]})]})}),S.jsx("h1",{className:"text-xl font-semibold",children:" & "}),S.jsx("input",{className:"mt-4 w-full rounded-xl border px-4 py-3",placeholder:"",value:t,onChange:E=>e(E.target.value)}),S.jsx("input",{className:"mt-3 w-full rounded-xl border px-4 py-3",placeholder:"",value:n,onChange:E=>i(E.target.value),autoComplete:"email"}),S.jsx("input",{className:"mt-3 w-full rounded-xl border px-4 py-3",type:"password",placeholder:"",value:a,onChange:E=>o(E.target.value),autoComplete:"new-password"}),y&&S.jsx("p",{className:"mt-3 text-sm text-emerald-600",children:y}),m&&S.jsx("p",{className:"mt-3 text-sm text-red-600",children:m}),S.jsx("button",{className:"mt-5 w-full rounded-xl bg-indigo-600 text-white py-3 hover:bg-indigo-500 disabled:opacity-60",disabled:d||!t||!n||!a||!c,children:d?"":""}),S.jsxs("p",{className:"mt-4 text-center text-sm text-slate-500",children:[""," ",S.jsx("a",{className:"text-indigo-600 underline",href:"/admin/login",children:""})]})]})})}const c7=di;function u7(){const t=Ms();return b.useEffect(()=>{const e=new URLSearchParams(location.search).get("session_id");e&&(async()=>(await c7.get(`/api/billing/thanks?session_id=${e}`),t("/admin/site",{replace:!0})))()},[]),S.jsx("div",{className:"p-8",children:""})}function d7(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var i=e.styles[n]||{},a=e.attributes[n]||{},o=e.elements[n];!ci(o)||!sr(o)||(Object.assign(o.style,i),Object.keys(a).forEach(function(c){var u=a[c];u===!1?o.removeAttribute(c):o.setAttribute(c,u===!0?"":u)}))})}function f7(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(i){var a=e.elements[i],o=e.attributes[i]||{},c=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:n[i]),u=c.reduce(function(d,h){return d[h]="",d},{});!ci(a)||!sr(a)||(Object.assign(a.style,u),Object.keys(o).forEach(function(d){a.removeAttribute(d)}))})}}const wb={name:"applyStyles",enabled:!0,phase:"write",fn:d7,effect:f7,requires:["computeStyles"]};var h7=[Sb,kb,yb,wb],m7=eh({defaultModifiers:h7}),p7=[Sb,kb,yb,wb,px,hx,gx,ux,mx],xb=eh({defaultModifiers:p7});const Ax=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ex,afterRead:X1,afterWrite:ix,applyStyles:wb,arrow:ux,auto:Zf,basePlacements:ol,beforeMain:Z1,beforeRead:Q1,beforeWrite:tx,bottom:Yn,clippingParents:Y1,computeStyles:yb,createPopper:xb,createPopperBase:P4,createPopperLite:m7,detectOverflow:el,end:Wo,eventListeners:Sb,flip:hx,hide:mx,left:pn,main:J1,modifierPhases:rx,offset:px,placements:pb,popper:Oo,popperGenerator:eh,popperOffsets:kb,preventOverflow:gx,read:W1,reference:K1,right:Kn,start:Os,top:mn,variationPlacements:dv,viewport:mb,write:nx},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const Ta=new Map,Jp={set(t,e,n){Ta.has(t)||Ta.set(t,new Map);const i=Ta.get(t);if(!i.has(e)&&i.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`);return}i.set(e,n)},get(t,e){return Ta.has(t)&&Ta.get(t).get(e)||null},remove(t,e){if(!Ta.has(t))return;const n=Ta.get(t);n.delete(e),n.size===0&&Ta.delete(t)}},g7=1e6,v7=1e3,bv="transitionend",Ox=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,(e,n)=>`#${CSS.escape(n)}`)),t),b7=t=>t==null?`${t}`:Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase(),y7=t=>{do t+=Math.floor(Math.random()*g7);while(document.getElementById(t));return t},S7=t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:n}=window.getComputedStyle(t);const i=Number.parseFloat(e),a=Number.parseFloat(n);return!i&&!a?0:(e=e.split(",")[0],n=n.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(n))*v7)},Nx=t=>{t.dispatchEvent(new Event(bv))},Ir=t=>!t||typeof t!="object"?!1:(typeof t.jquery<"u"&&(t=t[0]),typeof t.nodeType<"u"),La=t=>Ir(t)?t.jquery?t[0]:t:typeof t=="string"&&t.length>0?document.querySelector(Ox(t)):null,ul=t=>{if(!Ir(t)||t.getClientRects().length===0)return!1;const e=getComputedStyle(t).getPropertyValue("visibility")==="visible",n=t.closest("details:not([open])");if(!n)return e;if(n!==t){const i=t.closest("summary");if(i&&i.parentNode!==n||i===null)return!1}return e},Ia=t=>!t||t.nodeType!==Node.ELEMENT_NODE||t.classList.contains("disabled")?!0:typeof t.disabled<"u"?t.disabled:t.hasAttribute("disabled")&&t.getAttribute("disabled")!=="false",Dx=t=>{if(!document.documentElement.attachShadow)return null;if(typeof t.getRootNode=="function"){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?Dx(t.parentNode):null},xf=()=>{},nu=t=>{t.offsetHeight},Mx=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,eg=[],T7=t=>{document.readyState==="loading"?(eg.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of eg)e()}),eg.push(t)):t()},fi=()=>document.documentElement.dir==="rtl",pi=t=>{T7(()=>{const e=Mx();if(e){const n=t.NAME,i=e.fn[n];e.fn[n]=t.jQueryInterface,e.fn[n].Constructor=t,e.fn[n].noConflict=()=>(e.fn[n]=i,t.jQueryInterface)}})},_n=(t,e=[],n=t)=>typeof t=="function"?t.call(...e):n,Px=(t,e,n=!0)=>{if(!n){_n(t);return}const a=S7(e)+5;let o=!1;const c=({target:u})=>{u===e&&(o=!0,e.removeEventListener(bv,c),_n(t))};e.addEventListener(bv,c),setTimeout(()=>{o||Nx(e)},a)},Rb=(t,e,n,i)=>{const a=t.length;let o=t.indexOf(e);return o===-1?!n&&i?t[a-1]:t[0]:(o+=n?1:-1,i&&(o=(o+a)%a),t[Math.max(0,Math.min(o,a-1))])},E7=/[^.]*(?=\..*)\.|.*/,C7=/\..*/,k7=/::\d+$/,tg={};let $C=1;const Lx={mouseenter:"mouseover",mouseleave:"mouseout"},_7=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ix(t,e){return e&&`${e}::${$C++}`||t.uidEvent||$C++}function jx(t){const e=Ix(t);return t.uidEvent=e,tg[e]=tg[e]||{},tg[e]}function w7(t,e){return function n(i){return Ab(i,{delegateTarget:t}),n.oneOff&&fe.off(t,i.type,e),e.apply(t,[i])}}function x7(t,e,n){return function i(a){const o=t.querySelectorAll(e);for(let{target:c}=a;c&&c!==this;c=c.parentNode)for(const u of o)if(u===c)return Ab(a,{delegateTarget:c}),i.oneOff&&fe.off(t,a.type,e,n),n.apply(c,[a])}}function Ux(t,e,n=null){return Object.values(t).find(i=>i.callable===e&&i.delegationSelector===n)}function Bx(t,e,n){const i=typeof e=="string",a=i?n:e||n;let o=zx(t);return _7.has(o)||(o=t),[i,a,o]}function GC(t,e,n,i,a){if(typeof e!="string"||!t)return;let[o,c,u]=Bx(e,n,i);e in Lx&&(c=(k=>function(E){if(!E.relatedTarget||E.relatedTarget!==E.delegateTarget&&!E.delegateTarget.contains(E.relatedTarget))return k.call(this,E)})(c));const d=jx(t),h=d[u]||(d[u]={}),m=Ux(h,c,o?n:null);if(m){m.oneOff=m.oneOff&&a;return}const v=Ix(c,e.replace(E7,"")),y=o?x7(t,n,c):w7(t,c);y.delegationSelector=o?n:null,y.callable=c,y.oneOff=a,y.uidEvent=v,h[v]=y,t.addEventListener(u,y,o)}function yv(t,e,n,i,a){const o=Ux(e[n],i,a);o&&(t.removeEventListener(n,o,!!a),delete e[n][o.uidEvent])}function R7(t,e,n,i){const a=e[n]||{};for(const[o,c]of Object.entries(a))o.includes(i)&&yv(t,e,n,c.callable,c.delegationSelector)}function zx(t){return t=t.replace(C7,""),Lx[t]||t}const fe={on(t,e,n,i){GC(t,e,n,i,!1)},one(t,e,n,i){GC(t,e,n,i,!0)},off(t,e,n,i){if(typeof e!="string"||!t)return;const[a,o,c]=Bx(e,n,i),u=c!==e,d=jx(t),h=d[c]||{},m=e.startsWith(".");if(typeof o<"u"){if(!Object.keys(h).length)return;yv(t,d,c,o,a?n:null);return}if(m)for(const v of Object.keys(d))R7(t,d,v,e.slice(1));for(const[v,y]of Object.entries(h)){const T=v.replace(k7,"");(!u||e.includes(T))&&yv(t,d,c,y.callable,y.delegationSelector)}},trigger(t,e,n){if(typeof e!="string"||!t)return null;const i=Mx(),a=zx(e),o=e!==a;let c=null,u=!0,d=!0,h=!1;o&&i&&(c=i.Event(e,n),i(t).trigger(c),u=!c.isPropagationStopped(),d=!c.isImmediatePropagationStopped(),h=c.isDefaultPrevented());const m=Ab(new Event(e,{bubbles:u,cancelable:!0}),n);return h&&m.preventDefault(),d&&t.dispatchEvent(m),m.defaultPrevented&&c&&c.preventDefault(),m}};function Ab(t,e={}){for(const[n,i]of Object.entries(e))try{t[n]=i}catch{Object.defineProperty(t,n,{configurable:!0,get(){return i}})}return t}function YC(t){if(t==="true")return!0;if(t==="false")return!1;if(t===Number(t).toString())return Number(t);if(t===""||t==="null")return null;if(typeof t!="string")return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function ng(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const jr={setDataAttribute(t,e,n){t.setAttribute(`data-bs-${ng(e)}`,n)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${ng(e)}`)},getDataAttributes(t){if(!t)return{};const e={},n=Object.keys(t.dataset).filter(i=>i.startsWith("bs")&&!i.startsWith("bsConfig"));for(const i of n){let a=i.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=YC(t.dataset[i])}return e},getDataAttribute(t,e){return YC(t.getAttribute(`data-bs-${ng(e)}`))}};class iu{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,n){const i=Ir(n)?jr.getDataAttribute(n,"config"):{};return{...this.constructor.Default,...typeof i=="object"?i:{},...Ir(n)?jr.getDataAttributes(n):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,n=this.constructor.DefaultType){for(const[i,a]of Object.entries(n)){const o=e[i],c=Ir(o)?"element":b7(o);if(!new RegExp(a).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${i}" provided type "${c}" but expected type "${a}".`)}}}const A7="5.3.8";class zi extends iu{constructor(e,n){super(),e=La(e),e&&(this._element=e,this._config=this._getConfig(n),Jp.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Jp.remove(this._element,this.constructor.DATA_KEY),fe.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,n,i=!0){Px(e,n,i)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Jp.get(La(e),this.DATA_KEY)}static getOrCreateInstance(e,n={}){return this.getInstance(e)||new this(e,typeof n=="object"?n:null)}static get VERSION(){return A7}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const ig=t=>{let e=t.getAttribute("data-bs-target");if(!e||e==="#"){let n=t.getAttribute("href");if(!n||!n.includes("#")&&!n.startsWith("."))return null;n.includes("#")&&!n.startsWith("#")&&(n=`#${n.split("#")[1]}`),e=n&&n!=="#"?n.trim():null}return e?e.split(",").map(n=>Ox(n)).join(","):null},Pe={find(t,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,t))},findOne(t,e=document.documentElement){return Element.prototype.querySelector.call(e,t)},children(t,e){return[].concat(...t.children).filter(n=>n.matches(e))},parents(t,e){const n=[];let i=t.parentNode.closest(e);for(;i;)n.push(i),i=i.parentNode.closest(e);return n},prev(t,e){let n=t.previousElementSibling;for(;n;){if(n.matches(e))return[n];n=n.previousElementSibling}return[]},next(t,e){let n=t.nextElementSibling;for(;n;){if(n.matches(e))return[n];n=n.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(n=>`${n}:not([tabindex^="-"])`).join(",");return this.find(e,t).filter(n=>!Ia(n)&&ul(n))},getSelectorFromElement(t){const e=ig(t);return e&&Pe.findOne(e)?e:null},getElementFromSelector(t){const e=ig(t);return e?Pe.findOne(e):null},getMultipleElementsFromSelector(t){const e=ig(t);return e?Pe.find(e):[]}},th=(t,e="hide")=>{const n=`click.dismiss${t.EVENT_KEY}`,i=t.NAME;fe.on(document,n,`[data-bs-dismiss="${i}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),Ia(this))return;const o=Pe.getElementFromSelector(this)||this.closest(`.${i}`);t.getOrCreateInstance(o)[e]()})},O7="alert",N7="bs.alert",Vx=`.${N7}`,D7=`close${Vx}`,M7=`closed${Vx}`,P7="fade",L7="show";class nh extends zi{static get NAME(){return O7}close(){if(fe.trigger(this._element,D7).defaultPrevented)return;this._element.classList.remove(L7);const n=this._element.classList.contains(P7);this._queueCallback(()=>this._destroyElement(),this._element,n)}_destroyElement(){this._element.remove(),fe.trigger(this._element,M7),this.dispose()}static jQueryInterface(e){return this.each(function(){const n=nh.getOrCreateInstance(this);if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e](this)}})}}th(nh,"close");pi(nh);const I7="button",j7="bs.button",U7=`.${j7}`,B7=".data-api",z7="active",KC='[data-bs-toggle="button"]',V7=`click${U7}${B7}`;class ih extends zi{static get NAME(){return I7}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(z7))}static jQueryInterface(e){return this.each(function(){const n=ih.getOrCreateInstance(this);e==="toggle"&&n[e]()})}}fe.on(document,V7,KC,t=>{t.preventDefault();const e=t.target.closest(KC);ih.getOrCreateInstance(e).toggle()});pi(ih);const H7="swipe",dl=".bs.swipe",F7=`touchstart${dl}`,q7=`touchmove${dl}`,$7=`touchend${dl}`,G7=`pointerdown${dl}`,Y7=`pointerup${dl}`,K7="touch",Q7="pen",W7="pointer-event",X7=40,Z7={endCallback:null,leftCallback:null,rightCallback:null},J7={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Rf extends iu{constructor(e,n){super(),this._element=e,!(!e||!Rf.isSupported())&&(this._config=this._getConfig(n),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Z7}static get DefaultType(){return J7}static get NAME(){return H7}dispose(){fe.off(this._element,dl)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),_n(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=X7)return;const n=e/this._deltaX;this._deltaX=0,n&&_n(n>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(fe.on(this._element,G7,e=>this._start(e)),fe.on(this._element,Y7,e=>this._end(e)),this._element.classList.add(W7)):(fe.on(this._element,F7,e=>this._start(e)),fe.on(this._element,q7,e=>this._move(e)),fe.on(this._element,$7,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Q7||e.pointerType===K7)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const eB="carousel",tB="bs.carousel",Ha=`.${tB}`,Hx=".data-api",nB="ArrowLeft",iB="ArrowRight",rB=500,Cc="next",xo="prev",No="left",rf="right",aB=`slide${Ha}`,rg=`slid${Ha}`,sB=`keydown${Ha}`,oB=`mouseenter${Ha}`,lB=`mouseleave${Ha}`,cB=`dragstart${Ha}`,uB=`load${Ha}${Hx}`,dB=`click${Ha}${Hx}`,Fx="carousel",Dd="active",fB="slide",hB="carousel-item-end",mB="carousel-item-start",pB="carousel-item-next",gB="carousel-item-prev",qx=".active",$x=".carousel-item",vB=qx+$x,bB=".carousel-item img",yB=".carousel-indicators",SB="[data-bs-slide], [data-bs-slide-to]",TB='[data-bs-ride="carousel"]',EB={[nB]:rf,[iB]:No},CB={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},kB={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class ru extends zi{constructor(e,n){super(e,n),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Pe.findOne(yB,this._element),this._addEventListeners(),this._config.ride===Fx&&this.cycle()}static get Default(){return CB}static get DefaultType(){return kB}static get NAME(){return eB}next(){this._slide(Cc)}nextWhenVisible(){!document.hidden&&ul(this._element)&&this.next()}prev(){this._slide(xo)}pause(){this._isSliding&&Nx(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){fe.one(this._element,rg,()=>this.cycle());return}this.cycle()}}to(e){const n=this._getItems();if(e>n.length-1||e<0)return;if(this._isSliding){fe.one(this._element,rg,()=>this.to(e));return}const i=this._getItemIndex(this._getActive());if(i===e)return;const a=e>i?Cc:xo;this._slide(a,n[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&fe.on(this._element,sB,e=>this._keydown(e)),this._config.pause==="hover"&&(fe.on(this._element,oB,()=>this.pause()),fe.on(this._element,lB,()=>this._maybeEnableCycle())),this._config.touch&&Rf.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const i of Pe.find(bB,this._element))fe.on(i,cB,a=>a.preventDefault());const n={leftCallback:()=>this._slide(this._directionToOrder(No)),rightCallback:()=>this._slide(this._directionToOrder(rf)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),rB+this._config.interval))}};this._swipeHelper=new Rf(this._element,n)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const n=EB[e.key];n&&(e.preventDefault(),this._slide(this._directionToOrder(n)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const n=Pe.findOne(qx,this._indicatorsElement);n.classList.remove(Dd),n.removeAttribute("aria-current");const i=Pe.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);i&&(i.classList.add(Dd),i.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const n=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=n||this._config.defaultInterval}_slide(e,n=null){if(this._isSliding)return;const i=this._getActive(),a=e===Cc,o=n||Rb(this._getItems(),i,a,this._config.wrap);if(o===i)return;const c=this._getItemIndex(o),u=T=>fe.trigger(this._element,T,{relatedTarget:o,direction:this._orderToDirection(e),from:this._getItemIndex(i),to:c});if(u(aB).defaultPrevented||!i||!o)return;const h=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=o;const m=a?mB:hB,v=a?pB:gB;o.classList.add(v),nu(o),i.classList.add(m),o.classList.add(m);const y=()=>{o.classList.remove(m,v),o.classList.add(Dd),i.classList.remove(Dd,v,m),this._isSliding=!1,u(rg)};this._queueCallback(y,i,this._isAnimated()),h&&this.cycle()}_isAnimated(){return this._element.classList.contains(fB)}_getActive(){return Pe.findOne(vB,this._element)}_getItems(){return Pe.find($x,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return fi()?e===No?xo:Cc:e===No?Cc:xo}_orderToDirection(e){return fi()?e===xo?No:rf:e===xo?rf:No}static jQueryInterface(e){return this.each(function(){const n=ru.getOrCreateInstance(this,e);if(typeof e=="number"){n.to(e);return}if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e]()}})}}fe.on(document,dB,SB,function(t){const e=Pe.getElementFromSelector(this);if(!e||!e.classList.contains(Fx))return;t.preventDefault();const n=ru.getOrCreateInstance(e),i=this.getAttribute("data-bs-slide-to");if(i){n.to(i),n._maybeEnableCycle();return}if(jr.getDataAttribute(this,"slide")==="next"){n.next(),n._maybeEnableCycle();return}n.prev(),n._maybeEnableCycle()});fe.on(window,uB,()=>{const t=Pe.find(TB);for(const e of t)ru.getOrCreateInstance(e)});pi(ru);const _B="collapse",wB="bs.collapse",au=`.${wB}`,xB=".data-api",RB=`show${au}`,AB=`shown${au}`,OB=`hide${au}`,NB=`hidden${au}`,DB=`click${au}${xB}`,ag="show",Lo="collapse",Md="collapsing",MB="collapsed",PB=`:scope .${Lo} .${Lo}`,LB="collapse-horizontal",IB="width",jB="height",UB=".collapse.show, .collapse.collapsing",Sv='[data-bs-toggle="collapse"]',BB={parent:null,toggle:!0},zB={parent:"(null|element)",toggle:"boolean"};class Gc extends zi{constructor(e,n){super(e,n),this._isTransitioning=!1,this._triggerArray=[];const i=Pe.find(Sv);for(const a of i){const o=Pe.getSelectorFromElement(a),c=Pe.find(o).filter(u=>u===this._element);o!==null&&c.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return BB}static get DefaultType(){return zB}static get NAME(){return _B}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(UB).filter(u=>u!==this._element).map(u=>Gc.getOrCreateInstance(u,{toggle:!1}))),e.length&&e[0]._isTransitioning||fe.trigger(this._element,RB).defaultPrevented)return;for(const u of e)u.hide();const i=this._getDimension();this._element.classList.remove(Lo),this._element.classList.add(Md),this._element.style[i]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(Md),this._element.classList.add(Lo,ag),this._element.style[i]="",fe.trigger(this._element,AB)},c=`scroll${i[0].toUpperCase()+i.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[i]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||fe.trigger(this._element,OB).defaultPrevented)return;const n=this._getDimension();this._element.style[n]=`${this._element.getBoundingClientRect()[n]}px`,nu(this._element),this._element.classList.add(Md),this._element.classList.remove(Lo,ag);for(const a of this._triggerArray){const o=Pe.getElementFromSelector(a);o&&!this._isShown(o)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Md),this._element.classList.add(Lo),fe.trigger(this._element,NB)};this._element.style[n]="",this._queueCallback(i,this._element,!0)}_isShown(e=this._element){return e.classList.contains(ag)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=La(e.parent),e}_getDimension(){return this._element.classList.contains(LB)?IB:jB}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Sv);for(const n of e){const i=Pe.getElementFromSelector(n);i&&this._addAriaAndCollapsedClass([n],this._isShown(i))}}_getFirstLevelChildren(e){const n=Pe.find(PB,this._config.parent);return Pe.find(e,this._config.parent).filter(i=>!n.includes(i))}_addAriaAndCollapsedClass(e,n){if(e.length)for(const i of e)i.classList.toggle(MB,!n),i.setAttribute("aria-expanded",n)}static jQueryInterface(e){const n={};return typeof e=="string"&&/show|hide/.test(e)&&(n.toggle=!1),this.each(function(){const i=Gc.getOrCreateInstance(this,n);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e]()}})}}fe.on(document,DB,Sv,function(t){(t.target.tagName==="A"||t.delegateTarget&&t.delegateTarget.tagName==="A")&&t.preventDefault();for(const e of Pe.getMultipleElementsFromSelector(this))Gc.getOrCreateInstance(e,{toggle:!1}).toggle()});pi(Gc);const QC="dropdown",VB="bs.dropdown",Ls=`.${VB}`,Ob=".data-api",HB="Escape",WC="Tab",FB="ArrowUp",XC="ArrowDown",qB=2,$B=`hide${Ls}`,GB=`hidden${Ls}`,YB=`show${Ls}`,KB=`shown${Ls}`,Gx=`click${Ls}${Ob}`,Yx=`keydown${Ls}${Ob}`,QB=`keyup${Ls}${Ob}`,Do="show",WB="dropup",XB="dropend",ZB="dropstart",JB="dropup-center",e9="dropdown-center",vs='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',t9=`${vs}.${Do}`,af=".dropdown-menu",n9=".navbar",i9=".navbar-nav",r9=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",a9=fi()?"top-end":"top-start",s9=fi()?"top-start":"top-end",o9=fi()?"bottom-end":"bottom-start",l9=fi()?"bottom-start":"bottom-end",c9=fi()?"left-start":"right-start",u9=fi()?"right-start":"left-start",d9="top",f9="bottom",h9={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},m9={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ir extends zi{constructor(e,n){super(e,n),this._popper=null,this._parent=this._element.parentNode,this._menu=Pe.next(this._element,af)[0]||Pe.prev(this._element,af)[0]||Pe.findOne(af,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return h9}static get DefaultType(){return m9}static get NAME(){return QC}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ia(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!fe.trigger(this._element,YB,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(i9))for(const i of[].concat(...document.body.children))fe.on(i,"mouseover",xf);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Do),this._element.classList.add(Do),fe.trigger(this._element,KB,e)}}hide(){if(Ia(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!fe.trigger(this._element,$B,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))fe.off(i,"mouseover",xf);this._popper&&this._popper.destroy(),this._menu.classList.remove(Do),this._element.classList.remove(Do),this._element.setAttribute("aria-expanded","false"),jr.removeDataAttribute(this._menu,"popper"),fe.trigger(this._element,GB,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ir(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${QC.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Ax>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ir(this._config.reference)?e=La(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const n=this._getPopperConfig();this._popper=xb(e,this._menu,n)}_isShown(){return this._menu.classList.contains(Do)}_getPlacement(){const e=this._parent;if(e.classList.contains(XB))return c9;if(e.classList.contains(ZB))return u9;if(e.classList.contains(JB))return d9;if(e.classList.contains(e9))return f9;const n=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(WB)?n?s9:a9:n?l9:o9}_detectNavbar(){return this._element.closest(n9)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(n=>Number.parseInt(n,10)):typeof e=="function"?n=>e(n,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(jr.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,..._n(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:n}){const i=Pe.find(r9,this._menu).filter(a=>ul(a));i.length&&Rb(i,n,e===XC,!i.includes(n)).focus()}static jQueryInterface(e){return this.each(function(){const n=ir.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e]()}})}static clearMenus(e){if(e.button===qB||e.type==="keyup"&&e.key!==WC)return;const n=Pe.find(t9);for(const i of n){const a=ir.getInstance(i);if(!a||a._config.autoClose===!1)continue;const o=e.composedPath(),c=o.includes(a._menu);if(o.includes(a._element)||a._config.autoClose==="inside"&&!c||a._config.autoClose==="outside"&&c||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===WC||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const u={relatedTarget:a._element};e.type==="click"&&(u.clickEvent=e),a._completeHide(u)}}static dataApiKeydownHandler(e){const n=/input|textarea/i.test(e.target.tagName),i=e.key===HB,a=[FB,XC].includes(e.key);if(!a&&!i||n&&!i)return;e.preventDefault();const o=this.matches(vs)?this:Pe.prev(this,vs)[0]||Pe.next(this,vs)[0]||Pe.findOne(vs,e.delegateTarget.parentNode),c=ir.getOrCreateInstance(o);if(a){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),o.focus())}}fe.on(document,Yx,vs,ir.dataApiKeydownHandler);fe.on(document,Yx,af,ir.dataApiKeydownHandler);fe.on(document,Gx,ir.clearMenus);fe.on(document,QB,ir.clearMenus);fe.on(document,Gx,vs,function(t){t.preventDefault(),ir.getOrCreateInstance(this).toggle()});pi(ir);const Kx="backdrop",p9="fade",ZC="show",JC=`mousedown.bs.${Kx}`,g9={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},v9={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Qx extends iu{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return g9}static get DefaultType(){return v9}static get NAME(){return Kx}show(e){if(!this._config.isVisible){_n(e);return}this._append();const n=this._getElement();this._config.isAnimated&&nu(n),n.classList.add(ZC),this._emulateAnimation(()=>{_n(e)})}hide(e){if(!this._config.isVisible){_n(e);return}this._getElement().classList.remove(ZC),this._emulateAnimation(()=>{this.dispose(),_n(e)})}dispose(){this._isAppended&&(fe.off(this._element,JC),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(p9),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=La(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),fe.on(e,JC,()=>{_n(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Px(e,this._getElement(),this._config.isAnimated)}}const b9="focustrap",y9="bs.focustrap",Af=`.${y9}`,S9=`focusin${Af}`,T9=`keydown.tab${Af}`,E9="Tab",C9="forward",ek="backward",k9={autofocus:!0,trapElement:null},_9={autofocus:"boolean",trapElement:"element"};class Wx extends iu{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return k9}static get DefaultType(){return _9}static get NAME(){return b9}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),fe.off(document,Af),fe.on(document,S9,e=>this._handleFocusin(e)),fe.on(document,T9,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,fe.off(document,Af))}_handleFocusin(e){const{trapElement:n}=this._config;if(e.target===document||e.target===n||n.contains(e.target))return;const i=Pe.focusableChildren(n);i.length===0?n.focus():this._lastTabNavDirection===ek?i[i.length-1].focus():i[0].focus()}_handleKeydown(e){e.key===E9&&(this._lastTabNavDirection=e.shiftKey?ek:C9)}}const tk=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",nk=".sticky-top",Pd="padding-right",ik="margin-right";class Tv{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Pd,n=>n+e),this._setElementAttributes(tk,Pd,n=>n+e),this._setElementAttributes(nk,ik,n=>n-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Pd),this._resetElementAttributes(tk,Pd),this._resetElementAttributes(nk,ik)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,n,i){const a=this.getWidth(),o=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+a)return;this._saveInitialAttribute(c,n);const u=window.getComputedStyle(c).getPropertyValue(n);c.style.setProperty(n,`${i(Number.parseFloat(u))}px`)};this._applyManipulationCallback(e,o)}_saveInitialAttribute(e,n){const i=e.style.getPropertyValue(n);i&&jr.setDataAttribute(e,n,i)}_resetElementAttributes(e,n){const i=a=>{const o=jr.getDataAttribute(a,n);if(o===null){a.style.removeProperty(n);return}jr.removeDataAttribute(a,n),a.style.setProperty(n,o)};this._applyManipulationCallback(e,i)}_applyManipulationCallback(e,n){if(Ir(e)){n(e);return}for(const i of Pe.find(e,this._element))n(i)}}const w9="modal",x9="bs.modal",hi=`.${x9}`,R9=".data-api",A9="Escape",O9=`hide${hi}`,N9=`hidePrevented${hi}`,Xx=`hidden${hi}`,Zx=`show${hi}`,D9=`shown${hi}`,M9=`resize${hi}`,P9=`click.dismiss${hi}`,L9=`mousedown.dismiss${hi}`,I9=`keydown.dismiss${hi}`,j9=`click${hi}${R9}`,rk="modal-open",U9="fade",ak="show",sg="modal-static",B9=".modal.show",z9=".modal-dialog",V9=".modal-body",H9='[data-bs-toggle="modal"]',F9={backdrop:!0,focus:!0,keyboard:!0},q9={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class tl extends zi{constructor(e,n){super(e,n),this._dialog=Pe.findOne(z9,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Tv,this._addEventListeners()}static get Default(){return F9}static get DefaultType(){return q9}static get NAME(){return w9}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||fe.trigger(this._element,Zx,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(rk),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||fe.trigger(this._element,O9).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(ak),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){fe.off(window,hi),fe.off(this._dialog,hi),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Qx({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Wx({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const n=Pe.findOne(V9,this._dialog);n&&(n.scrollTop=0),nu(this._element),this._element.classList.add(ak);const i=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,fe.trigger(this._element,D9,{relatedTarget:e})};this._queueCallback(i,this._dialog,this._isAnimated())}_addEventListeners(){fe.on(this._element,I9,e=>{if(e.key===A9){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),fe.on(window,M9,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),fe.on(this._element,L9,e=>{fe.one(this._element,P9,n=>{if(!(this._element!==e.target||this._element!==n.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(rk),this._resetAdjustments(),this._scrollBar.reset(),fe.trigger(this._element,Xx)})}_isAnimated(){return this._element.classList.contains(U9)}_triggerBackdropTransition(){if(fe.trigger(this._element,N9).defaultPrevented)return;const n=this._element.scrollHeight>document.documentElement.clientHeight,i=this._element.style.overflowY;i==="hidden"||this._element.classList.contains(sg)||(n||(this._element.style.overflowY="hidden"),this._element.classList.add(sg),this._queueCallback(()=>{this._element.classList.remove(sg),this._queueCallback(()=>{this._element.style.overflowY=i},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,n=this._scrollBar.getWidth(),i=n>0;if(i&&!e){const a=fi()?"paddingLeft":"paddingRight";this._element.style[a]=`${n}px`}if(!i&&e){const a=fi()?"paddingRight":"paddingLeft";this._element.style[a]=`${n}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,n){return this.each(function(){const i=tl.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof i[e]>"u")throw new TypeError(`No method named "${e}"`);i[e](n)}})}}fe.on(document,j9,H9,function(t){const e=Pe.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),fe.one(e,Zx,a=>{a.defaultPrevented||fe.one(e,Xx,()=>{ul(this)&&this.focus()})});const n=Pe.findOne(B9);n&&tl.getInstance(n).hide(),tl.getOrCreateInstance(e).toggle(this)});th(tl);pi(tl);const $9="offcanvas",G9="bs.offcanvas",qr=`.${G9}`,Jx=".data-api",Y9=`load${qr}${Jx}`,K9="Escape",sk="show",ok="showing",lk="hiding",Q9="offcanvas-backdrop",eR=".offcanvas.show",W9=`show${qr}`,X9=`shown${qr}`,Z9=`hide${qr}`,ck=`hidePrevented${qr}`,tR=`hidden${qr}`,J9=`resize${qr}`,e8=`click${qr}${Jx}`,t8=`keydown.dismiss${qr}`,n8='[data-bs-toggle="offcanvas"]',i8={backdrop:!0,keyboard:!0,scroll:!1},r8={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ja extends zi{constructor(e,n){super(e,n),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return i8}static get DefaultType(){return r8}static get NAME(){return $9}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||fe.trigger(this._element,W9,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Tv().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(ok);const i=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(sk),this._element.classList.remove(ok),fe.trigger(this._element,X9,{relatedTarget:e})};this._queueCallback(i,this._element,!0)}hide(){if(!this._isShown||fe.trigger(this._element,Z9).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(lk),this._backdrop.hide();const n=()=>{this._element.classList.remove(sk,lk),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Tv().reset(),fe.trigger(this._element,tR)};this._queueCallback(n,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){fe.trigger(this._element,ck);return}this.hide()},n=!!this._config.backdrop;return new Qx({className:Q9,isVisible:n,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:n?e:null})}_initializeFocusTrap(){return new Wx({trapElement:this._element})}_addEventListeners(){fe.on(this._element,t8,e=>{if(e.key===K9){if(this._config.keyboard){this.hide();return}fe.trigger(this._element,ck)}})}static jQueryInterface(e){return this.each(function(){const n=ja.getOrCreateInstance(this,e);if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e](this)}})}}fe.on(document,e8,n8,function(t){const e=Pe.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),Ia(this))return;fe.one(e,tR,()=>{ul(this)&&this.focus()});const n=Pe.findOne(eR);n&&n!==e&&ja.getInstance(n).hide(),ja.getOrCreateInstance(e).toggle(this)});fe.on(window,Y9,()=>{for(const t of Pe.find(eR))ja.getOrCreateInstance(t).show()});fe.on(window,J9,()=>{for(const t of Pe.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(t).position!=="fixed"&&ja.getOrCreateInstance(t).hide()});th(ja);pi(ja);const a8=/^aria-[\w-]*$/i,nR={"*":["class","dir","id","lang","role",a8],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},s8=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),o8=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,l8=(t,e)=>{const n=t.nodeName.toLowerCase();return e.includes(n)?s8.has(n)?!!o8.test(t.nodeValue):!0:e.filter(i=>i instanceof RegExp).some(i=>i.test(n))};function c8(t,e,n){if(!t.length)return t;if(n&&typeof n=="function")return n(t);const a=new window.DOMParser().parseFromString(t,"text/html"),o=[].concat(...a.body.querySelectorAll("*"));for(const c of o){const u=c.nodeName.toLowerCase();if(!Object.keys(e).includes(u)){c.remove();continue}const d=[].concat(...c.attributes),h=[].concat(e["*"]||[],e[u]||[]);for(const m of d)l8(m,h)||c.removeAttribute(m.nodeName)}return a.body.innerHTML}const u8="TemplateFactory",d8={allowList:nR,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},f8={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},h8={entry:"(string|element|function|null)",selector:"(string|element)"};class m8 extends iu{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return d8}static get DefaultType(){return f8}static get NAME(){return u8}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,o]of Object.entries(this._config.content))this._setContent(e,o,a);const n=e.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&n.classList.add(...i.split(" ")),n}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[n,i]of Object.entries(e))super._typeCheckConfig({selector:n,entry:i},h8)}_setContent(e,n,i){const a=Pe.findOne(i,e);if(a){if(n=this._resolvePossibleFunction(n),!n){a.remove();return}if(Ir(n)){this._putElementInTemplate(La(n),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(n);return}a.textContent=n}}_maybeSanitize(e){return this._config.sanitize?c8(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return _n(e,[void 0,this])}_putElementInTemplate(e,n){if(this._config.html){n.innerHTML="",n.append(e);return}n.textContent=e.textContent}}const p8="tooltip",g8=new Set(["sanitize","allowList","sanitizeFn"]),og="fade",v8="modal",Ld="show",b8=".tooltip-inner",uk=`.${v8}`,dk="hide.bs.modal",kc="hover",lg="focus",cg="click",y8="manual",S8="hide",T8="hidden",E8="show",C8="shown",k8="inserted",_8="click",w8="focusin",x8="focusout",R8="mouseenter",A8="mouseleave",O8={AUTO:"auto",TOP:"top",RIGHT:fi()?"left":"right",BOTTOM:"bottom",LEFT:fi()?"right":"left"},N8={allowList:nR,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},D8={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class fl extends zi{constructor(e,n){if(typeof Ax>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,n),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return N8}static get DefaultType(){return D8}static get NAME(){return p8}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),fe.off(this._element.closest(uk),dk,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=fe.trigger(this._element,this.constructor.eventName(E8)),i=(Dx(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!i)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:o}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(o.append(a),fe.trigger(this._element,this.constructor.eventName(k8))),this._popper=this._createPopper(a),a.classList.add(Ld),"ontouchstart"in document.documentElement)for(const u of[].concat(...document.body.children))fe.on(u,"mouseover",xf);const c=()=>{fe.trigger(this._element,this.constructor.eventName(C8)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||fe.trigger(this._element,this.constructor.eventName(S8)).defaultPrevented)return;if(this._getTipElement().classList.remove(Ld),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))fe.off(a,"mouseover",xf);this._activeTrigger[cg]=!1,this._activeTrigger[lg]=!1,this._activeTrigger[kc]=!1,this._isHovered=null;const i=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),fe.trigger(this._element,this.constructor.eventName(T8)))};this._queueCallback(i,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const n=this._getTemplateFactory(e).toHtml();if(!n)return null;n.classList.remove(og,Ld),n.classList.add(`bs-${this.constructor.NAME}-auto`);const i=y7(this.constructor.NAME).toString();return n.setAttribute("id",i),this._isAnimated()&&n.classList.add(og),n}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new m8({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[b8]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(og)}_isShown(){return this.tip&&this.tip.classList.contains(Ld)}_createPopper(e){const n=_n(this._config.placement,[this,e,this._element]),i=O8[n.toUpperCase()];return xb(this._element,e,this._getPopperConfig(i))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(n=>Number.parseInt(n,10)):typeof e=="function"?n=>e(n,this._element):e}_resolvePossibleFunction(e){return _n(e,[this._element,this._element])}_getPopperConfig(e){const n={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:i=>{this._getTipElement().setAttribute("data-popper-placement",i.state.placement)}}]};return{...n,..._n(this._config.popperConfig,[void 0,n])}}_setListeners(){const e=this._config.trigger.split(" ");for(const n of e)if(n==="click")fe.on(this._element,this.constructor.eventName(_8),this._config.selector,i=>{const a=this._initializeOnDelegatedTarget(i);a._activeTrigger[cg]=!(a._isShown()&&a._activeTrigger[cg]),a.toggle()});else if(n!==y8){const i=n===kc?this.constructor.eventName(R8):this.constructor.eventName(w8),a=n===kc?this.constructor.eventName(A8):this.constructor.eventName(x8);fe.on(this._element,i,this._config.selector,o=>{const c=this._initializeOnDelegatedTarget(o);c._activeTrigger[o.type==="focusin"?lg:kc]=!0,c._enter()}),fe.on(this._element,a,this._config.selector,o=>{const c=this._initializeOnDelegatedTarget(o);c._activeTrigger[o.type==="focusout"?lg:kc]=c._element.contains(o.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},fe.on(this._element.closest(uk),dk,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,n){clearTimeout(this._timeout),this._timeout=setTimeout(e,n)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const n=jr.getDataAttributes(this._element);for(const i of Object.keys(n))g8.has(i)&&delete n[i];return e={...n,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:La(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[n,i]of Object.entries(this._config))this.constructor.Default[n]!==i&&(e[n]=i);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const n=fl.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e]()}})}}pi(fl);const M8="popover",P8=".popover-header",L8=".popover-body",I8={...fl.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},j8={...fl.DefaultType,content:"(null|string|element|function)"};class Nb extends fl{static get Default(){return I8}static get DefaultType(){return j8}static get NAME(){return M8}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[P8]:this._getTitle(),[L8]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const n=Nb.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e]()}})}}pi(Nb);const U8="scrollspy",B8="bs.scrollspy",Db=`.${B8}`,z8=".data-api",V8=`activate${Db}`,fk=`click${Db}`,H8=`load${Db}${z8}`,F8="dropdown-item",Ro="active",q8='[data-bs-spy="scroll"]',ug="[href]",$8=".nav, .list-group",hk=".nav-link",G8=".nav-item",Y8=".list-group-item",K8=`${hk}, ${G8} > ${hk}, ${Y8}`,Q8=".dropdown",W8=".dropdown-toggle",X8={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Z8={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class rh extends zi{constructor(e,n){super(e,n),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return X8}static get DefaultType(){return Z8}static get NAME(){return U8}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=La(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(n=>Number.parseFloat(n))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(fe.off(this._config.target,fk),fe.on(this._config.target,fk,ug,e=>{const n=this._observableSections.get(e.target.hash);if(n){e.preventDefault();const i=this._rootElement||window,a=n.offsetTop-this._element.offsetTop;if(i.scrollTo){i.scrollTo({top:a,behavior:"smooth"});return}i.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(n=>this._observerCallback(n),e)}_observerCallback(e){const n=c=>this._targetLinks.get(`#${c.target.id}`),i=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(n(c))},a=(this._rootElement||document.documentElement).scrollTop,o=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(n(c));continue}const u=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(o&&u){if(i(c),!a)return;continue}!o&&!u&&i(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Pe.find(ug,this._config.target);for(const n of e){if(!n.hash||Ia(n))continue;const i=Pe.findOne(decodeURI(n.hash),this._element);ul(i)&&(this._targetLinks.set(decodeURI(n.hash),n),this._observableSections.set(n.hash,i))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Ro),this._activateParents(e),fe.trigger(this._element,V8,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(F8)){Pe.findOne(W8,e.closest(Q8)).classList.add(Ro);return}for(const n of Pe.parents(e,$8))for(const i of Pe.prev(n,K8))i.classList.add(Ro)}_clearActiveClass(e){e.classList.remove(Ro);const n=Pe.find(`${ug}.${Ro}`,e);for(const i of n)i.classList.remove(Ro)}static jQueryInterface(e){return this.each(function(){const n=rh.getOrCreateInstance(this,e);if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e]()}})}}fe.on(window,H8,()=>{for(const t of Pe.find(q8))rh.getOrCreateInstance(t)});pi(rh);const J8="tab",ez="bs.tab",Is=`.${ez}`,tz=`hide${Is}`,nz=`hidden${Is}`,iz=`show${Is}`,rz=`shown${Is}`,az=`click${Is}`,sz=`keydown${Is}`,oz=`load${Is}`,lz="ArrowLeft",mk="ArrowRight",cz="ArrowUp",pk="ArrowDown",dg="Home",gk="End",bs="active",vk="fade",fg="show",uz="dropdown",iR=".dropdown-toggle",dz=".dropdown-menu",hg=`:not(${iR})`,fz='.list-group, .nav, [role="tablist"]',hz=".nav-item, .list-group-item",mz=`.nav-link${hg}, .list-group-item${hg}, [role="tab"]${hg}`,rR='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',mg=`${mz}, ${rR}`,pz=`.${bs}[data-bs-toggle="tab"], .${bs}[data-bs-toggle="pill"], .${bs}[data-bs-toggle="list"]`;class nl extends zi{constructor(e){super(e),this._parent=this._element.closest(fz),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),fe.on(this._element,sz,n=>this._keydown(n)))}static get NAME(){return J8}show(){const e=this._element;if(this._elemIsActive(e))return;const n=this._getActiveElem(),i=n?fe.trigger(n,tz,{relatedTarget:e}):null;fe.trigger(e,iz,{relatedTarget:n}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(n,e),this._activate(e,n))}_activate(e,n){if(!e)return;e.classList.add(bs),this._activate(Pe.getElementFromSelector(e));const i=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(fg);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),fe.trigger(e,rz,{relatedTarget:n})};this._queueCallback(i,e,e.classList.contains(vk))}_deactivate(e,n){if(!e)return;e.classList.remove(bs),e.blur(),this._deactivate(Pe.getElementFromSelector(e));const i=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(fg);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),fe.trigger(e,nz,{relatedTarget:n})};this._queueCallback(i,e,e.classList.contains(vk))}_keydown(e){if(![lz,mk,cz,pk,dg,gk].includes(e.key))return;e.stopPropagation(),e.preventDefault();const n=this._getChildren().filter(a=>!Ia(a));let i;if([dg,gk].includes(e.key))i=n[e.key===dg?0:n.length-1];else{const a=[mk,pk].includes(e.key);i=Rb(n,e.target,a,!0)}i&&(i.focus({preventScroll:!0}),nl.getOrCreateInstance(i).show())}_getChildren(){return Pe.find(mg,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,n){this._setAttributeIfNotExists(e,"role","tablist");for(const i of n)this._setInitialAttributesOnChild(i)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const n=this._elemIsActive(e),i=this._getOuterElement(e);e.setAttribute("aria-selected",n),i!==e&&this._setAttributeIfNotExists(i,"role","presentation"),n||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const n=Pe.getElementFromSelector(e);n&&(this._setAttributeIfNotExists(n,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(n,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,n){const i=this._getOuterElement(e);if(!i.classList.contains(uz))return;const a=(o,c)=>{const u=Pe.findOne(o,i);u&&u.classList.toggle(c,n)};a(iR,bs),a(dz,fg),i.setAttribute("aria-expanded",n)}_setAttributeIfNotExists(e,n,i){e.hasAttribute(n)||e.setAttribute(n,i)}_elemIsActive(e){return e.classList.contains(bs)}_getInnerElement(e){return e.matches(mg)?e:Pe.findOne(mg,e)}_getOuterElement(e){return e.closest(hz)||e}static jQueryInterface(e){return this.each(function(){const n=nl.getOrCreateInstance(this);if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e]()}})}}fe.on(document,az,rR,function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),!Ia(this)&&nl.getOrCreateInstance(this).show()});fe.on(window,oz,()=>{for(const t of Pe.find(pz))nl.getOrCreateInstance(t)});pi(nl);const gz="toast",vz="bs.toast",Fa=`.${vz}`,bz=`mouseover${Fa}`,yz=`mouseout${Fa}`,Sz=`focusin${Fa}`,Tz=`focusout${Fa}`,Ez=`hide${Fa}`,Cz=`hidden${Fa}`,kz=`show${Fa}`,_z=`shown${Fa}`,wz="fade",bk="hide",Id="show",jd="showing",xz={animation:"boolean",autohide:"boolean",delay:"number"},Rz={animation:!0,autohide:!0,delay:5e3};class ah extends zi{constructor(e,n){super(e,n),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Rz}static get DefaultType(){return xz}static get NAME(){return gz}show(){if(fe.trigger(this._element,kz).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(wz);const n=()=>{this._element.classList.remove(jd),fe.trigger(this._element,_z),this._maybeScheduleHide()};this._element.classList.remove(bk),nu(this._element),this._element.classList.add(Id,jd),this._queueCallback(n,this._element,this._config.animation)}hide(){if(!this.isShown()||fe.trigger(this._element,Ez).defaultPrevented)return;const n=()=>{this._element.classList.add(bk),this._element.classList.remove(jd,Id),fe.trigger(this._element,Cz)};this._element.classList.add(jd),this._queueCallback(n,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Id),super.dispose()}isShown(){return this._element.classList.contains(Id)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,n){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=n;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=n;break}}if(n){this._clearTimeout();return}const i=e.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){fe.on(this._element,bz,e=>this._onInteraction(e,!0)),fe.on(this._element,yz,e=>this._onInteraction(e,!1)),fe.on(this._element,Sz,e=>this._onInteraction(e,!0)),fe.on(this._element,Tz,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const n=ah.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e](this)}})}}th(ah);pi(ah);function Az(){const[t,e]=b.useState("");return b.useEffect(()=>{const n=new URLSearchParams(location.search).get("session_id");if(!n){e("ID");return}fetch(`http://localhost:8000/api/billing/session/${encodeURIComponent(n)}`).then(i=>i.ok?i.json():Promise.reject(i)).then(i=>{e(i?.status==="paid"?"":"/")}).catch(async i=>{let a="";if(i&&i.json)try{const o=await i.json();a+=` (${o?.error??o?.message??""})`}catch{}e(a)})},[]),S.jsx("div",{className:"min-h-screen grid place-items-center p-6",children:S.jsxs("div",{className:"max-w-md w-full rounded-2xl border p-6",children:[S.jsx("h1",{className:"text-xl font-semibold mb-3",children:""}),S.jsx("p",{children:t}),S.jsx("a",{className:"text-indigo-600 underline mt-4 inline-block",href:"/admin/site",children:""})]})})}function Oz(){return S.jsx("div",{className:"min-h-screen grid place-items-center p-6",children:S.jsxs("div",{className:"max-w-md w-full rounded-2xl border p-6",children:[S.jsx("h1",{className:"text-xl font-semibold mb-3",children:""}),S.jsx("p",{children:""}),S.jsx("a",{className:"text-indigo-600 underline mt-4 inline-block",href:"/signup",children:""})]})})}function Nz(){const[t,e]=b.useState("loading");return b.useEffect(()=>{let n=!0;return di("/me").then(()=>n&&e("ok")).catch(()=>n&&e("ng")),()=>{n=!1}},[]),t==="loading"?null:t==="ng"?S.jsx(Vk,{to:"/admin/login",replace:!0}):S.jsx(Rv,{})}qo(null);const Dz=yD([{path:"/s/:slug/*",element:S.jsx(Z4,{})},{path:"/s/:slug/reserve",element:S.jsx(MC,{})},{path:"/",element:S.jsx(UD,{}),children:[{index:!0,element:S.jsx(t7,{})},{path:"reserve",element:S.jsx(MC,{})},{path:"thanks",element:S.jsx(u7,{})},{path:"offices",element:S.jsx(i7,{})},{path:"signup",element:S.jsx(l7,{})},{path:":tenant/reserve",element:S.jsx(H4,{})},{path:"/billing/success",element:S.jsx(Az,{})},{path:"/billing/cancel",element:S.jsx(Oz,{})},{path:"tenants/:slug",element:S.jsx(s7,{})},{path:"wait",element:S.jsx(EU,{})},{path:"host",element:S.jsx(MU,{})},{path:"join",element:S.jsx(N5,{})},{path:"quick",element:S.jsx(LU,{})}]},{path:"/admin/login",element:S.jsx(UU,{})},{path:"/admin",element:S.jsx(Nz,{}),children:[{element:S.jsx(BU,{}),children:[{index:!0,element:S.jsx(Vk,{to:"dashboard",replace:!0})},{path:"dashboard",element:S.jsx(VU,{})},{path:"charts",element:S.jsx(HU,{})},{path:"tables",element:S.jsx(FU,{})},{path:"site",element:S.jsx(B4,{})}]}]},{path:"*",element:S.jsx("div",{style:{padding:24},children:"Not Found"})}]);yO.createRoot(document.getElementById("root")).render(S.jsx(hO.StrictMode,{children:S.jsx(IU,{children:S.jsx(DD,{router:Dz})})}));
