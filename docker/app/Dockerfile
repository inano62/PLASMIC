FROM php:8.3-fpm-alpine

RUN apk add --no-cache \
    bash git vim wget curl tzdata \
    icu-dev oniguruma-dev \
    libpng-dev libjpeg-turbo-dev freetype-dev \
    libzip-dev libxml2-dev postgresql-dev \
    linux-headers \
    $PHPIZE_DEPS

# Laravel å¿…é ˆæ‹¡å¼µã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
RUN docker-php-ext-configure gd --with-freetype --with-jpeg \
 && docker-php-ext-install -j"$(nproc)" \
    gd pdo pdo_mysql mysqli intl zip bcmath opcache dom

# ğŸ‘‡ composer ã‚’å…¬å¼ã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰ã‚³ãƒ”ãƒ¼
COPY --from=composer:2 /usr/bin/composer /usr/local/bin/composer

# ğŸ‘‡ apk çµŒç”±ã§å…¥ã£ãŸ PHP83 ã‚’å‰Šé™¤ï¼ˆã‚‚ã—æ®‹ã£ã¦ã„ã‚Œã°ï¼‰
RUN apk del composer php83 php83-common || true

# ğŸ‘‡ PHPã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ composer ãŒç¢ºå®Ÿã«ä½¿ãˆã‚‹ã‚ˆã†ã«
RUN ln -sf /usr/local/bin/php /usr/bin/php

WORKDIR /var/www
